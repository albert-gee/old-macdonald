<!DOCTYPE html><html><head><meta charset="UTF-8"><script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-bash.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-c.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-cmake.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-cpp.min.js"></script><style>
        .article {
            position: relative;
            padding-bottom: 24px;
        }
        

        .center {
            display: block;
            margin-left: auto;
            margin-right: auto;
        }
        

        .code-block {
            overflow: hidden;
            position: relative;
            padding: 0;
            border-radius: 8px;
            font-variant-ligatures: none;
            background-color: rgba(25, 25, 28, .05);
            word-break: break-all;
        }
        

        .control {
            color: #19191c;
            font-size: 16px;
            font-weight: 670;
        }
        

        .detached {
            margin-block-start: 0;
            margin-block-end: 0;
            margin-bottom: 8px;
        }
        

        .emphasis {
            color: inherit;
            font-weight: inherit;
            font-style: italic;
        }
        

        .header-row {
            background: #e6e6e6;
        }
        

        .image {
            max-width: 100%;
            max-height: 90vh;
            height: auto;
        }
        

        .image-container {
            max-width: 100vw;
        }
        

        .inline-code {
            border-radius: 4px;
            display: inline;
            padding: 2px 1px;
            font-family: JetBrains Sans,monospace;
            background: #e6e6e6;
        }
        

        .list {
            list-style-type: disc;
            padding-left: 0;
            margin-left: 15px;
        }
        

        .list-decimal {
            list-style-type: decimal;
        }
        

        .list-item {
            margin-top: 6px;
            margin-bottom: 6px;
            margin-left: 4px;
        }
        

        .main-title {
            padding-bottom: 24px;
            margin-top: 0;
            font-size: 40px;
            margin-block-start: 0;
            margin-block-end: 0;
        }
        

        .prism {
            page-break-inside: avoid;
        }
        
        /* PrismJS 1.29.0
https://prismjs.com/download.html#themes=prism&languages=markup+css+clike+javascript+abap+abnf+actionscript+ada+agda+al+antlr4+apacheconf+apex+apl+applescript+aql+arduino+arff+armasm+arturo+asciidoc+aspnet+asm6502+asmatmel+autohotkey+autoit+avisynth+avro-idl+awk+bash+basic+batch+bbcode+bbj+bicep+birb+bison+bnf+bqn+brainfuck+brightscript+bro+bsl+c+csharp+cpp+cfscript+chaiscript+cil+cilkc+cilkcpp+clojure+cmake+cobol+coffeescript+concurnas+csp+cooklang+coq+crystal+css-extras+csv+cue+cypher+d+dart+dataweave+dax+dhall+diff+django+dns-zone-file+docker+dot+ebnf+editorconfig+eiffel+ejs+elixir+elm+etlua+erb+erlang+excel-formula+fsharp+factor+false+firestore-security-rules+flow+fortran+ftl+gml+gap+gcode+gdscript+gedcom+gettext+gherkin+git+glsl+gn+linker-script+go+go-module+gradle+graphql+groovy+haml+handlebars+haskell+haxe+hcl+hlsl+hoon+http+hpkp+hsts+ichigojam+icon+icu-message-format+idris+ignore+inform7+ini+io+j+java+javadoc+javadoclike+javastacktrace+jexl+jolie+jq+jsdoc+js-extras+json+json5+jsonp+jsstacktrace+js-templates+julia+keepalived+keyman+kotlin+kumir+kusto+latex+latte+less+lilypond+liquid+lisp+livescript+llvm+log+lolcode+lua+magma+makefile+markdown+markup-templating+mata+matlab+maxscript+mel+mermaid+metafont+mizar+mongodb+monkey+moonscript+n1ql+n4js+nand2tetris-hdl+naniscript+nasm+neon+nevod+nginx+nim+nix+nsis+objectivec+ocaml+odin+opencl+openqasm+oz+parigp+parser+pascal+pascaligo+psl+pcaxis+peoplecode+perl+php+phpdoc+php-extras+plant-uml+plsql+powerquery+powershell+processing+prolog+promql+properties+protobuf+pug+puppet+pure+purebasic+purescript+python+qsharp+q+qml+qore+r+racket+cshtml+jsx+tsx+reason+regex+rego+renpy+rescript+rest+rip+roboconf+robotframework+ruby+rust+sas+sass+scss+scala+scheme+shell-session+smali+smalltalk+smarty+sml+solidity+solution-file+soy+sparql+splunk-spl+sqf+sql+squirrel+stan+stata+iecst+stylus+supercollider+swift+systemd+t4-templating+t4-cs+t4-vb+tap+tcl+tt2+textile+toml+tremor+turtle+twig+typescript+typoscript+unrealscript+uorazor+uri+v+vala+vbnet+velocity+verilog+vhdl+vim+visual-basic+warpscript+wasm+web-idl+wgsl+wiki+wolfram+wren+xeora+xml-doc+xojo+xquery+yaml+yang+zig&plugins=highlight-keywords */
code[class*=language-],pre[class*=language-]{color:#000;background:0 0;text-shadow:0 1px #fff;font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{text-shadow:none;background:#b3d4fc}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:16px;margin:0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}

        

        :root {
            width: 95%;
            max-width: 95vw;
            padding: 0 0 0 30px;
        }
        
        body {
            font-family: JetBrains Sans,serif;
        }
        
        a {
            overflow-wrap: anywhere;
            width: 100vw;
        }
        
        
        @font-face {
            font-family: JetBrains Sans;
            src: url(https://resources.jetbrains.com/storage/jetbrains-sans/JetBrainsSans-Light.woff2) format("woff2"), url(https://resources.jetbrains.com/storage/jetbrains-sans/JetBrainsSans-Light.woff) format("woff");
            font-weight: 300;
            font-style: normal;
        }

        @font-face {
            font-family: JetBrains Sans;
            src: url(https://resources.jetbrains.com/storage/jetbrains-sans/JetBrainsSans-Regular.woff2) format("woff2"), url(https://resources.jetbrains.com/storage/jetbrains-sans/JetBrainsSans-Regular.woff) format("woff");
            font-weight: 400;
            font-style: normal;
        }

        @font-face {
            font-family: JetBrains Sans;
            src: url(https://resources.jetbrains.com/storage/jetbrains-sans/JetBrainsSans-SemiBold.woff2) format("woff2"), url(https://resources.jetbrains.com/storage/jetbrains-sans/JetBrainsSans-SemiBold.woff) format("woff");
            font-weight: 600;
            font-style: normal;
        }
        
        
        code {
            display: inline;
            word-break: break-word;
            font-size: 15px;
            line-height: inherit;
            font-variant-ligatures: none;
            font-family: JetBrains Sans,monospace;
            white-space: pre-line;
            overflow-wrap: break-word;
        }
        
        figcaption {
            margin-top: 5px;
        }
        
        h2 {
            padding-top: 16px;
            padding-bottom: 8px;
            margin-block-start: 0;
            margin-block-end: 0;
        }
        
        h3 {
            padding-top: 8px;
            padding-bottom: 8px;
            margin-block-start: 0;
            margin-block-end: 0;
        }
        
        h4 {
            padding-top: 4px;
            padding-bottom: 8px;
            margin-block-start: 0;
            margin-block-end: 0;
        }
        
        p {
            padding: 0;
            border: 0;
            line-height: 25px;
            margin-block-start: 0;
            margin-block-end: 0;
            padding-bottom: 8px;
        }
        
        div {
            display: block;
        }
        
        table {
            border-collapse: collapse;
            width: 100%;
            page-break-inside: avoid;
        }
        
        th, td {
            border: 1px solid #c4c4c4;
            padding: 10px;
            text-align: left;
            word-break: break-all;
        }
        
        .no-bold {
            font-weight: normal; 
        }
        
        .entry {
            display: grid;
            grid-template-columns: auto max-content;
            grid-template-areas: "chapter page";
            align-items: end;
            gap: 0 .25rem;
            line-height: 25px;
        }
        
        .toc-link-container{
            grid-area: chapter;
            position: relative;
            overflow: hidden;
        }
        
        .toc-link{
            text-decoration: none;
            color: black;
        }
        
        .toc-link-container::after {
            position: absolute;
            padding-left: .25ch;
            content: " . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . "
            ". . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . "
            ". . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ";
            text-align: right;
        }
        
        .page {
            grid-area: page;
            width: 30px;
            text-align: right;
        }
        

        .table-wrapper {
            overflow: hidden;
            box-sizing: border-box;
            font: inherit;
        }
        

        .topic {
            page-break-before: always;
        }
        </style><title>pdfSourceSRS</title></head><body><div><section class="topic"><div><article class="article"><h1 class="main-title">Table of Contents</h1><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#1703914554">Introduction</a></div><div class="page">3</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#194827036">System Design</a></div><div class="page">7</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#429683684">Grow Chamber</a></div><div class="page">9</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-2101489201">Grow Chamber Assembly</a></div><div class="page">10</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#146093280">Root Chamber Assembly</a></div><div class="page">11</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#197990771">Seed Planting</a></div><div class="page">12</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-1652252355">Ventilation</a></div><div class="page">13</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-1957301961">Automation</a></div><div class="page">14</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#661270862">Background</a></div><div class="page">16</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-1790576086">Thread</a></div><div class="page">17</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-1997370655">Matter</a></div><div class="page">24</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#2146435910">Data Model</a></div><div class="page">25</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#279346443">Matter Commissioning</a></div><div class="page">43</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-2077639180">Access Control</a></div><div class="page">46</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-1918844910">Espressif</a></div><div class="page">47</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#1112016086">ESP Development Environment</a></div><div class="page">50</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-400735760">ESP-IDF Setup</a></div><div class="page">51</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-401349892">ESP-Matter Setup</a></div><div class="page">54</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-586960577">ESP32 Project Workflow</a></div><div class="page">57</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-1412866926">ESP OpenThread CLI</a></div><div class="page">63</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#1955462060">Thread Border Routers</a></div><div class="page">69</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-1231632047">ESP Basic Thread Border Router</a></div><div class="page">70</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-497258712">ESP Matter Thread Border Router</a></div><div class="page">80</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-1685420830">Accessory Devices</a></div><div class="page">84</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#1125845925">Matter Pressure and Temperature Sensor</a></div><div class="page">86</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#2085001628">Matter Relay Switch</a></div><div class="page">97</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#454638120">Matter Controller</a></div><div class="page">104</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-1509277031">CHIP-Tool</a></div><div class="page">105</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#1823421053">ESP Matter Controller</a></div><div class="page">124</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-309902166">Orchestrator</a></div><div class="page">131</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#1785010100">Matter Controller Interface</a></div><div class="page">136</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#771240009">Websocket Server</a></div><div class="page">140</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-848609994">Thread Interface</a></div><div class="page">143</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-851317846">Wi-Fi Interface</a></div><div class="page">149</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#1966040098">WiFi-Mesh-Lite Interface</a></div><div class="page">151</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#1047354404">ESP-Mesh-Lite Network</a></div><div class="page">152</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#956107380">Dashboard</a></div><div class="page">155</div></div></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="1703914554">Introduction</h1><section class="detached"><h2 id="1703914554#overview" data-toc="overview#Introduction.md-overview">Overview</h2><p id="1703914554#-ddxlbf_7">This project aims to develop a <span class="control" id="1703914554#-ddxlbf_10">decentralized system</span> for <span class="control" id="1703914554#-ddxlbf_11">Controlled Environment Agriculture</span> (CEA).</p><p id="1703914554#-ddxlbf_8">The system has a modular structure, where each module has its own sub-network of accessory devices, such as sensors and actuators, that autonomously monitor and control environmental conditions without requiring a central hub.</p><p id="1703914554#-ddxlbf_9">The system prioritizes interoperability, enabling the integration of devices from different manufacturers and the replacement of existing ones without major updates. It also implements security measures to ensure safe data transmission and access control, maintaining system functionality and scalability.</p></section><section class="detached"><h2 id="1703914554#motivation" data-toc="motivation#Introduction.md-motivation">Motivation</h2><p id="1703914554#-ddxlbf_12">Advancements in IoT-based monitoring and control systems have improved automation in agriculture, increasing efficiency and productivity.</p><p id="1703914554#-ddxlbf_13"><span class="emphasis" id="1703914554#-ddxlbf_17">Precision Agriculture</span> enhances field farming by using sensor data, GPS, and automated equipment to precisely manage inputs like water, fertilizers, and pesticides. <span class="emphasis" id="1703914554#-ddxlbf_18">Controlled-Environment Agriculture</span> extends this approach by eliminating limitations such as external environmental factors, soil variability, and large-scale deployment challenges through enclosed systems where temperature, humidity, light, and CO₂ are actively regulated. This allows for year-round production, reduces reliance on weather conditions, and ensures consistent crop yields, making it more reliable than traditional open-field farming.</p><p id="1703914554#-ddxlbf_14">However, many farming automation startups struggle to succeed, primarily due to the high cost of research and development. Building advanced automation systems requires substantial investment, which raises food production costs and makes it difficult for startups to compete with traditional farms that operate at lower expenses.</p><p id="1703914554#-ddxlbf_15">A major factor driving these costs is the reliance on centralized servers or cloud resources for data processing and control. This setup requires complex communication infrastructure, increases operational expenses, and complicates scalability, particularly for larger farms. Additionally, centralized systems create a single point of failure - if the central server or cloud service fails or is compromised, the entire operation can be disrupted. For example, an AWS IoT outage in 2020 caused significant downtime for applications relying on AWS IoT Core, demonstrating the risks of centralized dependency.</p><p id="1703914554#-ddxlbf_16">Another issue is the difficulty of integrating components from different manufacturers. Automated farms use a variety of sensors, actuators, and equipment, but differences in APIs and communication protocols can make it challenging to connect these systems smoothly.</p></section><section class="detached"><h2 id="1703914554#discussion" data-toc="discussion#Introduction.md-discussion">Discussion</h2><p id="1703914554#-ddxlbf_19">The system leverages the Matter protocol, which ensures compatibility between devices from different manufacturers. This standardisation simplifies integration, replacement, and future expansion of devices. However, the high costs associated with Matter certification &ndash; including a $7,000 annual membership fee for the Connectivity Standards Alliance (CSA) and $3,000 per product certification &ndash; pose significant challenges for small manufacturers and farms operating on tight budgets.</p><p id="1703914554#-ddxlbf_20">Future advancements in this system could include the adoption of microfluidics within hydroponic systems. Such developments would enhance resource efficiency and allow for precise control over environmental conditions tailored to specific crops. These innovations align with the system&rsquo;s modular design philosophy, which prioritises adaptability and scalability in agricultural automation.</p></section><section class="detached"><h2 id="1703914554#references" data-toc="references#Introduction.md-references">References</h2><p id="1703914554#-ddxlbf_21">[1] L. Adenauer, &ldquo;Up, up and away! The Economics of Vertical Farming,&rdquo; <span class="emphasis" id="1703914554#-ddxlbf_44">Journal of Agricultural Studies</span>, doi: 10.5296/jas.v2i1.4526 (<a href="https://doi.org/10.5296/jas.v2i1.4526">https://doi.org/10.5296/jas.v2i1.4526</a>).</p><p id="1703914554#-ddxlbf_22">[2] U.S. Department of Agriculture, Office of the Chief Scientist, and U.S. Department of Energy, Bioenergy Technologies Office, Workshop Report: Research and Development Potentials in Indoor Agriculture and Sustainable Urban Ecosystems, Washington, D.C., Feb. 2019. Online (<a href="https://www.usda.gov/sites/default/files/documents/indoor-agriculture-workshop-report.pdf">https://www.usda.gov/sites/default/files/documents/indoor-agriculture-workshop-report.pdf</a>).</p><p id="1703914554#-ddxlbf_23">[3] People, power costs keep indoor farming down to Earth, Finance &amp; Commerce, Associated Press, May 14, 2018. Online (<a href="https://finance-commerce.com/2018/05/people-power-costs-keep-indoor-farming-down-to-earth/">https://finance-commerce.com/2018/05/people-power-costs-keep-indoor-farming-down-to-earth/</a>)</p><p id="1703914554#-ddxlbf_24">[4] G. Johnson, &ldquo;AeroFarms files for Chapter 11 bankruptcy protection,&rdquo; <span class="emphasis" id="1703914554#-ddxlbf_48">Produce Blue Book</span>, Jun. 09, 2023. Online (<a href="https://www.producebluebook.com/2023/06/08/aerofarms-files-for-chapter-11-bankruptcy-protection/">https://www.producebluebook.com/2023/06/08/aerofarms-files-for-chapter-11-bankruptcy-protection/</a>).</p><p id="1703914554#-ddxlbf_25">[5] B. C. Baraniuk, &ldquo;Lean times hit the vertical farming business,&rdquo; Jul. 17, 2023. Online (<a href="https://www.bbc.com/news/business-66173872">https://www.bbc.com/news/business-66173872</a>).</p><p id="1703914554#-ddxlbf_26">[6] S. B&ouml;kle, D. S. Paraforos, D. Reiser, and H. W. Griepentrog, &ldquo;Conceptual framework of a decentral digital farming system for resilient and safe data management,&rdquo; <span class="emphasis" id="1703914554#-ddxlbf_51">Smart Agricultural Technology</span>, Volume 2, Feb. 2022. Online (<a href="https://www.sciencedirect.com/science/article/pii/S2772375522000065">https://www.sciencedirect.com/science/article/pii/S2772375522000065</a>).</p><p id="1703914554#-ddxlbf_27">[7] U. Shafi, R. Mumtaz, J. Garc&iacute;a-Nieto, S. A. Hassan, S. A. R. Zaidi, and N. Iqbal, &ldquo;Precision Agriculture Techniques and Practices: From Considerations to applications,&rdquo; <span class="emphasis" id="1703914554#-ddxlbf_53">Sensors</span>, vol. 19, no. 17, p. 3796, Sep. 2019, doi: 10.3390/s19173796 (<a href="https://doi.org/10.3390/s19173796">https://doi.org/10.3390/s19173796</a>).</p><p id="1703914554#-ddxlbf_28">[8] D. K. S. Karanam Desai, &ldquo;Automation in Agriculture: a Study,&rdquo; <span class="emphasis" id="1703914554#-ddxlbf_55">International Journal of Engineering Science</span>, vol. 2(2), Jun. 2016. Online (<a href="https://www.researchgate.net/publication/304650250_Automation_in_Agriculture_A_Study">https://www.researchgate.net/publication/304650250_Automation_in_Agriculture_A_Study</a>).</p><p id="1703914554#-ddxlbf_29">[9] &ldquo;Distributed or centralized mobility?,&rdquo; <span class="emphasis" id="1703914554#-ddxlbf_57">IEEE Conference Publication | IEEE Xplore</span>, Nov. 01, 2009. Online (<a href="https://ieeexplore.ieee.org/abstract/document/5426302/">https://ieeexplore.ieee.org/abstract/document/5426302/</a>).</p><p id="1703914554#-ddxlbf_30">[10] D. Belli, P. Barsocchi, and F. Palumbo, &ldquo;Connectivity standards alliance matter: state of the art and opportunities,&rdquo; <span class="emphasis" id="1703914554#-ddxlbf_59">Internet of Things</span>, vol. 25, doi: 10.1016/j.iot.2023.101005 (<a href="https://doi.org/10.1016/j.iot.2023.101005">https://doi.org/10.1016/j.iot.2023.101005</a>).</p><p id="1703914554#-ddxlbf_31">[11] G.-J. Ra and I.-Y. Lee, &ldquo;A study on KSI-based authentication management and communication for secure smart home environments,&rdquo; <span class="emphasis" id="1703914554#-ddxlbf_61">KSII Transactions on Internet and Information Systems</span>, vol. 12, no. 2, Feb. 2018, doi: 10.3837/tiis.2018.02.021 (<a href="https://doi.org/10.3837/tiis.2018.02.021">https://doi.org/10.3837/tiis.2018.02.021</a>).</p><p id="1703914554#-ddxlbf_32">[12] R. Speed, &ldquo;AWS admits to &lsquo;severely impaired&rsquo; services in US-EAST-1, can&rsquo;t even post updates to Service Health Dashboard,&rdquo; <span class="emphasis" id="1703914554#-ddxlbf_63">The Register</span>, Nov. 26, 2020. Online (<a href="https://www.theregister.com/2020/11/25/aws_down/">https://www.theregister.com/2020/11/25/aws_down/</a>).</p><p id="1703914554#-ddxlbf_33">[13] V. S, V. E. R D, V. A C, V. A, and S. L. S, &ldquo;A STUDY ON DEVELOPMENT OF CROPS BY FOGPONIC SYSTEM USING COCO COIR,&rdquo; <span class="emphasis" id="1703914554#-ddxlbf_65">International Research Journal of Engineering and Technology (IRJET)</span>, vol.7. Online (<a href="https://www.irjet.net/archives/V7/i4/IRJET-V7I41142.pdf">https://www.irjet.net/archives/V7/i4/IRJET-V7I41142.pdf</a>).</p><p id="1703914554#-ddxlbf_34">[14] V. O. Oner, <span class="emphasis" id="1703914554#-ddxlbf_67">Developing IoT Projects with ESP32 - Second Edition</span>, O&rsquo;Reilly Online Learning. Online (<a href="https://learning.oreilly.com/library/view/developing-iot-projects/9781803237688/Text/Chapter_3.xhtml#_idParaDest-48">https://learning.oreilly.com/library/view/developing-iot-projects/9781803237688/Text/Chapter_3.xhtml#_idParaDest-48</a>).</p><p id="1703914554#-ddxlbf_35">[15] Alliance Marketing, &ldquo;Peeking Under the Hood of Your Matter Smart Home - CSA-IOT,&rdquo; <span class="emphasis" id="1703914554#-ddxlbf_69">CSA-IOT</span>, Aug. 28, 2024. Online (<a href="https://csa-iot.org/newsroom/peeking-under-the-hood-of-your-matter-smart-home/">https://csa-iot.org/newsroom/peeking-under-the-hood-of-your-matter-smart-home/</a>).</p><p id="1703914554#-ddxlbf_36">[16] &ldquo;Technical documentation.&rdquo; Online (<a href="https://docs.nordicsemi.com/bundle/ncs-2.6.1/page/matter/chip_tool_guide.html">https://docs.nordicsemi.com/bundle/ncs-2.6.1/page/matter/chip_tool_guide.html</a>).</p><p id="1703914554#-ddxlbf_37">[17] &ldquo;Programming Guide - ESP32 - Espressif&rsquo;s SDK for Matter latest documentation.&rdquo; Online (<a href="https://docs.espressif.com/projects/esp-matter/en/latest/esp32/">https://docs.espressif.com/projects/esp-matter/en/latest/esp32/</a>).</p><p id="1703914554#-ddxlbf_38">[18] &ldquo;Commissioning | Overview Guides | Silicon Labs Matter | V2.2.1 | Silicon Labs.&rdquo; Online (<a href="https://docs.silabs.com/matter/2.2.1/matter-overview-guides/matter-commissioning">https://docs.silabs.com/matter/2.2.1/matter-overview-guides/matter-commissioning</a>).</p><p id="1703914554#-ddxlbf_39">[19] &ldquo;ESP32-H2 Thread/Zigbee &amp; BLE 5 SOC | Espressif Systems.&rdquo; Online (<a href="https://www.espressif.com/en/products/socs/esp32-h2">https://www.espressif.com/en/products/socs/esp32-h2</a>).</p><p id="1703914554#-ddxlbf_40">[20] &ldquo;Introduction to Matter | Introduction to Matter | Silicon Labs Matter | V2.1.1 | Silicon Labs.&rdquo; Online (<a href="https://docs.silabs.com/matter/2.1.1/matter-fundamentals-introduction/">https://docs.silabs.com/matter/2.1.1/matter-fundamentals-introduction/</a>).</p><p id="1703914554#-ddxlbf_41">[21] &ldquo;Matter FAQs | Frequently Asked Questions - CSA-IOT,&rdquo; <span class="emphasis" id="1703914554#-ddxlbf_76">CSA-IOT</span>. Online (<a href="https://csa-iot.org/all-solutions/matter/matter-faq/">https://csa-iot.org/all-solutions/matter/matter-faq/</a>).</p><p id="1703914554#-ddxlbf_42">[22] &ldquo;Thread benefits.&rdquo; Online (<a href="https://www.threadgroup.org/What-is-Thread/Thread-Benefits">https://www.threadgroup.org/What-is-Thread/Thread-Benefits</a>).</p><p id="1703914554#-ddxlbf_43">[23] &ldquo;OpenThread Border Router,&rdquo; <span class="emphasis" id="1703914554#-ddxlbf_79">OpenThread</span>. Online (<a href="https://openthread.io/guides/border-router">https://openthread.io/guides/border-router</a>).</p></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="194827036">System Design</h1><div class="image-container"><img class="center image" id="194827036#z1oeqjj_3" alt="Architecture Diagram" title="Architecture Diagram" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/system-design/architecture.png" width="500" height="500"></div><p id="194827036#z1oeqjj_4">This automated <span class="control" id="194827036#z1oeqjj_10">Controlled Environment Agriculture</span> system is designed with a modular structure.</p><p id="194827036#z1oeqjj_5">A <span class="control" id="194827036#z1oeqjj_11">Grow Chamber</span> is an independent module designed to maintain a controlled environment for a specific plant. It consists of the following components:</p><ul class="list" id="194827036#z1oeqjj_6" start="1"><li class="list-item" id="194827036#z1oeqjj_12"><p id="194827036#z1oeqjj_15"><span class="control" id="194827036#z1oeqjj_16">Root Chamber</span> contains the plant's root system and nutrient solution.</p></li><li class="list-item" id="194827036#z1oeqjj_13"><p id="194827036#z1oeqjj_17"><span class="control" id="194827036#z1oeqjj_18">Lighting</span> provides artificial light for photosynthesis.</p></li><li class="list-item" id="194827036#z1oeqjj_14"><p id="194827036#z1oeqjj_19"><span class="control" id="194827036#z1oeqjj_20">Ventilation</span> regulates temperature, humidity, and CO₂ levels.</p></li></ul><p id="194827036#z1oeqjj_7">Environmental conditions are regulated through a mesh network of <span class="control" id="194827036#z1oeqjj_21">Accessory Devices</span>:</p><ul class="list" id="194827036#z1oeqjj_8" start="1"><li class="list-item" id="194827036#z1oeqjj_22"><p id="194827036#z1oeqjj_24"><span class="control" id="194827036#z1oeqjj_25">Sensors</span> monitor temperature, humidity, light intensity, and CO₂ levels.</p></li><li class="list-item" id="194827036#z1oeqjj_23"><p id="194827036#z1oeqjj_26"><span class="control" id="194827036#z1oeqjj_27">Actuators</span> adjust conditions by controlling fog generation, ventilation, and lighting.</p></li></ul><p id="194827036#z1oeqjj_9">The <span class="control" id="194827036#z1oeqjj_28">Orchestrator</span> devices allow farmers to set up and manage Grow Chambers, while <span class="control" id="194827036#z1oeqjj_29">Controller</span> devices provide an interface for monitoring and control.</p></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="429683684">Grow Chamber</h1><section class="detached"><h2 id="429683684#overview" data-toc="overview#Grow-Chamber.md-overview">Overview</h2><p id="429683684#togwkr_6">A <span class="control" id="429683684#togwkr_7">Grow Chamber</span> is a self-contained module within the system, designed to provide an independent, controlled environment for plant growth.</p></section><section class="detached"><h2 id="429683684#system-design" data-toc="system-design#Grow-Chamber.md-system-design">System Design</h2><p id="429683684#togwkr_8">Commercially available grow tents for indoor plant cultivation function as individual <span class="control" id="429683684#togwkr_13">Grow Chambers</span>, providing structure and isolating the growing environment.</p><p id="429683684#togwkr_9">A bucket at the centre of the tent acts as a <span class="control" id="429683684#togwkr_14">Root Chamber</span>. It contains multiple <span class="control" id="429683684#togwkr_15">Plant Slots</span> that hold net pots filled with growing medium, where seeds are planted.</p><p id="429683684#togwkr_10">As the seeds germinate, their stems grow upward to form a canopy, while roots develop below. The <span class="control" id="429683684#togwkr_16">Fogponics System</span> delivers a fine, nutrient-rich mist to the roots, generated by an ultrasonic mist maker submerged in a water-nutrient solution.</p><p id="429683684#togwkr_11"><span class="control" id="429683684#togwkr_17">Lighting panels</span> positioned in the corners provide the necessary wavelengths for growth. The walls of the Tent and the Root Chamber are lined with Mylar, a reflective material that enhances light distribution for the plants.</p><p id="429683684#togwkr_12">The <span class="control" id="429683684#togwkr_18">Ventilation system</span> maintains airflow and regulates the temperature within the Grow chamber.</p></section><section class="detached"><h2 id="429683684#hardware-components" data-toc="hardware-components#Grow-Chamber.md-hardware-components">Hardware Components</h2><p id="429683684#togwkr_19">The hardware components were sourced from easily accessible suppliers, such as Canadian Tire and Amazon.</p></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-2101489201">Grow Chamber Assembly</h1><p id="-2101489201#oqomz0_3">Required Components:</p><ul class="list" id="-2101489201#oqomz0_4" start="1"><li class="list-item" id="-2101489201#oqomz0_5"><p id="-2101489201#oqomz0_11">Grow Tent for indoor plant cultivation (24&quot; x 24&quot; x 48&quot;, 61cm x 61cm x 122cm)</p></li><li class="list-item" id="-2101489201#oqomz0_6"><p id="-2101489201#oqomz0_12">Full Spectrum Grow Light for Indoor Plants</p></li><li class="list-item" id="-2101489201#oqomz0_7"><p id="-2101489201#oqomz0_13">Inline Fan: 4-inch diameter</p></li><li class="list-item" id="-2101489201#oqomz0_8"><p id="-2101489201#oqomz0_14">Carbon Filter: 4-inch flange diameter, 14 inches long</p></li><li class="list-item" id="-2101489201#oqomz0_9"><p id="-2101489201#oqomz0_15">Ducting: 4-inch diameter, 8 feet long</p></li><li class="list-item" id="-2101489201#oqomz0_10"><p id="-2101489201#oqomz0_16">Rubber Coupler Connector: Compatible with a 4-inch diameter</p></li></ul></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="146093280">Root Chamber Assembly</h1><p id="146093280#bc5taz_3">Required Components:</p><ul class="list" id="146093280#bc5taz_4" start="1"><li class="list-item" id="146093280#bc5taz_7"><p id="146093280#bc5taz_17">Canadian Tire Plastic Food Grade Safe Bucket, 5-Gal/19-L (37.20 cm x 31.00 cm) or 7.5-L</p></li><li class="list-item" id="146093280#bc5taz_8"><p id="146093280#bc5taz_18">Mylar Films</p></li><li class="list-item" id="146093280#bc5taz_9"><p id="146093280#bc5taz_19">Ultrasonic Mist Maker, 400ml/h</p></li><li class="list-item" id="146093280#bc5taz_10"><p id="146093280#bc5taz_20">Brushless DC Fan, 12V, IP67, 120mm x 25mm</p></li><li class="list-item" id="146093280#bc5taz_11"><p id="146093280#bc5taz_21">Peristaltic Pump, 12V 3x5mm</p></li><li class="list-item" id="146093280#bc5taz_12"><p id="146093280#bc5taz_22">Silicone tube, 3x5mm 5m</p></li><li class="list-item" id="146093280#bc5taz_13"><p id="146093280#bc5taz_23">Aquarium air pump</p></li><li class="list-item" id="146093280#bc5taz_14"><p id="146093280#bc5taz_24">FS400-SHT3X Soil Temperature and Humidity Sensor (SHT35)</p></li><li class="list-item" id="146093280#bc5taz_15"><p id="146093280#bc5taz_25">Ultrasonic Distance Sensor, water-resistant</p></li><li class="list-item" id="146093280#bc5taz_16"><p id="146093280#bc5taz_26">2&quot; Net pots</p></li></ul><p id="146093280#bc5taz_5">Required Tools:</p><ul class="list" id="146093280#bc5taz_6" start="1"><li class="list-item" id="146093280#bc5taz_27"><p id="146093280#bc5taz_32">Heat Gun</p></li><li class="list-item" id="146093280#bc5taz_28"><p id="146093280#bc5taz_33">Hole Saw, 1.5&quot; diameter</p></li><li class="list-item" id="146093280#bc5taz_29"><p id="146093280#bc5taz_34">Wire Stripper</p></li><li class="list-item" id="146093280#bc5taz_30"><p id="146093280#bc5taz_35">12V 1A AC/DC Power Adapter</p></li><li class="list-item" id="146093280#bc5taz_31"><p id="146093280#bc5taz_36">12V DC Power Jack Connector Adapter, Male Plug &amp; Female Socket Set, 5.5 X 2.1mm</p></li></ul></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="197990771">Seed Planting</h1><p id="197990771#-29k3iw_3">Required Components:</p><ul class="list" id="197990771#-29k3iw_4" start="1"><li class="list-item" id="197990771#-29k3iw_5"><p id="197990771#-29k3iw_9">Fertilizer</p></li><li class="list-item" id="197990771#-29k3iw_6"><p id="197990771#-29k3iw_10">Clay Pellets</p></li><li class="list-item" id="197990771#-29k3iw_7"><p id="197990771#-29k3iw_11">Organic cotton balls</p></li><li class="list-item" id="197990771#-29k3iw_8"><p id="197990771#-29k3iw_12">Arugula Seeds</p></li></ul></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-1652252355">Ventilation</h1><p id="-1652252355#-dg8x9e_3">The tent&rsquo;s internal volume is approximately 64,512 cubic inches, which converts to about 37.34 cubic feet: 32&rdquo; &times; 32&rdquo; &times; 63&rdquo; &divide; 1,728 &asymp; 37.34 ft&sup3;</p><p id="-1652252355#-dg8x9e_4">The 130 CFM inline duct fan can replace 37 cubic feet of air in about 17 seconds: 37 ft&sup3; &divide; 130 ft&sup3;/min &asymp; 0.28 minutes</p><p id="-1652252355#-dg8x9e_5">For effective growing conditions, it&rsquo;s recommended to perform a full air exchange every one to three minutes. This ensures fresh air circulation, stable temperature, and proper humidity levels.</p></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-1957301961">Automation</h1><section class="detached"><h2 id="-1957301961#overview" data-toc="overview#Automation.md-overview">Overview</h2><p id="-1957301961#-akrc94_7">The Automation System regulates the environment and resource availability based on plant growth stages, ensuring optimal conditions from germination to maturity.</p><p id="-1957301961#-akrc94_8">This chapter describes the development of the automation system components, including assembling hardware, developing software, and integrating the system with the network infrastructure.</p></section><section class="detached"><h2 id="-1957301961#hardware" data-toc="hardware#Automation.md-hardware">Hardware</h2><p id="-1957301961#-akrc94_9">The system uses Espressif's development boards (<a href="#-1918844910#hardware">&quot;Hardware&quot; in &quot;Espressif&quot;</a>): <span class="control" id="-1957301961#-akrc94_12">ESP32-C6</span> and <span class="control" id="-1957301961#-akrc94_13">ESP32-H2</span> for sensor data processing and actuator control, and the <span class="control" id="-1957301961#-akrc94_14">Thread Border Router board</span> for communication with Thread-enabled devices and external networks.</p><p id="-1957301961#-akrc94_10">Sensors monitor temperature, humidity, and CO₂ levels, while actuators such as mist makers, exhaust fans, and LED grow lights adjust conditions based on automation rules.</p></section><section class="detached"><h2 id="-1957301961#software" data-toc="software#Automation.md-software">Software</h2><p id="-1957301961#-akrc94_15">Development is based on ESP-IDF (<a href="#-1918844910#esp-idf-framework">&quot;ESP-IDF Framework&quot; in &quot;Espressif&quot;</a>), the official framework for ESP32, with ESP-Matter (<a href="#-1918844910#esp-matter-solution">&quot;ESP Matter Solution&quot; in &quot;Espressif&quot;</a>) integrated for Matter device support.</p><p id="-1957301961#-akrc94_16">The environment is set up on <span class="control" id="-1957301961#-akrc94_19">Ubuntu Desktop</span>.</p></section><section class="detached"><h2 id="-1957301961#network-communication" data-toc="network-communication#Automation.md-network-communication">Network Communication</h2><p id="-1957301961#-akrc94_20">The system uses Thread (<a href="#-1790576086">Thread</a>) protocol for low-power, mesh-based wireless communication between sensors, actuators, and control units.</p><p id="-1957301961#-akrc94_21">Wi-Fi and Thread integration through Thread Border Routers (<a href="#1955462060">Thread Border Routers</a>) allows remote monitoring and control through Dashboard (<a href="#956107380">Dashboard</a>).</p><p id="-1957301961#-akrc94_22">Matter (<a href="#-1997370655">Matter</a>) is used as the application layer protocol to enable device interoperability and secure communication over Wi-Fi, Ethernet, and Thread, allowing the devices to work together without compatibility issues.</p></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="661270862">Background</h1><p id="661270862#-3rhc1r_3">This section provides an overview of the relevant background information necessary to understand the project's context, including key concepts and technologies.</p></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-1790576086">Thread</h1><section class="detached"><h2 id="-1790576086#overview" data-toc="overview#Thread.md-overview">Overview</h2><p id="-1790576086#-vhh1nf_12"><span class="control" id="-1790576086#-vhh1nf_17">Thread</span> is an IPv6-based networking protocol designed for low-power Internet of Things devices in an IEEE 802.15.4-2006 wireless mesh network.</p><p id="-1790576086#-vhh1nf_13"><span class="control" id="-1790576086#-vhh1nf_18">Matter (<a href="#-1997370655">Matter</a>)</span> devices can communicate with each other using Thread as a transport protocol.</p><p id="-1790576086#-vhh1nf_14"><span class="control" id="-1790576086#-vhh1nf_20">OpenThread (OT)</span> is an open-source implementation of the <span class="control" id="-1790576086#-vhh1nf_21">Thread</span> networking protocol.</p><p id="-1790576086#-vhh1nf_15">The Thread Network prevents <span class="control" id="-1790576086#-vhh1nf_22">single points of failure</span> through device redundancy and autonomous role transitions, but in topologies like a Thread Network Partition with only one Border Router, failure of that Border Router can disrupt external network access due to the lack of a backup.</p><p id="-1790576086#-vhh1nf_16">Devices in a Thread Network can communicate directly without an active Border Router. Although, having multiple Border Routers allows connections to one or more external networks, improving reliability and redundancy.</p></section><section class="detached"><h2 id="-1790576086#architecture" data-toc="architecture#Thread.md-architecture">Architecture</h2><p id="-1790576086#-vhh1nf_23">OpenThread runs on various OS or bare-metal systems, including Linux and ESP32, due to its narrow abstraction layer and portable C/C++ design. It supports the following designs:</p><ul class="list" id="-1790576086#-vhh1nf_24" start="1"><li class="list-item" id="-1790576086#-vhh1nf_25"><p id="-1790576086#-vhh1nf_28"><span class="control" id="-1790576086#-vhh1nf_29">System-on-chip (SoC):</span> a single chip combines a processor and an 802.15.4 radio for Thread. In this design, both OpenThread and the device's main software (application layer) run on the same processor. This mode is used in <span class="control" id="-1790576086#-vhh1nf_30">end devices</span> like sensors and actuators (ESP32-H2, ESP32-C6).</p></li><li class="list-item" id="-1790576086#-vhh1nf_26"><p id="-1790576086#-vhh1nf_31"><span class="control" id="-1790576086#-vhh1nf_32">Radio Co-Processor (RCP):</span> the host processor runs the full OpenThread stack, while a separate Thread radio chip handles only the PHY and MAC layers of IEEE 802.15.4. They communicate using the Spinel protocol over SPI or UART. Since the host processor manages all networking tasks, it typically remains powered on, making this setup ideal for devices that prioritize performance over power efficiency. This mode is used in <span class="control" id="-1790576086#-vhh1nf_33">Thread Border Routers</span>, where a host processor, such as an ESP32-S3 or ESP32, is paired with an ESP32-H2 or ESP32-C6 as the Thread radio co-processor.</p></li><li class="list-item" id="-1790576086#-vhh1nf_27"><p id="-1790576086#-vhh1nf_34"><span class="control" id="-1790576086#-vhh1nf_35">Network Co-Processor (NCP):</span> OpenThread runs on a Thread-enabled SoC, while the application software runs separately on a <span class="control" id="-1790576086#-vhh1nf_36">host processor</span>. These two processors communicate using wpantund over SPI or UART, with the Spinel protocol managing the connection. Unlike RCP, this design allows the host processor to sleep, while the Thread-enabled chip stays active to maintain network connectivity. This design is beneficial for power-saving devices that require a constant network connection but do not need the host processor to remain active at all times.</p></li></ul></section><section class="detached"><h2 id="-1790576086#device-types" data-toc="device-types#Thread.md-device-types">Device Types</h2><p id="-1790576086#-vhh1nf_37">There are two types of Thread devices:</p><ul class="list" id="-1790576086#-vhh1nf_38" start="1"><li class="list-item" id="-1790576086#-vhh1nf_39"><p id="-1790576086#-vhh1nf_41"><span class="control" id="-1790576086#-vhh1nf_42">Minimal Thread Device (MTD)</span> communicates only with its FTD parent.</p></li><li class="list-item" id="-1790576086#-vhh1nf_40"><p id="-1790576086#-vhh1nf_43"><span class="control" id="-1790576086#-vhh1nf_44">Full Thread Device (FTD)</span> communicates with other FTDs and its MTD children.</p></li></ul></section><section class="detached"><h2 id="-1790576086#device-roles" data-toc="device-roles#Thread.md-device-roles">Device Roles</h2><p id="-1790576086#-vhh1nf_45">A Thread device can have multiple roles. For example, it can act as a Router, Border Router, and Commissioner simultaneously. See also Commissioning Roles (<a href="#-1790576086#commissioning-roles">&quot;Commissioning Roles&quot; in &quot;Thread&quot;</a>).</p><section class="detached"><h3 id="-1790576086#router" data-toc="router#Thread.md-router">Router</h3><p id="-1790576086#-vhh1nf_50">A <span class="control" id="-1790576086#-vhh1nf_53">Router</span> is an FTD (<a href="#-1790576086#device-types">&quot;Device Types&quot; in &quot;Thread&quot;</a>) that provides routing services in a Thread Network. It forwards packets, maintains routing information, and serves as a Parent for End Devices (<a href="#-1790576086#end-device">&quot;End Device&quot; in &quot;Thread&quot;</a>). Additionally, Routers support Commissioning (<a href="#-1790576086#commissioning">&quot;Commissioning&quot; in &quot;Thread&quot;</a>), handling device joining and security services.</p><p id="-1790576086#-vhh1nf_51">A <span class="control" id="-1790576086#-vhh1nf_57">Leader</span> is a special Router that manages a Thread Network Partition. Each Partition has one Leader, elected dynamically from the available Routers. If the Leader fails, another Router automatically takes over. The Leader is responsible for:</p><ul class="list" id="-1790576086#-vhh1nf_52" start="1"><li class="list-item" id="-1790576086#-vhh1nf_58"><p id="-1790576086#-vhh1nf_61">Assigning and managing Router IDs.</p></li><li class="list-item" id="-1790576086#-vhh1nf_59"><p id="-1790576086#-vhh1nf_62">Maintaining Thread Network Data.</p></li><li class="list-item" id="-1790576086#-vhh1nf_60"><p id="-1790576086#-vhh1nf_63">Coordinating network operations.</p></li></ul></section><section class="detached"><h3 id="-1790576086#end-device" data-toc="end-device#Thread.md-end-device">End Device</h3><p id="-1790576086#-vhh1nf_64">An <span class="control" id="-1790576086#-vhh1nf_67">End Device</span> is a device that connects to the Thread Network but does not forward packets like a Router (<a href="#-1790576086#router">&quot;Router&quot; in &quot;Thread&quot;</a>). Instead, it relies on a Parent Router for communication. End Devices are typically low-power devices, such as sensors or actuators, that do not need to maintain full network topology information.</p><p id="-1790576086#-vhh1nf_65">Depending on their capabilities and power management strategies, End Devices are classified into the following types:</p><ul class="list" id="-1790576086#-vhh1nf_66" start="1"><li class="list-item" id="-1790576086#-vhh1nf_69"><p id="-1790576086#-vhh1nf_73"><span class="control" id="-1790576086#-vhh1nf_74">Router-Eligible End Device (REED)</span> is an FTD (<a href="#-1790576086#device-types">&quot;Device Types&quot; in &quot;Thread&quot;</a>) that operates as an End Device but can be promoted to a Router (<a href="#-1790576086#router">&quot;Router&quot; in &quot;Thread&quot;</a>) if the network requires additional routing capacity. It does not forward messages but maintains connections with Routers and supports Commissioning (<a href="#-1790576086#commissioning">&quot;Commissioning&quot; in &quot;Thread&quot;</a>).</p></li><li class="list-item" id="-1790576086#-vhh1nf_70"><p id="-1790576086#-vhh1nf_78">A <span class="control" id="-1790576086#-vhh1nf_79">Full End Device (FED)</span> is an FTD (<a href="#-1790576086#device-types">&quot;Device Types&quot; in &quot;Thread&quot;</a>) that operates as an End Device and will never become a Router. Unlike a REED, a FED cannot be promoted to a Router.</p></li><li class="list-item" id="-1790576086#-vhh1nf_71"><p id="-1790576086#-vhh1nf_81">A <span class="control" id="-1790576086#-vhh1nf_82">Minimal End Device (MED)</span> is an MTD (<a href="#-1790576086#device-types">&quot;Device Types&quot; in &quot;Thread&quot;</a>) that keeps its radio on at all times and can communicate with its Parent Router whenever needed. MEDs do not forward messages or participate in routing.</p></li><li class="list-item" id="-1790576086#-vhh1nf_72"><p id="-1790576086#-vhh1nf_84">A <span class="control" id="-1790576086#-vhh1nf_85">Sleepy End Device (SED)</span> is an MTD (<a href="#-1790576086#device-types">&quot;Device Types&quot; in &quot;Thread&quot;</a>) that turns off its radio when idle to save power. It periodically wakes up to communicate with its Parent Router but does not forward messages.</p></li></ul></section><section class="detached"><h3 id="-1790576086#border-router" data-toc="border-router#Thread.md-border-router">Border Router</h3><p id="-1790576086#-vhh1nf_87">A <span class="control" id="-1790576086#-vhh1nf_90">Thread Border Router</span> is a device that connects a Thread Network to external IP networks, such as Wi-Fi or Ethernet. It allows Thread devices to communicate with the internet or other smart home ecosystems.</p><p id="-1790576086#-vhh1nf_88">OpenThread's implementation of a Border Router is called <span class="control" id="-1790576086#-vhh1nf_91">OpenThread Border Router (OTBR)</span>.</p><p id="-1790576086#-vhh1nf_89">Espressif (<a href="#-1918844910">Espressif</a>) provides the ESP Thread Border Router SDK (<a href="#-1918844910#esp-thread-border-router-solution">&quot;ESP Thread Border Router Solution&quot; in &quot;Espressif&quot;</a>) and hardware platforms (<a href="#-1918844910#esp-thread-border-router-solution">&quot;ESP Thread Border Router Solution&quot; in &quot;Espressif&quot;</a>) for building Thread Border Routers.</p></section></section><section class="detached"><h2 id="-1790576086#network" data-toc="network#Thread.md-network">Network</h2><section class="detached"><h3 id="-1790576086#thread-network-data" data-toc="thread-network-data#Thread.md-thread-network-data">Thread Network Data</h3><p id="-1790576086#-vhh1nf_97"><span class="control" id="-1790576086#-vhh1nf_101">Thread Network Data</span> is a collection of network-related information managed and distributed by the Leader (<a href="#-1790576086#router">&quot;Router&quot; in &quot;Thread&quot;</a>) in a Thread network.</p><p id="-1790576086#-vhh1nf_98">It includes the following details:</p><ul class="list" id="-1790576086#-vhh1nf_99" start="1"><li class="list-item" id="-1790576086#-vhh1nf_103"><p id="-1790576086#-vhh1nf_108">Border Routers</p></li><li class="list-item" id="-1790576086#-vhh1nf_104"><p id="-1790576086#-vhh1nf_109">On-mesh prefixes</p></li><li class="list-item" id="-1790576086#-vhh1nf_105"><p id="-1790576086#-vhh1nf_110">External routes</p></li><li class="list-item" id="-1790576086#-vhh1nf_106"><p id="-1790576086#-vhh1nf_111">6LoWPAN contexts</p></li><li class="list-item" id="-1790576086#-vhh1nf_107"><p id="-1790576086#-vhh1nf_112">Network commissioning parameters</p></li></ul><p id="-1790576086#-vhh1nf_100">The Leader (<a href="#-1790576086#router">&quot;Router&quot; in &quot;Thread&quot;</a>) collects and updates Thread Network Data, distributing changes using MLE (Mesh Link Establishment) messages. Routers and REEDs store the full data, while End Devices (MTDs) (<a href="#-1790576086#end-device">&quot;End Device&quot; in &quot;Thread&quot;</a>) can store either the full set or only a stable subset to save resources.</p></section><section class="detached"><h3 id="-1790576086#active-operational-dataset" data-toc="active-operational-dataset#Thread.md-active-operational-dataset">Active Operational Dataset</h3><p id="-1790576086#-vhh1nf_115">The <span class="control" id="-1790576086#-vhh1nf_117">Active Operational Dataset</span> contains the configuration settings that Thread devices use to connect and operate within a specific Thread network:</p><ul class="list" id="-1790576086#-vhh1nf_116" start="1"><li class="list-item" id="-1790576086#-vhh1nf_118"><p id="-1790576086#-vhh1nf_128"><span class="control" id="-1790576086#-vhh1nf_129">Active Timestamp</span> determines dataset priority.</p></li><li class="list-item" id="-1790576086#-vhh1nf_119"><p id="-1790576086#-vhh1nf_130"><span class="control" id="-1790576086#-vhh1nf_131">Channel</span> is a PHY-layer channel for network communication.</p></li><li class="list-item" id="-1790576086#-vhh1nf_120"><p id="-1790576086#-vhh1nf_132"><span class="control" id="-1790576086#-vhh1nf_133">Channel Mask</span> defines channels for network discovery and scanning.</p></li><li class="list-item" id="-1790576086#-vhh1nf_121"><p id="-1790576086#-vhh1nf_134"><span class="control" id="-1790576086#-vhh1nf_135">Extended PAN ID</span> is a unique identifier for the Thread network.</p></li><li class="list-item" id="-1790576086#-vhh1nf_122"><p id="-1790576086#-vhh1nf_136"><span class="control" id="-1790576086#-vhh1nf_137">Mesh-Local Prefix</span> is an IPv6 prefix for local device communication.</p></li><li class="list-item" id="-1790576086#-vhh1nf_123"><p id="-1790576086#-vhh1nf_138"><span class="control" id="-1790576086#-vhh1nf_139">Network Key</span> is a 128-bit key used to secure communication within the Thread network.</p></li><li class="list-item" id="-1790576086#-vhh1nf_124"><p id="-1790576086#-vhh1nf_140"><span class="control" id="-1790576086#-vhh1nf_141">Network Name</span> is a human-readable network identifier.</p></li><li class="list-item" id="-1790576086#-vhh1nf_125"><p id="-1790576086#-vhh1nf_142"><span class="control" id="-1790576086#-vhh1nf_143">PAN ID</span> is a MAC-layer identifier for data transmissions.</p></li><li class="list-item" id="-1790576086#-vhh1nf_126"><p id="-1790576086#-vhh1nf_144"><span class="control" id="-1790576086#-vhh1nf_145">PSKc</span> is a security key for network authentication.</p></li><li class="list-item" id="-1790576086#-vhh1nf_127"><p id="-1790576086#-vhh1nf_146"><span class="control" id="-1790576086#-vhh1nf_147">Security Policy</span> specifies allowed and restricted security operations.</p></li></ul></section></section><section class="detached"><h2 id="-1790576086#commissioning" data-toc="commissioning#Thread.md-commissioning">Commissioning</h2><p id="-1790576086#-vhh1nf_148">The <span class="control" id="-1790576086#-vhh1nf_150">Joiner ID</span> is derived from the Joiner Discerner if one is set; otherwise, it is derived from the device's factory-assigned EUI-64 using SHA-256. This ID also serves as the device's IEEE 802.15.4 Extended Address during commissioning. When the device joins a Thread network, it automatically receives the Network Key.</p><section class="detached"><h3 id="-1790576086#commissioning-roles" data-toc="commissioning-roles#Thread.md-commissioning-roles">Commissioning Roles</h3><p id="-1790576086#-vhh1nf_151">The Thread Specification defines several commissioning roles within the <span class="control" id="-1790576086#-vhh1nf_153">Mesh Commissioning Protocol (MeshCoP):</span></p><ul class="list" id="-1790576086#-vhh1nf_152" start="1"><li class="list-item" id="-1790576086#-vhh1nf_154"><p id="-1790576086#-vhh1nf_158"><span class="control" id="-1790576086#-vhh1nf_160">Commissioner</span> manages device authentication and onboarding in a Thread network. It provides network credentials to new devices (<span class="control" id="-1790576086#-vhh1nf_161">Joiners</span>) and can update network parameters or perform diagnostics. Types of Commissioners:</p><ul class="list" id="-1790576086#-vhh1nf_159" start="1"><li class="list-item" id="-1790576086#-vhh1nf_162"><p id="-1790576086#-vhh1nf_165"><span class="control" id="-1790576086#-vhh1nf_166">On-Mesh Commissioner</span> operates inside the Thread network and has full control over commissioning.</p></li><li class="list-item" id="-1790576086#-vhh1nf_163"><p id="-1790576086#-vhh1nf_167"><span class="control" id="-1790576086#-vhh1nf_168">External Commissioner</span> resides outside the Thread network and connects via a <span class="control" id="-1790576086#-vhh1nf_169">Border Agent</span> (e.g., a mobile app or cloud service).</p></li><li class="list-item" id="-1790576086#-vhh1nf_164"><p id="-1790576086#-vhh1nf_170"><span class="control" id="-1790576086#-vhh1nf_171">Native Commissioner</span> uses the same Thread interface as the mesh to manage commissioning.</p></li></ul></li><li class="list-item" id="-1790576086#-vhh1nf_155"><p id="-1790576086#-vhh1nf_172"><span class="control" id="-1790576086#-vhh1nf_173">Joiner</span> is a Thread device attempting to join a commissioned Thread network. It does not have network credentials and must authenticate with a Commissioner to gain access.</p></li><li class="list-item" id="-1790576086#-vhh1nf_156"><p id="-1790576086#-vhh1nf_174"><span class="control" id="-1790576086#-vhh1nf_175">Border Agent (BA)</span> relays messages between an External or Native Commissioner and the Thread Network, ensuring secure communication between external networks and the Thread network.</p></li><li class="list-item" id="-1790576086#-vhh1nf_157"><p id="-1790576086#-vhh1nf_176"><span class="control" id="-1790576086#-vhh1nf_177">Joiner Router</span> is a Router or REED that assists a Joiner in communicating with a Commissioner when the Joiner is not within direct range. It does not perform full routing but forwards Joiner messages to facilitate secure commissioning.</p></li></ul></section></section><section class="detached"><h2 id="-1790576086#openthread-cli" data-toc="openthread-cli#Thread.md-openthread-cli">OpenThread CLI</h2><p id="-1790576086#-vhh1nf_178">The <span class="control" id="-1790576086#-vhh1nf_180">OpenThread CLI</span> is a command-line interface that provides configuration and management APIs for OpenThread.</p><p id="-1790576086#-vhh1nf_179">It is used on OpenThread Border Routers (OTBR), Commissioners, and other Thread devices. The available commands depend on the device type. The <span class="inline-code" id="-1790576086#-vhh1nf_181">help</span> command prints all the supported commands.</p></section><section class="detached"><h2 id="-1790576086#references" data-toc="references#Thread.md-references">References</h2><ul class="list" id="-1790576086#-vhh1nf_182" start="1"><li class="list-item" id="-1790576086#-vhh1nf_183"><p id="-1790576086#-vhh1nf_192">OpenThread Platforms (<a href="https://openthread.io/platforms">https://openthread.io/platforms</a>)</p></li><li class="list-item" id="-1790576086#-vhh1nf_184"><p id="-1790576086#-vhh1nf_194">OpenThread Node Roles and Types (<a href="https://openthread.io/guides/thread-primer/node-roles-and-types">https://openthread.io/guides/thread-primer/node-roles-and-types</a>)</p></li><li class="list-item" id="-1790576086#-vhh1nf_185"><p id="-1790576086#-vhh1nf_196">OpenThread Border Router (<a href="https://openthread.io/guides/border-router">https://openthread.io/guides/border-router</a>)</p></li><li class="list-item" id="-1790576086#-vhh1nf_186"><p id="-1790576086#-vhh1nf_198">Espressif OpenThread API (<a href="https://docs.espressif.com/projects/esp-idf/en/stable/esp32s2/api-guides/openthread.html">https://docs.espressif.com/projects/esp-idf/en/stable/esp32s2/api-guides/openthread.html</a>)</p></li><li class="list-item" id="-1790576086#-vhh1nf_187"><p id="-1790576086#-vhh1nf_200">OpenThread CLI Overview (<a href="https://openthread.io/reference/cli">https://openthread.io/reference/cli</a>)</p></li><li class="list-item" id="-1790576086#-vhh1nf_188"><p id="-1790576086#-vhh1nf_202">Espressif OpenThread CLI (<a href="https://github.com/espressif/esp-idf/tree/v5.4/examples/openthread/ot_cli">https://github.com/espressif/esp-idf/tree/v5.4/examples/openthread/ot_cli</a>)</p></li><li class="list-item" id="-1790576086#-vhh1nf_189"><p id="-1790576086#-vhh1nf_204">ESP Thread Border Router SDK (<a href="https://docs.espressif.com/projects/esp-thread-br/en/latest/">https://docs.espressif.com/projects/esp-thread-br/en/latest/</a>)</p></li><li class="list-item" id="-1790576086#-vhh1nf_190"><p id="-1790576086#-vhh1nf_206">Thread Commissioning (<a href="https://www.threadgroup.org/Portals/0/documents/support/CommissioningWhitePaper_658_2.pdf">https://www.threadgroup.org/Portals/0/documents/support/CommissioningWhitePaper_658_2.pdf</a>)</p></li><li class="list-item" id="-1790576086#-vhh1nf_191"><p id="-1790576086#-vhh1nf_208">OpenThread commissioning (<a href="https://docs.nordicsemi.com/bundle/ncs-latest/page/nrf/protocols/thread/overview/commissioning.html">https://docs.nordicsemi.com/bundle/ncs-latest/page/nrf/protocols/thread/overview/commissioning.html</a>)</p></li></ul></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-1997370655">Matter</h1><section class="detached"><h2 id="-1997370655#overview" data-toc="overview#Matter.md-overview">Overview</h2><p id="-1997370655#ciuszy_6">Matter is an <span class="control" id="-1997370655#ciuszy_7">IP-based</span> IoT connectivity standard that defines a common application layer for secure and interoperable communication over <span class="control" id="-1997370655#ciuszy_8">Wi-Fi</span>, <span class="control" id="-1997370655#ciuszy_9">Thread (<a href="#-1790576086">Thread</a>)</span>, and <span class="control" id="-1997370655#ciuszy_10">Ethernet</span> networks.</p></section><section class="detached"><h2 id="-1997370655#references" data-toc="references#Matter.md-references">References</h2><ul class="list" id="-1997370655#ciuszy_12" start="1"><li class="list-item" id="-1997370655#ciuszy_13"><p id="-1997370655#ciuszy_14">CSA - Specification Download Request (<a href="https://csa-iot.org/developer-resource/specifications-download-request/">https://csa-iot.org/developer-resource/specifications-download-request/</a>)</p></li></ul></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="2146435910">Data Model</h1><section class="detached"><h2 id="2146435910#overview" data-toc="overview#Data-Model.md-overview">Overview</h2><p id="2146435910#uv4ond_8"><span class="control" id="2146435910#uv4ond_19">Matter</span> (<a href="#-1997370655">Matter</a>) devices follow a hierarchical <span class="control" id="2146435910#uv4ond_18">Data Model</span>.</p><p id="2146435910#uv4ond_9">At the top of this hierarchy is the <span class="control" id="2146435910#uv4ond_20">Device</span>, which represents a physical entity.</p><p id="2146435910#uv4ond_10">Each Device contains one or more <span class="control" id="2146435910#uv4ond_21">Nodes</span> - addressable entities that support the Matter protocol stack. Once commissioned, each Node has its own <span class="control" id="2146435910#uv4ond_22">Operational Node ID</span> and <span class="control" id="2146435910#uv4ond_23">Node Operational Credentials</span>. Nodes can have different roles:</p><ul class="list" id="2146435910#uv4ond_11" start="1"><li class="list-item" id="2146435910#uv4ond_24"><p id="2146435910#uv4ond_27"><span class="control" id="2146435910#uv4ond_28">Controllers</span> (e.g., Google Home app) manage other nodes.</p></li><li class="list-item" id="2146435910#uv4ond_25"><p id="2146435910#uv4ond_29"><span class="control" id="2146435910#uv4ond_30">Commissioners</span> are responsible for commissioning devices by assigning Fabric credentials to <span class="control" id="2146435910#uv4ond_31">Commissionee</span> devices.</p></li><li class="list-item" id="2146435910#uv4ond_26"><p id="2146435910#uv4ond_32"><span class="control" id="2146435910#uv4ond_33">OTA Providers</span> supply software updates to <span class="control" id="2146435910#uv4ond_34">OTA Requesters</span>.</p></li></ul><p id="2146435910#uv4ond_12">Nodes can contain one or more individually addressable <span class="control" id="2146435910#uv4ond_35">Endpoints</span>, each representing a specific feature set.</p><p id="2146435910#uv4ond_13">Endpoints contain one or more <span class="control" id="2146435910#uv4ond_36">Clusters (<a href="#2146435910#clusters">&quot;Clusters&quot; in &quot;Data Model&quot;</a>)</span>, which enable independent utility or application functions. The <span class="emphasis" id="2146435910#uv4ond_37">Endpoint 0</span> is reserved for the Utility Clusters. Each Cluster may include the following:</p><ul class="list" id="2146435910#uv4ond_14" start="1"><li class="list-item" id="2146435910#uv4ond_39"><p id="2146435910#uv4ond_42"><span class="control" id="2146435910#uv4ond_43">Attributes</span>, which represent a physical quantity or state.</p></li><li class="list-item" id="2146435910#uv4ond_40"><p id="2146435910#uv4ond_44"><span class="control" id="2146435910#uv4ond_45">Commands</span>, which are actions.</p></li><li class="list-item" id="2146435910#uv4ond_41"><p id="2146435910#uv4ond_46"><span class="control" id="2146435910#uv4ond_47">Events</span>, which represent notifications of state changes or significant conditions.</p></li></ul><p id="2146435910#uv4ond_15">Example: a Smart Thermostat Device contains two Nodes:</p><ul class="list" id="2146435910#uv4ond_16" start="1"><li class="list-item" id="2146435910#uv4ond_48"><p id="2146435910#uv4ond_50">A Thermostat Node with a Thermostat Cluster (Attributes: Current Temperature, Commands: Set Heating Setpoint, Events: Temperature Changed).</p></li><li class="list-item" id="2146435910#uv4ond_49"><p id="2146435910#uv4ond_51">A Humidity Sensor Node with a Humidity Measurement Cluster (Attributes: Humidity Percentage, Commands: Read Humidity, Events: Humidity Changed).</p></li></ul></section><section class="detached"><h2 id="2146435910#device-types" data-toc="device-types#Data-Model.md-device-types">Device Types</h2><section class="detached"><h3 id="2146435910#thread-border-router-0x0091" data-toc="thread-border-router-0x0091#Data-Model.md-thread-border-router-0x0091">Thread Border Router (0x0091)</h3><p id="2146435910#uv4ond_58">Clusters:</p><ul class="list" id="2146435910#uv4ond_59" start="1"><li class="list-item" id="2146435910#uv4ond_60"><p id="2146435910#uv4ond_63">Thread Network Diagnostics (0x0035)</p></li><li class="list-item" id="2146435910#uv4ond_61"><p id="2146435910#uv4ond_64">Thread Border Router Management (0x0452)</p></li><li class="list-item" id="2146435910#uv4ond_62"><p id="2146435910#uv4ond_65">Thread Network Directory (0x0453)</p></li></ul></section><section class="detached"><h3 id="2146435910#temperature-sensor-0x0302" data-toc="temperature-sensor-0x0302#Data-Model.md-temperature-sensor-0x0302">Temperature Sensor (0x0302)</h3><p id="2146435910#uv4ond_66">Clusters:</p><ul class="list" id="2146435910#uv4ond_67" start="1"><li class="list-item" id="2146435910#uv4ond_68"><p id="2146435910#uv4ond_71">Identify (0x0003)</p></li><li class="list-item" id="2146435910#uv4ond_69"><p id="2146435910#uv4ond_72">Groups (0x0004)</p></li><li class="list-item" id="2146435910#uv4ond_70"><p id="2146435910#uv4ond_73">Temperature Measurement (0x0402)</p></li></ul></section><section class="detached"><h3 id="2146435910#secondary-network-interface-0x0019" data-toc="secondary-network-interface-0x0019#Data-Model.md-secondary-network-interface-0x0019">Secondary Network Interface (0x0019)</h3><p id="2146435910#uv4ond_74">Clusters:</p><ul class="list" id="2146435910#uv4ond_75" start="1"><li class="list-item" id="2146435910#uv4ond_76"><p id="2146435910#uv4ond_80">Network Commissioning (0x0031)</p></li><li class="list-item" id="2146435910#uv4ond_77"><p id="2146435910#uv4ond_81">Thread Network Diagnostics (0x0035)</p></li><li class="list-item" id="2146435910#uv4ond_78"><p id="2146435910#uv4ond_82">Wi-Fi Network Diagnostics (0x0036)</p></li><li class="list-item" id="2146435910#uv4ond_79"><p id="2146435910#uv4ond_83">Ethernet Network Diagnostics (0x0037)</p></li></ul></section><section class="detached"><h3 id="2146435910#root-node-0x0016" data-toc="root-node-0x0016#Data-Model.md-root-node-0x0016">Root Node (0x0016)</h3><p id="2146435910#uv4ond_84">Conditions:</p><ul class="list" id="2146435910#uv4ond_85" start="1"><li class="list-item" id="2146435910#uv4ond_88"><p id="2146435910#uv4ond_90">CustomNetworkConfig: The node only supports out-of-band-configured networking (e.g., rich user interface, manufacturer-specific means, custom commissioning flows, or future IP-compliant network technology not yet directly supported by the <span class="inline-code" id="2146435910#uv4ond_91">NetworkCommissioning</span> cluster).</p></li><li class="list-item" id="2146435910#uv4ond_89"><p id="2146435910#uv4ond_92">ManagedAclAllowed: The node has at least one endpoint where some Device Type present on the endpoint has a Device Library element requirement table entry that sets this condition to true.</p></li></ul><p id="2146435910#uv4ond_86">Clusters:</p><ul class="list" id="2146435910#uv4ond_87" start="1"><li class="list-item" id="2146435910#uv4ond_93"><p id="2146435910#uv4ond_112">Access Control (0x001F)</p></li><li class="list-item" id="2146435910#uv4ond_94"><p id="2146435910#uv4ond_113">Basic Information (0x0028)</p></li><li class="list-item" id="2146435910#uv4ond_95"><p id="2146435910#uv4ond_114">Localization Configuration (0x002B)</p></li><li class="list-item" id="2146435910#uv4ond_96"><p id="2146435910#uv4ond_115">Time Format Localization (0x002C)</p></li><li class="list-item" id="2146435910#uv4ond_97"><p id="2146435910#uv4ond_116">Unit Localization (0x002D)</p></li><li class="list-item" id="2146435910#uv4ond_98"><p id="2146435910#uv4ond_117">Power Source Configuration (0x002E)</p></li><li class="list-item" id="2146435910#uv4ond_99"><p id="2146435910#uv4ond_118">General Commissioning (0x0030)</p></li><li class="list-item" id="2146435910#uv4ond_100"><p id="2146435910#uv4ond_119">Network Commissioning (0x0031)</p></li><li class="list-item" id="2146435910#uv4ond_101"><p id="2146435910#uv4ond_120">Diagnostic Logs (0x0032)</p></li><li class="list-item" id="2146435910#uv4ond_102"><p id="2146435910#uv4ond_121">General Diagnostics (0x0033)</p></li><li class="list-item" id="2146435910#uv4ond_103"><p id="2146435910#uv4ond_122">Software Diagnostics (0x0034)</p></li><li class="list-item" id="2146435910#uv4ond_104"><p id="2146435910#uv4ond_123">Thread Network Diagnostics (0x0035)</p></li><li class="list-item" id="2146435910#uv4ond_105"><p id="2146435910#uv4ond_124">Wi-Fi Network Diagnostics (0x0036)</p></li><li class="list-item" id="2146435910#uv4ond_106"><p id="2146435910#uv4ond_125">Ethernet Network Diagnostics (0x0037)</p></li><li class="list-item" id="2146435910#uv4ond_107"><p id="2146435910#uv4ond_126">Time Synchronization (0x0038)</p></li><li class="list-item" id="2146435910#uv4ond_108"><p id="2146435910#uv4ond_127">Administrator Commissioning (0x003C)</p></li><li class="list-item" id="2146435910#uv4ond_109"><p id="2146435910#uv4ond_128">Node Operational Credentials (0x003E)</p></li><li class="list-item" id="2146435910#uv4ond_110"><p id="2146435910#uv4ond_129">Group Key Management (0x003F)</p></li><li class="list-item" id="2146435910#uv4ond_111"><p id="2146435910#uv4ond_130">ICD Management (0x0046)</p></li></ul></section><section class="detached"><h3 id="2146435910#pressure-sensor-0x0305" data-toc="pressure-sensor-0x0305#Data-Model.md-pressure-sensor-0x0305">Pressure Sensor (0x0305)</h3><p id="2146435910#uv4ond_131">Clusters:</p><ul class="list" id="2146435910#uv4ond_132" start="1"><li class="list-item" id="2146435910#uv4ond_133"><p id="2146435910#uv4ond_136">Identify (0x0003)</p></li><li class="list-item" id="2146435910#uv4ond_134"><p id="2146435910#uv4ond_137">Groups (0x0004)</p></li><li class="list-item" id="2146435910#uv4ond_135"><p id="2146435910#uv4ond_138">Pressure Measurement (0x0403)</p></li></ul></section><section class="detached"><h3 id="2146435910#network-infrastructure-manager-0x0090" data-toc="network-infrastructure-manager-0x0090#Data-Model.md-network-infrastructure-manager-0x0090">Network Infrastructure Manager (0x0090)</h3><p id="2146435910#uv4ond_139">Clusters:</p><ul class="list" id="2146435910#uv4ond_140" start="1"><li class="list-item" id="2146435910#uv4ond_141"><p id="2146435910#uv4ond_144">Wi-Fi Network Management (0x0451)</p></li><li class="list-item" id="2146435910#uv4ond_142"><p id="2146435910#uv4ond_145">Thread Border Router Management (0x0452)</p></li><li class="list-item" id="2146435910#uv4ond_143"><p id="2146435910#uv4ond_146">Thread Network Directory (0x0453)</p></li></ul></section></section><section class="detached"><h2 id="2146435910#clusters" data-toc="clusters#Data-Model.md-clusters">Clusters</h2><p id="2146435910#uv4ond_147">This section describes the <span class="control" id="2146435910#uv4ond_159">Clusters</span> in the Matter data model used in this project.</p><section class="detached"><h3 id="2146435910#descriptor-cluster-0x001d" data-toc="descriptor-cluster-0x001d#Data-Model.md-descriptor-cluster-0x001d">Descriptor Cluster (0x001D)</h3><p id="2146435910#uv4ond_160">Features:</p><ul class="list" id="2146435910#uv4ond_161" start="1"><li class="list-item" id="2146435910#uv4ond_164"><p id="2146435910#uv4ond_165">TagList: The TagList attribute is present.</p></li></ul><p id="2146435910#uv4ond_162">Attributes:</p><ul class="list" id="2146435910#uv4ond_163" start="1"><li class="list-item" id="2146435910#uv4ond_166"><p id="2146435910#uv4ond_171">DeviceTypeList (0x0000): List of device types associated with this endpoint.</p></li><li class="list-item" id="2146435910#uv4ond_167"><p id="2146435910#uv4ond_172">ServerList (0x0001): List of server clusters implemented on this endpoint.</p></li><li class="list-item" id="2146435910#uv4ond_168"><p id="2146435910#uv4ond_173">ClientList (0x0002): List of client clusters implemented on this endpoint.</p></li><li class="list-item" id="2146435910#uv4ond_169"><p id="2146435910#uv4ond_174">PartsList (0x0003): List of endpoints that are part of this endpoint.</p></li><li class="list-item" id="2146435910#uv4ond_170"><p id="2146435910#uv4ond_175">TagList (0x0004): List of semantic tags (available if the <span class="control" id="2146435910#uv4ond_176">TagList</span> feature is supported).</p></li></ul></section><section class="detached"><h3 id="2146435910#basic-information-cluster-0x0028" data-toc="basic-information-cluster-0x0028#Data-Model.md-basic-information-cluster-0x0028">Basic Information Cluster (0x0028)</h3><p id="2146435910#uv4ond_177">Attributes:</p><ul class="list" id="2146435910#uv4ond_178" start="1"><li class="list-item" id="2146435910#uv4ond_181"><p id="2146435910#uv4ond_204">DataModelRevision (0x0000): Data model revision, default is &quot;MS&quot;</p></li><li class="list-item" id="2146435910#uv4ond_182"><p id="2146435910#uv4ond_205">VendorName (0x0001): Vendor name (max length: 32 characters)</p></li><li class="list-item" id="2146435910#uv4ond_183"><p id="2146435910#uv4ond_206">VendorID (0x0002): Vendor ID</p></li><li class="list-item" id="2146435910#uv4ond_184"><p id="2146435910#uv4ond_207">ProductName (0x0003): Product name (max length: 32 characters)</p></li><li class="list-item" id="2146435910#uv4ond_185"><p id="2146435910#uv4ond_208">ProductID (0x0004): Product ID</p></li><li class="list-item" id="2146435910#uv4ond_186"><p id="2146435910#uv4ond_209">NodeLabel (0x0005): Node label (max length: 32 characters)</p></li><li class="list-item" id="2146435910#uv4ond_187"><p id="2146435910#uv4ond_210">Location (0x0006): Location (2-character code)</p></li><li class="list-item" id="2146435910#uv4ond_188"><p id="2146435910#uv4ond_211">HardwareVersion (0x0007): Hardware version (default is 0)</p></li><li class="list-item" id="2146435910#uv4ond_189"><p id="2146435910#uv4ond_212">HardwareVersionString (0x0008): Hardware version as a string (1 to 64 characters)</p></li><li class="list-item" id="2146435910#uv4ond_190"><p id="2146435910#uv4ond_213">SoftwareVersion (0x0009): Software version</p></li><li class="list-item" id="2146435910#uv4ond_191"><p id="2146435910#uv4ond_214">SoftwareVersionString (0x000A): Software version as a string (1 to 64 characters)</p></li><li class="list-item" id="2146435910#uv4ond_192"><p id="2146435910#uv4ond_215">ManufacturingDate (0x000B): Manufacturing date (8 to 16 characters)</p></li><li class="list-item" id="2146435910#uv4ond_193"><p id="2146435910#uv4ond_216">PartNumber (0x000C): Part number (max length: 32 characters)</p></li><li class="list-item" id="2146435910#uv4ond_194"><p id="2146435910#uv4ond_217">ProductURL (0x000D): Product URL (max length: 256 characters)</p></li><li class="list-item" id="2146435910#uv4ond_195"><p id="2146435910#uv4ond_218">ProductLabel (0x000E): Product label (max length: 64 characters)</p></li><li class="list-item" id="2146435910#uv4ond_196"><p id="2146435910#uv4ond_219">SerialNumber (0x000F): Serial number (max length: 32 characters)</p></li><li class="list-item" id="2146435910#uv4ond_197"><p id="2146435910#uv4ond_220">LocalConfigDisabled (0x0010): Local configuration status (true/false)</p></li><li class="list-item" id="2146435910#uv4ond_198"><p id="2146435910#uv4ond_221">Reachable (0x0011): Device reachability status (true/false)</p></li><li class="list-item" id="2146435910#uv4ond_199"><p id="2146435910#uv4ond_222">UniqueID (0x0012): Unique ID (max length: 32 characters)</p></li><li class="list-item" id="2146435910#uv4ond_200"><p id="2146435910#uv4ond_223">CapabilityMinima (0x0013): Minimum capabilities (Case sessions and subscriptions)</p></li><li class="list-item" id="2146435910#uv4ond_201"><p id="2146435910#uv4ond_224">ProductAppearance (0x0014): Product appearance (Finish and PrimaryColor)</p></li><li class="list-item" id="2146435910#uv4ond_202"><p id="2146435910#uv4ond_225">SpecificationVersion (0x0015): Specification version</p></li><li class="list-item" id="2146435910#uv4ond_203"><p id="2146435910#uv4ond_226">MaxPathsPerInvoke (0x0016): Max paths per invocation (default is 1)</p></li></ul><p id="2146435910#uv4ond_179">Events:</p><ul class="list" id="2146435910#uv4ond_180" start="1"><li class="list-item" id="2146435910#uv4ond_227"><p id="2146435910#uv4ond_231">StartUp (0x00): Triggered on startup with the SoftwareVersion field</p></li><li class="list-item" id="2146435910#uv4ond_228"><p id="2146435910#uv4ond_232">ShutDown (0x01): Triggered on shutdown</p></li><li class="list-item" id="2146435910#uv4ond_229"><p id="2146435910#uv4ond_233">Leave (0x02): Triggered when a device leaves, with a FabricIndex field (1 to 254)</p></li><li class="list-item" id="2146435910#uv4ond_230"><p id="2146435910#uv4ond_234">ReachableChanged (0x03): Triggered when the reachability status changes, with a ReachableNewValue field (true/false)</p></li></ul></section><section class="detached"><h3 id="2146435910#commissioner-control-cluster-0x0751" data-toc="commissioner-control-cluster-0x0751#Data-Model.md-commissioner-control-cluster-0x0751">Commissioner Control Cluster (0x0751)</h3><p id="2146435910#uv4ond_235">Attributes:</p><ul class="list" id="2146435910#uv4ond_236" start="1"><li class="list-item" id="2146435910#uv4ond_241"><p id="2146435910#uv4ond_242">SupportedDeviceCategories (0x0000): Supported Device Categories bitmap</p></li></ul><p id="2146435910#uv4ond_237">Commands:</p><ul class="list" id="2146435910#uv4ond_238" start="1"><li class="list-item" id="2146435910#uv4ond_243"><p id="2146435910#uv4ond_246">RequestCommissioningApproval (0x00): Triggered by a request for commissioning approval from the server</p><ul class="list" id="2146435910#uv4ond_247" start="1"><li class="list-item" id="2146435910#uv4ond_248"><p id="2146435910#uv4ond_252">RequestID (uint64)</p></li><li class="list-item" id="2146435910#uv4ond_249"><p id="2146435910#uv4ond_253">VendorID (vendor-id)</p></li><li class="list-item" id="2146435910#uv4ond_250"><p id="2146435910#uv4ond_254">ProductID (uint16)</p></li><li class="list-item" id="2146435910#uv4ond_251"><p id="2146435910#uv4ond_255">Label (string, max length 64)</p></li></ul></li><li class="list-item" id="2146435910#uv4ond_244"><p id="2146435910#uv4ond_256">CommissionNode (0x01): Command to commission a node, expects a response from the server</p><ul class="list" id="2146435910#uv4ond_257" start="1"><li class="list-item" id="2146435910#uv4ond_258"><p id="2146435910#uv4ond_260">RequestID (uint64)</p></li><li class="list-item" id="2146435910#uv4ond_259"><p id="2146435910#uv4ond_261">ResponseTimeoutSeconds (uint16, default 30, range 30 to 120)</p></li></ul></li><li class="list-item" id="2146435910#uv4ond_245"><p id="2146435910#uv4ond_262">ReverseOpenCommissioningWindow (0x02): Response from the server after a commissioning request</p><ul class="list" id="2146435910#uv4ond_263" start="1"><li class="list-item" id="2146435910#uv4ond_264"><p id="2146435910#uv4ond_269">CommissioningTimeout (uint16)</p></li><li class="list-item" id="2146435910#uv4ond_265"><p id="2146435910#uv4ond_270">PAKEPasscodeVerifier (octstr)</p></li><li class="list-item" id="2146435910#uv4ond_266"><p id="2146435910#uv4ond_271">Discriminator (uint16, max value 4095)</p></li><li class="list-item" id="2146435910#uv4ond_267"><p id="2146435910#uv4ond_272">Iterations (uint32, range 1000 to 100000)</p></li><li class="list-item" id="2146435910#uv4ond_268"><p id="2146435910#uv4ond_273">Salt (octstr, length between 16 to 32)</p></li></ul></li></ul><p id="2146435910#uv4ond_239">Events:</p><ul class="list" id="2146435910#uv4ond_240" start="1"><li class="list-item" id="2146435910#uv4ond_274"><p id="2146435910#uv4ond_275">CommissioningRequestResult (0x00): Event indicating the result of a commissioning request</p><ul class="list" id="2146435910#uv4ond_276" start="1"><li class="list-item" id="2146435910#uv4ond_277"><p id="2146435910#uv4ond_280">RequestID (uint64)</p></li><li class="list-item" id="2146435910#uv4ond_278"><p id="2146435910#uv4ond_281">ClientNodeID (node-id)</p></li><li class="list-item" id="2146435910#uv4ond_279"><p id="2146435910#uv4ond_282">StatusCode (status)</p></li></ul></li></ul></section><section class="detached"><h3 id="2146435910#thread-network-diagnostics-cluster-0x0035" data-toc="thread-network-diagnostics-cluster-0x0035#Data-Model.md-thread-network-diagnostics-cluster-0x0035">Thread Network Diagnostics Cluster (0x0035)</h3><p id="2146435910#uv4ond_283">Attributes:</p><ul class="list" id="2146435910#uv4ond_284" start="1"><li class="list-item" id="2146435910#uv4ond_289"><p id="2146435910#uv4ond_349">Channel (0x0000): Channel number</p></li><li class="list-item" id="2146435910#uv4ond_290"><p id="2146435910#uv4ond_350">RoutingRole (0x0001): Routing role of the node</p></li><li class="list-item" id="2146435910#uv4ond_291"><p id="2146435910#uv4ond_351">NetworkName (0x0002): Network name (max length 16)</p></li><li class="list-item" id="2146435910#uv4ond_292"><p id="2146435910#uv4ond_352">PanId (0x0003): PAN ID</p></li><li class="list-item" id="2146435910#uv4ond_293"><p id="2146435910#uv4ond_353">ExtendedPanId (0x0004): Extended PAN ID</p></li><li class="list-item" id="2146435910#uv4ond_294"><p id="2146435910#uv4ond_354">MeshLocalPrefix (0x0005): Mesh local prefix</p></li><li class="list-item" id="2146435910#uv4ond_295"><p id="2146435910#uv4ond_355">OverrunCount (0x0006): Overrun count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_296"><p id="2146435910#uv4ond_356">NeighborTable (0x0007): List of neighbor table entries</p></li><li class="list-item" id="2146435910#uv4ond_297"><p id="2146435910#uv4ond_357">RouteTable (0x0008): List of route table entries</p></li><li class="list-item" id="2146435910#uv4ond_298"><p id="2146435910#uv4ond_358">PartitionId (0x0009): Partition ID</p></li><li class="list-item" id="2146435910#uv4ond_299"><p id="2146435910#uv4ond_359">Weighting (0x000A): Weighting (max value 255)</p></li><li class="list-item" id="2146435910#uv4ond_300"><p id="2146435910#uv4ond_360">DataVersion (0x000B): Data version (max value 255)</p></li><li class="list-item" id="2146435910#uv4ond_301"><p id="2146435910#uv4ond_361">StableDataVersion (0x000C): Stable data version (max value 255)</p></li><li class="list-item" id="2146435910#uv4ond_302"><p id="2146435910#uv4ond_362">LeaderRouterId (0x000D): Leader router ID (max value 62)</p></li><li class="list-item" id="2146435910#uv4ond_303"><p id="2146435910#uv4ond_363">DetachedRoleCount (0x000E): Detached role count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_304"><p id="2146435910#uv4ond_364">ChildRoleCount (0x000F): Child role count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_305"><p id="2146435910#uv4ond_365">RouterRoleCount (0x0010): Router role count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_306"><p id="2146435910#uv4ond_366">LeaderRoleCount (0x0011): Leader role count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_307"><p id="2146435910#uv4ond_367">AttachAttemptCount (0x0012): Attach attempt count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_308"><p id="2146435910#uv4ond_368">PartitionIdChangeCount (0x0013): Partition ID change count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_309"><p id="2146435910#uv4ond_369">BetterPartitionAttachAttemptCount (0x0014): Better partition attach attempt count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_310"><p id="2146435910#uv4ond_370">ParentChangeCount (0x0015): Parent change count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_311"><p id="2146435910#uv4ond_371">TxTotalCount (0x0016): Total TX count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_312"><p id="2146435910#uv4ond_372">TxUnicastCount (0x0017): Unicast TX count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_313"><p id="2146435910#uv4ond_373">TxBroadcastCount (0x0018): Broadcast TX count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_314"><p id="2146435910#uv4ond_374">TxAckRequestedCount (0x0019): TX with ACK requested (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_315"><p id="2146435910#uv4ond_375">TxAckedCount (0x001A): TX with ACK received (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_316"><p id="2146435910#uv4ond_376">TxNoAckRequestedCount (0x001B): TX with no ACK requested (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_317"><p id="2146435910#uv4ond_377">TxDataCount (0x001C): Data TX count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_318"><p id="2146435910#uv4ond_378">TxDataPollCount (0x001D): Data poll TX count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_319"><p id="2146435910#uv4ond_379">TxBeaconCount (0x001E): Beacon TX count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_320"><p id="2146435910#uv4ond_380">TxBeaconRequestCount (0x001F): Beacon request TX count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_321"><p id="2146435910#uv4ond_381">TxOtherCount (0x0020): Other TX count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_322"><p id="2146435910#uv4ond_382">TxRetryCount (0x0021): Retry TX count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_323"><p id="2146435910#uv4ond_383">TxDirectMaxRetryExpiryCount (0x0022): Direct max retry expiry TX count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_324"><p id="2146435910#uv4ond_384">TxIndirectMaxRetryExpiryCount (0x0023): Indirect max retry expiry TX count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_325"><p id="2146435910#uv4ond_385">TxErrCcaCount (0x0024): CCA error TX count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_326"><p id="2146435910#uv4ond_386">TxErrAbortCount (0x0025): Abort error TX count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_327"><p id="2146435910#uv4ond_387">TxErrBusyChannelCount (0x0026): Busy channel error TX count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_328"><p id="2146435910#uv4ond_388">RxTotalCount (0x0027): Total RX count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_329"><p id="2146435910#uv4ond_389">RxUnicastCount (0x0028): Unicast RX count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_330"><p id="2146435910#uv4ond_390">RxBroadcastCount (0x0029): Broadcast RX count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_331"><p id="2146435910#uv4ond_391">RxDataCount (0x002A): Data RX count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_332"><p id="2146435910#uv4ond_392">RxDataPollCount (0x002B): Data poll RX count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_333"><p id="2146435910#uv4ond_393">RxBeaconCount (0x002C): Beacon RX count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_334"><p id="2146435910#uv4ond_394">RxBeaconRequestCount (0x002D): Beacon request RX count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_335"><p id="2146435910#uv4ond_395">RxOtherCount (0x002E): Other RX count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_336"><p id="2146435910#uv4ond_396">RxAddressFilteredCount (0x002F): Address filtered RX count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_337"><p id="2146435910#uv4ond_397">RxDestAddrFilteredCount (0x0030): Destination address filtered RX count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_338"><p id="2146435910#uv4ond_398">RxDuplicatedCount (0x0031): Duplicated RX count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_339"><p id="2146435910#uv4ond_399">RxErrNoFrameCount (0x0032): No frame error RX count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_340"><p id="2146435910#uv4ond_400">RxErrUnknownNeighborCount (0x0033): Unknown neighbor error RX count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_341"><p id="2146435910#uv4ond_401">RxErrInvalidSrcAddrCount (0x0034): Invalid source address error RX count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_342"><p id="2146435910#uv4ond_402">RxErrSecCount (0x0035): Security error RX count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_343"><p id="2146435910#uv4ond_403">RxErrFcsCount (0x0036): FCS error RX count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_344"><p id="2146435910#uv4ond_404">RxErrOtherCount (0x0037): Other error RX count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_345"><p id="2146435910#uv4ond_405">ActiveTimestamp (0x0038): Active timestamp (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_346"><p id="2146435910#uv4ond_406">PendingTimestamp (0x0039): Pending timestamp (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_347"><p id="2146435910#uv4ond_407">Delay (0x003A): Delay (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_348"><p id="2146435910#uv4ond_408">SecurityPolicy (0x003B): Security policy</p></li></ul><p id="2146435910#uv4ond_285">Commands:</p><ul class="list" id="2146435910#uv4ond_286" start="1"><li class="list-item" id="2146435910#uv4ond_409"><p id="2146435910#uv4ond_410">ResetCounts (0x00): Resets error counts and statistics, invokes on the server</p></li></ul><p id="2146435910#uv4ond_287">Events:</p><ul class="list" id="2146435910#uv4ond_288" start="1"><li class="list-item" id="2146435910#uv4ond_411"><p id="2146435910#uv4ond_413">ConnectionStatus (0x00): Event indicating connection status</p></li><li class="list-item" id="2146435910#uv4ond_412"><p id="2146435910#uv4ond_414">NetworkFaultChange (0x01): Event indicating network fault change</p></li></ul></section><section class="detached"><h3 id="2146435910#wi-fi-network-diagnostics-cluster-0x0036" data-toc="wi-fi-network-diagnostics-cluster-0x0036#Data-Model.md-wi-fi-network-diagnostics-cluster-0x0036">Wi-Fi Network Diagnostics Cluster (0x0036)</h3><p id="2146435910#uv4ond_415">Attributes:</p><ul class="list" id="2146435910#uv4ond_416" start="1"><li class="list-item" id="2146435910#uv4ond_421"><p id="2146435910#uv4ond_434">BSSID (0x0000): Basic Service Set Identifier (BSSID)</p></li><li class="list-item" id="2146435910#uv4ond_422"><p id="2146435910#uv4ond_435">SecurityType (0x0001): Wi-Fi security type</p></li><li class="list-item" id="2146435910#uv4ond_423"><p id="2146435910#uv4ond_436">WiFiVersion (0x0002): Wi-Fi version</p></li><li class="list-item" id="2146435910#uv4ond_424"><p id="2146435910#uv4ond_437">ChannelNumber (0x0003): Channel number</p></li><li class="list-item" id="2146435910#uv4ond_425"><p id="2146435910#uv4ond_438">RSSI (0x0004): Received Signal Strength Indicator (RSSI)</p></li><li class="list-item" id="2146435910#uv4ond_426"><p id="2146435910#uv4ond_439">BeaconLostCount (0x0005): Number of beacon losses (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_427"><p id="2146435910#uv4ond_440">BeaconRxCount (0x0006): Number of beacon packets received (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_428"><p id="2146435910#uv4ond_441">PacketMulticastRxCount (0x0007): Multicast RX packet count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_429"><p id="2146435910#uv4ond_442">PacketMulticastTxCount (0x0008): Multicast TX packet count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_430"><p id="2146435910#uv4ond_443">PacketUnicastRxCount (0x0009): Unicast RX packet count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_431"><p id="2146435910#uv4ond_444">PacketUnicastTxCount (0x000A): Unicast TX packet count (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_432"><p id="2146435910#uv4ond_445">CurrentMaxRate (0x000B): Current maximum rate (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_433"><p id="2146435910#uv4ond_446">OverrunCount (0x000C): Overrun count (default 0)</p></li></ul><p id="2146435910#uv4ond_417">Commands:</p><ul class="list" id="2146435910#uv4ond_418" start="1"><li class="list-item" id="2146435910#uv4ond_447"><p id="2146435910#uv4ond_448">ResetCounts (0x00): Resets the counts for errors and statistics</p></li></ul><p id="2146435910#uv4ond_419">Events:</p><ul class="list" id="2146435910#uv4ond_420" start="1"><li class="list-item" id="2146435910#uv4ond_449"><p id="2146435910#uv4ond_452">Disconnection (0x00): Event triggered when a disconnection occurs</p><ul class="list" id="2146435910#uv4ond_453" start="1"><li class="list-item" id="2146435910#uv4ond_454"><p id="2146435910#uv4ond_455">ReasonCode (uint16)</p></li></ul></li><li class="list-item" id="2146435910#uv4ond_450"><p id="2146435910#uv4ond_456">AssociationFailure (0x01): Event triggered on association failure</p><ul class="list" id="2146435910#uv4ond_457" start="1"><li class="list-item" id="2146435910#uv4ond_458"><p id="2146435910#uv4ond_460">AssociationFailureCause (AssociationFailureCauseEnum)</p></li><li class="list-item" id="2146435910#uv4ond_459"><p id="2146435910#uv4ond_461">Status (uint16)</p></li></ul></li><li class="list-item" id="2146435910#uv4ond_451"><p id="2146435910#uv4ond_462">ConnectionStatus (0x02): Event triggered when the connection status changes</p><ul class="list" id="2146435910#uv4ond_463" start="1"><li class="list-item" id="2146435910#uv4ond_464"><p id="2146435910#uv4ond_465">ConnectionStatus (ConnectionStatusEnum)</p></li></ul></li></ul></section><section class="detached"><h3 id="2146435910#network-commissioning-cluster-0x0031" data-toc="network-commissioning-cluster-0x0031#Data-Model.md-network-commissioning-cluster-0x0031">Network Commissioning Cluster (0x0031)</h3><p id="2146435910#uv4ond_466">Attributes:</p><ul class="list" id="2146435910#uv4ond_467" start="1"><li class="list-item" id="2146435910#uv4ond_472"><p id="2146435910#uv4ond_483">MaxNetworks (0x0000): Maximum number of networks (min 1)</p></li><li class="list-item" id="2146435910#uv4ond_473"><p id="2146435910#uv4ond_484">Networks (0x0001): List of network information</p></li><li class="list-item" id="2146435910#uv4ond_474"><p id="2146435910#uv4ond_485">ScanMaxTimeSeconds (0x0002): Max scan time for networks</p></li><li class="list-item" id="2146435910#uv4ond_475"><p id="2146435910#uv4ond_486">ConnectMaxTimeSeconds (0x0003): Max connection time</p></li><li class="list-item" id="2146435910#uv4ond_476"><p id="2146435910#uv4ond_487">InterfaceEnabled (0x0004): Whether the interface is enabled (default true)</p></li><li class="list-item" id="2146435910#uv4ond_477"><p id="2146435910#uv4ond_488">LastNetworkingStatus (0x0005): Last network commissioning status</p></li><li class="list-item" id="2146435910#uv4ond_478"><p id="2146435910#uv4ond_489">LastNetworkID (0x0006): Last network ID</p></li><li class="list-item" id="2146435910#uv4ond_479"><p id="2146435910#uv4ond_490">LastConnectErrorValue (0x0007): Last connection error value</p></li><li class="list-item" id="2146435910#uv4ond_480"><p id="2146435910#uv4ond_491">SupportedWiFiBands (0x0008): List of supported Wi-Fi bands</p></li><li class="list-item" id="2146435910#uv4ond_481"><p id="2146435910#uv4ond_492">SupportedThreadFeatures (0x0009): Thread features supported</p></li><li class="list-item" id="2146435910#uv4ond_482"><p id="2146435910#uv4ond_493">ThreadVersion (0x000A): Thread version</p></li></ul><p id="2146435910#uv4ond_468">Commands:</p><ul class="list" id="2146435910#uv4ond_469" start="1"><li class="list-item" id="2146435910#uv4ond_494"><p id="2146435910#uv4ond_503">ScanNetworks (0x00): Scan for available networks</p></li><li class="list-item" id="2146435910#uv4ond_495"><p id="2146435910#uv4ond_504">ScanNetworksResponse (0x01): Response to scan networks request</p></li><li class="list-item" id="2146435910#uv4ond_496"><p id="2146435910#uv4ond_505">AddOrUpdateWiFiNetwork (0x02): Add or update a Wi-Fi network</p></li><li class="list-item" id="2146435910#uv4ond_497"><p id="2146435910#uv4ond_506">AddOrUpdateThreadNetwork (0x03): Add or update a Thread network</p></li><li class="list-item" id="2146435910#uv4ond_498"><p id="2146435910#uv4ond_507">RemoveNetwork (0x04): Remove a network</p></li><li class="list-item" id="2146435910#uv4ond_499"><p id="2146435910#uv4ond_508">NetworkConfigResponse (0x05): Response to network configuration commands</p></li><li class="list-item" id="2146435910#uv4ond_500"><p id="2146435910#uv4ond_509">ConnectNetwork (0x06): Connect to a network</p></li><li class="list-item" id="2146435910#uv4ond_501"><p id="2146435910#uv4ond_510">ConnectNetworkResponse (0x07): Response to connect to network</p></li><li class="list-item" id="2146435910#uv4ond_502"><p id="2146435910#uv4ond_511">ReorderNetwork (0x08): Reorder a network in the list</p></li></ul><p id="2146435910#uv4ond_470">Events:</p><ul class="list" id="2146435910#uv4ond_471" start="1"><li class="list-item" id="2146435910#uv4ond_512"><p id="2146435910#uv4ond_515">Disconnection (0x00): Event indicating network disconnection</p></li><li class="list-item" id="2146435910#uv4ond_513"><p id="2146435910#uv4ond_516">AssociationFailure (0x01): Event indicating a failure in association</p></li><li class="list-item" id="2146435910#uv4ond_514"><p id="2146435910#uv4ond_517">ConnectionStatus (0x02): Event indicating the connection status</p></li></ul></section><section class="detached"><h3 id="2146435910#on-off-cluster-0x0006" data-toc="on-off-cluster-0x0006#Data-Model.md-on-off-cluster-0x0006">On/Off Cluster (0x0006)</h3><p id="2146435910#uv4ond_518">Attributes:</p><ul class="list" id="2146435910#uv4ond_519" start="1"><li class="list-item" id="2146435910#uv4ond_528"><p id="2146435910#uv4ond_533">OnOff (0x0000): On/Off state (default false)</p></li><li class="list-item" id="2146435910#uv4ond_529"><p id="2146435910#uv4ond_534">GlobalSceneControl (0x4000): Global scene control (default true)</p></li><li class="list-item" id="2146435910#uv4ond_530"><p id="2146435910#uv4ond_535">OnTime (0x4001): On time duration (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_531"><p id="2146435910#uv4ond_536">OffWaitTime (0x4002): Off wait time (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_532"><p id="2146435910#uv4ond_537">StartUpOnOff (0x4003): Start-up behavior for OnOff state (default &quot;MS&quot;)</p></li></ul><p id="2146435910#uv4ond_520">Commands:</p><ul class="list" id="2146435910#uv4ond_521" start="1"><li class="list-item" id="2146435910#uv4ond_538"><p id="2146435910#uv4ond_544">Off (0x00): Command to turn off</p></li><li class="list-item" id="2146435910#uv4ond_539"><p id="2146435910#uv4ond_545">On (0x01): Command to turn on</p></li><li class="list-item" id="2146435910#uv4ond_540"><p id="2146435910#uv4ond_546">Toggle (0x02): Command to toggle the On/Off state</p></li><li class="list-item" id="2146435910#uv4ond_541"><p id="2146435910#uv4ond_547">OffWithEffect (0x40): Turn off with an effect</p><ul class="list" id="2146435910#uv4ond_548" start="1"><li class="list-item" id="2146435910#uv4ond_549"><p id="2146435910#uv4ond_551">EffectIdentifier (EffectIdentifierEnum)</p></li><li class="list-item" id="2146435910#uv4ond_550"><p id="2146435910#uv4ond_552">EffectVariant (enum8)</p></li></ul></li><li class="list-item" id="2146435910#uv4ond_542"><p id="2146435910#uv4ond_553">OnWithRecallGlobalScene (0x41): Turn on with the recall of the global scene</p></li><li class="list-item" id="2146435910#uv4ond_543"><p id="2146435910#uv4ond_554">OnWithTimedOff (0x42): Turn on with timed off</p><ul class="list" id="2146435910#uv4ond_555" start="1"><li class="list-item" id="2146435910#uv4ond_556"><p id="2146435910#uv4ond_559">OnOffControl (OnOffControlBitmap)</p></li><li class="list-item" id="2146435910#uv4ond_557"><p id="2146435910#uv4ond_560">OnTime (uint16)</p></li><li class="list-item" id="2146435910#uv4ond_558"><p id="2146435910#uv4ond_561">OffWaitTime (uint16)</p></li></ul></li></ul><p id="2146435910#uv4ond_522">Events:</p><ul class="list" id="2146435910#uv4ond_523" start="1"><li class="list-item" id="2146435910#uv4ond_562"><p id="2146435910#uv4ond_563">No events listed for this cluster</p></li></ul><p id="2146435910#uv4ond_524">Features:</p><ul class="list" id="2146435910#uv4ond_525" start="1"><li class="list-item" id="2146435910#uv4ond_564"><p id="2146435910#uv4ond_567">Lighting (LT): Supports lighting applications</p></li><li class="list-item" id="2146435910#uv4ond_565"><p id="2146435910#uv4ond_568">DeadFrontBehavior (DF): Device has Dead Front behavior</p></li><li class="list-item" id="2146435910#uv4ond_566"><p id="2146435910#uv4ond_569">OffOnly (OFFONLY): Device supports the OffOnly feature</p></li></ul><p id="2146435910#uv4ond_526">Data Types:</p><ul class="list" id="2146435910#uv4ond_527" start="1"><li class="list-item" id="2146435910#uv4ond_570"><p id="2146435910#uv4ond_575">DelayedAllOffEffectVariantEnum: Defines variants for delayed off effects</p></li><li class="list-item" id="2146435910#uv4ond_571"><p id="2146435910#uv4ond_576">DyingLightEffectVariantEnum: Defines variants for dying light effect</p></li><li class="list-item" id="2146435910#uv4ond_572"><p id="2146435910#uv4ond_577">EffectIdentifierEnum: Identifiers for effects like DelayedAllOff and DyingLight</p></li><li class="list-item" id="2146435910#uv4ond_573"><p id="2146435910#uv4ond_578">StartUpOnOffEnum: Defines start-up behavior for OnOff (Off, On, or Toggle)</p></li><li class="list-item" id="2146435910#uv4ond_574"><p id="2146435910#uv4ond_579">OnOffControlBitmap: Bitmap for controlling On/Off state behavior</p></li></ul></section><section class="detached"><h3 id="2146435910#pressure-measurement-cluster-0x0403" data-toc="pressure-measurement-cluster-0x0403#Data-Model.md-pressure-measurement-cluster-0x0403">Pressure Measurement Cluster (0x0403)</h3><p id="2146435910#uv4ond_580">Attributes:</p><ul class="list" id="2146435910#uv4ond_581" start="1"><li class="list-item" id="2146435910#uv4ond_584"><p id="2146435910#uv4ond_593">MeasuredValue (0x0000): The current measured pressure value (int16)</p></li><li class="list-item" id="2146435910#uv4ond_585"><p id="2146435910#uv4ond_594">MinMeasuredValue (0x0001): Minimum measured pressure value (int16, max 32766)</p></li><li class="list-item" id="2146435910#uv4ond_586"><p id="2146435910#uv4ond_595">MaxMeasuredValue (0x0002): Maximum measured pressure value (int16)</p></li><li class="list-item" id="2146435910#uv4ond_587"><p id="2146435910#uv4ond_596">Tolerance (0x0003): Tolerance for the measurement (uint16, default 0, max 2048)</p></li><li class="list-item" id="2146435910#uv4ond_588"><p id="2146435910#uv4ond_597">ScaledValue (0x0010): Scaled pressure value (int16)</p></li><li class="list-item" id="2146435910#uv4ond_589"><p id="2146435910#uv4ond_598">MinScaledValue (0x0011): Minimum scaled value (int16, max 32766)</p></li><li class="list-item" id="2146435910#uv4ond_590"><p id="2146435910#uv4ond_599">MaxScaledValue (0x0012): Maximum scaled value (int16)</p></li><li class="list-item" id="2146435910#uv4ond_591"><p id="2146435910#uv4ond_600">ScaledTolerance (0x0013): Tolerance for the scaled value (uint16, default 0, max 2048)</p></li><li class="list-item" id="2146435910#uv4ond_592"><p id="2146435910#uv4ond_601">Scale (0x0014): Scaling factor for the measurement (int8, default 0, min -127)</p></li></ul><p id="2146435910#uv4ond_582">Features:</p><ul class="list" id="2146435910#uv4ond_583" start="1"><li class="list-item" id="2146435910#uv4ond_602"><p id="2146435910#uv4ond_603">Extended (EXT): Indicates extended range and resolution support</p></li></ul></section><section class="detached"><h3 id="2146435910#temperature-measurement-cluster-0x0402" data-toc="temperature-measurement-cluster-0x0402#Data-Model.md-temperature-measurement-cluster-0x0402">Temperature Measurement Cluster (0x0402)</h3><p id="2146435910#uv4ond_604">Attributes:</p><ul class="list" id="2146435910#uv4ond_605" start="1"><li class="list-item" id="2146435910#uv4ond_606"><p id="2146435910#uv4ond_610">MeasuredValue (0x0000): The current measured temperature value (type: temperature)</p></li><li class="list-item" id="2146435910#uv4ond_607"><p id="2146435910#uv4ond_611">MinMeasuredValue (0x0001): Minimum measured temperature value (type: temperature, range: -273.15&deg;C to 32766&deg;C)</p></li><li class="list-item" id="2146435910#uv4ond_608"><p id="2146435910#uv4ond_612">MaxMeasuredValue (0x0002): Maximum measured temperature value (type: temperature, greater than MinMeasuredValue)</p></li><li class="list-item" id="2146435910#uv4ond_609"><p id="2146435910#uv4ond_613">Tolerance (0x0003): Tolerance for the measurement (uint16, default 0, max 2048)</p></li></ul></section><section class="detached"><h3 id="2146435910#thread-border-router-management-cluster-0x0452" data-toc="thread-border-router-management-cluster-0x0452#Data-Model.md-thread-border-router-management-cluster-0x0452">Thread Border Router Management Cluster (0x0452)</h3><p id="2146435910#uv4ond_614">Attributes:</p><ul class="list" id="2146435910#uv4ond_615" start="1"><li class="list-item" id="2146435910#uv4ond_618"><p id="2146435910#uv4ond_624">BorderRouterName (0x0000): The name of the Border Router (1 to 63 characters)</p></li><li class="list-item" id="2146435910#uv4ond_619"><p id="2146435910#uv4ond_625">BorderAgentID (0x0001): The Border Agent ID (16 bytes)</p></li><li class="list-item" id="2146435910#uv4ond_620"><p id="2146435910#uv4ond_626">ThreadVersion (0x0002): The Thread version (default &quot;MS&quot;)</p></li><li class="list-item" id="2146435910#uv4ond_621"><p id="2146435910#uv4ond_627">InterfaceEnabled (0x0003): Whether the interface is enabled (default false)</p></li><li class="list-item" id="2146435910#uv4ond_622"><p id="2146435910#uv4ond_628">ActiveDatasetTimestamp (0x0004): Timestamp for the active dataset (default 0)</p></li><li class="list-item" id="2146435910#uv4ond_623"><p id="2146435910#uv4ond_629">PendingDatasetTimestamp (0x0005): Timestamp for the pending dataset (default 0)</p></li></ul><p id="2146435910#uv4ond_616">Commands:</p><ul class="list" id="2146435910#uv4ond_617" start="1"><li class="list-item" id="2146435910#uv4ond_630"><p id="2146435910#uv4ond_635">GetActiveDatasetRequest (0x00): Request to get the active dataset</p></li><li class="list-item" id="2146435910#uv4ond_631"><p id="2146435910#uv4ond_636">GetPendingDatasetRequest (0x01): Request to get the pending dataset</p></li><li class="list-item" id="2146435910#uv4ond_632"><p id="2146435910#uv4ond_637">DatasetResponse (0x02): Response containing the dataset (max length: 254 bytes)</p></li><li class="list-item" id="2146435910#uv4ond_633"><p id="2146435910#uv4ond_638">SetActiveDatasetRequest (0x03): Request to set the active dataset (max length: 254 bytes)</p></li><li class="list-item" id="2146435910#uv4ond_634"><p id="2146435910#uv4ond_639">SetPendingDatasetRequest (0x04): Request to set the pending dataset (max length: 254 bytes) with PAN change feature</p></li></ul></section><section class="detached"><h3 id="2146435910#thread-network-directory-cluster-0x0453" data-toc="thread-network-directory-cluster-0x0453#Data-Model.md-thread-network-directory-cluster-0x0453">Thread Network Directory Cluster (0x0453)</h3><p id="2146435910#uv4ond_640">Attributes:</p><ul class="list" id="2146435910#uv4ond_641" start="1"><li class="list-item" id="2146435910#uv4ond_644"><p id="2146435910#uv4ond_647">PreferredExtendedPanID (0x0000): Preferred Extended PAN ID (8 bytes, nullable)</p></li><li class="list-item" id="2146435910#uv4ond_645"><p id="2146435910#uv4ond_648">ThreadNetworks (0x0001): List of Thread networks (max count defined by <span class="inline-code" id="2146435910#uv4ond_649">ThreadNetworkTableSize</span>)</p></li><li class="list-item" id="2146435910#uv4ond_646"><p id="2146435910#uv4ond_650">ThreadNetworkTableSize (0x0002): Maximum number of Thread networks (default: 10)</p></li></ul><p id="2146435910#uv4ond_642">Commands:</p><ul class="list" id="2146435910#uv4ond_643" start="1"><li class="list-item" id="2146435910#uv4ond_651"><p id="2146435910#uv4ond_655">AddNetwork (0x00): Add a network by providing the Operational Dataset (max length: 254 bytes)</p></li><li class="list-item" id="2146435910#uv4ond_652"><p id="2146435910#uv4ond_656">RemoveNetwork (0x01): Remove a network by specifying the Extended PAN ID (8 bytes)</p></li><li class="list-item" id="2146435910#uv4ond_653"><p id="2146435910#uv4ond_657">GetOperationalDataset (0x02): Get the Operational Dataset of a specified network by providing the Extended PAN ID (8 bytes)</p></li><li class="list-item" id="2146435910#uv4ond_654"><p id="2146435910#uv4ond_658">OperationalDatasetResponse (0x03): Response containing the Operational Dataset (max length: 254 bytes)</p></li></ul></section></section><section class="detached"><h2 id="2146435910#references" data-toc="references#Data-Model.md-references">References</h2><p id="2146435910#uv4ond_659">Device Types are defined in the <span class="control" id="2146435910#uv4ond_661">Device Library</span> rather than the main <span class="control" id="2146435910#uv4ond_662">Matter specification</span> document. Application Clusters are specified in the <span class="control" id="2146435910#uv4ond_663">Application Cluster Library</span>. These three documents can be requested from the <span class="control" id="2146435910#uv4ond_664">Connectivity Standards Alliance</span> (<span class="control" id="2146435910#uv4ond_665">CSA</span>) members' website. The <span class="control" id="2146435910#uv4ond_666">Matter Data Model</span> is also available on GitHub in the <span class="control" id="2146435910#uv4ond_667">Connected Home over IP</span> repository.</p><ul class="list" id="2146435910#uv4ond_660" start="1"><li class="list-item" id="2146435910#uv4ond_668"><p id="2146435910#uv4ond_686">Google Developer Centre - Matter - The Device Data Model (<a href="https://developers.home.google.com/matter/primer/device-data-model">https://developers.home.google.com/matter/primer/device-data-model</a>)</p></li><li class="list-item" id="2146435910#uv4ond_669"><p id="2146435910#uv4ond_688">GitHub - Matter Data Model (<a href="https://github.com/project-chip/connectedhomeip/tree/master/data_model/">https://github.com/project-chip/connectedhomeip/tree/master/data_model/</a>)</p></li><li class="list-item" id="2146435910#uv4ond_670"><p id="2146435910#uv4ond_690">Thread Border Router Device (<a href="https://github.com/project-chip/connectedhomeip/blob/master/data_model/1.4.1/device_types/ThreadBorderRouter.xml">https://github.com/project-chip/connectedhomeip/blob/master/data_model/1.4.1/device_types/ThreadBorderRouter.xml</a>)</p></li><li class="list-item" id="2146435910#uv4ond_671"><p id="2146435910#uv4ond_692">Temperature Sensor Device (<a href="https://github.com/project-chip/connectedhomeip/blob/master/data_model/1.4.1/device_types/TemperatureSensor.xml">https://github.com/project-chip/connectedhomeip/blob/master/data_model/1.4.1/device_types/TemperatureSensor.xml</a>)</p></li><li class="list-item" id="2146435910#uv4ond_672"><p id="2146435910#uv4ond_694">Secondary Network Interface Device (<a href="https://github.com/project-chip/connectedhomeip/blob/master/data_model/1.4.1/device_types/SecondaryNetworkInterface.xml">https://github.com/project-chip/connectedhomeip/blob/master/data_model/1.4.1/device_types/SecondaryNetworkInterface.xml</a>)</p></li><li class="list-item" id="2146435910#uv4ond_673"><p id="2146435910#uv4ond_696">Root Node Device (<a href="https://github.com/project-chip/connectedhomeip/blob/master/data_model/1.4.1/device_types/RootNodeDeviceType.xml">https://github.com/project-chip/connectedhomeip/blob/master/data_model/1.4.1/device_types/RootNodeDeviceType.xml</a>)</p></li><li class="list-item" id="2146435910#uv4ond_674"><p id="2146435910#uv4ond_698">Pressure Sensor Device (<a href="https://github.com/project-chip/connectedhomeip/blob/master/data_model/1.4.1/device_types/PressureSensor.xml">https://github.com/project-chip/connectedhomeip/blob/master/data_model/1.4.1/device_types/PressureSensor.xml</a>)</p></li><li class="list-item" id="2146435910#uv4ond_675"><p id="2146435910#uv4ond_700">Network Infrastructure Manager Device (<a href="https://github.com/project-chip/connectedhomeip/blob/master/data_model/1.4.1/device_types/NetworkInfraManager.xml">https://github.com/project-chip/connectedhomeip/blob/master/data_model/1.4.1/device_types/NetworkInfraManager.xml</a>)</p></li><li class="list-item" id="2146435910#uv4ond_676"><p id="2146435910#uv4ond_702">Basic Information Cluster (<a href="https://github.com/project-chip/connectedhomeip/blob/master/data_model/1.4.1/clusters/BasicInformationCluster.xml">https://github.com/project-chip/connectedhomeip/blob/master/data_model/1.4.1/clusters/BasicInformationCluster.xml</a>)</p></li><li class="list-item" id="2146435910#uv4ond_677"><p id="2146435910#uv4ond_704">Commissioner Control Cluster (<a href="https://github.com/project-chip/connectedhomeip/blob/master/data_model/1.4.1/clusters/CommissionerControlCluster.xml">https://github.com/project-chip/connectedhomeip/blob/master/data_model/1.4.1/clusters/CommissionerControlCluster.xml</a>)</p></li><li class="list-item" id="2146435910#uv4ond_678"><p id="2146435910#uv4ond_706">Thread Diagnostics Cluster (<a href="https://github.com/project-chip/connectedhomeip/blob/master/data_model/1.4.1/clusters/DiagnosticsThread.xml">https://github.com/project-chip/connectedhomeip/blob/master/data_model/1.4.1/clusters/DiagnosticsThread.xml</a>)</p></li><li class="list-item" id="2146435910#uv4ond_679"><p id="2146435910#uv4ond_708">Wi-Fi Diagnostics Cluster (<a href="https://github.com/project-chip/connectedhomeip/blob/master/data_model/1.4.1/clusters/DiagnosticsWiFi.xml">https://github.com/project-chip/connectedhomeip/blob/master/data_model/1.4.1/clusters/DiagnosticsWiFi.xml</a>)</p></li><li class="list-item" id="2146435910#uv4ond_680"><p id="2146435910#uv4ond_710">Network Commissioning Cluster (<a href="https://github.com/project-chip/connectedhomeip/blob/master/data_model/1.4.1/clusters/NetworkCommissioningCluster.xml">https://github.com/project-chip/connectedhomeip/blob/master/data_model/1.4.1/clusters/NetworkCommissioningCluster.xml</a>)</p></li><li class="list-item" id="2146435910#uv4ond_681"><p id="2146435910#uv4ond_712">On/Off Cluster (<a href="https://github.com/project-chip/connectedhomeip/blob/master/data_model/1.4.1/clusters/OnOff.xml">https://github.com/project-chip/connectedhomeip/blob/master/data_model/1.4.1/clusters/OnOff.xml</a>)</p></li><li class="list-item" id="2146435910#uv4ond_682"><p id="2146435910#uv4ond_714">Pressure Measurement Cluster (<a href="https://github.com/project-chip/connectedhomeip/blob/master/data_model/1.4.1/clusters/PressureMeasurement.xml">https://github.com/project-chip/connectedhomeip/blob/master/data_model/1.4.1/clusters/PressureMeasurement.xml</a>)</p></li><li class="list-item" id="2146435910#uv4ond_683"><p id="2146435910#uv4ond_716">Temperature Measurement Cluster (<a href="https://github.com/project-chip/connectedhomeip/blob/master/data_model/1.4.1/clusters/TemperatureMeasurement.xml">https://github.com/project-chip/connectedhomeip/blob/master/data_model/1.4.1/clusters/TemperatureMeasurement.xml</a>)</p></li><li class="list-item" id="2146435910#uv4ond_684"><p id="2146435910#uv4ond_718">Thread Border Router Management Cluster (<a href="https://github.com/project-chip/connectedhomeip/blob/master/data_model/1.4.1/clusters/ThreadBorderRouterManagement.xml">https://github.com/project-chip/connectedhomeip/blob/master/data_model/1.4.1/clusters/ThreadBorderRouterManagement.xml</a>)</p></li><li class="list-item" id="2146435910#uv4ond_685"><p id="2146435910#uv4ond_720">Thread Network Directory Cluster (<a href="https://github.com/project-chip/connectedhomeip/blob/master/data_model/1.4.1/clusters/ThreadNetworkDirectory.xml">https://github.com/project-chip/connectedhomeip/blob/master/data_model/1.4.1/clusters/ThreadNetworkDirectory.xml</a>)</p></li></ul></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="279346443">Matter Commissioning</h1><section class="detached"><h2 id="279346443#overview" data-toc="overview#Matter-Commissioning.md-overview">Overview</h2><p id="279346443#-2a0g4c_4"><span class="control" id="279346443#-2a0g4c_9">Commissioners</span> add a <span class="control" id="279346443#-2a0g4c_10">Commissionee</span> device to a <span class="control" id="279346443#-2a0g4c_11">Fabric</span>.</p><p id="279346443#-2a0g4c_5">A <span class="control" id="279346443#-2a0g4c_12">Fabric</span> is a private virtual network that connects Matter Devices and extends across Wi-Fi, Thread, and Ethernet physical networks. During the Matter commissioning process, controllers assign Fabric credentials to ensure secure integration.</p><section class="detached"><h3 id="279346443#commissioning-process" data-toc="commissioning-process#Matter-Commissioning.md-commissioning-process">Commissioning Process</h3><p id="279346443#-2a0g4c_13">Commissioning involves the following steps:</p><ol class="list list-decimal" id="279346443#-2a0g4c_14" type="1" start="1"><li class="list-item" id="279346443#-2a0g4c_15"><p id="279346443#-2a0g4c_22">The Commissioner retrieves the Onboarding Payload (<a href="#279346443#onboarding-payload">&quot;Onboarding Payload&quot; in &quot;Matter Commissioning&quot;</a>) and discovers (<a href="#279346443#device-discovery">&quot;Device Discovery&quot; in &quot;Matter Commissioning&quot;</a>) the Commissionee device.</p></li><li class="list-item" id="279346443#-2a0g4c_16"><p id="279346443#-2a0g4c_25">Passcode-Authenticated Session Establishment (PASE) is used to establish encryption keys, securing communication between the Commissioner and Commissionee. This process also sets up an attestation challenge for verifying the device&rsquo;s authenticity.</p></li><li class="list-item" id="279346443#-2a0g4c_17"><p id="279346443#-2a0g4c_26">The Commissioner verifies the Commissionee&rsquo;s authenticity through Device Attestation, ensuring it is a certified Matter device.</p></li><li class="list-item" id="279346443#-2a0g4c_18"><p id="279346443#-2a0g4c_27">The Commissioner configures the Commissionee by providing essential information including network configuration settings, such as Wi-Fi credentials (SSID and passphrase) or Thread network credentials.</p></li><li class="list-item" id="279346443#-2a0g4c_19"><p id="279346443#-2a0g4c_28">The Commissionee joins the operational network, unless it is already connected. The Commissioner or Administrator identifies or discovers the device&rsquo;s IPv6 address to enable further communication.</p></li><li class="list-item" id="279346443#-2a0g4c_20"><p id="279346443#-2a0g4c_29">Certificate-Authenticated Session Establishment (CASE) is used to derive long-term encryption keys, securing all future unicast communication between the Commissioner or Administrator and the Commissionee.</p></li><li class="list-item" id="279346443#-2a0g4c_21"><p id="279346443#-2a0g4c_30">The Commissioning process completes with an encrypted message exchange, confirming successful onboarding using CASE-derived encryption keys on the operational network.</p></li></ol></section><section class="detached"><h3 id="279346443#onboarding-payload" data-toc="onboarding-payload#Matter-Commissioning.md-onboarding-payload">Onboarding Payload</h3><p id="279346443#-2a0g4c_31">The <span class="control" id="279346443#-2a0g4c_33">Commissionee</span> shares the <span class="control" id="279346443#-2a0g4c_34">Onboarding Payload</span> with the <span class="control" id="279346443#-2a0g4c_35">Commissioner</span> through a <span class="emphasis" id="279346443#-2a0g4c_36">QR Code</span>, <span class="emphasis" id="279346443#-2a0g4c_37">Manual Pairing Code</span>, or <span class="emphasis" id="279346443#-2a0g4c_38">NFC Tag</span>. It is composed of required and optional information. The following information may be included:</p><ul class="list" id="279346443#-2a0g4c_32" start="1"><li class="list-item" id="279346443#-2a0g4c_39"><p id="279346443#-2a0g4c_47"><span class="control" id="279346443#-2a0g4c_48">Version</span> specifies the payload format version, allowing future updates. It is 3 bits (0b000) for machine-readable formats and 1 bit (0b0) for Manual Pairing Codes.</p></li><li class="list-item" id="279346443#-2a0g4c_40"><p id="279346443#-2a0g4c_49"><span class="control" id="279346443#-2a0g4c_50">Vendor ID</span> is a 16-bit identifier assigned by the Connectivity Standards Alliance (CSA) to uniquely identify a device manufacturer. It ensures that devices from different manufacturers can be distinguished within the Matter ecosystem.</p></li><li class="list-item" id="279346443#-2a0g4c_41"><p id="279346443#-2a0g4c_51"><span class="control" id="279346443#-2a0g4c_52">Product ID</span> is a 16-bit identifier assigned by the manufacturer to differentiate between their products. It helps identify specific device models and is used in commissioning and attestation processes.</p></li><li class="list-item" id="279346443#-2a0g4c_42"><p id="279346443#-2a0g4c_53"><span class="control" id="279346443#-2a0g4c_54">Custom Flow</span> is a 2-bit enumeration that specifies whether additional steps are required before commissioning. It informs the Commissioner if the device is ready for commissioning immediately, requires user interaction (such as pressing a button), or needs an external service interaction before being available for setup.</p></li><li class="list-item" id="279346443#-2a0g4c_43"><p id="279346443#-2a0g4c_55"><span class="control" id="279346443#-2a0g4c_56">Discovery Capabilities Bitmask</span> is an 8-bit bitmask included in machine-readable formats. It indicates the discovery technologies (e.g., BLE, Wi-Fi, Thread) supported by the device, helping the Commissioner determine how to find and connect to it.</p></li><li class="list-item" id="279346443#-2a0g4c_44"><p id="279346443#-2a0g4c_57"><span class="control" id="279346443#-2a0g4c_58">Discriminator</span> is a 12-bit identifier used to distinguish between multiple commissionable device advertisements. When a device enters commissioning mode, it broadcasts this value over BLE, Wi-Fi, or Thread, and it must match the value the device advertises. Each device should have a unique Discriminator to improve discovery and setup reliability. In machine-readable formats, the full 12-bit Discriminator is used, while in Manual Pairing Codes, only the upper 4 bits are included.</p></li><li class="list-item" id="279346443#-2a0g4c_45"><p id="279346443#-2a0g4c_59"><span class="control" id="279346443#-2a0g4c_60">Passcode</span> is a 27-bit numeric value used to authenticate the device during commissioning, serving as proof of possession. It is encoded as an 8-digit decimal number ranging from 00000001 to 99999998, excluding invalid values. The Passcode is also used as a shared secret to establish a secure channel between the Commissioner and the device for further onboarding steps.</p></li><li class="list-item" id="279346443#-2a0g4c_46"><p id="279346443#-2a0g4c_61"><span class="control" id="279346443#-2a0g4c_62">TLV Data</span> is optional, variable-length information stored in machine-readable formats using the Tag-Length-Value encoding. This data provides additional commissioning details.</p></li></ul></section><section class="detached"><h3 id="279346443#device-discovery" data-toc="device-discovery#Matter-Commissioning.md-device-discovery">Device Discovery</h3><p id="279346443#-2a0g4c_63"><span class="control" id="279346443#-2a0g4c_65">Device Discovery</span> is the process where a <span class="control" id="279346443#-2a0g4c_66">Commissioner</span> identifies a <span class="control" id="279346443#-2a0g4c_67">Commissionee</span> before onboarding it to a <span class="control" id="279346443#-2a0g4c_68">Fabric</span>. Devices announce their presence through the following methods:</p><ul class="list" id="279346443#-2a0g4c_64" start="1"><li class="list-item" id="279346443#-2a0g4c_69"><p id="279346443#-2a0g4c_73"><span class="control" id="279346443#-2a0g4c_74">BLE</span> is used by devices without network credentials to advertise their presence. The Commissioner scans for advertisements containing the Discriminator, Vendor ID, and Product ID to identify the correct device.</p></li><li class="list-item" id="279346443#-2a0g4c_70"><p id="279346443#-2a0g4c_75"><span class="control" id="279346443#-2a0g4c_76">Wi-Fi / Ethernet</span> is used by devices already connected to a network, announcing themselves via mDNS.</p></li><li class="list-item" id="279346443#-2a0g4c_71"><p id="279346443#-2a0g4c_77"><span class="control" id="279346443#-2a0g4c_78">Thread</span> is used by Thread-enabled devices, which register with a Thread Border Router using Service Registration Protocol (SRP).</p></li><li class="list-item" id="279346443#-2a0g4c_72"><p id="279346443#-2a0g4c_79"><span class="control" id="279346443#-2a0g4c_80">User-Directed Commissioning (UDC)</span> allows a device to actively search for Commissioners, letting the user select one for onboarding.</p></li></ul></section></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-2077639180">Access Control</h1><p id="-2077639180#ejr9zv_3">All Matter Interaction Model operations require verification by the Access Control mechanism. Before a client can read, subscribe, write attributes, or invoke commands on a server, Access Control must confirm sufficient privileges. If not granted, the operation is denied (status 0x7E: Access Denied).</p><p id="-2077639180#ejr9zv_4">Matter enforces access levels for secure operations:</p><ul class="list" id="-2077639180#ejr9zv_5" start="1"><li class="list-item" id="-2077639180#ejr9zv_9"><p id="-2077639180#ejr9zv_14"><span class="control" id="-2077639180#ejr9zv_15">View</span> (<span class="control" id="-2077639180#ejr9zv_16">1</span>) &ndash; Can read and subscribe to all attributes and events, except the Access Control Cluster.</p></li><li class="list-item" id="-2077639180#ejr9zv_10"><p id="-2077639180#ejr9zv_17">Proxy (2) - <span class="emphasis" id="-2077639180#ejr9zv_18">not yet supported in Matter SDK</span> &ndash; Can read and subscribe to all attributes and events when acting as a Proxy device.</p></li><li class="list-item" id="-2077639180#ejr9zv_11"><p id="-2077639180#ejr9zv_19"><span class="control" id="-2077639180#ejr9zv_20">Operate</span> (<span class="control" id="-2077639180#ejr9zv_21">3</span>) &ndash; Can perform the main function of the Node, plus all View privileges (except Access Control Cluster).</p></li><li class="list-item" id="-2077639180#ejr9zv_12"><p id="-2077639180#ejr9zv_22"><span class="control" id="-2077639180#ejr9zv_23">Manage</span> (<span class="control" id="-2077639180#ejr9zv_24">4</span>) &ndash; Can modify the Node&rsquo;s settings and configuration, plus all Operate privileges (except Access Control Cluster).</p></li><li class="list-item" id="-2077639180#ejr9zv_13"><p id="-2077639180#ejr9zv_25"><span class="control" id="-2077639180#ejr9zv_26">Administer</span> (<span class="control" id="-2077639180#ejr9zv_27">5</span>) &ndash; Can manage the Access Control Cluster, plus all Manage privileges.</p></li></ul><p id="-2077639180#ejr9zv_6">The Administer privilege is initially granted to the commissioner over the PASE commissioning channel, allowing it to invoke commands during commissioning.</p><p id="-2077639180#ejr9zv_7">Administrators manage ACLs by reading and writing the fabric-scoped ACL attribute in the Access Control Cluster (always on endpoint 0). These ACLs control which Interaction Model operations are allowed or denied for fabric nodes via CASE and group messaging.</p><section class="detached"><h2 id="-2077639180#references" data-toc="references#Access-Control.md-references">References</h2><ul class="list" id="-2077639180#ejr9zv_28" start="1"><li class="list-item" id="-2077639180#ejr9zv_29"><p id="-2077639180#ejr9zv_30">GitHub - Matter - Access Control Guide (<a href="https://github.com/project-chip/connectedhomeip/blob/master/docs/guides/access-control-guide.md">https://github.com/project-chip/connectedhomeip/blob/master/docs/guides/access-control-guide.md</a>)</p></li></ul></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-1918844910">Espressif</h1><section class="detached"><h2 id="-1918844910#overview" data-toc="overview#Espressif.md-overview">Overview</h2><p id="-1918844910#-zh9fiv_10"><span class="control" id="-1918844910#-zh9fiv_11">Espressif</span> is a semiconductor company that develops SoCs, microcontrollers, and development boards for IoT applications.</p></section><section class="detached"><h2 id="-1918844910#hardware" data-toc="hardware#Espressif.md-hardware">Hardware</h2><p id="-1918844910#-zh9fiv_12">Espressif's SoCs (System-on-Chips) enable wireless communication for IoT applications. Development boards integrate these SoCs with power circuits, USB interfaces, and breakout pins, making them easy to use for prototyping and automation projects.</p><p id="-1918844910#-zh9fiv_13">The following development boards are used in this system:</p><ul class="list" id="-1918844910#-zh9fiv_14" start="1"><li class="list-item" id="-1918844910#-zh9fiv_15"><p id="-1918844910#-zh9fiv_19">ESP32-H2-DevKitM-1 (<a href="https://docs.espressif.com/projects/esp-dev-kits/en/latest/esp32h2/esp32-h2-devkitm-1/index.html">https://docs.espressif.com/projects/esp-dev-kits/en/latest/esp32h2/esp32-h2-devkitm-1/index.html</a>) is a development board with Thread and Bluetooth LE connectivity, designed for low-power applications.</p></li><li class="list-item" id="-1918844910#-zh9fiv_16"><p id="-1918844910#-zh9fiv_21">ESP32-C6-DevKitC-1 (<a href="https://docs.espressif.com/projects/esp-dev-kits/en/latest/esp32c6/esp32-c6-devkitc-1/index.html">https://docs.espressif.com/projects/esp-dev-kits/en/latest/esp32c6/esp32-c6-devkitc-1/index.html</a>) is a development board with Wi-Fi 6, Bluetooth LE, and Thread connectivity.</p></li><li class="list-item" id="-1918844910#-zh9fiv_17"><p id="-1918844910#-zh9fiv_23">ESP32-DevKitM-1 (<a href="https://docs.espressif.com/projects/esp-dev-kits/en/latest/esp32/esp32-devkitm-1/index.html">https://docs.espressif.com/projects/esp-dev-kits/en/latest/esp32/esp32-devkitm-1/index.html</a>) is a development board with Wi-Fi and Bluetooth LE connectivity, designed for general-purpose applications.</p></li><li class="list-item" id="-1918844910#-zh9fiv_18"><p id="-1918844910#-zh9fiv_25">ESP Thread Border Router (<a href="https://docs.espressif.com/projects/esp-thread-br/en/latest/hardware_platforms.html">https://docs.espressif.com/projects/esp-thread-br/en/latest/hardware_platforms.html</a>) is a development board that acts as a Thread Border Router, enabling communication between Thread networks and Wi-Fi or Ethernet for external connectivity.</p></li></ul></section><section class="detached"><h2 id="-1918844910#esp-idf-framework" data-toc="esp-idf-framework#Espressif.md-esp-idf-framework">ESP-IDF Framework</h2><p id="-1918844910#-zh9fiv_27"><span class="control" id="-1918844910#-zh9fiv_28">ESP-IDF</span> (<span class="control" id="-1918844910#-zh9fiv_29">Espressif IoT Development Framework</span>) is Espressif&rsquo;s official IoT Development Framework for the ESP32, ESP32-S, ESP32-C and ESP32-H series of SoCs.</p></section><section class="detached"><h2 id="-1918844910#esp-matter-solution" data-toc="esp-matter-solution#Espressif.md-esp-matter-solution">ESP Matter Solution</h2><p id="-1918844910#-zh9fiv_30">The <span class="control" id="-1918844910#-zh9fiv_33">Espressif's SDK for Matter</span> is the official Matter (<a href="#-1997370655">Matter</a>) development framework for ESP32 series SoCs.</p><p id="-1918844910#-zh9fiv_31">Wi-Fi-enabled ESP32, ESP32-C, and ESP32-S series can be used to build Matter Wi-Fi devices, with the ESP32-S series also supporting Ethernet connectivity via an external controller.</p><p id="-1918844910#-zh9fiv_32">ESP32-H series SoCs, which support IEEE 802.15.4, are used for Matter-compatible Thread end devices.</p></section><section class="detached"><h2 id="-1918844910#esp-thread-border-router-solution" data-toc="esp-thread-border-router-solution#Espressif.md-esp-thread-border-router-solution">ESP Thread Border Router Solution</h2><p id="-1918844910#-zh9fiv_35">The <span class="control" id="-1918844910#-zh9fiv_40">Espressif Thread Border Router SDK</span> is a FreeRTOS-based solution built on the ESP-IDF (<a href="#-1918844910#esp-idf-framework">&quot;ESP-IDF Framework&quot; in &quot;Espressif&quot;</a>) and OpenThread (<a href="#-1790576086">Thread</a>) stack. It supports both Wi-Fi and Ethernet interfaces as the backbone link, combined with 802.15.4 SoCs for Thread communication.</p><p id="-1918844910#-zh9fiv_36">The Wi-Fi-based Espressif Thread Border runs on two SoCs:</p><ul class="list" id="-1918844910#-zh9fiv_37" start="1"><li class="list-item" id="-1918844910#-zh9fiv_43"><p id="-1918844910#-zh9fiv_45">The host Wi-Fi SoC, which runs OpenThread Border Router (ESP32, ESP32-S, or ESP32-C series SoC).</p></li><li class="list-item" id="-1918844910#-zh9fiv_44"><p id="-1918844910#-zh9fiv_46">The Radio Co-Processor (RCP), which enables the Border Router to access the 802.15.4 physical and MAC layers (ESP32-H series SoC).</p></li></ul><p id="-1918844910#-zh9fiv_38">Espressif also provides a single <span class="control" id="-1918844910#-zh9fiv_47">ESP THREAD BR-ZIGBEE GW</span> board that integrates both the host SoC and the RCP into a single board.</p><p id="-1918844910#-zh9fiv_39">Espressif also provides a <span class="control" id="-1918844910#-zh9fiv_48">ESP Thread BR-Zigbee GW_SUB</span> daughter board for building an Ethernet-enabled Thread Border Router. It must be connected to a Wi-Fi-based ESP Thread Border Router.</p></section><section class="detached"><h2 id="-1918844910#esp-mesh-lite" data-toc="esp-mesh-lite#Espressif.md-esp-mesh-lite">ESP-Mesh-Lite</h2><p id="-1918844910#-zh9fiv_49"><span class="control" id="-1918844910#-zh9fiv_51">ESP-Mesh-Lite</span> is a Wi-Fi Mesh networking solution based on the Wi-Fi protocol. It supports Espressif's Wi-Fi SoCs (<a href="#-1918844910#hardware">&quot;Hardware&quot; in &quot;Espressif&quot;</a>), including ESP32, ESP32-C, and ESP32-S.</p><p id="-1918844910#-zh9fiv_50">In a traditional Wi-Fi network, all devices must connect directly to the router, limiting coverage and the number of connected devices based on the router's capacity. With <span class="control" id="-1918844910#-zh9fiv_53">ESP-Mesh-Lite</span>, devices can connect to nearby nodes instead of relying solely on the router. This extends Wi-Fi coverage and allows more devices to join the network without router limitations.</p></section><section class="detached"><h2 id="-1918844910#references" data-toc="references#Espressif.md-references">References</h2><ul class="list" id="-1918844910#-zh9fiv_54" start="1"><li class="list-item" id="-1918844910#-zh9fiv_55"><p id="-1918844910#-zh9fiv_60">About Espressif (<a href="https://www.espressif.com/en/about">https://www.espressif.com/en/about</a>)</p></li><li class="list-item" id="-1918844910#-zh9fiv_56"><p id="-1918844910#-zh9fiv_62">Espressif Development Boards (<a href="https://www.espressif.com/en/products/devkits/">https://www.espressif.com/en/products/devkits/</a>)</p></li><li class="list-item" id="-1918844910#-zh9fiv_57"><p id="-1918844910#-zh9fiv_64">ESP IoT Development Framework (<a href="https://www.espressif.com/en/products/sdks/esp-idf">https://www.espressif.com/en/products/sdks/esp-idf</a>)</p></li><li class="list-item" id="-1918844910#-zh9fiv_58"><p id="-1918844910#-zh9fiv_66">ESP-Mesh-Lite (<a href="https://www.espressif.com/en/sdks/esp-mesh-lite">https://www.espressif.com/en/sdks/esp-mesh-lite</a>)</p></li><li class="list-item" id="-1918844910#-zh9fiv_59"><p id="-1918844910#-zh9fiv_68">ESP-Mesh-Lite User Guide (<a href="https://github.com/espressif/esp-mesh-lite/blob/master/components/mesh_lite/User_Guide.md">https://github.com/espressif/esp-mesh-lite/blob/master/components/mesh_lite/User_Guide.md</a>)</p></li></ul></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="1112016086">ESP Development Environment</h1><p id="1112016086#pkxeg5_4">This chapter describes the development environment setup for building and deploying projects on ESP32 series SoCs.</p><p id="1112016086#pkxeg5_5">Prerequisites:</p><ul class="list" id="1112016086#pkxeg5_6" start="1"><li class="list-item" id="1112016086#pkxeg5_9"><p id="1112016086#pkxeg5_10"><span class="control" id="1112016086#pkxeg5_11">Ubuntu Desktop</span> 24.04 LTS is used as the development environment for this guide.</p></li></ul><p id="1112016086#pkxeg5_7">The following software has to be installed:</p><ul class="list" id="1112016086#pkxeg5_8" start="1"><li class="list-item" id="1112016086#pkxeg5_12"><p id="1112016086#pkxeg5_14">ESP-IDF framework (<a href="#-1918844910#esp-idf-framework">&quot;ESP-IDF Framework&quot; in &quot;Espressif&quot;</a>)</p></li><li class="list-item" id="1112016086#pkxeg5_13"><p id="1112016086#pkxeg5_16">ESP-Matter framework (<a href="#-1918844910#esp-matter-solution">&quot;ESP Matter Solution&quot; in &quot;Espressif&quot;</a>)</p></li></ul></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-400735760">ESP-IDF Setup</h1><section class="detached"><h2 id="-400735760#overview" data-toc="overview#ESP-IDF-Setup.md-overview">Overview</h2><p id="-400735760#z3b50uj_10">This section demonstrates how to set up the ESP-IDF (<a href="#-1918844910#esp-idf-framework">&quot;ESP-IDF Framework&quot; in &quot;Espressif&quot;</a>) development environment for building and running applications on ESP32 SoCs.</p><p id="-400735760#z3b50uj_11">This project uses ESP-IDF v5.3.2 (<a href="https://docs.espressif.com/projects/esp-idf/en/v5.3.2/">https://docs.espressif.com/projects/esp-idf/en/v5.3.2/</a>), locked to commit fb25eb0 (<a href="https://github.com/espressif/esp-idf/commit/fb25eb02ebcf78a78b4c34a839238a4a56accec7">https://github.com/espressif/esp-idf/commit/fb25eb02ebcf78a78b4c34a839238a4a56accec7</a>).</p></section><section class="detached"><h2 id="-400735760#step-1-install-prerequisites" data-toc="step-1-install-prerequisites#ESP-IDF-Setup.md-step-1-install-prerequisites">Step 1: Install Prerequisites</h2><div class="detached code-block" id="-400735760#z3b50uj_15"><pre><code class="language-bash">sudo apt-get install git wget flex bison gperf python3 python3-pip python3-venv cmake ninja-build ccache libffi-dev libssl-dev dfu-util libusb-1.0-0</code></pre></div></section><section class="detached"><h2 id="-400735760#step-2-get-esp-idf" data-toc="step-2-get-esp-idf#ESP-IDF-Setup.md-step-2-get-esp-idf">Step 2: Get ESP-IDF</h2><div class="detached code-block" id="-400735760#z3b50uj_16"><pre><code class="language-bash">mkdir -p ~/esp
cd ~/esp
git clone -b release/v5.3 --recursive https://github.com/espressif/esp-idf.git esp-idf-5.3
cd ~/esp/esp-idf-5.3
git checkout fb25eb02ebcf78a78b4c34a839238a4a56accec7</code></pre></div></section><section class="detached"><h2 id="-400735760#step-3-set-up-the-tools" data-toc="step-3-set-up-the-tools#ESP-IDF-Setup.md-step-3-set-up-the-tools">Step 3: Set up the Tools</h2><p id="-400735760#z3b50uj_17">ESP-IDF provides a script <span class="inline-code" id="-400735760#z3b50uj_19">install.sh</span> that installs the required tools such as the compiler, debugger, Python packages, etc.:</p><div class="detached code-block" id="-400735760#z3b50uj_18"><pre><code class="language-bash">./install.sh all</code></pre></div></section><section class="detached"><h2 id="-400735760#step-4-create-get-idf-alias" data-toc="step-4-create-get-idf-alias#ESP-IDF-Setup.md-step-4-create-get-idf-alias">Step 4: Create get_idf Alias</h2><p id="-400735760#z3b50uj_20">ESP-IDF provides a script <span class="inline-code" id="-400735760#z3b50uj_23">export.sh</span> that sets environment variables so the tools are usable from the command line. The script sets IDF_PATH, updates PATH with ESP-IDF tools, verifies Python compatibility, and enables idf.py auto-completion.</p><p id="-400735760#z3b50uj_21">Create an alias for executing export.sh by adding the following line to <span class="inline-code" id="-400735760#z3b50uj_24">~/.bashrc</span> file:</p><div class="detached code-block" id="-400735760#z3b50uj_22"><pre><code class="language-bash">alias get_idf='. $HOME/esp/esp-idf-5.3/export.sh'</code></pre></div></section><section class="detached"><h2 id="-400735760#step-5-refresh-configuration" data-toc="step-5-refresh-configuration#ESP-IDF-Setup.md-step-5-refresh-configuration">Step 5: Refresh Configuration</h2><p id="-400735760#z3b50uj_25">Restart your terminal session or run:</p><div class="detached code-block" id="-400735760#z3b50uj_26"><pre><code class="language-bash">source ~/.bashrc</code></pre></div><p id="-400735760#z3b50uj_27">Now, running <span class="inline-code" id="-400735760#z3b50uj_29">get_idf</span> will set up or refresh the esp-idf environment in any terminal session.</p><div class="image-container"><img class="center image" id="-400735760#z3b50uj_28" alt="get_idf output" title="get_idf output" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/development-environment/esp-idf-v5-4.jpg" width="500" height="525"></div></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-401349892">ESP-Matter Setup</h1><p id="-401349892#z9wiqc3_4">This section demonstrates how to set up the Espressif's SDK for Matter (<a href="#-1918844910#esp-idf-framework">&quot;ESP-IDF Framework&quot; in &quot;Espressif&quot;</a>) for building Matter applications on ESP32 SoCs.</p><p id="-401349892#z9wiqc3_5">This project uses Espressif's SDK for Matter v1.4 (<a href="https://github.com/espressif/esp-matter/tree/release/v1.4">https://github.com/espressif/esp-matter/tree/release/v1.4</a>), locked to commit 30af618 (<a href="https://github.com/espressif/esp-matter/commit/30af618a6e962623a0098ad6a33b468f33dc49c7">https://github.com/espressif/esp-matter/commit/30af618a6e962623a0098ad6a33b468f33dc49c7</a>).</p><p id="-401349892#z9wiqc3_6">Prerequisites:</p><ul class="list" id="-401349892#z9wiqc3_7" start="1"><li class="list-item" id="-401349892#z9wiqc3_17"><p id="-401349892#z9wiqc3_18">ESP-IDF (<a href="#-400735760">ESP-IDF Setup</a>) development environment is set up.</p></li></ul><section class="detached"><h2 id="-401349892#step-1-install-prerequisites" data-toc="step-1-install-prerequisites#ESP-Matter-Setup.md-step-1-install-prerequisites">Step 1: Install Prerequisites</h2><div class="detached code-block" id="-401349892#z9wiqc3_20"><pre><code class="language-bash">sudo apt-get install git gcc g++ pkg-config libssl-dev libdbus-1-dev \
 	libglib2.0-dev libavahi-client-dev ninja-build python3-venv python3-dev \
 	python3-pip unzip libgirepository1.0-dev libcairo2-dev libreadline-dev</code></pre></div><p id="-401349892#z9wiqc3_21">Refer to the Matter Build Guide (<a href="https://github.com/espressif/connectedhomeip/blob/v1.3-branch/docs/guides/BUILDING.md">https://github.com/espressif/connectedhomeip/blob/v1.3-branch/docs/guides/BUILDING.md</a>) for more details.</p></section><section class="detached"><h2 id="-401349892#step-2-clone-esp-matter-repository" data-toc="step-2-clone-esp-matter-repository#ESP-Matter-Setup.md-step-2-clone-esp-matter-repository">Step 2: Clone ESP-Matter Repository</h2><p id="-401349892#z9wiqc3_23">It includes esp-matter SDK and tools (e.g., CHIP-tool, CHIP-cert, ZAP).</p><div class="detached code-block" id="-401349892#z9wiqc3_24"><pre><code class="language-bash">cd ~/esp/
git clone -b release/v1.4 --recursive https://github.com/espressif/esp-matter.git esp-matter-1.4
cd esp-matter-1.4
git checkout 30af618a6e962623a0098ad6a33b468f33dc49c7</code></pre></div></section><section class="detached"><h2 id="-401349892#step-3-bootstrap-esp-matter" data-toc="step-3-bootstrap-esp-matter#ESP-Matter-Setup.md-step-3-bootstrap-esp-matter">Step 3: Bootstrap ESP-Matter</h2><div class="detached code-block" id="-401349892#z9wiqc3_25"><pre><code class="language-bash">get_idf
~/esp/esp-matter-1.4/install.sh</code></pre></div><div class="image-container"><img class="center image" id="-401349892#z9wiqc3_26" alt="Bootstrapping ESP-Matter" title="Bootstrapping ESP-Matter" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/accessory-devices/image14.png" width="500" height="614"></div></section><section class="detached"><h2 id="-401349892#step-4-create-get-matter-alias" data-toc="step-4-create-get-matter-alias#ESP-Matter-Setup.md-step-4-create-get-matter-alias">Step 4: Create get_matter Alias</h2><p id="-401349892#z9wiqc3_27">The script <span class="inline-code" id="-401349892#z9wiqc3_29">~/esp/esp-matter/export.sh</span> configures the environment. Create an alias for executing it by adding the following line to <span class="inline-code" id="-401349892#z9wiqc3_30">~/.bashrc</span> file:</p><div class="detached code-block" id="-401349892#z9wiqc3_28"><pre><code class="language-bash">alias get_matter='. $HOME/esp/esp-matter/export.sh'</code></pre></div></section><section class="detached"><h2 id="-401349892#step-5-refresh-configuration" data-toc="step-5-refresh-configuration#ESP-Matter-Setup.md-step-5-refresh-configuration">Step 5: Refresh Configuration</h2><p id="-401349892#z9wiqc3_31">Restart your terminal session or run:</p><div class="detached code-block" id="-401349892#z9wiqc3_32"><pre><code class="language-bash">source ~/.bashrc</code></pre></div><p id="-401349892#z9wiqc3_33">Now, running <span class="inline-code" id="-401349892#z9wiqc3_34">get_matter</span> will set up or refresh the ESP-Matter environment in any terminal session.</p></section><section class="detached"><h2 id="-401349892#references" data-toc="references#ESP-Matter-Setup.md-references">References</h2><ul class="list" id="-401349892#z9wiqc3_35" start="1"><li class="list-item" id="-401349892#z9wiqc3_36"><p id="-401349892#z9wiqc3_38">Connected Home over IP v1.3 (<a href="https://github.com/espressif/connectedhomeip/tree/v1.3-branch">https://github.com/espressif/connectedhomeip/tree/v1.3-branch</a>)</p></li><li class="list-item" id="-401349892#z9wiqc3_37"><p id="-401349892#z9wiqc3_40">Connected Home IP Documentation (<a href="https://project-chip.github.io/connectedhomeip-doc/index.html">https://project-chip.github.io/connectedhomeip-doc/index.html</a>)</p></li></ul></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-586960577">ESP32 Project Workflow</h1><p id="-586960577#z5jy4a8_4">This section describes the workflow for creating, building, and deploying a new project.</p><p id="-586960577#z5jy4a8_5">Prerequisites:</p><ul class="list" id="-586960577#z5jy4a8_6" start="1"><li class="list-item" id="-586960577#z5jy4a8_18"><p id="-586960577#z5jy4a8_22">ESP-IDF (<a href="#-400735760">ESP-IDF Setup</a>) development environment is set up.</p></li><li class="list-item" id="-586960577#z5jy4a8_19"><p id="-586960577#z5jy4a8_24">ESP-Matter (<a href="#-401349892">ESP-Matter Setup</a>) development environment is set up.</p></li><li class="list-item" id="-586960577#z5jy4a8_20"><p id="-586960577#z5jy4a8_26">ESP32 (<a href="#-1918844910#hardware">&quot;Hardware&quot; in &quot;Espressif&quot;</a>) development board is available.</p></li><li class="list-item" id="-586960577#z5jy4a8_21"><p id="-586960577#z5jy4a8_28">CLion 2024.3.3 or later is installed.</p></li></ul><section class="detached"><h2 id="-586960577#step-1-set-up-esp-idf-and-esp-matter-environment" data-toc="step-1-set-up-esp-idf-and-esp-matter-environment#ESP32-Project-Workflow.md-step-1-set-up-esp-idf-and-esp-matter-environment">Step 1: Set Up ESP-IDF and ESP-Matter Environment</h2><p id="-586960577#z5jy4a8_29">Run the aliases, created during the development setup, to initialise the ESP-IDF and ESP-Matter environments in the current terminal session:</p><div class="detached code-block" id="-586960577#z5jy4a8_30"><pre><code class="language-bash">get_idf
get_matter</code></pre></div></section><section class="detached"><h2 id="-586960577#step-2-create-a-new-project" data-toc="step-2-create-a-new-project#ESP32-Project-Workflow.md-step-2-create-a-new-project">Step 2: Create a New Project</h2><p id="-586960577#z5jy4a8_31">ESP-IDF provides the idf.py (<a href="https://docs.espressif.com/projects/esp-idf/en/v5.2.3/esp32/api-guides/tools/idf-py.html">https://docs.espressif.com/projects/esp-idf/en/v5.2.3/esp32/api-guides/tools/idf-py.html</a>) command-line tool as a front-end for managing project builds, deployment, debugging, and other tasks, simplifying the workflow significantly. It integrates several essential tools, including CMake for project configuration, Ninja for building, and esptool.py for flashing the target device.</p><div class="detached code-block" id="-586960577#z5jy4a8_32"><pre><code class="language-bash">idf.py create-project &lt;project name&gt;
cd &lt;project name&gt;</code></pre></div></section><section class="detached"><h2 id="-586960577#step-3-set-target-device" data-toc="step-3-set-target-device#ESP32-Project-Workflow.md-step-3-set-target-device">Step 3: Set Target Device</h2><p id="-586960577#z5jy4a8_34">The following command sets the target device:</p><div class="detached code-block" id="-586960577#z5jy4a8_35"><pre><code class="language-bash">idf.py set-target &lt;chip_name&gt;</code></pre></div><p id="-586960577#z5jy4a8_36">For example, to set the target device to ESP32-H2:</p><div class="detached code-block" id="-586960577#z5jy4a8_37"><pre><code class="language-bash">idf.py set-target esp32h2</code></pre></div><p id="-586960577#z5jy4a8_38">It creates a new <span class="inline-code" id="-586960577#z5jy4a8_39">sdkconfig</span> file in the root directory of the project. This configuration file can be modified via <span class="inline-code" id="-586960577#z5jy4a8_40">idf.py menuconfig</span>.</p></section><section class="detached"><h2 id="-586960577#step-4-open-the-project-in-clion-ide" data-toc="step-4-open-the-project-in-clion-ide#ESP32-Project-Workflow.md-step-4-open-the-project-in-clion-ide">Step 4: Open the Project in CLion IDE</h2><p id="-586960577#z5jy4a8_41">Create a toolchain named <span class="control" id="-586960577#z5jy4a8_48">ESP-IDF</span> with the environment file set to <span class="inline-code" id="-586960577#z5jy4a8_49">esp-idf/script.sh</span>:</p><div class="image-container"><img class="center image" id="-586960577#z5jy4a8_42" alt="Toolchain setup" title="Toolchain setup" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/accessory-devices/image10.png" width="500" height="375"></div><p id="-586960577#z5jy4a8_43">Set up a CMake profile with the following Matter environmental variables:</p><div class="detached code-block" id="-586960577#z5jy4a8_44"><pre><code class="language-bash">ESP_MATTER_PATH=~/esp/esp-matter-1.4;ZAP_INSTALL_PATH=~/esp/esp-matter-1.4/connectedhomeip/connectedhomeip/.environment/cipd/packages/zap</code></pre></div><div class="image-container"><img class="center image" id="-586960577#z5jy4a8_45" alt="CMake profile configuration" title="CMake profile configuration" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/accessory-devices/image26.png" width="500" height="369"></div><p id="-586960577#z5jy4a8_46">Structure of a new ESP-IDF project:</p><div class="image-container"><img class="center image" id="-586960577#z5jy4a8_47" alt="Structure of a new ESP-IDF project" title="Structure of a new ESP-IDF project" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/accessory-devices/image12.png" width="500" height="230"></div></section><section class="detached"><h2 id="-586960577#step-5-create-default-configuration" data-toc="step-5-create-default-configuration#ESP32-Project-Workflow.md-step-5-create-default-configuration">Step 5: Create Default Configuration</h2><div class="detached code-block" id="-586960577#z5jy4a8_50"><pre><code class="language-bash">touch sdkconfig.defaults</code></pre></div></section><section class="detached"><h2 id="-586960577#step-6-update-cmakelists-txt" data-toc="step-6-update-cmakelists-txt#ESP32-Project-Workflow.md-step-6-update-cmakelists-txt">Step 6: Update CMakeLists.txt</h2><p id="-586960577#z5jy4a8_51">Update the <span class="inline-code" id="-586960577#z5jy4a8_53">CMakeLists.txt</span> file to include the Matter SDK:</p><div class="detached code-block" id="-586960577#z5jy4a8_52"><pre><code class="language-cmake"># For more information about build system see
# https://docs.espressif.com/projects/esp-idf/en/latest/api-guides/build-system.html
# The following five lines of boilerplate have to be in your project's
# CMakeLists in this exact order for cmake to work correctly
cmake_minimum_required(VERSION 3.16)

# Set an error message if ESP_MATTER_PATH is not set
if(NOT DEFINED ENV{ESP_MATTER_PATH})
    message(FATAL_ERROR &quot;Please set ESP_MATTER_PATH to the path of esp-matter repo&quot;)
endif(NOT DEFINED ENV{ESP_MATTER_PATH})

# The set() commands should be placed after the cmake_minimum() line but before the include() line.
set(PROJECT_VER &quot;1.0&quot;)
set(PROJECT_VER_NUMBER 1)
set(ESP_MATTER_PATH $ENV{ESP_MATTER_PATH})
set(MATTER_SDK_PATH ${ESP_MATTER_PATH}/connectedhomeip/connectedhomeip)
set(ENV{PATH} &quot;$ENV{PATH}:${ESP_MATTER_PATH}/connectedhomeip/connectedhomeip/.environment/cipd/packages/pigweed&quot;)

# Pulls in the rest of the CMake functionality to configure the project, discover all the components, etc.
include($ENV{IDF_PATH}/tools/cmake/project.cmake)
# Include common component dependencies and configurations from ESP-Matter examples
include(${ESP_MATTER_PATH}/examples/common/cmake_common/components_include.cmake)

# Optional list of additional directories to search for components.
set(EXTRA_COMPONENT_DIRS
        &quot;${MATTER_SDK_PATH}/config/esp32/components&quot;
        &quot;${ESP_MATTER_PATH}/components&quot;
        ${extra_components_dirs_append})

# Declare the project
project(project-example)

# Set the C++ standard to C++17
idf_build_set_property(CXX_COMPILE_OPTIONS &quot;-std=gnu++17;-Os;-DCHIP_HAVE_CONFIG_H;-Wno-overloaded-virtual&quot; APPEND)
idf_build_set_property(C_COMPILE_OPTIONS &quot;-Os&quot; APPEND)
# For RISCV chips, project_include.cmake sets -Wno-format, but does not clear various
# flags that depend on -Wformat
idf_build_set_property(COMPILE_OPTIONS &quot;-Wno-format-nonliteral;-Wno-format-security&quot; APPEND)
# Enable colored output in ninja builds
add_compile_options(-fdiagnostics-color=always -Wno-write-strings)</code></pre></div></section><section class="detached"><h2 id="-586960577#step-7-build-the-project" data-toc="step-7-build-the-project#ESP32-Project-Workflow.md-step-7-build-the-project">Step 7: Build the Project</h2><div class="detached code-block" id="-586960577#z5jy4a8_54"><pre><code class="language-bash">idf.py build</code></pre></div></section><section class="detached"><h2 id="-586960577#step-8-determine-serial-port" data-toc="step-8-determine-serial-port#ESP32-Project-Workflow.md-step-8-determine-serial-port">Step 8: Determine Serial Port</h2><p id="-586960577#z5jy4a8_55">Connect the ESP32 board to the computer and check under which serial port the board is visible. Serial ports have the following naming patterns: <span class="inline-code" id="-586960577#z5jy4a8_56">/dev/tty</span>.</p></section><section class="detached"><h2 id="-586960577#step-9-flash-project-to-target" data-toc="step-9-flash-project-to-target#ESP32-Project-Workflow.md-step-9-flash-project-to-target">Step 9: Flash Project to Target</h2><div class="detached code-block" id="-586960577#z5jy4a8_57"><pre><code class="language-bash">idf.py -p &lt;PORT&gt; flash</code></pre></div></section><section class="detached"><h2 id="-586960577#step-10-launch-idf-monitor" data-toc="step-10-launch-idf-monitor#ESP32-Project-Workflow.md-step-10-launch-idf-monitor">Step 10: Launch IDF Monitor</h2><p id="-586960577#z5jy4a8_58">Use the monitor application and exit using <span class="inline-code" id="-586960577#z5jy4a8_60">CTRL+]</span>:</p><div class="detached code-block" id="-586960577#z5jy4a8_59"><pre><code class="language-bash">idf.py -p &lt;PORT&gt; monitor</code></pre></div></section><section class="detached"><h2 id="-586960577#references" data-toc="references#ESP32-Project-Workflow.md-references">References</h2><p id="-586960577#z5jy4a8_61">IDF Frontend - idf.py (<a href="https://docs.espressif.com/projects/esp-idf/en/stable/esp32h2/api-guides/tools/idf-py.html">https://docs.espressif.com/projects/esp-idf/en/stable/esp32h2/api-guides/tools/idf-py.html</a>)</p></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-1412866926">ESP OpenThread CLI</h1><p id="-1412866926#wsejgd_4">This section describes how to build and run the OpenThread CLI (<a href="#-1790576086#openthread-cli">&quot;OpenThread CLI&quot; in &quot;Thread&quot;</a>) example project from the ESP-IDF (<a href="#-1918844910#esp-idf-framework">&quot;ESP-IDF Framework&quot; in &quot;Espressif&quot;</a>). It can be used to test and debug the OpenThread stack on ESP32 series SoCs (<a href="#-1918844910#hardware">&quot;Hardware&quot; in &quot;Espressif&quot;</a>).</p><p id="-1412866926#wsejgd_5">Prerequisites:</p><ul class="list" id="-1412866926#wsejgd_6" start="1"><li class="list-item" id="-1412866926#wsejgd_13"><p id="-1412866926#wsejgd_15">ESP-IDF development environment (<a href="#-400735760">ESP-IDF Setup</a>) is set up.</p></li><li class="list-item" id="-1412866926#wsejgd_14"><p id="-1412866926#wsejgd_17">ESP32 series development board is available. This example is tested on ESP32-H2-DevKitM-1 (<a href="https://docs.espressif.com/projects/esp-dev-kits/en/latest/esp32h2/esp32-h2-devkitm-1/index.html">https://docs.espressif.com/projects/esp-dev-kits/en/latest/esp32h2/esp32-h2-devkitm-1/index.html</a>).</p></li></ul><section class="detached"><h2 id="-1412866926#build-and-run" data-toc="build-and-run#ESP-OpenThread-CLI.md-build-and-run">Build and Run</h2><section class="detached"><h3 id="-1412866926#step-1-prepare-the-environment" data-toc="step-1-prepare-the-environment#ESP-OpenThread-CLI.md-step-1-prepare-the-environment">Step 1: Prepare the Environment</h3><div class="detached code-block" id="-1412866926#wsejgd_24"><pre><code class="language-bash">get_idf
cd $IDF_PATH/examples/openthread/ot_cli</code></pre></div></section><section class="detached"><h3 id="-1412866926#step-2-set-target" data-toc="step-2-set-target#ESP-OpenThread-CLI.md-step-2-set-target">Step 2: Set target</h3><p id="-1412866926#wsejgd_25">The following command sets the target device to ESP32-H2:</p><div class="detached code-block" id="-1412866926#wsejgd_26"><pre><code class="language-bash">idf.py set-target esp32h2</code></pre></div></section><section class="detached"><h3 id="-1412866926#step-3-optional-configure-device" data-toc="step-3-optional-configure-device#ESP-OpenThread-CLI.md-step-3-optional-configure-device">Step 3 (Optional): Configure Device</h3><p id="-1412866926#wsejgd_27">The example can run with the default configuration. <span class="inline-code" id="-1412866926#wsejgd_29">idf.py menuconfig</span> can be used for customized settings:</p><ul class="list" id="-1412866926#wsejgd_28" start="1"><li class="list-item" id="-1412866926#wsejgd_30"><p id="-1412866926#wsejgd_31">Enabling Joiner Role: <span class="inline-code" id="-1412866926#wsejgd_32">Component Config &rarr; OpenThread &rarr; Thread Core Features &rarr; Enable Joiner</span></p></li></ul></section><section class="detached"><h3 id="-1412866926#step-4-connect-to-computer" data-toc="step-4-connect-to-computer#ESP-OpenThread-CLI.md-step-4-connect-to-computer">Step 4: Connect to Computer</h3><p id="-1412866926#wsejgd_33">Connect the ESP32-H2-DevKitM-1 to the computer using a USB cable.</p></section><section class="detached"><h3 id="-1412866926#step-5-build-and-flash" data-toc="step-5-build-and-flash#ESP-OpenThread-CLI.md-step-5-build-and-flash">Step 5: Build and Flash</h3><div class="detached code-block" id="-1412866926#wsejgd_34"><pre><code class="language-bash">idf.py build
idf.py -p &lt;PORT_TO_ESP32_H2&gt; flash monitor</code></pre></div></section></section><section class="detached"><h2 id="-1412866926#usage" data-toc="usage#ESP-OpenThread-CLI.md-usage">Usage</h2><section class="detached"><h3 id="-1412866926#joining-thread-network" data-toc="joining-thread-network#ESP-OpenThread-CLI.md-joining-thread-network">Joining Thread Network</h3><p id="-1412866926#wsejgd_40">A Thread device can join the network using either a minimal dataset (providing only the Network Key) or a complete Active Operational Dataset.</p><p id="-1412866926#wsejgd_41"><span class="control" id="-1412866926#wsejgd_49">Example 1: Joining with Minimal Provisioning (Network Key Only)</span></p><p id="-1412866926#wsejgd_42">The device is initially provisioned with only the Network Key. After joining, the device synchronizes with the network and automatically receives the complete Active Operational Dataset.</p><div class="detached code-block" id="-1412866926#wsejgd_43"><pre><code class="language-bash">dataset networkkey 00112233445566778899aabbccddeeff
dataset commit active
ifconfig up
thread start</code></pre></div><p id="-1412866926#wsejgd_44">Display the full Active Operational Dataset:</p><div class="detached code-block" id="-1412866926#wsejgd_45"><pre><code class="language-bash">dataset active</code></pre></div><p id="-1412866926#wsejgd_46"><span class="control" id="-1412866926#wsejgd_50">Example 2: Joining with the Full Active Operational Dataset</span></p><p id="-1412866926#wsejgd_47">In this method, all network parameters (such as PAN ID, channel, Mesh-Local Prefix, etc.) are provisioned upfront. The device is configured with the complete dataset before starting the Thread interface.</p><div class="detached code-block" id="-1412866926#wsejgd_48"><pre><code class="language-bash">dataset set active 0e080000000000010000000300001835060004001fffe00208fe7bb701f5f1125d0708fd75cbde7c6647bd0510b3914792d44f45b6c7d76eb9306eec94030f4f70656e5468726561642d35383332010258320410e35c581af5029b054fc904a24c2b27700c0402a0fff8
ifconfig up
thread start</code></pre></div></section><section class="detached"><h3 id="-1412866926#commissioning" data-toc="commissioning#ESP-OpenThread-CLI.md-commissioning">Commissioning</h3><p id="-1412866926#wsejgd_51"><span class="control" id="-1412866926#wsejgd_56">Joiner device</span>:</p><ul class="list" id="-1412866926#wsejgd_52" start="1"><li class="list-item" id="-1412866926#wsejgd_57"><p id="-1412866926#wsejgd_59">Get the factory-assigned IEEE EUI-64 address (e.g., <span class="inline-code" id="-1412866926#wsejgd_61">744dbdfffe63f5c8</span>).</p><div class="detached code-block" id="-1412866926#wsejgd_60"><pre><code class="language-bash">eui64</code></pre></div></li><li class="list-item" id="-1412866926#wsejgd_58"><p id="-1412866926#wsejgd_62">Bring the IPv6 interface up, enable the Thread Joiner role, and start the Thread protocol:</p><div class="detached code-block" id="-1412866926#wsejgd_63"><pre><code class="language-bash">ifconfig up
joiner start J00MMM
thread start</code></pre></div></li></ul><p id="-1412866926#wsejgd_53"><span class="control" id="-1412866926#wsejgd_64">Commissioner device</span>:</p><ul class="list" id="-1412866926#wsejgd_54" start="1"><li class="list-item" id="-1412866926#wsejgd_65"><p id="-1412866926#wsejgd_68">Start the Commissioner role:</p><div class="detached code-block" id="-1412866926#wsejgd_69"><pre><code class="language-bash">commissioner start</code></pre></div></li><li class="list-item" id="-1412866926#wsejgd_66"><p id="-1412866926#wsejgd_70">Add a joiner entry:</p><div class="detached code-block" id="-1412866926#wsejgd_71"><pre><code class="language-bash">commissioner joiner add &lt;eui64|discerner&gt; &lt;pksd&gt;</code></pre></div><p id="-1412866926#wsejgd_72">Example:</p><div class="detached code-block" id="-1412866926#wsejgd_73"><pre><code class="language-bash">commissioner joiner add 744dbdfffe63f5c8 J00MMM or commissioner joiner add * J00MMM</code></pre></div></li><li class="list-item" id="-1412866926#wsejgd_67"><p id="-1412866926#wsejgd_74">Display all Joiner entries in table format:</p><div class="detached code-block" id="-1412866926#wsejgd_75"><pre><code class="language-bash">commissioner joiner table</code></pre></div></li></ul><p id="-1412866926#wsejgd_55">The Joiner device receives the Network Key when joining the network.</p></section><section class="detached"><h3 id="-1412866926#retrieving-information" data-toc="retrieving-information#ESP-OpenThread-CLI.md-retrieving-information">Retrieving Information</h3><p id="-1412866926#wsejgd_76">The command <span class="inline-code" id="-1412866926#wsejgd_79">router table</span> prints a list of routers in a table format. Each router is identified by its Extended MAC.</p><p id="-1412866926#wsejgd_77">The command <span class="inline-code" id="-1412866926#wsejgd_80">extaddr</span> returns the Extended MAC address of a device.</p><p id="-1412866926#wsejgd_78">The <span class="inline-code" id="-1412866926#wsejgd_81">joiner id</span> command returns the Joiner ID used for commissioning.</p></section><section class="detached"><h3 id="-1412866926#sending-udp-packets" data-toc="sending-udp-packets#ESP-OpenThread-CLI.md-sending-udp-packets">Sending UDP packets</h3><p id="-1412866926#wsejgd_82">Running UDP Server:</p><div class="detached code-block" id="-1412866926#wsejgd_83"><pre><code class="language-bash">udpsockserver open
udpsockserver bind 12345
udpsockserver status</code></pre></div><p id="-1412866926#wsejgd_84">Sending a UDP packet and closing the server:</p><div class="detached code-block" id="-1412866926#wsejgd_85"><pre><code class="language-bash">udpsockserver send fdf9:2548:ce39:efbb:9612:c4a0:477b:349a 12346 hello
udpsockserver close</code></pre></div><p id="-1412866926#wsejgd_86">Running UDP Client:</p><div class="detached code-block" id="-1412866926#wsejgd_87"><pre><code class="language-bash">udpsockclient open # or udpsockclient open &lt;port&gt;, e.g., udpsockclient open 12345
udpsockclient status</code></pre></div><p id="-1412866926#wsejgd_88">Sending a UDP packet and closing the client:</p><div class="detached code-block" id="-1412866926#wsejgd_89"><pre><code class="language-bash">udpsockclient send fdf9:2548:ce39:efbb:79b9:4ac4:f686:8fc9 12346 hello
udpsockclient close</code></pre></div></section><section class="detached"><h3 id="-1412866926#scanning-and-discovering" data-toc="scanning-and-discovering#ESP-OpenThread-CLI.md-scanning-and-discovering">Scanning and Discovering</h3><p id="-1412866926#wsejgd_90">The <span class="inline-code" id="-1412866926#wsejgd_93">scan</span> command performs IEEE 802.15.4 scan to find nearby devices. The <span class="inline-code" id="-1412866926#wsejgd_94">discover</span> command performs an MLE Discovery operation to find Thread networks nearby.</p><div class="image-container"><img class="center image" id="-1412866926#wsejgd_91" alt="Thread Discover" title="Thread Discover" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/orchestrator-devices/thc_1.png" width="500" height="179"></div><div class="image-container"><img class="center image" id="-1412866926#wsejgd_92" alt="Thread Scan" title="Thread Scan" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/orchestrator-devices/thc_2.png" width="500" height="130"></div></section></section><section class="detached"><h2 id="-1412866926#references" data-toc="references#ESP-OpenThread-CLI.md-references">References</h2><ul class="list" id="-1412866926#wsejgd_95" start="1"><li class="list-item" id="-1412866926#wsejgd_98"><p id="-1412866926#wsejgd_106">OpenThread CLI Command Reference (<a href="https://openthread.io/reference/cli/commands">https://openthread.io/reference/cli/commands</a>)</p></li><li class="list-item" id="-1412866926#wsejgd_99"><p id="-1412866926#wsejgd_108">Forming a Thread network on the Thread Border Router (<a href="https://openthread.io/codelabs/esp-openthread-hardware#3">https://openthread.io/codelabs/esp-openthread-hardware#3</a>)</p></li><li class="list-item" id="-1412866926#wsejgd_100"><p id="-1412866926#wsejgd_110">How to set up a Command Line Interface on a thread device (<a href="https://mattercoder.com/codelabs/how-to-install-border-router-on-esp32/?index=..%2F..index#5">https://mattercoder.com/codelabs/how-to-install-border-router-on-esp32/?index=..%2F..index#5</a>)</p></li><li class="list-item" id="-1412866926#wsejgd_101"><p id="-1412866926#wsejgd_112">OpenThread CLI - Commissioning (<a href="https://github.com/openthread/ot-commissioner/tree/main/src/app/cli">https://github.com/openthread/ot-commissioner/tree/main/src/app/cli</a>)</p></li><li class="list-item" id="-1412866926#wsejgd_102"><p id="-1412866926#wsejgd_114">OpenThread CLI - Operational Datasets (<a href="https://github.com/openthread/openthread/blob/main/src/cli/README_DATASET.md">https://github.com/openthread/openthread/blob/main/src/cli/README_DATASET.md</a>)</p></li><li class="list-item" id="-1412866926#wsejgd_103"><p id="-1412866926#wsejgd_116">ESP OT-CLI Example (<a href="https://github.com/espressif/esp-idf/tree/master/examples/openthread/ot_cli">https://github.com/espressif/esp-idf/tree/master/examples/openthread/ot_cli</a>)</p></li><li class="list-item" id="-1412866926#wsejgd_104"><p id="-1412866926#wsejgd_118">Build and Run CLI device (<a href="https://docs.espressif.com/projects/esp-thread-br/en/latest/dev-guide/build_and_run.html#build-and-run-the-thread-cli-device">https://docs.espressif.com/projects/esp-thread-br/en/latest/dev-guide/build_and_run.html#build-and-run-the-thread-cli-device</a>)</p></li><li class="list-item" id="-1412866926#wsejgd_105"><p id="-1412866926#wsejgd_120">Set Up Service Registration Protocol (SRP) Server-Client Connectivity With OT CLI (<a href="https://openthread.io/reference/cli/concepts/srp">https://openthread.io/reference/cli/concepts/srp</a>)</p></li></ul><p id="-1412866926#wsejgd_96">ESP Thread Sniffer:</p><ul class="list" id="-1412866926#wsejgd_97" start="1"><li class="list-item" id="-1412866926#wsejgd_122"><p id="-1412866926#wsejgd_125">https://docs.espressif.com/projects/esp-zigbee-sdk/en/latest/esp32h2/developing.html#sniffer-and-wireshark</p></li><li class="list-item" id="-1412866926#wsejgd_123"><p id="-1412866926#wsejgd_126">https://openthread.io/guides/pyspinel/sniffer</p></li><li class="list-item" id="-1412866926#wsejgd_124"><p id="-1412866926#wsejgd_127">https://github.com/espressif/esp-idf/blob/master/examples/openthread/ot_rcp/README.md</p></li></ul></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="1955462060">Thread Border Routers</h1><section class="detached"><h2 id="1955462060#overview" data-toc="overview#Thread-Border-Routers.md-overview">Overview</h2><p id="1955462060#syor4f_5">Thread Border Routers (<a href="#-1790576086#border-router">&quot;Border Router&quot; in &quot;Thread&quot;</a>) provide IP connectivity between the Thread Network of accessory devices (<a href="#-1685420830">Accessory Devices</a>) and adjacent external W-Fi network, such as a home LAN, building network, or the broader Internet.</p><p id="1955462060#syor4f_6">This section walks through how to set up and run ESP Basic Thread Border Router (<a href="#-1231632047">ESP Basic Thread Border Router</a>) and ESP Matter Thread Border Router (<a href="#-497258712">ESP Matter Thread Border Router</a>) examples on the ESP Thread Border Router (<a href="#-1918844910#esp-thread-border-router-solution">&quot;ESP Thread Border Router Solution&quot; in &quot;Espressif&quot;</a>) board.</p></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-1231632047">ESP Basic Thread Border Router</h1><section class="detached"><h2 id="-1231632047#overview" data-toc="overview#ESP-Basic-Thread-Border-Router.md-overview">Overview</h2><p id="-1231632047#-vz3voi_9">The <span class="inline-code" id="-1231632047#-vz3voi_11">ESP Basic Thread Border Router</span> example from ESP_IDF (<a href="#-1918844910#esp-idf-framework">&quot;ESP-IDF Framework&quot; in &quot;Espressif&quot;</a>) demonstrates how to build firmware for a basic Thread Border Router device running on Espressif's hardware.</p><p id="-1231632047#-vz3voi_10">The firmware configures the OpenThread platform using default radio, host, and port settings. Optionally, it enables external coexistence and sets up mDNS (with the hostname &quot;esp-ot-br&quot;), along with OTA and web server support if enabled. Finally, it launches the Border Router.</p></section><section class="detached"><h2 id="-1231632047#build-and-run" data-toc="build-and-run#ESP-Basic-Thread-Border-Router.md-build-and-run">Build and Run</h2><p id="-1231632047#-vz3voi_13">This section demonstrates how to build and run the <span class="control" id="-1231632047#-vz3voi_22">ESP Basic Thread Border Router</span> example.</p><p id="-1231632047#-vz3voi_14">Prerequisites:</p><ul class="list" id="-1231632047#-vz3voi_15" start="1"><li class="list-item" id="-1231632047#-vz3voi_23"><p id="-1231632047#-vz3voi_25">ESP-IDF development environment (<a href="#-400735760">ESP-IDF Setup</a>) is set up.</p></li><li class="list-item" id="-1231632047#-vz3voi_24"><p id="-1231632047#-vz3voi_27">ESP THREAD BR-ZIGBEE GW (<a href="#-1790576086#border-router">&quot;Border Router&quot; in &quot;Thread&quot;</a>) board</p></li></ul><div class="image-container"><img class="center image" id="-1231632047#-vz3voi_16" alt="ESP Thread Border Router/Zigbee Gateway" title="ESP Thread Border Router/Zigbee Gateway" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/orchestrator-devices/esp-thread-border-router.jpg" width="500" height="282"></div><section class="detached"><h3 id="-1231632047#step-1-build-the-rcp-image" data-toc="step-1-build-the-rcp-image#ESP-Basic-Thread-Border-Router.md-step-1-build-the-rcp-image">Step 1: Build the RCP Image</h3><div class="detached code-block" id="-1231632047#-vz3voi_29"><pre><code class="language-bash">get_idf
cd $IDF_PATH/examples/openthread/ot_rcp/
idf.py set-target esp32h2   # Select the ESP32-H2. Skipping this step would result in a build error.
idf.py build</code></pre></div><p id="-1231632047#-vz3voi_30">The firmware does not need to be manually flashed onto the device. It will be integrated into the Border Router firmware and automatically installed onto the ESP32-H2 chip during the first boot-up. <span class="inline-code" id="-1231632047#-vz3voi_31">idf.py menuconfig</span> can be used for customized settings.</p></section><section class="detached"><h3 id="-1231632047#step-2-clone-espressif-thread-border-router-sdk" data-toc="step-2-clone-espressif-thread-border-router-sdk#ESP-Basic-Thread-Border-Router.md-step-2-clone-espressif-thread-border-router-sdk">Step 2: Clone Espressif Thread Border Router SDK</h3><p id="-1231632047#-vz3voi_32">This project uses Espressif Thread Border Router SDK locked to commit cf3a09f (<a href="https://github.com/espressif/esp-thread-br/commit/cf3a09f5f44991a4e65b2d1c5113637e1d086b68">https://github.com/espressif/esp-thread-br/commit/cf3a09f5f44991a4e65b2d1c5113637e1d086b68</a>).</p><div class="detached code-block" id="-1231632047#-vz3voi_33"><pre><code class="language-bash">cd ~/esp
git clone --recursive https://github.com/espressif/esp-thread-br.git
cd ~/esp/esp-thread-br/
git checkout cf3a09f5f44991a4e65b2d1c5113637e1d086b68
cd ~/esp/esp-thread-br/examples/basic_thread_border_router</code></pre></div></section><section class="detached"><h3 id="-1231632047#step-3-configure-the-device-optional" data-toc="step-3-configure-the-device-optional#ESP-Basic-Thread-Border-Router.md-step-3-configure-the-device-optional">Step 3: Configure the Device (Optional)</h3><p id="-1231632047#-vz3voi_35">This section describes how to configure the device using <span class="inline-code" id="-1231632047#-vz3voi_46">idf.py menuconfig</span>. This step is <span class="emphasis" id="-1231632047#-vz3voi_47">optional</span> because the device can be configured using the OpenThread CLI (<a href="#-1790576086#openthread-cli">&quot;OpenThread CLI&quot; in &quot;Thread&quot;</a>) after flashing the firmware.</p><p id="-1231632047#-vz3voi_36">The default configuration in <span class="inline-code" id="-1231632047#-vz3voi_49">sdkconfig.default</span> file is designed to work out of the box on the ESP Thread Border Router board with ESP32-S3 as the default SoC target. For other SoCs, the target must be configured using <span class="inline-code" id="-1231632047#-vz3voi_50">idf.py set-target &lt;chip_name&gt;</span>.</p><p id="-1231632047#-vz3voi_37">The command below opens the configuration menu:</p><div class="detached code-block" id="-1231632047#-vz3voi_38"><pre><code class="language-bash">idf.py menuconfig</code></pre></div><p id="-1231632047#-vz3voi_39">Enable <span class="control" id="-1231632047#-vz3voi_51">automatic start mode</span> and the <span class="control" id="-1231632047#-vz3voi_52">Web GUI</span>:</p><ul class="list" id="-1231632047#-vz3voi_40" start="1"><li class="list-item" id="-1231632047#-vz3voi_53"><p id="-1231632047#-vz3voi_54"><span class="inline-code" id="-1231632047#-vz3voi_55">ESP Thread Border Router Example &rarr; Enable the automatic start mode in Thread Border</span></p></li></ul><p id="-1231632047#-vz3voi_41">In <span class="control" id="-1231632047#-vz3voi_56">automatic start mode</span>, the device first attempts to use the Wi-Fi SSID and password stored in <span class="control" id="-1231632047#-vz3voi_57">NVS</span> ( Non-Volatile Storage). If no Wi-Fi credentials are found in NVS, it uses <span class="control" id="-1231632047#-vz3voi_58">EXAMPLE_WIFI_SSID</span> and <span class="control" id="-1231632047#-vz3voi_59">EXAMPLE_WIFI_PASSWORD</span>, retrieved from the following configuration options:</p><ul class="list" id="-1231632047#-vz3voi_42" start="1"><li class="list-item" id="-1231632047#-vz3voi_60"><p id="-1231632047#-vz3voi_62"><span class="inline-code" id="-1231632047#-vz3voi_63">Example Connection Configuration &rarr; WiFi SSID</span></p></li><li class="list-item" id="-1231632047#-vz3voi_61"><p id="-1231632047#-vz3voi_64"><span class="inline-code" id="-1231632047#-vz3voi_65">Example Connection Configuration &rarr; WiFi Password</span></p></li></ul><p id="-1231632047#-vz3voi_43">Additionally, <span class="control" id="-1231632047#-vz3voi_66">Thread dataset</span> can be configured:</p><p id="-1231632047#-vz3voi_44"><span class="inline-code" id="-1231632047#-vz3voi_67">Component config &rarr; OpenThread &rarr; Thread Core Features &rarr; Thread Operational Dataset</span></p><div class="image-container"><img class="center image" id="-1231632047#-vz3voi_45" alt="Thread Border Router Dataset" title="Thread Border Router Dataset" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/orchestrator-devices/esp-thread-border-router-dataset.png" width="400" height="226"></div></section><section class="detached"><h3 id="-1231632047#step-4-connect-the-esp-thread-border-router-board" data-toc="step-4-connect-the-esp-thread-border-router-board#ESP-Basic-Thread-Border-Router.md-step-4-connect-the-esp-thread-border-router-board">Step 4: Connect the ESP Thread Border Router Board</h3><p id="-1231632047#-vz3voi_68">Use <span class="control" id="-1231632047#-vz3voi_69">USB2 (ESP32-S3)</span> on the ESP Thread Border Router Board to connect the board to the computer. Only the ESP32-S3 ( main SoC) port needs to be connected. The main SoC automatically programs the Thread co-processor.</p></section><section class="detached"><h3 id="-1231632047#step-5-build-and-flash" data-toc="step-5-build-and-flash#ESP-Basic-Thread-Border-Router.md-step-5-build-and-flash">Step 5: Build and Flash</h3><div class="detached code-block" id="-1231632047#-vz3voi_70"><pre><code class="language-bash">idf.py build 
idf.py -p &lt;PORT&gt; flash monitor</code></pre></div></section></section><section class="detached"><h2 id="-1231632047#openthread-cli" data-toc="openthread-cli#ESP-Basic-Thread-Border-Router.md-openthread-cli">OpenThread CLI</h2><p id="-1231632047#-vz3voi_71">This section demonstrates how to use the OpenThread CLI (<a href="#-1790576086#openthread-cli">&quot;OpenThread CLI&quot; in &quot;Thread&quot;</a>) on the ESP Thread Border Router.</p><p id="-1231632047#-vz3voi_72">OpenThread CLI is enabled in the ESP OpenThread component (<a href="https://github.com/espressif/esp-idf/blob/master/components/openthread/Kconfig">https://github.com/espressif/esp-idf/blob/master/components/openthread/Kconfig</a>) by default. It can also be enabled/disabled using the <span class="inline-code" id="-1231632047#-vz3voi_82">idf.py menuconfig</span> command:</p><ul class="list" id="-1231632047#-vz3voi_73" start="1"><li class="list-item" id="-1231632047#-vz3voi_83"><p id="-1231632047#-vz3voi_84"><span class="inline-code" id="-1231632047#-vz3voi_85">Component config &rarr; OpenThread &rarr; Thread Console &rarr; Enable OpenThread Command-Line Interface</span></p></li></ul><p id="-1231632047#-vz3voi_74">The <span class="inline-code" id="-1231632047#-vz3voi_86">ESP Thread Border Router</span> project extends the standard <span class="inline-code" id="-1231632047#-vz3voi_87">OpenThread CLI</span> by including the OpenThread Extension Commands (<a href="https://github.com/espressif/esp-thread-br/tree/main/components/esp_ot_cli_extension#wifi">https://github.com/espressif/esp-thread-br/tree/main/components/esp_ot_cli_extension#wifi</a>) component with additional commands demonstrated below, such as Wi-Fi management and IP address printing.</p><section class="detached"><h3 id="-1231632047#wi-fi-management" data-toc="wi-fi-management#ESP-Basic-Thread-Border-Router.md-wi-fi-management">Wi-Fi Management</h3><p id="-1231632047#-vz3voi_89">Connect the ESP Thread Border Router to a Wi-Fi network:</p><div class="detached code-block" id="-1231632047#-vz3voi_90"><pre><code class="language-bash">wifi connect -s &lt;SSID&gt; -p &lt;PASSWORD&gt;</code></pre></div><p id="-1231632047#-vz3voi_91">Disconnect the ESP Thread Border Router from the Wi-Fi network:</p><div class="detached code-block" id="-1231632047#-vz3voi_92"><pre><code class="language-bash">wifi disconnect</code></pre></div><p id="-1231632047#-vz3voi_93">Print the current Wi-Fi network state:</p><div class="detached code-block" id="-1231632047#-vz3voi_94"><pre><code class="language-bash">wifi state</code></pre></div></section><section class="detached"><h3 id="-1231632047#ip-addresses-and-network-interfaces" data-toc="ip-addresses-and-network-interfaces#ESP-Basic-Thread-Border-Router.md-ip-addresses-and-network-interfaces">IP Addresses and Network Interfaces</h3><p id="-1231632047#-vz3voi_95">Print all the IP address on each interface of lwIP of the Thread Border Router:</p><div class="detached code-block" id="-1231632047#-vz3voi_96"><pre><code class="language-bash">ip print</code></pre></div><div class="image-container"><img class="center image" id="-1231632047#-vz3voi_97" alt="Print IPs" title="Print IPs" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/orchestrator-devices/tbr_1.png" width="400" height="307"></div><p id="-1231632047#-vz3voi_98">The output lists network interfaces (netif):</p><ul class="list" id="-1231632047#-vz3voi_99" start="1"><li class="list-item" id="-1231632047#-vz3voi_103"><p id="-1231632047#-vz3voi_107"><span class="control" id="-1231632047#-vz3voi_108">nt</span></p></li><li class="list-item" id="-1231632047#-vz3voi_104"><p id="-1231632047#-vz3voi_109"><span class="control" id="-1231632047#-vz3voi_110">ot</span> (OpenThread Network Interface (<a href="https://github.com/espressif/esp-idf/blob/release/v5.3/components/openthread/src/esp_openthread_lwip_netif.c#L136">https://github.com/espressif/esp-idf/blob/release/v5.3/components/openthread/src/esp_openthread_lwip_netif.c#L136</a>)),</p></li><li class="list-item" id="-1231632047#-vz3voi_105"><p id="-1231632047#-vz3voi_112"><span class="control" id="-1231632047#-vz3voi_113">st</span> (Wi-Fi Station (STA) interface (<a href="https://github.com/espressif/esp-idf/blob/release/v5.3/components/esp_netif/lwip/netif/wlanif.c#L223">https://github.com/espressif/esp-idf/blob/release/v5.3/components/esp_netif/lwip/netif/wlanif.c#L223</a>)), this includes the <span class="control" id="-1231632047#-vz3voi_115">Global Unicast Address</span> (<span class="control" id="-1231632047#-vz3voi_116">GUA</span>), which falls within the 2000::/3 range (starts with 2xxx, 3xxx). This address is globally routable and can be used for external access if the Wi-Fi router&rsquo;s firewall allows incoming connections to this address.</p></li><li class="list-item" id="-1231632047#-vz3voi_106"><p id="-1231632047#-vz3voi_117"><span class="control" id="-1231632047#-vz3voi_118">lo</span> (Loopback interface (<a href="https://github.com/espressif/esp-lwip/blob/2.1.3-esp/src/core/netif.c#L151">https://github.com/espressif/esp-lwip/blob/2.1.3-esp/src/core/netif.c#L151</a>)).</p></li></ul><p id="-1231632047#-vz3voi_100">If the Thread Border Router is connected to a Wi-Fi network, we can ping it from another device. The following commands should be run on a Linux machine to find the name of the Wi-Fi network interfaces and then use it to ping the Thread Border Router:</p><div class="detached code-block" id="-1231632047#-vz3voi_101"><pre><code class="language-bash">ip addr
ping6 -I &lt;INTERFACE&gt; &lt;DEVICE_IP&gt;
ping6 -I wlo1 fe80::aaaa:0000:0000:0000
ping6 -I wlo1 2604::aaaa:0000:0000:0000</code></pre></div><div class="image-container"><img class="center image" id="-1231632047#-vz3voi_102" alt="Ping" title="Ping" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/orchestrator-devices/tbr_2.png" width="400" height="147"></div></section><section class="detached"><h3 id="-1231632047#forming-thread-network" data-toc="forming-thread-network#ESP-Basic-Thread-Border-Router.md-forming-thread-network">Forming Thread network</h3><p id="-1231632047#-vz3voi_120">The following commands form a Thread network (<a href="#-1790576086#network">&quot;Network&quot; in &quot;Thread&quot;</a>):</p><ol class="list list-decimal" id="-1231632047#-vz3voi_121" type="1" start="1"><li class="list-item" id="-1231632047#-vz3voi_123"><p id="-1231632047#-vz3voi_129"><span class="emphasis" id="-1231632047#-vz3voi_131">Optional</span>. Delete any previous settings stored on non-volatile memory, and then trigger a platform reset:</p><div class="detached code-block" id="-1231632047#-vz3voi_130"><pre><code class="language-bash">factoryreset</code></pre></div></li><li class="list-item" id="-1231632047#-vz3voi_124"><p id="-1231632047#-vz3voi_132">Initialize a new dataset:</p><div class="detached code-block" id="-1231632047#-vz3voi_133"><pre><code class="language-bash">dataset init new</code></pre></div></li><li class="list-item" id="-1231632047#-vz3voi_125"><p id="-1231632047#-vz3voi_134">Commit the new Operational Dataset buffer to Active Operational Dataset:</p><div class="detached code-block" id="-1231632047#-vz3voi_135"><pre><code class="language-bash">dataset commit active</code></pre></div></li><li class="list-item" id="-1231632047#-vz3voi_126"><p id="-1231632047#-vz3voi_136">Enable IPv6 communication:</p><div class="detached code-block" id="-1231632047#-vz3voi_137"><pre><code class="language-bash">ifconfig up</code></pre></div></li><li class="list-item" id="-1231632047#-vz3voi_127"><p id="-1231632047#-vz3voi_138">Enable Thread interface</p><div class="detached code-block" id="-1231632047#-vz3voi_139"><pre><code class="language-bash">thread start</code></pre></div></li><li class="list-item" id="-1231632047#-vz3voi_128"><p id="-1231632047#-vz3voi_140">Show the Active Operational Dataset. The optional <span class="inline-code" id="-1231632047#-vz3voi_145">-x</span> argument prints it as hex-encoded TLVs:</p><div class="detached code-block" id="-1231632047#-vz3voi_141"><pre><code class="language-bash">dataset active -x</code></pre></div><div class="image-container"><img class="center image" id="-1231632047#-vz3voi_142" alt="Active Operational Dataset" title="Active Operational Dataset" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/orchestrator-devices/ot_cli_1.png" width="500" height="442"></div><p id="-1231632047#-vz3voi_143">The ip print (<a href="#-1231632047#ip-addresses-and-network-interfaces">&quot;IP Addresses and Network Interfaces&quot; in &quot;ESP Basic Thread Border Router&quot;</a>) command now shows the Thread interface with the IPv6 address:</p><div class="image-container"><img class="center image" id="-1231632047#-vz3voi_144" alt="Ping" title="Ping" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/orchestrator-devices/tbr_3.png" width="400" height="352"></div></li></ol></section><section class="detached"><h3 id="-1231632047#managing-border-routing-manager" data-toc="managing-border-routing-manager#ESP-Basic-Thread-Border-Router.md-managing-border-routing-manager">Managing Border Routing Manager</h3><p id="-1231632047#-vz3voi_147">The Border Routing Manager starts automatically after enabling the Thread interface. The <span class="inline-code" id="-1231632047#-vz3voi_154">br</span> command can be used to manage the Border Routing Manager.</p><p id="-1231632047#-vz3voi_148">Print the current state of Border Routing Manager:</p><div class="detached code-block" id="-1231632047#-vz3voi_149"><pre><code class="language-bash">br state</code></pre></div><p id="-1231632047#-vz3voi_150">Initializes the Border Routing Manager:</p><div class="detached code-block" id="-1231632047#-vz3voi_151"><pre><code class="language-bash">br init &lt;infrastructure-network-index&gt; &lt;is-running&gt;</code></pre></div><p id="-1231632047#-vz3voi_152">Enables the Border Routing Manager:</p><div class="detached code-block" id="-1231632047#-vz3voi_153"><pre><code class="language-bash">br enable</code></pre></div></section><section class="detached"><h3 id="-1231632047#information-commands" data-toc="information-commands#ESP-Basic-Thread-Border-Router.md-information-commands">Information Commands</h3><p id="-1231632047#-vz3voi_155">The <span class="inline-code" id="-1231632047#-vz3voi_156">platform</span> command prints the current platform. The <span class="inline-code" id="-1231632047#-vz3voi_157">version</span> and <span class="inline-code" id="-1231632047#-vz3voi_158">rcp version</span> print the OpenThread version and the radio version respectively.</p></section></section><section class="detached"><h2 id="-1231632047#restful-api-and-web-gui" data-toc="restful-api-and-web-gui#ESP-Basic-Thread-Border-Router.md-restful-api-and-web-gui">RESTful API and Web GUI</h2><p id="-1231632047#-vz3voi_159">The ESP Thread Border Router provides a RESTful API and Web GUI for managing the Thread Border Router. It is disabled by default and can be enabled using <span class="inline-code" id="-1231632047#-vz3voi_163">idf.py menuconfig</span>:</p><ul class="list" id="-1231632047#-vz3voi_160" start="1"><li class="list-item" id="-1231632047#-vz3voi_164"><p id="-1231632047#-vz3voi_165"><span class="inline-code" id="-1231632047#-vz3voi_166">ESP Thread Border Router Example &rarr; Enable the web server in Thread Border Router</span></p></li></ul><section class="detached"><h3 id="-1231632047#web-gui-access" data-toc="web-gui-access#ESP-Basic-Thread-Border-Router.md-web-gui-access">Web GUI Access</h3><p id="-1231632047#-vz3voi_167">The Web GUI can be accessed using the IP address of the Thread Border Router:</p><div class="detached code-block" id="-1231632047#-vz3voi_168"><pre><code class="language-bash">http://&lt;DEVICE_IP&gt;/index.html</code></pre></div><p id="-1231632047#-vz3voi_169">The Web GUI can be accessed using the IPv4 address assigned by the Wi-Fi router or the device's IPv6 Global Unicast Address (see <span class="inline-code" id="-1231632047#-vz3voi_170">ip print</span> in extension-commands). IPv4 is only accessible within the local network unless port forwarding is configured on the router. IPv6 can be accessed externally if a firewall rule is added on the router.</p></section><section class="detached"><h3 id="-1231632047#restful-api-client-library-generation" data-toc="restful-api-client-library-generation#ESP-Basic-Thread-Border-Router.md-restful-api-client-library-generation">RESTful API Client Library Generation</h3><p id="-1231632047#-vz3voi_171">The API is documented using the OpenAPI specification in the openapi.yaml (<a href="https://github.com/espressif/esp-thread-br/blob/main/components/esp_ot_br_server/src/openapi.yaml">https://github.com/espressif/esp-thread-br/blob/main/components/esp_ot_br_server/src/openapi.yaml</a>) file. OpenAPI Generator (<a href="https://github.com/OpenAPITools/openapi-generator">https://github.com/OpenAPITools/openapi-generator</a>) can be used to generate a client library.</p><p id="-1231632047#-vz3voi_172">The following commands should be run on a Linux machine with installed Docker and Node.js to generate a TypeScript client library for the ESP-Thread Border Router server:</p><div class="detached code-block" id="-1231632047#-vz3voi_173"><pre><code class="language-bash">docker run --rm -v &quot;${PWD}:/local&quot; openapitools/openapi-generator-cli generate -i /local/openapi.yaml -g typescript-fetch -o /local/out/typescript-fetch
sudo chown -R $USER:$USER out/
npm install --safe-dev typescript</code></pre></div></section></section><section class="detached"><h2 id="-1231632047#references" data-toc="references#ESP-Basic-Thread-Border-Router.md-references">References</h2><ul class="list" id="-1231632047#-vz3voi_176" start="1"><li class="list-item" id="-1231632047#-vz3voi_177"><p id="-1231632047#-vz3voi_184">Espressif Thread Border Router SDK (<a href="https://github.com/espressif/esp-thread-br">https://github.com/espressif/esp-thread-br</a>)</p></li><li class="list-item" id="-1231632047#-vz3voi_178"><p id="-1231632047#-vz3voi_186">OpenThread - ESP Thread Border Router (<a href="https://mattercoder.com/codelabs/how-to-install-border-router-on-esp32/?index=..%2F..index#0">https://mattercoder.com/codelabs/how-to-install-border-router-on-esp32/?index=..%2F..index#0</a>)</p></li><li class="list-item" id="-1231632047#-vz3voi_179"><p id="-1231632047#-vz3voi_188">Espressif - Build and Run ESP Thread Border Router (<a href="https://docs.espressif.com/projects/esp-thread-br/en/latest/dev-guide/build_and_run.html">https://docs.espressif.com/projects/esp-thread-br/en/latest/dev-guide/build_and_run.html</a>)</p></li><li class="list-item" id="-1231632047#-vz3voi_180"><p id="-1231632047#-vz3voi_190">OpenThread - Build a Thread Network with the ESP32H2 and ESP Thread Border Router Board (<a href="https://openthread.io/codelabs/esp-openthread-hardware">https://openthread.io/codelabs/esp-openthread-hardware</a>)</p></li><li class="list-item" id="-1231632047#-vz3voi_181"><p id="-1231632047#-vz3voi_192">How to Install Border Router on ESP32-DevKit and ESP32-H2 (<a href="https://mattercoder.com/codelabs/how-to-install-border-router-on-esp32/?index=..%2F..index#0">https://mattercoder.com/codelabs/how-to-install-border-router-on-esp32/?index=..%2F..index#0</a>)</p></li><li class="list-item" id="-1231632047#-vz3voi_182"><p id="-1231632047#-vz3voi_194">Web GUI (<a href="https://docs.espressif.com/projects/esp-thread-br/en/latest/codelab/web-gui.html">https://docs.espressif.com/projects/esp-thread-br/en/latest/codelab/web-gui.html</a>)</p></li><li class="list-item" id="-1231632047#-vz3voi_183"><p id="-1231632047#-vz3voi_196">Global Unicast Address (<a href="https://docs.oracle.com/cd/E19120-01/open.solaris/819-3000/ipv6-overview-130/index.html">https://docs.oracle.com/cd/E19120-01/open.solaris/819-3000/ipv6-overview-130/index.html</a>)</p></li></ul></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-497258712">ESP Matter Thread Border Router</h1><section class="detached"><h2 id="-497258712#overview" data-toc="overview#ESP-Matter-Thread-Border-Router.md-overview">Overview</h2><p id="-497258712#pz5uj7_9">The <span class="inline-code" id="-497258712#pz5uj7_12">ESP Matter Thread Border Router</span> example from Espressif's SDK for Matter (<a href="#-1918844910#esp-matter-solution">&quot;ESP Matter Solution&quot; in &quot;Espressif&quot;</a>) demonstrates how to build firmware for a Matter-compliant Thread Border Router device running on Espressif's hardware.</p><p id="-497258712#pz5uj7_10">The firmware creates a Matter node and configures a Thread Border Router endpoint. If Thread support is enabled, it configures the OpenThread platform with default radio, host, and port settings. Finally, it starts the Matter stack with an event callback to handle network events and initializes the diagnostic console if enabled.</p><p id="-497258712#pz5uj7_11">When the ESP32 connects to Wi-Fi and gets an IP, it sets up Wi-Fi as the backbone for OpenThread and starts the Thread Border Router to enable communication between Thread and Wi-Fi. A static variable stops it from running more than once.</p></section><section class="detached"><h2 id="-497258712#build-and-run" data-toc="build-and-run#ESP-Matter-Thread-Border-Router.md-build-and-run">Build and Run</h2><p id="-497258712#pz5uj7_14">This section demonstrates how to build and run the <span class="inline-code" id="-497258712#pz5uj7_22">ESP Matter Thread Border Router</span> example from Espressif's SDK for Matter (<a href="#-1918844910#esp-matter-solution">&quot;ESP Matter Solution&quot; in &quot;Espressif&quot;</a>).</p><p id="-497258712#pz5uj7_15">Prerequisites:</p><ul class="list" id="-497258712#pz5uj7_16" start="1"><li class="list-item" id="-497258712#pz5uj7_24"><p id="-497258712#pz5uj7_27">ESP-IDF development environment (<a href="#-400735760">ESP-IDF Setup</a>) is set up.</p></li><li class="list-item" id="-497258712#pz5uj7_25"><p id="-497258712#pz5uj7_29">ESP-Matter development environment (<a href="#-401349892">ESP-Matter Setup</a>) is set up.</p></li><li class="list-item" id="-497258712#pz5uj7_26"><p id="-497258712#pz5uj7_31">ESP THREAD BR-ZIGBEE GW (<a href="#-1790576086#border-router">&quot;Border Router&quot; in &quot;Thread&quot;</a>) board</p></li></ul><section class="detached"><h3 id="-497258712#step-1-build-and-configure-the-rcp-image" data-toc="step-1-build-and-configure-the-rcp-image#ESP-Matter-Thread-Border-Router.md-step-1-build-and-configure-the-rcp-image">Step 1: Build and Configure the RCP Image</h3><p id="-497258712#pz5uj7_33">The build process is similar to the Basic Thread Border Router example (<a href="#-1231632047#build-and-run">&quot;Build and Run&quot; in &quot;ESP Basic Thread Border Router&quot;</a>). The following steps from the Basic Thread Border Router example are required if not already completed:</p><ol class="list list-decimal" id="-497258712#pz5uj7_34" type="1" start="1"><li class="list-item" id="-497258712#pz5uj7_36"><p id="-497258712#pz5uj7_38">Follow Step 1: Build the RCP Image (<a href="#-1231632047#step-1-build-the-rcp-image">&quot;Step 1: Build the RCP Image&quot; in &quot;ESP Basic Thread Border Router&quot;</a>).</p></li><li class="list-item" id="-497258712#pz5uj7_37"><p id="-497258712#pz5uj7_40">Follow optional Step 3: Configure the Device (<a href="#-1231632047#step-3-configure-the-device-optional">&quot;Step 3: Configure the Device (Optional)&quot; in &quot;ESP Basic Thread Border Router&quot;</a>).</p></li></ol></section><section class="detached"><h3 id="-497258712#step-2-set-up-environment" data-toc="step-2-set-up-environment#ESP-Matter-Thread-Border-Router.md-step-2-set-up-environment">Step 2: Set Up Environment</h3><p id="-497258712#pz5uj7_42">Set up the environment and navigate to the <span class="inline-code" id="-497258712#pz5uj7_44">ESP Matter Thread Border Router</span> example directory:</p><div class="detached code-block" id="-497258712#pz5uj7_43"><pre><code class="language-bash">get_idf
get_matter
cd $ESP_MATTER_PATH/examples/thread_border_router</code></pre></div></section><section class="detached"><h3 id="-497258712#step-3-set-target-to-esp32-s3" data-toc="step-3-set-target-to-esp32-s3#ESP-Matter-Thread-Border-Router.md-step-3-set-target-to-esp32-s3">Step 3: Set target to ESP32-S3</h3><div class="detached code-block" id="-497258712#pz5uj7_45"><pre><code class="language-bash">idf.py set-target esp32s3</code></pre></div></section><section class="detached"><h3 id="-497258712#step-4-connect-the-esp-thread-border-router-board" data-toc="step-4-connect-the-esp-thread-border-router-board#ESP-Matter-Thread-Border-Router.md-step-4-connect-the-esp-thread-border-router-board">Step 4: Connect the ESP Thread Border Router Board</h3><p id="-497258712#pz5uj7_46">Follow Step 4: Connect the ESP Thread Border Router Board (<a href="#-1231632047#step-4-connect-the-esp-thread-border-router-board">&quot;Step 4: Connect the ESP Thread Border Router Board&quot; in &quot;ESP Basic Thread Border Router&quot;</a>) from the Basic Thread Border Router example.</p></section><section class="detached"><h3 id="-497258712#step-5-build-and-flash" data-toc="step-5-build-and-flash#ESP-Matter-Thread-Border-Router.md-step-5-build-and-flash">Step 5: Build and Flash</h3><div class="detached code-block" id="-497258712#pz5uj7_48"><pre><code class="language-bash">idf.py build 
idf.py -p &lt;PORT&gt; flash monitor</code></pre></div></section></section><section class="detached"><h2 id="-497258712#matter-cli" data-toc="matter-cli#ESP-Matter-Thread-Border-Router.md-matter-cli">Matter CLI</h2><p id="-497258712#pz5uj7_49">This section demonstrates how to use the Matter CLI on the ESP Matter Thread Border Router.</p><p id="-497258712#pz5uj7_50">The device automatically starts BLE advertising when powered on. The following command can be used to check the state:</p><div class="detached code-block" id="-497258712#pz5uj7_51"><pre><code class="language-bash">matter ble adv state</code></pre></div><p id="-497258712#pz5uj7_52">The following command prints the Matter configuration, including the PIN code and Discriminator, needed for commissioning:</p><div class="detached code-block" id="-497258712#pz5uj7_53"><pre><code class="language-bash">matter config</code></pre></div></section><section class="detached"><h2 id="-497258712#chip-tool" data-toc="chip-tool#ESP-Matter-Thread-Border-Router.md-chip-tool">CHIP-Tool</h2><p id="-497258712#pz5uj7_54">The Thread Border Router management cluster allows provisioning of the Thread interface using a Matter commissioner.</p><section class="detached"><h3 id="-497258712#commissioning-to-wi-fi-over-ble" data-toc="commissioning-to-wi-fi-over-ble#ESP-Matter-Thread-Border-Router.md-commissioning-to-wi-fi-over-ble">Commissioning to Wi-Fi over BLE</h3><p id="-497258712#pz5uj7_57">Refer to Commissioning to Wi-Fi over BLE using CHIP Tool (<a href="#-1509277031#commissioning-to-wi-fi-over-ble">&quot;Commissioning to Wi-Fi over BLE&quot; in &quot;CHIP-Tool&quot;</a>).</p></section><section class="detached"><h3 id="-497258712#joining-a-thread-network" data-toc="joining-a-thread-network#ESP-Matter-Thread-Border-Router.md-joining-a-thread-network">Joining a Thread Network</h3><p id="-497258712#pz5uj7_59">After commissioning, a fail-safe timer must be armed:</p><div class="detached code-block" id="-497258712#pz5uj7_60"><pre><code class="language-bash">./chip-tool generalcommissioning arm-fail-safe &lt;TIMEOUT_IN_SEC&gt; 1 &lt;NODE_ID&gt; 0
./chip-tool generalcommissioning arm-fail-safe 120 1 0x1122 0</code></pre></div><p id="-497258712#pz5uj7_61">Provision the Border Router using an active dataset in HEX TLV format (the same format used for commissioning a Matter over Thread (<a href="#-1509277031#commissioning-to-thread-over-ble">&quot;Commissioning to Thread over BLE&quot; in &quot;CHIP-Tool&quot;</a>) device via the <span class="inline-code" id="-497258712#pz5uj7_69">ble-thread</span> command). The <span class="control" id="-497258712#pz5uj7_70">Thread Border Router Management Cluster</span> should be used:</p><div class="detached code-block" id="-497258712#pz5uj7_62"><pre><code class="language-bash">./chip-tool threadborderroutermanagement set-active-dataset-request hex:&lt;ACTIVE_DATASET&gt; &lt;NODE_ID&gt; 1</code></pre></div><p id="-497258712#pz5uj7_63">If the active dataset command succeeds, complete the commissioning process by disarming the fail-safe timer and committing the configuration to non-volatile storage:</p><div class="detached code-block" id="-497258712#pz5uj7_64"><pre><code class="language-bash">./chip-tool generalcommissioning commissioning-complete &lt;NODE_ID&gt; 1</code></pre></div><p id="-497258712#pz5uj7_65">Verify the configuration by retrieving the active dataset:</p><div class="detached code-block" id="-497258712#pz5uj7_66"><pre><code class="language-bash">./chip-tool threadborderroutermanagement get-active-dataset-request &lt;NODE_ID&gt; 1</code></pre></div><p id="-497258712#pz5uj7_67">The response includes a <span class="inline-code" id="-497258712#pz5uj7_71">DatasetResponse</span> containing the active dataset in hex-encoded format.</p></section></section><section class="detached"><h2 id="-497258712#references" data-toc="references#ESP-Matter-Thread-Border-Router.md-references">References</h2><ul class="list" id="-497258712#pz5uj7_72" start="1"><li class="list-item" id="-497258712#pz5uj7_73"><p id="-497258712#pz5uj7_74">ESP-Matter Thread Border Router (<a href="https://github.com/espressif/esp-matter/tree/main/examples/thread_border_router">https://github.com/espressif/esp-matter/tree/main/examples/thread_border_router</a>)</p></li></ul></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-1685420830">Accessory Devices</h1><section class="detached"><h2 id="-1685420830#overview" data-toc="overview#Accessory-Devices.md-overview">Overview</h2><p id="-1685420830#-nx2aw7_6"><span class="control" id="-1685420830#-nx2aw7_7">Accessory Devices</span> are Matter (<a href="#-1997370655">Matter</a>)-compatible Thread End Devices (<a href="#-1790576086#end-device">&quot;End Device&quot; in &quot;Thread&quot;</a>) that monitor and control environmental conditions within a Grow Chamber. They include <span class="control" id="-1685420830#-nx2aw7_10">sensors</span> and <span class="control" id="-1685420830#-nx2aw7_11">actuators</span>.</p></section><section class="detached"><h2 id="-1685420830#sensors" data-toc="sensors#Accessory-Devices.md-sensors">Sensors</h2><p id="-1685420830#-nx2aw7_12">A sensor is any device that generates some sort of output when exposed to a phenomenon.</p><p id="-1685420830#-nx2aw7_13">The table below lists the sensors utilised in this project:</p><div class="table-wrapper detached"><table id="-1685420830#-nx2aw7_14"><tr class="header-row" id="-1685420830#-nx2aw7_16"><th id="-1685420830#-nx2aw7_21"><p><span class="control" id="-1685420830#-nx2aw7_23">Sensor</span></p></th><th id="-1685420830#-nx2aw7_22"><p><span class="control" id="-1685420830#-nx2aw7_24">Purpose</span></p></th></tr><tr class="" id="-1685420830#-nx2aw7_17"><td id="-1685420830#-nx2aw7_25"><p>BMP280</p></td><td id="-1685420830#-nx2aw7_26"><p>Temperature and air pressure</p></td></tr><tr class="" id="-1685420830#-nx2aw7_18"><td id="-1685420830#-nx2aw7_27"><p>BH1750 or TSL2561</p></td><td id="-1685420830#-nx2aw7_28"><p>Light intensity</p></td></tr><tr class="" id="-1685420830#-nx2aw7_19"><td id="-1685420830#-nx2aw7_29"><p>DHT22</p></td><td id="-1685420830#-nx2aw7_30"><p>Temperature and humidity</p></td></tr><tr class="" id="-1685420830#-nx2aw7_20"><td id="-1685420830#-nx2aw7_31"><p>MH-Z19B</p></td><td id="-1685420830#-nx2aw7_32"><p>Carbon dioxide (CO₂) levels</p></td></tr></table></div><p id="-1685420830#-nx2aw7_15">The sensor devices utilise the ESP32-H2 microcontrollers with Thread connectivity and low power consumption, enabling effective operation in various agricultural settings.</p></section><section class="detached"><h2 id="-1685420830#actuators" data-toc="actuators#Accessory-Devices.md-actuators">Actuators</h2><p id="-1685420830#-nx2aw7_33">Actuators are located on the output side of IoT solutions. They change their state based on an analog or digital signal from the microcontroller and produce an output that affects the environment.</p><p id="-1685420830#-nx2aw7_34">The table below lists the actuators that will be utilised in this project:</p><div class="table-wrapper detached"><table id="-1685420830#-nx2aw7_35"><tr class="header-row" id="-1685420830#-nx2aw7_37"><th id="-1685420830#-nx2aw7_42"><p><span class="control" id="-1685420830#-nx2aw7_44">Actuator</span></p></th><th id="-1685420830#-nx2aw7_43"><p><span class="control" id="-1685420830#-nx2aw7_45">Purpose</span></p></th></tr><tr class="" id="-1685420830#-nx2aw7_38"><td id="-1685420830#-nx2aw7_46"><p>Ultrasonic mist maker</p></td><td id="-1685420830#-nx2aw7_47"><p>Fog generation</p></td></tr><tr class="" id="-1685420830#-nx2aw7_39"><td id="-1685420830#-nx2aw7_48"><p>Exhaust fan, 120mm DC</p></td><td id="-1685420830#-nx2aw7_49"><p>Ventilation</p></td></tr><tr class="" id="-1685420830#-nx2aw7_40"><td id="-1685420830#-nx2aw7_50"><p>LED grow lights</p></td><td id="-1685420830#-nx2aw7_51"><p>Plant growth lighting</p></td></tr><tr class="" id="-1685420830#-nx2aw7_41"><td id="-1685420830#-nx2aw7_52"><p>Air pump and air stone</p></td><td id="-1685420830#-nx2aw7_53"><p>Aeration for water inside Root Chamber</p></td></tr></table></div><p id="-1685420830#-nx2aw7_36">Actuator devices utilise the ESP32-DevKitM-1 microcontrollers. In contrast to ESP32-H2, the ESP32-DevKitM-1 does not support Thread connectivity and has higher power consumption. It is used to control actuators, which inherently consume a lot of power.</p></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="1125845925">Matter Pressure and Temperature Sensor</h1><section class="detached"><h2 id="1125845925#overview" data-toc="overview#Matter-Pressure-and-Temperature-Sensor.md-overview">Overview</h2><p id="1125845925#g2oefe_9">The <span class="control" id="1125845925#g2oefe_14">Matter Pressure and Temperature Sensor</span> is a Matter (<a href="#-1997370655">Matter</a>)-compatible SED (<a href="#-1790576086#end-device">&quot;End Device&quot; in &quot;Thread&quot;</a>) device that reads temperature and pressure data from a BMP280 sensor and exposes the readings as Matter attributes.</p><p id="1125845925#g2oefe_10">This section describes the development of a Matter-compatible temperature and pressure sensor.</p><p id="1125845925#g2oefe_11">Source Code: GitHub (<a href="https://github.com/albert-gee/matter_bmp280">https://github.com/albert-gee/matter_bmp280</a>)</p><p id="1125845925#g2oefe_12">Prerequisites:</p><ul class="list" id="1125845925#g2oefe_13" start="1"><li class="list-item" id="1125845925#g2oefe_18"><p id="1125845925#g2oefe_21">ESP-IDF development environment (<a href="#-400735760">ESP-IDF Setup</a>) is set up.</p></li><li class="list-item" id="1125845925#g2oefe_19"><p id="1125845925#g2oefe_23">ESP-Matter development environment (<a href="#-401349892">ESP-Matter Setup</a>) is set up.</p></li><li class="list-item" id="1125845925#g2oefe_20"><p id="1125845925#g2oefe_25">ESP32-H2-DevKitM-1 (<a href="https://docs.espressif.com/projects/esp-dev-kits/en/latest/esp32h2/esp32-h2-devkitm-1/index.html">https://docs.espressif.com/projects/esp-dev-kits/en/latest/esp32h2/esp32-h2-devkitm-1/index.html</a>) is available.</p></li></ul></section><section class="detached"><h2 id="1125845925#hardware-assembly" data-toc="hardware-assembly#Matter-Pressure-and-Temperature-Sensor.md-hardware-assembly">Hardware Assembly</h2><section class="detached"><h3 id="1125845925#wiring-bmp280-to-esp32" data-toc="wiring-bmp280-to-esp32#Matter-Pressure-and-Temperature-Sensor.md-wiring-bmp280-to-esp32">Wiring BMP280 to ESP32</h3><p id="1125845925#g2oefe_29">The <span class="control" id="1125845925#g2oefe_37">ESP32-H2</span> development board reads data from the <span class="control" id="1125845925#g2oefe_38">BMP280</span>, a low-power sensor designed for battery-powered devices. They communicate using <span class="control" id="1125845925#g2oefe_39">I2C (Inter-Integrated Circuit)</span>, a serial, synchronous, half-duplex protocol. The ESP32 has two I2C ports, each capable of operating as a controller or target. In this project, the ESP32-H2 acts as the controller, while the BMP280 functions as the target.</p><p id="1125845925#g2oefe_30">The I2C bus has two lines: the Serial Data Line (SDA) and the Serial Clock Line (SCL). On the ESP32-H2, SDA and SCL can be assigned to any available GPIO pins.</p><p id="1125845925#g2oefe_31">On the ESP32-DevKitM-1, GPIO21 is used for SDA, and GPIO22 is used for SCL.</p><p id="1125845925#g2oefe_32">The table below shows the connections for the BMP280 sensor to the ESP32-DevKitM-1 microcontroller:</p><div class="table-wrapper detached"><table id="1125845925#g2oefe_33"><tr class="header-row" id="1125845925#g2oefe_40"><th id="1125845925#g2oefe_46"><p><span class="control" id="1125845925#g2oefe_48">BMP280 Pin</span></p></th><th id="1125845925#g2oefe_47"><p><span class="control" id="1125845925#g2oefe_49">ESP32 Pin</span></p></th></tr><tr class="" id="1125845925#g2oefe_41"><td id="1125845925#g2oefe_50"><p>VCC</p></td><td id="1125845925#g2oefe_51"><p>3.3V</p></td></tr><tr class="" id="1125845925#g2oefe_42"><td id="1125845925#g2oefe_52"><p>GND</p></td><td id="1125845925#g2oefe_53"><p>GND</p></td></tr><tr class="" id="1125845925#g2oefe_43"><td id="1125845925#g2oefe_54"><p>SDA</p></td><td id="1125845925#g2oefe_55"><p>GPIO21</p></td></tr><tr class="" id="1125845925#g2oefe_44"><td id="1125845925#g2oefe_56"><p>SCL</p></td><td id="1125845925#g2oefe_57"><p>GPIO22</p></td></tr><tr class="" id="1125845925#g2oefe_45"><td id="1125845925#g2oefe_58"><p>SDO</p></td><td id="1125845925#g2oefe_59"><p>GND</p></td></tr></table></div><p id="1125845925#g2oefe_34">The pictures below show the connections for the BMP280 sensor to the ESP32-DevKitM-1 microcontroller:</p><div class="image-container"><img class="center image" id="1125845925#g2oefe_35" alt="BMP280 connected to ESP32-DevKitM-1 (front)" title="BMP280 connected to ESP32-DevKitM-1 (front)" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/accessory-devices/image7.jpg" width="500" height="282"></div><div class="image-container"><img class="center image" id="1125845925#g2oefe_36" alt="BMP280 connected to ESP32-DevKitM-1 (back)" title="BMP280 connected to ESP32-DevKitM-1 (back)" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/accessory-devices/image4.jpg" width="500" height="282"></div></section><section class="detached"><h3 id="1125845925#testing-i2c-connectivity" data-toc="testing-i2c-connectivity#Matter-Pressure-and-Temperature-Sensor.md-testing-i2c-connectivity">Testing I2C Connectivity</h3><p id="1125845925#g2oefe_60">The I2C tools (<a href="https://github.com/espressif/esp-idf/tree/release/v5.4/examples/peripherals/i2c/i2c_tools">https://github.com/espressif/esp-idf/tree/release/v5.4/examples/peripherals/i2c/i2c_tools</a>) from ESP-IDF examples were used to test communication with the sensor device.</p><p id="1125845925#g2oefe_61">The following command configures the I2C bus with specific GPIO number, port number and frequency:</p><div class="detached code-block" id="1125845925#g2oefe_62"><pre><code class="language-bash">i2cconfig --port=0 --sda=21 --scl=22 --freq=100000</code></pre></div><p id="1125845925#g2oefe_63">The following command scans an I2C bus for devices and output a table with the list of detected devices on the bus:</p><div class="detached code-block" id="1125845925#g2oefe_64"><pre><code class="language-bash">i2cdetect</code></pre></div><div class="image-container"><img class="center image" id="1125845925#g2oefe_65" alt="i2cconfig output" title="i2cconfig output" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/accessory-devices/image20.png" width="500" height="350"></div><p id="1125845925#g2oefe_66">It displays the address 0x76 since the SDO pin is connected to GND.</p><p id="1125845925#g2oefe_67">The following command get the value of the &ldquo;ID&rdquo; register which contains the chip identification number chip_id, which is 0x58:</p><div class="detached code-block" id="1125845925#g2oefe_68"><pre><code class="language-bash">i2cget -c 0x76 -r 0xD0 -l 1</code></pre></div><ul class="list" id="1125845925#g2oefe_69" start="1"><li class="list-item" id="1125845925#g2oefe_71"><p id="1125845925#g2oefe_74">-c option to specify the address of I2C device (acquired from i2cdetect command).</p></li><li class="list-item" id="1125845925#g2oefe_72"><p id="1125845925#g2oefe_75">-r option to specify the register address you want to inspect.</p></li><li class="list-item" id="1125845925#g2oefe_73"><p id="1125845925#g2oefe_76">-l option to specify the length of the content.</p></li></ul></section></section><section class="detached"><h2 id="1125845925#firmware-development" data-toc="firmware-development#Matter-Pressure-and-Temperature-Sensor.md-firmware-development">Firmware Development</h2><p id="1125845925#g2oefe_77">The firmware for the ESP32-H2 was developed using the <span class="control" id="1125845925#g2oefe_84">ESP-IDF framework</span>.</p><p id="1125845925#g2oefe_78">The BMP280 datasheet (<span class="emphasis" id="1125845925#g2oefe_85">BST-BMP280-DS001-26</span>) is used as a reference during development.</p><section class="detached"><h3 id="1125845925#project-bootstrap" data-toc="project-bootstrap#Matter-Pressure-and-Temperature-Sensor.md-project-bootstrap">Project Bootstrap</h3><p id="1125845925#g2oefe_86">Follow the following steps from the ESP32 Project Workflow (<a href="#-586960577">ESP32 Project Workflow</a>) guide:</p><ul class="list" id="1125845925#g2oefe_87" start="1"><li class="list-item" id="1125845925#g2oefe_89"><p id="1125845925#g2oefe_95">Step 1: Set Up ESP-IDF and ESP-Matter Environment (<a href="#-586960577#step-1-set-up-esp-idf-and-esp-matter-environment">&quot;Step 1: Set Up ESP-IDF and ESP-Matter Environment&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li><li class="list-item" id="1125845925#g2oefe_90"><p id="1125845925#g2oefe_97">Step 2: Create a New Project (<a href="#-586960577#step-2-create-a-new-project">&quot;Step 2: Create a New Project&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li><li class="list-item" id="1125845925#g2oefe_91"><p id="1125845925#g2oefe_99">Step 3: Set Target Device (<a href="#-586960577#step-3-set-target-device">&quot;Step 3: Set Target Device&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li><li class="list-item" id="1125845925#g2oefe_92"><p id="1125845925#g2oefe_101">Step 4: Open the Project in CLion IDE (<a href="#-586960577#step-4-open-the-project-in-clion-ide">&quot;Step 4: Open the Project in CLion IDE&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li><li class="list-item" id="1125845925#g2oefe_93"><p id="1125845925#g2oefe_103">Step 5: Create Default Configuration (<a href="#-586960577#step-5-create-default-configuration">&quot;Step 5: Create Default Configuration&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li><li class="list-item" id="1125845925#g2oefe_94"><p id="1125845925#g2oefe_105">Step 6: Update CMakeLists.txt (<a href="#-586960577#step-6-update-cmakelists-txt">&quot;Step 6: Update CMakeLists.txt&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li></ul></section><section class="detached"><h3 id="1125845925#driver-component-development" data-toc="driver-component-development#Matter-Pressure-and-Temperature-Sensor.md-driver-component-development">Driver Component Development</h3><p id="1125845925#g2oefe_107">The command below creates a new component named <span class="inline-code" id="1125845925#g2oefe_121">bmp280_driver</span> inside the <span class="inline-code" id="1125845925#g2oefe_122">components</span> directory.</p><div class="detached code-block" id="1125845925#g2oefe_108"><pre><code class="language-bash">idf.py create-component bmp280_driver -C components</code></pre></div><div class="image-container"><img class="center image" id="1125845925#g2oefe_109" alt="Creating a new component within an ESP-IDF project" title="Creating a new component within an ESP-IDF project" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/accessory-devices/image1.png" width="500" height="102"></div><p id="1125845925#g2oefe_110">The ESP-IDF framework includes a driver for working with I2C devices. To ensure that this component can use the driver, the <span class="inline-code" id="1125845925#g2oefe_123">REQUIRES</span> directive must be added to <span class="inline-code" id="1125845925#g2oefe_124">components/bmp280_driver/CMakeLists.txt</span> as follows:</p><div class="detached code-block" id="1125845925#g2oefe_111"><pre><code class="language-bash">REQUIRES &quot;driver&quot;</code></pre></div><div class="image-container"><img class="center image" id="1125845925#g2oefe_112" alt="Using the REQUIRES Directive" title="Using the REQUIRES Directive" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/accessory-devices/image25.png" width="500" height="135"></div><p id="1125845925#g2oefe_113">This directive ensures that the build system includes the I2C driver as a dependency for the component during the build process.</p><p id="1125845925#g2oefe_114">The <span class="inline-code" id="1125845925#g2oefe_125">i2c_utils.h</span> header file declares utility functions for initializing, managing, and performing operations on an I2C master bus and its connected devices.</p><p id="1125845925#g2oefe_115">The <span class="inline-code" id="1125845925#g2oefe_126">i2c_utils.c</span> file implements these functions and includes <span class="inline-code" id="1125845925#g2oefe_127">driver/i2c_master.h</span> ($IDF_PATH/components/driver/i2c/include/driver/i2c_master.h) to access the driver&rsquo;s API in controller mode.</p><p id="1125845925#g2oefe_116">The BMP280 code is designed according to the specifications outlined in the BST-BMP280-DS001-26 datasheet. Communication with the sensor is performed through read and write operations on its 8-bit registers.</p><div class="image-container"><img class="center image" id="1125845925#g2oefe_117" alt="BMP280 Memory Map. Source: BST-BMP280-DS001-26 datasheet" title="BMP280 Memory Map. Source: BST-BMP280-DS001-26 datasheet" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/accessory-devices/image35.png" width="500" height="172"></div><p id="1125845925#g2oefe_118">The <span class="inline-code" id="1125845925#g2oefe_128">bmp280_driver.h</span> header file declares the configurations, constants, and functions needed to interface with and operate the sensor, based on the datasheet.</p><p id="1125845925#g2oefe_119">The <span class="inline-code" id="1125845925#g2oefe_129">bmp280_driver.c</span> file implements these functions, providing support for sensor initialization, configuration, and data handling. It adheres to the datasheet to verify the sensor, apply compensation to raw measurements, and configure parameters like oversampling, operating modes, and filters.</p><p id="1125845925#g2oefe_120">The BMP280 sensor uses factory-programmed calibration parameters to adjust raw data for accurate measurements. These parameters are stored in the sensor's non-volatile memory (NVM) during production, are unique to each device, and cannot be modified by the user, as described in Section 3.11.2 of the datasheet. The <span class="inline-code" id="1125845925#g2oefe_130">bmp280_calibration.h</span> header declares the constants, structures, and functions needed to handle this calibration data. It includes functionality to read the parameters and apply them to raw pressure and temperature readings. The <span class="inline-code" id="1125845925#g2oefe_131">bmp280_calibration.c</span> file implements these functions, following the temperature and pressure compensation formulas specified in Section 3.11 of the datasheet.</p></section><section class="detached"><h3 id="1125845925#matter-component-development" data-toc="matter-component-development#Matter-Pressure-and-Temperature-Sensor.md-matter-component-development">Matter Component Development</h3><p id="1125845925#g2oefe_132">The command below creates a new component named bmp280_driver inside the components directory.</p><div class="detached code-block" id="1125845925#g2oefe_133"><pre><code class="language-bash">idf.py create-component matter_interface -C components</code></pre></div><p id="1125845925#g2oefe_134">The <span class="inline-code" id="1125845925#g2oefe_137">matter_temperature_sensor.h</span> file defines functions for managing a Matter-compatible temperature sensor.</p><p id="1125845925#g2oefe_135">The <span class="inline-code" id="1125845925#g2oefe_138">matter_temperature_sensor.c</span> file implements these functions using Espressif&rsquo;s Matter SDK, built on the Matter SDK.</p><p id="1125845925#g2oefe_136">In the Matter ecosystem, devices are represented as Nodes, which consist of Endpoints representing specific functions, such as temperature measurement. Endpoints are organized into Clusters that group related features. This implementation sets up a Node with an Endpoint for temperature measurement, configures its Clusters, and manages communication within the Matter network.</p></section><section class="detached"><h3 id="1125845925#integration-of-bmp280-driver-with-esp-matter" data-toc="integration-of-bmp280-driver-with-esp-matter#Matter-Pressure-and-Temperature-Sensor.md-integration-of-bmp280-driver-with-esp-matter">Integration of BMP280 Driver with ESP-Matter</h3><p id="1125845925#g2oefe_139">The bmp280_driver component outputs temperature and pressure readings as 32-bit signed integers (int32_t), following the BMP280 datasheet specifications. These integers are used to process the sensor&rsquo;s raw 20-bit data for precise calculations, including compensation and scaling. The readings represent scaled real-world values to preserve decimal precision using integer arithmetic. For example, a temperature of 25.25&deg;C is stored as 2525 (in units of 0.01&deg;C), and a pressure of 1013.25 is stored as 101325 (in Pascals).</p><p id="1125845925#g2oefe_140">During integration with ESP-Matter, an issue arose because ESP-Matter defines attributes like measured_value, min_measured_value, and max_measured_value in its Temperature and Pressure Measurement Clusters using the nullable&lt; int16_t&gt; data type. This required the BMP280&rsquo;s outputs, represented as int32_t, to be reduced to fit within the int16_t range of -32,768 to 32,767. The BMP280 outputs temperature values within a range of -40&deg;C to +85&deg;C and pressure values within a range of 300 hPa to 1100 hPa. For temperature, no additional scaling was necessary because even the maximum value, when scaled (e.g., 85.00&deg;C becomes 8500), fits comfortably within the int16_t range without any loss of precision.</p><p id="1125845925#g2oefe_141">For pressure, however, scaled values can exceed the limit of the int16_t range. Multiplying higher values by 100 to preserve decimal precision increases their magnitude beyond the int16_t limit. For example, a pressure of 1013.25 becomes 101325 when scaled, which far exceeds the int16_t range.</p><p id="1125845925#g2oefe_142">To address this, the scaling approach was modified. Instead of multiplying by 100 to represent hundredths of Pascals, pressure values were scaled by 10. This reduced the magnitude of the scaled values, allowing them to fit within the int16_t range. For example, a pressure of 1013.25 is scaled to 10132, which fits comfortably within the range. Similarly, the maximum pressure of 1100.00 is scaled to 11000.</p></section><section class="detached"><h3 id="1125845925#reading-the-temperature" data-toc="reading-the-temperature#Matter-Pressure-and-Temperature-Sensor.md-reading-the-temperature">Reading the Temperature</h3><p id="1125845925#g2oefe_143">To manage temperature readings, two approaches were considered:</p><ul class="list" id="1125845925#g2oefe_144" start="1"><li class="list-item" id="1125845925#g2oefe_147"><p id="1125845925#g2oefe_149">Regularly poll the temperature sensor, for example, using a timer. Each new reading is written directly to the attribute&rsquo;s stored value.</p></li><li class="list-item" id="1125845925#g2oefe_148"><p id="1125845925#g2oefe_150">Update the temperature reading only when a client requests it. In this approach, the sensor retrieves the latest temperature data and writes it to the attribute before responding to the client.</p></li></ul><p id="1125845925#g2oefe_145">The second approach requires a mechanism to dynamically fetch the latest sensor data during a client read operation. ESP-Matter provides native support for callbacks during attribute write operations, but not for reads. In the ESP-Matter repository on GitHub, Issue #264 (<a href="https://github.com/espressif/esp-matter/issues/264">https://github.com/espressif/esp-matter/issues/264</a>) includes a discussion about using the <span class="inline-code" id="1125845925#g2oefe_152">ATTRIBUTE_FLAG_OVERRIDE</span> flag to implement such functionality. The discussion describes a workaround involving modifications to the framework&rsquo;s internal <span class="inline-code" id="1125845925#g2oefe_153">esp_matter_attribute.cpp</span> file to override the default attribute behavior and introduce custom read logic.</p><p id="1125845925#g2oefe_146">A more maintainable alternative would be to leverage the flag directly within application code. This approach avoids modifying the framework itself. However, it introduces additional complexity and can cause delays in client responses, as the sensor data must be fetched in real-time for each read request. Due to these challenges, the first option was chosen for its simplicity and faster response times.</p></section></section><section class="detached"><h2 id="1125845925#testing" data-toc="testing#Matter-Pressure-and-Temperature-Sensor.md-testing">Testing</h2><section class="detached"><h3 id="1125845925#testing-with-chip-tool" data-toc="testing-with-chip-tool#Matter-Pressure-and-Temperature-Sensor.md-testing-with-chip-tool">Testing with CHIP-Tool</h3><p id="1125845925#g2oefe_156">Refer to CHIP-Tool (<a href="#-1509277031">CHIP-Tool</a>) for more details.</p><div class="detached code-block" id="1125845925#g2oefe_157"><pre><code class="language-bash">matter config
matter onboardingcodes ble</code></pre></div><div class="detached code-block" id="1125845925#g2oefe_158"><pre><code class="language-bash">matter esp attribute get 0x0001 0x00000402 0x00000000
matter esp attribute get 0x0002 0x00000403 0x00000000</code></pre></div></section><section class="detached"><h3 id="1125845925#connecting-to-google-home" data-toc="connecting-to-google-home#Matter-Pressure-and-Temperature-Sensor.md-connecting-to-google-home">Connecting to Google Home</h3><p id="1125845925#g2oefe_160">It is also possible to use third-party software, such as the Google Home app, as a controller. However, the device appears offline in Google Home despite being successfully commissioned. To address this issue, a structured troubleshooting process was undertaken:</p><ul class="list" id="1125845925#g2oefe_161" start="1"><li class="list-item" id="1125845925#g2oefe_166"><p id="1125845925#g2oefe_169">Flash Memory Reset: The device&rsquo;s flash memory was erased to remove any residual configurations that could interfere with its functionality.</p></li><li class="list-item" id="1125845925#g2oefe_167"><p id="1125845925#g2oefe_170">Network Configuration Check: It was confirmed that both the mobile device and the hardware were connected to a 2.4 GHz Wi-Fi network, as the system does not support 5 GHz networks.</p></li><li class="list-item" id="1125845925#g2oefe_168"><p id="1125845925#g2oefe_171">Device Reset: The hardware was reset to ensure proper initialization and resolve any temporary issues.</p></li></ul><p id="1125845925#g2oefe_162">Vaishali Avhale, Associate QA Engineer at Espressif Systems, provided feedback on a related issue in the Espressif ESP-Matter GitHub repository (Issue #1125 (<a href="https://github.com/espressif/esp-matter/issues/1125">https://github.com/espressif/esp-matter/issues/1125</a>)). She tested the system using a Google Nest Hub 2nd Generation as a hub and confirmed that it worked correctly in this configuration. She noted that a hub device is a required component for proper operation within Google's ecosystem.</p><div class="image-container"><img class="center image" id="1125845925#g2oefe_163" alt="Google Home app detecting a device that is broadcasting its presence using Bluetooth Low Energy (BLE)" title="Google Home app detecting a device that is broadcasting its presence using Bluetooth Low Energy (BLE)" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/accessory-devices/image5.jpg" width="93" height="200"></div><div class="image-container"><img class="center image" id="1125845925#g2oefe_164" alt="Google Home app requesting QR code for commissioning" title="Google Home app requesting QR code for commissioning" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/accessory-devices/image3.jpg" width="93" height="200"></div><div class="image-container"><img class="center image" id="1125845925#g2oefe_165" alt="Google Home app notifies that its hardware doesn&amp;rsquo;t support Matter" title="Google Home app notifies that its hardware doesn&amp;rsquo;t support Matter" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/accessory-devices/image29.jpg" width="93" height="200"></div></section></section><section class="detached"><h2 id="1125845925#references" data-toc="references#Matter-Pressure-and-Temperature-Sensor.md-references">References</h2><ul class="list" id="1125845925#g2oefe_173" start="1"><li class="list-item" id="1125845925#g2oefe_174"><p id="1125845925#g2oefe_177">BMP280 &ndash; Data sheet (<a href="https://www.bosch-sensortec.com/media/boschsensortec/downloads/datasheets/bst-bmp280-ds001-26.pdf">https://www.bosch-sensortec.com/media/boschsensortec/downloads/datasheets/bst-bmp280-ds001-26.pdf</a>)</p></li><li class="list-item" id="1125845925#g2oefe_175"><p id="1125845925#g2oefe_179">Telink Matter Developers Guide (<a href="https://wiki.telink-semi.cn/doc/an/TelinkMatterDevelopersGuide_en.pdf">https://wiki.telink-semi.cn/doc/an/TelinkMatterDevelopersGuide_en.pdf</a>)</p></li><li class="list-item" id="1125845925#g2oefe_176"><p id="1125845925#g2oefe_181">ESP-Matter Sensors Example (<a href="https://github.com/espressif/esp-matter/tree/main/examples/sensors">https://github.com/espressif/esp-matter/tree/main/examples/sensors</a>)</p></li></ul></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="2085001628">Matter Relay Switch</h1><section class="detached"><h2 id="2085001628#overview" data-toc="overview#Matter-Relay-Switch.md-overview">Overview</h2><p id="2085001628#-l9sso1_7">The <span class="control" id="2085001628#-l9sso1_12">Matter Relay Switch</span> is a Matter (<a href="#-1997370655">Matter</a>)-compatible REED (<a href="#-1790576086#end-device">&quot;End Device&quot; in &quot;Thread&quot;</a>) device that can be controlled remotely to turn a relay on or off. It can be used to control various devices, such as lights or fans.</p><p id="2085001628#-l9sso1_8">This section describes the development of the <span class="control" id="2085001628#-l9sso1_15">Matter Relay Switch</span>.</p><p id="2085001628#-l9sso1_9">Source Code: GitHub (<a href="https://github.com/albert-gee/matter_relay">https://github.com/albert-gee/matter_relay</a>)</p><p id="2085001628#-l9sso1_10">Prerequisites:</p><ul class="list" id="2085001628#-l9sso1_11" start="1"><li class="list-item" id="2085001628#-l9sso1_17"><p id="2085001628#-l9sso1_20">ESP-IDF development environment (<a href="#-400735760">ESP-IDF Setup</a>) is set up.</p></li><li class="list-item" id="2085001628#-l9sso1_18"><p id="2085001628#-l9sso1_22">ESP-Matter development environment (<a href="#-401349892">ESP-Matter Setup</a>) is set up.</p></li><li class="list-item" id="2085001628#-l9sso1_19"><p id="2085001628#-l9sso1_24">ESP32-H2-DevKitM-1 (<a href="https://docs.espressif.com/projects/esp-dev-kits/en/latest/esp32h2/esp32-h2-devkitm-1/index.html">https://docs.espressif.com/projects/esp-dev-kits/en/latest/esp32h2/esp32-h2-devkitm-1/index.html</a>) is available.</p></li></ul></section><section class="detached"><h2 id="2085001628#hardware-assembly" data-toc="hardware-assembly#Matter-Relay-Switch.md-hardware-assembly">Hardware Assembly</h2><section class="detached"><h3 id="2085001628#wiring-relay-to-esp32" data-toc="wiring-relay-to-esp32#Matter-Relay-Switch.md-wiring-relay-to-esp32">Wiring Relay to ESP32</h3><p id="2085001628#-l9sso1_27">The <span class="control" id="2085001628#-l9sso1_35">Valefod 5V 1-Channel Relay Module</span> is used to control loads up to 10A using a low-power control signal from a microcontroller such as an Arduino or ESP32. It features optocoupler isolation for improved signal integrity and supports both high and low trigger configurations.</p><p id="2085001628#-l9sso1_28">The relay has the following terminal layout:</p><ul class="list" id="2085001628#-l9sso1_29" start="1"><li class="list-item" id="2085001628#-l9sso1_36"><p id="2085001628#-l9sso1_38"><span class="control" id="2085001628#-l9sso1_40">Side 1: Control Terminals</span></p><ul class="list" id="2085001628#-l9sso1_39" start="1"><li class="list-item" id="2085001628#-l9sso1_41"><p id="2085001628#-l9sso1_44">DC+ (Power Supply Positive): Connect to a 5V power supply.</p></li><li class="list-item" id="2085001628#-l9sso1_42"><p id="2085001628#-l9sso1_45">DC- (Power Supply Negative): Connect to the ground of the power supply.</p></li><li class="list-item" id="2085001628#-l9sso1_43"><p id="2085001628#-l9sso1_46">IN (Input Signal): Connect to a GPIO pin on the microcontroller to control the relay.</p></li></ul></li><li class="list-item" id="2085001628#-l9sso1_37"><p id="2085001628#-l9sso1_47"><span class="control" id="2085001628#-l9sso1_49">Side 2: Switch Terminals</span></p><ul class="list" id="2085001628#-l9sso1_48" start="1"><li class="list-item" id="2085001628#-l9sso1_50"><p id="2085001628#-l9sso1_53">COM (Common Terminal): Shared terminal for the relay's switch.</p></li><li class="list-item" id="2085001628#-l9sso1_51"><p id="2085001628#-l9sso1_54">NO (Normally Open): Open circuit by default; closes when the relay is activated.</p></li><li class="list-item" id="2085001628#-l9sso1_52"><p id="2085001628#-l9sso1_55">NC (Normally Closed): Closed circuit by default; opens when the relay is activated.</p></li></ul></li></ul><p id="2085001628#-l9sso1_30">The Normally Open (NO) terminal is used when the circuit should remain open (off) by default, requiring activation to close the circuit. The Normally Closed (NC) terminal is used when the circuit should remain closed (on) by default, opening only when the relay is activated.</p><div class="image-container"><img class="center image" id="2085001628#-l9sso1_31" alt="Wiring Relay to ESP32" title="Wiring Relay to ESP32" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/accessory-devices/image39.jpg" width="500" height="888"></div><div class="image-container"><img class="center image" id="2085001628#-l9sso1_32" alt="Wiring Relay to ESP32" title="Wiring Relay to ESP32" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/accessory-devices/image40.jpg" width="500" height="888"></div><div class="image-container"><img class="center image" id="2085001628#-l9sso1_33" alt="Wiring Relay to ESP32" title="Wiring Relay to ESP32" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/accessory-devices/image13.jpg" width="500" height="282"></div><div class="image-container"><img class="center image" id="2085001628#-l9sso1_34" alt="Wiring Relay to ESP32" title="Wiring Relay to ESP32" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/accessory-devices/image24.jpg" width="500" height="282"></div></section></section><section class="detached"><h2 id="2085001628#firmware-development" data-toc="firmware-development#Matter-Relay-Switch.md-firmware-development">Firmware Development</h2><p id="2085001628#-l9sso1_56">The firmware uses the ESP-IDF (<a href="#-1918844910#esp-idf-framework">&quot;ESP-IDF Framework&quot; in &quot;Espressif&quot;</a>) framework with the SDK for Matter. It sets up an On/Off endpoint and configures callbacks to manage Matter attributes, enabling GPIO-based relay control.</p><section class="detached"><h3 id="2085001628#project-bootstrap" data-toc="project-bootstrap#Matter-Relay-Switch.md-project-bootstrap">Project Bootstrap</h3><p id="2085001628#-l9sso1_61">Follow the following steps from the ESP32 Project Workflow (<a href="#-586960577">ESP32 Project Workflow</a>) guide:</p><ul class="list" id="2085001628#-l9sso1_62" start="1"><li class="list-item" id="2085001628#-l9sso1_64"><p id="2085001628#-l9sso1_70">Step 1: Set Up ESP-IDF and ESP-Matter Environment (<a href="#-586960577#step-1-set-up-esp-idf-and-esp-matter-environment">&quot;Step 1: Set Up ESP-IDF and ESP-Matter Environment&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li><li class="list-item" id="2085001628#-l9sso1_65"><p id="2085001628#-l9sso1_72">Step 2: Create a New Project (<a href="#-586960577#step-2-create-a-new-project">&quot;Step 2: Create a New Project&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li><li class="list-item" id="2085001628#-l9sso1_66"><p id="2085001628#-l9sso1_74">Step 3: Set Target Device (<a href="#-586960577#step-3-set-target-device">&quot;Step 3: Set Target Device&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li><li class="list-item" id="2085001628#-l9sso1_67"><p id="2085001628#-l9sso1_76">Step 4: Open the Project in CLion IDE (<a href="#-586960577#step-4-open-the-project-in-clion-ide">&quot;Step 4: Open the Project in CLion IDE&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li><li class="list-item" id="2085001628#-l9sso1_68"><p id="2085001628#-l9sso1_78">Step 5: Create Default Configuration (<a href="#-586960577#step-5-create-default-configuration">&quot;Step 5: Create Default Configuration&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li><li class="list-item" id="2085001628#-l9sso1_69"><p id="2085001628#-l9sso1_80">Step 6: Update CMakeLists.txt (<a href="#-586960577#step-6-update-cmakelists-txt">&quot;Step 6: Update CMakeLists.txt&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li></ul></section><section class="detached"><h3 id="2085001628#gpio-configuration" data-toc="gpio-configuration#Matter-Relay-Switch.md-gpio-configuration">GPIO Configuration</h3><p id="2085001628#-l9sso1_82">The header file <span class="inline-code" id="2085001628#-l9sso1_88">$IDF_PATH/components/esp_driver_gpio/include/driver/gpio.h</span> can be included with:</p><div class="detached code-block" id="2085001628#-l9sso1_83"><pre><code class="language-c">#include &quot;driver/gpio.h&quot;</code></pre></div><p id="2085001628#-l9sso1_84">This header file is a part of the API provided by the <span class="inline-code" id="2085001628#-l9sso1_89">esp_driver_gpio</span> component. To declare that your component depends on esp_driver_gpio, the following line has to be added to CMakeLists.txt:</p><div class="detached code-block" id="2085001628#-l9sso1_85"><pre><code class="language-cmake">REQUIRES esp_driver_gpio</code></pre></div><p id="2085001628#-l9sso1_86">or</p><div class="detached code-block" id="2085001628#-l9sso1_87"><pre><code class="language-cmake">PRIV_REQUIRES esp_driver_gpio</code></pre></div></section><section class="detached"><h3 id="2085001628#startup-process" data-toc="startup-process#Matter-Relay-Switch.md-startup-process">Startup Process</h3><p id="2085001628#-l9sso1_90">The device boots up and loads the firmware, initializing flash memory, configuring system memory, setting up GPIOs, and loading stored data from NVS.</p><p id="2085001628#-l9sso1_91">Once initialization is complete, it starts the Matter stack, creates the relay node, and runs the OpenThread stack. Finally, it begins BLE advertising (CHIPoBLE) to enable pairing.</p></section></section><section class="detached"><h2 id="2085001628#testing" data-toc="testing#Matter-Relay-Switch.md-testing">Testing</h2><section class="detached"><h3 id="2085001628#testing-with-chip-tool" data-toc="testing-with-chip-tool#Matter-Relay-Switch.md-testing-with-chip-tool">Testing with CHIP-Tool</h3><p id="2085001628#-l9sso1_93">Refer to CHIP-Tool (<a href="#-1509277031">CHIP-Tool</a>) for more details.</p><div class="detached code-block" id="2085001628#-l9sso1_94"><pre><code class="language-bash">matter config
matter onboardingcodes ble

matter esp attribute set 0x1 0x6 0x0 1
matter esp attribute get 0x1 0x6 0x0</code></pre></div></section></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="454638120">Matter Controller</h1><p id="454638120#-nw37al_3">This chapter describes the development of Matter Controllers.</p><p id="454638120#-nw37al_4">CHIP-Tool (<a href="#-1509277031">CHIP-Tool</a>) and ESP Matter Controller examples (<a href="#1823421053">ESP Matter Controller</a>) firmware are used to demonstrate the Matter Controller functionality.</p><p id="454638120#-nw37al_5">The Orchestrator (<a href="#-309902166">Orchestrator</a>) device is based on the ESP Matter Controller example.</p></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-1509277031">CHIP-Tool</h1><section class="detached"><h2 id="-1509277031#overview" data-toc="overview#CHIP-Tool.md-overview">Overview</h2><p id="-1509277031#q781fm_11"><span class="control" id="-1509277031#q781fm_14">CHIP Tool</span> is a Matter Controllers implementation that allows to commission a Matter (<a href="#-1997370655">Matter</a>) device into a network and to communicate with it. It is used for testing and debugging Matter devices.</p><p id="-1509277031#q781fm_12">CHIP Tool was built and installed on a <span class="control" id="-1509277031#q781fm_16">Raspberry Pi 4 Model B</span> (4GB RAM and 32GB SD card) running <span class="emphasis" id="-1509277031#q781fm_17">Ubuntu Server for Raspberry Pi 24.04.1 LTS</span>. <span class="emphasis" id="-1509277031#q781fm_18">Raspberry Pi Imager v1.8.5</span> was used to flash the Ubuntu image onto the SD card.</p><p id="-1509277031#q781fm_13">Matter v1.4.0.0 (<a href="https://github.com/project-chip/connectedhomeip/releases/tag/v1.4.0.0">https://github.com/project-chip/connectedhomeip/releases/tag/v1.4.0.0</a>) SDK was used to build the CHIP-Tool application.</p></section><section class="detached"><h2 id="-1509277031#raspberry-pi-setup" data-toc="raspberry-pi-setup#CHIP-Tool.md-raspberry-pi-setup">Raspberry Pi Setup</h2><p id="-1509277031#q781fm_20">This section outlines the steps to set up a Raspberry Pi as a Matter controller using CHIP-Tool. The process is time-consuming.</p><section class="detached"><h3 id="-1509277031#step-1-ubuntu-installation" data-toc="step-1-ubuntu-installation#CHIP-Tool.md-step-1-ubuntu-installation">Step 1. Ubuntu installation</h3><ol class="list list-decimal" id="-1509277031#q781fm_26" type="1" start="1"><li class="list-item" id="-1509277031#q781fm_33"><p id="-1509277031#q781fm_34">Install the OS</p><ol class="list list-decimal" id="-1509277031#q781fm_35" type="1" start="1"><li class="list-item" id="-1509277031#q781fm_36"><p id="-1509277031#q781fm_41">Download the Ubuntu Server image from the Ubuntu website (<a href="https://ubuntu.com/download/raspberry-pi">https://ubuntu.com/download/raspberry-pi</a>).</p></li><li class="list-item" id="-1509277031#q781fm_37"><p id="-1509277031#q781fm_43">Download and install Raspberry Pi Imager on Ubuntu Desktop:</p><div class="detached code-block" id="-1509277031#q781fm_44"><pre><code class="language-bash">sudo apt update
sudo apt install rpi-imager</code></pre></div></li><li class="list-item" id="-1509277031#q781fm_38"><p id="-1509277031#q781fm_45">Insert the SD card into card reader and connect it to the computer.</p></li><li class="list-item" id="-1509277031#q781fm_39"><p id="-1509277031#q781fm_46">Select the Ubuntu image and the SD card in Raspberry Pi Imager.</p></li><li class="list-item" id="-1509277031#q781fm_40"><p id="-1509277031#q781fm_47">Edit Settings (Wi-Fi and SSH credentials and enable SSH) and flash the image onto the SD card.</p></li></ol></li></ol><div class="image-container"><img class="center image" id="-1509277031#q781fm_27" alt="Alt Text" title="Alt Text" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/orchestrator-devices/rpi_1.jpg" width="500" height="352"></div><div class="image-container"><img class="center image" id="-1509277031#q781fm_28" alt="Alt Text" title="Alt Text" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/orchestrator-devices/rpi_2.jpg" width="500" height="352"></div><div class="image-container"><img class="center image" id="-1509277031#q781fm_29" alt="Alt Text" title="Alt Text" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/orchestrator-devices/rpi_3.jpg" width="500" height="352"></div><div class="image-container"><img class="center image" id="-1509277031#q781fm_30" alt="Alt Text" title="Alt Text" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/orchestrator-devices/rpi_4.jpg" width="500" height="605"></div><div class="image-container"><img class="center image" id="-1509277031#q781fm_31" alt="Alt Text" title="Alt Text" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/orchestrator-devices/rpi_5.jpg" width="500" height="352"></div><div class="image-container"><img class="center image" id="-1509277031#q781fm_32" alt="Alt Text" title="Alt Text" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/orchestrator-devices/rpi_6.jpg" width="500" height="352"></div></section><section class="detached"><h3 id="-1509277031#step-2-connecting-to-raspberry-pi" data-toc="step-2-connecting-to-raspberry-pi#CHIP-Tool.md-step-2-connecting-to-raspberry-pi">Step 2. Connecting to Raspberry Pi</h3><p id="-1509277031#q781fm_48">Insert the SD card into the Raspberry Pi and power it on. It will automatically connect to Wi-Fi using the credentials provided during the installation process. It can take a few minutes for the Raspberry Pi to boot up. Once it is ready, connect to it using SSH with the credentials provided during the installation process.</p><div class="detached code-block" id="-1509277031#q781fm_49"><pre><code class="language-bash">ssh ggc_user@mattercontroller.local</code></pre></div><div class="image-container"><img class="center image" id="-1509277031#q781fm_50" alt="Connecting to Raspberry Pi" title="Connecting to Raspberry Pi" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/orchestrator-devices/rpi_7.png" width="500" height="569"></div></section><section class="detached"><h3 id="-1509277031#step-3-installing-pre-requisites" data-toc="step-3-installing-pre-requisites#CHIP-Tool.md-step-3-installing-pre-requisites">Step 3. Installing Pre-requisites</h3><ol class="list list-decimal" id="-1509277031#q781fm_51" type="1" start="1"><li class="list-item" id="-1509277031#q781fm_52"><p id="-1509277031#q781fm_58">Update the system and install Raspberry Pi-specific dependencies (<a href="https://github.com/project-chip/connectedhomeip/blob/master/docs/guides/BUILDING.md#installing-prerequisites-on-raspberry-pi-4">https://github.com/project-chip/connectedhomeip/blob/master/docs/guides/BUILDING.md#installing-prerequisites-on-raspberry-pi-4</a>):</p><div class="detached code-block" id="-1509277031#q781fm_59"><pre><code class="language-bash">sudo apt update
sudo apt upgrade
sudo apt-get install git gcc g++ pkg-config libssl-dev libdbus-1-dev \
     libglib2.0-dev libavahi-client-dev ninja-build python3-venv python3-dev \
     python3-pip unzip libgirepository1.0-dev libcairo2-dev libreadline-dev \
     default-jre
sudo apt-get install bluez avahi-utils
sudo reboot
ssh ggc_user@mattercontroller.local</code></pre></div></li><li class="list-item" id="-1509277031#q781fm_53"><p id="-1509277031#q781fm_61">Edit the <span class="inline-code" id="-1509277031#q781fm_65">bluetooth.service</span> unit:</p><div class="detached code-block" id="-1509277031#q781fm_62"><pre><code class="language-bash">sudo systemctl edit bluetooth.service</code></pre></div><p id="-1509277031#q781fm_63">Add the following content:</p><div class="detached code-block" id="-1509277031#q781fm_64"><pre><code class="language-bash">[Service]
ExecStart=
ExecStart=/usr/sbin/bluetoothd -E -P battery
Restart=always
RestartSec=3</code></pre></div></li><li class="list-item" id="-1509277031#q781fm_54"><p id="-1509277031#q781fm_66">Enable and Start the Bluetooth service:</p><div class="detached code-block" id="-1509277031#q781fm_67"><pre><code class="language-bash">sudo systemctl start bluetooth.service</code></pre></div></li><li class="list-item" id="-1509277031#q781fm_55"><p id="-1509277031#q781fm_68">Edit the dbus-fi.w1.wpa_supplicant1.service file:</p><div class="detached code-block" id="-1509277031#q781fm_69"><pre><code class="language-bash">sudo nano /etc/systemd/system/dbus-fi.w1.wpa_supplicant1.service</code></pre></div><p id="-1509277031#q781fm_70">Replace the line #11 with:</p><div class="detached code-block" id="-1509277031#q781fm_71"><pre><code class="language-bash">ExecStart=/usr/sbin/wpa_supplicant -u -s -O /run/wpa_supplicant</code></pre></div></li><li class="list-item" id="-1509277031#q781fm_56"><p id="-1509277031#q781fm_72">Edit the wpa_supplicant.conf file:</p><div class="detached code-block" id="-1509277031#q781fm_73"><pre><code class="language-bash">sudo nano /etc/wpa_supplicant/wpa_supplicant.conf</code></pre></div><p id="-1509277031#q781fm_74">Add the following content:</p><div class="detached code-block" id="-1509277031#q781fm_75"><pre><code class="language-bash">ctrl_interface=DIR=/run/wpa_supplicant
update_config=1</code></pre></div></li><li class="list-item" id="-1509277031#q781fm_57"><p id="-1509277031#q781fm_76">Reboot the Raspberry Pi:</p><div class="detached code-block" id="-1509277031#q781fm_77"><pre><code class="language-bash">sudo reboot
ssh ggc_user@mattercontroller.local</code></pre></div></li></ol></section><section class="detached"><h3 id="-1509277031#step-4-building-chip-tool" data-toc="step-4-building-chip-tool#CHIP-Tool.md-step-4-building-chip-tool">Step 4. Building CHIP Tool</h3><p id="-1509277031#q781fm_78">The application will require installation of Matter SDK on Raspberry Pi:</p><ol class="list list-decimal" id="-1509277031#q781fm_79" type="1" start="1"><li class="list-item" id="-1509277031#q781fm_80"><p id="-1509277031#q781fm_84">Clone the Matter SDK repository:</p><div class="detached code-block" id="-1509277031#q781fm_85"><pre><code class="language-bash">mkdir matter
cd ~/matter
git clone https://github.com/project-chip/connectedhomeip.git
cd connectedhomeip/
git checkout tags/v1.4.0.0</code></pre></div></li><li class="list-item" id="-1509277031#q781fm_81"><p id="-1509277031#q781fm_86">Prepare Matter SDK:</p><div class="detached code-block" id="-1509277031#q781fm_87"><pre><code class="language-bash">./scripts/checkout_submodules.py --shallow --platform  linux
source ~/matter/connectedhomeip/scripts/activate.sh</code></pre></div><div class="image-container"><img class="center image" id="-1509277031#q781fm_88" alt="Matter SDK Installation" title="Matter SDK Installation" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/orchestrator-devices/rpi_8.png" width="500" height="686"></div></li><li class="list-item" id="-1509277031#q781fm_82"><p id="-1509277031#q781fm_89">Build CHIP Tool using build_examples.py:</p><p id="-1509277031#q781fm_90">The <span class="inline-code" id="-1509277031#q781fm_96">targets</span> command retrieves supported build targets listed below:</p><div class="detached code-block" id="-1509277031#q781fm_91"><pre><code class="language-bash">./scripts/build/build_examples.py targets</code></pre></div><ul class="list" id="-1509277031#q781fm_92" start="1"><li class="list-item" id="-1509277031#q781fm_97"><p id="-1509277031#q781fm_107"><span class="control" id="-1509277031#q781fm_109">Ameba:</span></p><ul class="list" id="-1509277031#q781fm_108" start="1"><li class="list-item" id="-1509277031#q781fm_110"><p id="-1509277031#q781fm_111"><span class="inline-code" id="-1509277031#q781fm_112">amebad-{all-clusters, all-clusters-minimal, light, light-switch, pigweed}</span></p></li></ul></li><li class="list-item" id="-1509277031#q781fm_98"><p id="-1509277031#q781fm_113"><span class="control" id="-1509277031#q781fm_115">ASR:</span> <span class="inline-code" id="-1509277031#q781fm_116">asr-{asr582x, asr595x, asr550x}-{all-clusters, all-clusters-minimal, lighting, light-switch, lock, bridge, temperature-measurement, thermostat, ota-requestor, dishwasher, refrigerator}</span></p><ul class="list" id="-1509277031#q781fm_114" start="1"><li class="list-item" id="-1509277031#q781fm_117"><p id="-1509277031#q781fm_118">Optional flags: <span class="inline-code" id="-1509277031#q781fm_119">[-ota] [-shell] [-no_logging] [-factory] [-rotating_id] [-rio]</span></p></li></ul></li><li class="list-item" id="-1509277031#q781fm_99"><p id="-1509277031#q781fm_120"><span class="control" id="-1509277031#q781fm_122">Android:</span> <span class="inline-code" id="-1509277031#q781fm_123">android-{arm, arm64, x86, x64, androidstudio-arm, androidstudio-arm64, androidstudio-x86, androidstudio-x64}-{chip-tool, chip-test, tv-server, tv-casting-app, java-matter-controller, kotlin-matter-controller, virtual-device-app}</span></p><ul class="list" id="-1509277031#q781fm_121" start="1"><li class="list-item" id="-1509277031#q781fm_124"><p id="-1509277031#q781fm_125">Optional flags: <span class="inline-code" id="-1509277031#q781fm_126">[-no-debug]</span></p></li></ul></li><li class="list-item" id="-1509277031#q781fm_100"><p id="-1509277031#q781fm_127"><span class="control" id="-1509277031#q781fm_129">Bouffalolab:</span> <span class="inline-code" id="-1509277031#q781fm_130">bouffalolab-{bl602dk, bl704ldk, bl706dk, bl602-night-light, bl706-night-light, bl602-iot-matter-v1, xt-zb6-devkit}-light</span></p><ul class="list" id="-1509277031#q781fm_128" start="1"><li class="list-item" id="-1509277031#q781fm_131"><p id="-1509277031#q781fm_132">Optional flags: <span class="inline-code" id="-1509277031#q781fm_133">[-ethernet] [-wifi] [-thread] [-easyflash] [-littlefs] [-shell] [-mfd] [-rotating_device_id] [-rpc] [-cdc] [-mot] [-resetcnt] [-memmonitor] [-115200] [-fp]</span></p></li></ul></li><li class="list-item" id="-1509277031#q781fm_101"><p id="-1509277031#q781fm_134"><span class="control" id="-1509277031#q781fm_136">Texas Instruments (TI):</span></p><ul class="list" id="-1509277031#q781fm_135" start="1"><li class="list-item" id="-1509277031#q781fm_137"><p id="-1509277031#q781fm_140"><span class="inline-code" id="-1509277031#q781fm_141">cc32xx-{lock, air-purifier}</span></p></li><li class="list-item" id="-1509277031#q781fm_138"><p id="-1509277031#q781fm_142"><span class="inline-code" id="-1509277031#q781fm_143">ti-cc13x4_26x4-{lighting, lock, pump, pump-controller}</span></p></li><li class="list-item" id="-1509277031#q781fm_139"><p id="-1509277031#q781fm_144">Optional flags: <span class="inline-code" id="-1509277031#q781fm_145">[-mtd] [-ftd]</span></p></li></ul></li><li class="list-item" id="-1509277031#q781fm_102"><p id="-1509277031#q781fm_146"><span class="control" id="-1509277031#q781fm_147">Cypress (Infineon):</span> <span class="inline-code" id="-1509277031#q781fm_148">cyw30739-{cyw30739b2_p5_evk_01, cyw30739b2_p5_evk_02, cyw30739b2_p5_evk_03, cyw930739m2evb_01, cyw930739m2evb_02}-{light, light-switch, lock, thermostat}</span></p></li><li class="list-item" id="-1509277031#q781fm_103"><p id="-1509277031#q781fm_149"><span class="control" id="-1509277031#q781fm_151">Silicon Labs (EFR32):</span> <span class="inline-code" id="-1509277031#q781fm_152">efr32-{brd2704b, brd4316a, brd4317a, brd4318a, brd4319a, brd4186a, brd4187a, brd2601b, brd4187c, brd4186c, brd2703a, brd4338a, brd2605a}-{window-covering, switch, unit-test, light, lock, thermostat, pump, air-quality-sensor-app}</span></p><ul class="list" id="-1509277031#q781fm_150" start="1"><li class="list-item" id="-1509277031#q781fm_153"><p id="-1509277031#q781fm_154">Optional flags: <span class="inline-code" id="-1509277031#q781fm_155">[-rpc] [-with-ota-requestor] [-icd] [-low-power] [-shell] [-no-logging] [-openthread-mtd] [-heap-monitoring] [-no-openthread-cli] [-show-qr-code] [-wifi] [-rs9116] [-wf200] [-siwx917] [-ipv4] [-additional-data-advertising] [-use-ot-lib] [-use-ot-coap-lib] [-no-version] [-skip-rps-generation]</span></p></li></ul></li><li class="list-item" id="-1509277031#q781fm_104"><p id="-1509277031#q781fm_156"><span class="control" id="-1509277031#q781fm_158">Espressif (ESP32):</span> <span class="inline-code" id="-1509277031#q781fm_159">esp32-{m5stack, c3devkit, devkitc, qemu}-{all-clusters, all-clusters-minimal, energy-management, ota-provider, ota-requestor, shell, light, lock, bridge, temperature-measurement, tests}</span></p><ul class="list" id="-1509277031#q781fm_157" start="1"><li class="list-item" id="-1509277031#q781fm_160"><p id="-1509277031#q781fm_161">Optional flags: <span class="inline-code" id="-1509277031#q781fm_162">[-rpc] [-ipv6only] [-tracing] [-data-model-disabled] [-data-model-enabled]</span></p></li></ul></li><li class="list-item" id="-1509277031#q781fm_105"><p id="-1509277031#q781fm_163"><span class="control" id="-1509277031#q781fm_165">General:</span></p><ul class="list" id="-1509277031#q781fm_164" start="1"><li class="list-item" id="-1509277031#q781fm_166"><p id="-1509277031#q781fm_167"><span class="inline-code" id="-1509277031#q781fm_168">genio-lighting-app</span></p></li></ul></li><li class="list-item" id="-1509277031#q781fm_106"><p id="-1509277031#q781fm_169"><span class="control" id="-1509277031#q781fm_171">Linux:</span></p><ul class="list" id="-1509277031#q781fm_170" start="1"><li class="list-item" id="-1509277031#q781fm_172"><p id="-1509277031#q781fm_177"><span class="inline-code" id="-1509277031#q781fm_178">linux-fake-tests</span></p></li><li class="list-item" id="-1509277031#q781fm_173"><p id="-1509277031#q781fm_179">Optional flags: <span class="inline-code" id="-1509277031#q781fm_180">[-mbedtls] [-boringssl] [-asan] [-tsan] [-ubsan] [-libfuzzer] [-ossfuzz] [-pw-fuzztest] [-coverage] [-dmalloc] [-clang]</span> <span class="inline-code" id="-1509277031#q781fm_181">linux-arm64-{rpc-console, all-clusters, all-clusters-minimal, chip-tool, thermostat, java-matter-controller, kotlin-matter-controller, minmdns, light, light-data-model-no-unique-id, lock, shell, ota-provider, ota-requestor, simulated-app1, simulated-app2, python-bindings, tv-app, tv-casting-app, bridge, fabric-admin, fabric-bridge, tests, chip-cert, address-resolve-tool, contact-sensor, dishwasher, microwave-oven, refrigerator, rvc, air-purifier, lit-icd, air-quality-sensor, network-manager, energy-management}</span></p></li><li class="list-item" id="-1509277031#q781fm_174"><p id="-1509277031#q781fm_182">Optional flags: <span class="inline-code" id="-1509277031#q781fm_183">[-nodeps] [-nlfaultinject] [-platform-mdns] [-minmdns-verbose] [-libnl] [-same-event-loop] [-no-interactive] [-ipv6only] [-no-ble] [-no-wifi] [-no-thread] [-no-shell] [-mbedtls] [-boringssl] [-asan] [-tsan] [-ubsan] [-libfuzzer] [-ossfuzz] [-pw-fuzztest] [-coverage] [-dmalloc] [-clang] [-test] [-rpc] [-with-ui] [-evse-test-event] [-enable-dnssd-tests] [-disable-dnssd-tests] [-chip-casting-simplified] [-data-model-check] [-data-model-disabled] [-data-model-enabled] [-check-failure-die]</span></p></li><li class="list-item" id="-1509277031#q781fm_175"><p id="-1509277031#q781fm_184"><span class="inline-code" id="-1509277031#q781fm_185">linux-arm64-efr32-test-runner</span></p></li><li class="list-item" id="-1509277031#q781fm_176"><p id="-1509277031#q781fm_186">Optional flags: <span class="inline-code" id="-1509277031#q781fm_187">[-clang]</span></p></li></ul></li></ul><p id="-1509277031#q781fm_93">The <span class="inline-code" id="-1509277031#q781fm_188">linux-arm64-chip-tool</span> and <span class="inline-code" id="-1509277031#q781fm_189">linux-arm64-all-clusters</span> targets were selected from the Linux section, with the <span class="inline-code" id="-1509277031#q781fm_190">-ipv6only</span> and <span class="inline-code" id="-1509277031#q781fm_191">-platform-mdns</span> flags:</p><div class="detached code-block" id="-1509277031#q781fm_94"><pre><code class="language-bash">./scripts/build/build_examples.py --target linux-arm64-chip-tool-ipv6only-platform-mdns gen
cd ~/matter/connectedhomeip/out/linux-arm64-chip-tool-ipv6only-platform-mdns
ninja -j 1 &amp; disown</code></pre></div><p id="-1509277031#q781fm_95">Building the CHIP-Tool is a time-consuming process. To prevent SSH session timeouts, ninja was executed in the background. The job count was limited to 1 (<span class="inline-code" id="-1509277031#q781fm_192">-j 1</span>) to reduce memory usage. <span class="inline-code" id="-1509277031#q781fm_193">tail -f nohup.out</span> can be used to monitor the output.</p></li><li class="list-item" id="-1509277031#q781fm_83"><p id="-1509277031#q781fm_194">Move the built CHIP Tool:</p><div class="detached code-block" id="-1509277031#q781fm_195"><pre><code class="language-bash">mv ~/matter/connectedhomeip/out/linux-arm64-chip-tool-ipv6only-platform-mdns/chip-tool ~/matter/chip-tool
rm -rf ~/matter/connectedhomeip/out/linux-arm64-chip-tool-ipv6only-platform-mdns</code></pre></div></li></ol></section><section class="detached"><h3 id="-1509277031#step-5-testing" data-toc="step-5-testing#CHIP-Tool.md-step-5-testing">Step 5. Testing</h3><p id="-1509277031#q781fm_196">Running CHIP Tool:</p><div class="detached code-block" id="-1509277031#q781fm_197"><pre><code class="language-bash">cd ~/matter
./chip-tool</code></pre></div></section></section><section class="detached"><h2 id="-1509277031#commissioning" data-toc="commissioning#CHIP-Tool.md-commissioning">Commissioning</h2><p id="-1509277031#q781fm_198">This section describes the Matter commissioning (<a href="#279346443">Matter Commissioning</a>) using CHIP Tool.</p><p id="-1509277031#q781fm_199">The following command should be run on the Commissionee to print the static configuration that includes the <span class="control" id="-1509277031#q781fm_206">PIN code</span> and <span class="control" id="-1509277031#q781fm_207">Discriminator</span> (<span class="emphasis" id="-1509277031#q781fm_208">0xf00</span> is <span class="emphasis" id="-1509277031#q781fm_209">3840</span> in decimal):</p><div class="detached code-block" id="-1509277031#q781fm_200"><pre><code class="language-bash">matter config</code></pre></div><section class="detached"><h3 id="-1509277031#commissioning-to-wi-fi-over-ble" data-toc="commissioning-to-wi-fi-over-ble#CHIP-Tool.md-commissioning-to-wi-fi-over-ble">Commissioning to Wi-Fi over BLE</h3><p id="-1509277031#q781fm_210">A Commissionee joins an existing IP network over Bluetooth LE before being commissioned into a Matter network.</p><p id="-1509277031#q781fm_211">The following CHIP-Tool command starts commissioning onto a <span class="control" id="-1509277031#q781fm_217">Wi-Fi</span> network over BLE:</p><div class="detached code-block" id="-1509277031#q781fm_212"><pre><code class="language-bash">./chip-tool pairing ble-wifi 0x1122 SSID WIFIPASS 20202021 3840
./chip-tool pairing ble-wifi &lt;NODE_ID_TO_ASSIGN&gt; &lt;SSID&gt; &lt;PASSWORD&gt; &lt;PIN&gt; &lt;DISCRIMINATOR&gt;</code></pre></div><p id="-1509277031#q781fm_213">The parameters are defined as follows:</p><ul class="list" id="-1509277031#q781fm_214" start="1"><li class="list-item" id="-1509277031#q781fm_218"><p id="-1509277031#q781fm_223"><span class="inline-code" id="-1509277031#q781fm_224">&lt;NODE_ID_TO_ASSIGN&gt;</span> is the node ID assigned to the device being commissioned, which can be a decimal or hexadecimal number prefixed with &lsquo;0x&rsquo;.</p></li><li class="list-item" id="-1509277031#q781fm_219"><p id="-1509277031#q781fm_225"><span class="inline-code" id="-1509277031#q781fm_226">&lt;SSID&gt;</span> is the Wi-Fi SSID, provided as a plain string or in hexadecimal format as &lsquo;hex:XXXXXXXX&rsquo;, where each byte of the SSID is represented as two-digit hexadecimal numbers.</p></li><li class="list-item" id="-1509277031#q781fm_220"><p id="-1509277031#q781fm_227"><span class="inline-code" id="-1509277031#q781fm_228">&lt;PASSWORD&gt;</span> is the Wi-Fi password, given as a plain string or hex data.</p></li><li class="list-item" id="-1509277031#q781fm_221"><p id="-1509277031#q781fm_229"><span class="inline-code" id="-1509277031#q781fm_230">&lt;PIN&gt;</span> is the PIN code for authentication.</p></li><li class="list-item" id="-1509277031#q781fm_222"><p id="-1509277031#q781fm_231"><span class="inline-code" id="-1509277031#q781fm_232">&lt;DISCRIMINATOR&gt;</span> is the discriminator value.</p></li></ul><p id="-1509277031#q781fm_215">CHIP-Tool starts the commissioning process, which includes the following steps:</p><ol class="list list-decimal" id="-1509277031#q781fm_216" type="1" start="1"><li class="list-item" id="-1509277031#q781fm_233"><p id="-1509277031#q781fm_242"><span class="control" id="-1509277031#q781fm_244">Initialization</span></p><ul class="list" id="-1509277031#q781fm_243" start="1"><li class="list-item" id="-1509277031#q781fm_245"><p id="-1509277031#q781fm_248">Initializes storage and loads key-value store (KVS) configurations.</p></li><li class="list-item" id="-1509277031#q781fm_246"><p id="-1509277031#q781fm_249">Detects network interfaces and identifies the WiFi interface.</p></li><li class="list-item" id="-1509277031#q781fm_247"><p id="-1509277031#q781fm_250">Sets up UDP transport manager and BLE transport layers.</p></li></ul></li><li class="list-item" id="-1509277031#q781fm_234"><p id="-1509277031#q781fm_251"><span class="control" id="-1509277031#q781fm_253">Fabric and Node Setup</span></p><ul class="list" id="-1509277031#q781fm_252" start="1"><li class="list-item" id="-1509277031#q781fm_254"><p id="-1509277031#q781fm_256">Loads the fabric table, which contains information about existing secure networks.</p></li><li class="list-item" id="-1509277031#q781fm_255"><p id="-1509277031#q781fm_257">Creates a new fabric with a unique Fabric ID and Node ID.</p></li></ul></li><li class="list-item" id="-1509277031#q781fm_235"><p id="-1509277031#q781fm_258"><span class="control" id="-1509277031#q781fm_260">BLE Scanning and Connection</span></p><ul class="list" id="-1509277031#q781fm_259" start="1"><li class="list-item" id="-1509277031#q781fm_261"><p id="-1509277031#q781fm_264">Scans for nearby BLE devices.</p></li><li class="list-item" id="-1509277031#q781fm_262"><p id="-1509277031#q781fm_265">Identifies the correct device using a discriminator match.</p></li><li class="list-item" id="-1509277031#q781fm_263"><p id="-1509277031#q781fm_266">Establishes a BLE connection with the device.</p></li></ul></li><li class="list-item" id="-1509277031#q781fm_236"><p id="-1509277031#q781fm_267"><span class="control" id="-1509277031#q781fm_269">Secure Session Establishment</span></p><ul class="list" id="-1509277031#q781fm_268" start="1"><li class="list-item" id="-1509277031#q781fm_270"><p id="-1509277031#q781fm_273">Performs a PASE (Password Authenticated Session Establishment) handshake over BLE.</p></li><li class="list-item" id="-1509277031#q781fm_271"><p id="-1509277031#q781fm_274">Exchanges secure messages to establish an encrypted session.</p></li><li class="list-item" id="-1509277031#q781fm_272"><p id="-1509277031#q781fm_275">Marks the session as &quot;Active&quot; upon success.</p></li></ul></li><li class="list-item" id="-1509277031#q781fm_237"><p id="-1509277031#q781fm_276"><span class="control" id="-1509277031#q781fm_278">Commissioning Process</span></p><ul class="list" id="-1509277031#q781fm_277" start="1"><li class="list-item" id="-1509277031#q781fm_279"><p id="-1509277031#q781fm_282">Reads the device&rsquo;s attributes and capabilities.</p></li><li class="list-item" id="-1509277031#q781fm_280"><p id="-1509277031#q781fm_283">Arms a fail-safe mechanism to prevent accidental changes.</p></li><li class="list-item" id="-1509277031#q781fm_281"><p id="-1509277031#q781fm_284">Configures the device based on regional regulatory requirements.</p></li></ul></li><li class="list-item" id="-1509277031#q781fm_238"><p id="-1509277031#q781fm_285"><span class="control" id="-1509277031#q781fm_287">Certificate Exchange</span></p><ul class="list" id="-1509277031#q781fm_286" start="1"><li class="list-item" id="-1509277031#q781fm_288"><p id="-1509277031#q781fm_290">The device provides PAI (Product Attestation Intermediate) and DAC (Device Attestation Certificate).</p></li><li class="list-item" id="-1509277031#q781fm_289"><p id="-1509277031#q781fm_291">The system verifies the certificates and device authenticity.</p></li></ul></li><li class="list-item" id="-1509277031#q781fm_239"><p id="-1509277031#q781fm_292"><span class="control" id="-1509277031#q781fm_294">Attestation and Verification</span></p><ul class="list" id="-1509277031#q781fm_293" start="1"><li class="list-item" id="-1509277031#q781fm_295"><p id="-1509277031#q781fm_297">Validates the device&rsquo;s attestation data to ensure a trusted identity.</p></li><li class="list-item" id="-1509277031#q781fm_296"><p id="-1509277031#q781fm_298">Performs a revocation check to confirm the device&rsquo;s legitimacy.</p></li></ul></li><li class="list-item" id="-1509277031#q781fm_240"><p id="-1509277031#q781fm_299"><span class="control" id="-1509277031#q781fm_301">Operational Certificate Signing</span></p><ul class="list" id="-1509277031#q781fm_300" start="1"><li class="list-item" id="-1509277031#q781fm_302"><p id="-1509277031#q781fm_304">The device generates a CSR (Certificate Signing Request).</p></li><li class="list-item" id="-1509277031#q781fm_303"><p id="-1509277031#q781fm_305">The system issues a NOC (Node Operational Certificate) to authenticate the device in the network.</p></li></ul></li><li class="list-item" id="-1509277031#q781fm_241"><p id="-1509277031#q781fm_306"><span class="control" id="-1509277031#q781fm_308">Finalizing the Pairing</span></p><ul class="list" id="-1509277031#q781fm_307" start="1"><li class="list-item" id="-1509277031#q781fm_309"><p id="-1509277031#q781fm_311">Sends the root certificate to the device.</p></li><li class="list-item" id="-1509277031#q781fm_310"><p id="-1509277031#q781fm_312">Marks the pairing process as &quot;Success,&quot; making the device a trusted member of the Matter network.</p></li></ul></li></ol></section><section class="detached"><h3 id="-1509277031#commissioning-to-thread-over-ble" data-toc="commissioning-to-thread-over-ble#CHIP-Tool.md-commissioning-to-thread-over-ble">Commissioning to Thread over BLE</h3><p id="-1509277031#q781fm_313">The following CHIP-Tool command initiates commissioning onto a <span class="control" id="-1509277031#q781fm_317">Thread</span> network over BLE:</p><div class="detached code-block" id="-1509277031#q781fm_314"><pre><code class="language-bash">./chip-tool pairing ble-thread 0x1122 20202021 3840
./chip-tool pairing ble-thread &lt;NODE_ID_TO_ASSIGN&gt; hex:&lt;OPERATIONAL_DATASET&gt; &lt;PIN&gt; &lt;DISCRIMINATOR&gt;</code></pre></div><p id="-1509277031#q781fm_315">The parameters are defined as follows:</p><ul class="list" id="-1509277031#q781fm_316" start="1"><li class="list-item" id="-1509277031#q781fm_318"><p id="-1509277031#q781fm_322"><span class="inline-code" id="-1509277031#q781fm_323">&lt;NODE_ID_TO_ASSIGN&gt;</span> is the node ID assigned to the device being commissioned, which can be a decimal number or a hexadecimal number prefixed with &lsquo;0x&rsquo;.</p></li><li class="list-item" id="-1509277031#q781fm_319"><p id="-1509277031#q781fm_324"><span class="inline-code" id="-1509277031#q781fm_325">&lt;OPERATIONAL_DATASET&gt;</span> is the Thread Operational Dataset (<a href="#-1790576086">Thread</a>), which contains the network credentials needed to join a Thread network. It is provided in hexadecimal format (<span class="inline-code" id="-1509277031#q781fm_327">hex:XXXXXXXX</span>), where each byte of the dataset is represented as two-digit hexadecimal numbers.</p></li><li class="list-item" id="-1509277031#q781fm_320"><p id="-1509277031#q781fm_328"><span class="inline-code" id="-1509277031#q781fm_329">&lt;PIN&gt;</span> is the PIN code for authentication.</p></li><li class="list-item" id="-1509277031#q781fm_321"><p id="-1509277031#q781fm_330"><span class="inline-code" id="-1509277031#q781fm_331">&lt;DISCRIMINATOR&gt;</span> is the discriminator value.</p></li></ul></section><section class="detached"><h3 id="-1509277031#commissioning-over-existing-ip-network" data-toc="commissioning-over-existing-ip-network#CHIP-Tool.md-commissioning-over-existing-ip-network">Commissioning over Existing IP Network</h3><p id="-1509277031#q781fm_332">A Commissionee already connected to a Wi-Fi, Ethernet, or Thread network can be commissioned without BLE discovery, using <span class="control" id="-1509277031#q781fm_341">mDNS service discovery</span> instead.</p><p id="-1509277031#q781fm_333">The following CHIP-Tool command commissions a device that is already connected to a <span class="control" id="-1509277031#q781fm_342">Wi-Fi</span> or <span class="control" id="-1509277031#q781fm_343">Ethernet</span> network:</p><div class="detached code-block" id="-1509277031#q781fm_334"><pre><code class="language-bash">./chip-tool pairing onnetwork 0x1122 20202021
./chip-tool pairing onnetwork &lt;NODE_ID_TO_ASSIGN&gt; &lt;PIN&gt;</code></pre></div><p id="-1509277031#q781fm_335">The parameters are defined as follows:</p><ul class="list" id="-1509277031#q781fm_336" start="1"><li class="list-item" id="-1509277031#q781fm_344"><p id="-1509277031#q781fm_346"><span class="inline-code" id="-1509277031#q781fm_347">&lt;NODE_ID_TO_ASSIGN&gt;</span> is the <span class="control" id="-1509277031#q781fm_348">node ID</span> assigned to the device being commissioned.</p></li><li class="list-item" id="-1509277031#q781fm_345"><p id="-1509277031#q781fm_349"><span class="inline-code" id="-1509277031#q781fm_350">&lt;PIN&gt;</span> is the PIN code for authentication.</p></li></ul><p id="-1509277031#q781fm_337">The following CHIP-Tool command commissions a device that is already connected to a <span class="control" id="-1509277031#q781fm_351">Thread</span> network:</p><div class="detached code-block" id="-1509277031#q781fm_338"><pre><code class="language-bash">./chip-tool pairing onnetwork-thread 0x1122 hex:&lt;OPERATIONAL_DATASET&gt; 20202021
./chip-tool pairing onnetwork-thread &lt;NODE_ID_TO_ASSIGN&gt; hex:&lt;OPERATIONAL_DATASET&gt; &lt;PIN&gt;</code></pre></div><p id="-1509277031#q781fm_339">The parameters are defined as follows:</p><ul class="list" id="-1509277031#q781fm_340" start="1"><li class="list-item" id="-1509277031#q781fm_352"><p id="-1509277031#q781fm_355"><span class="inline-code" id="-1509277031#q781fm_356">&lt;NODE_ID_TO_ASSIGN&gt;</span> is the <span class="control" id="-1509277031#q781fm_357">node ID</span> assigned to the device being commissioned.</p></li><li class="list-item" id="-1509277031#q781fm_353"><p id="-1509277031#q781fm_358"><span class="inline-code" id="-1509277031#q781fm_359">&lt;OPERATIONAL_DATASET&gt;</span> is the <span class="control" id="-1509277031#q781fm_360">Thread Operational Dataset</span>, which contains the network credentials for joining a Thread network.</p></li><li class="list-item" id="-1509277031#q781fm_354"><p id="-1509277031#q781fm_361"><span class="inline-code" id="-1509277031#q781fm_362">&lt;PIN&gt;</span> is the <span class="control" id="-1509277031#q781fm_363">PIN code</span> for authentication.</p></li></ul></section><section class="detached"><h3 id="-1509277031#removing-a-device-from-fabric" data-toc="removing-a-device-from-fabric#CHIP-Tool.md-removing-a-device-from-fabric">Removing a Device from Fabric</h3><p id="-1509277031#q781fm_364">The following CHIP-Tool command removes a device from the Matter Fabric:</p><div class="detached code-block" id="-1509277031#q781fm_365"><pre><code class="language-bash">./chip-tool pairing unpair 0x1122
./chip-tool pairing unpair &lt;NODE_ID_TO_ASSIGN&gt;</code></pre></div><p id="-1509277031#q781fm_366">The parameters are defined as follows:</p><ul class="list" id="-1509277031#q781fm_367" start="1"><li class="list-item" id="-1509277031#q781fm_368"><p id="-1509277031#q781fm_369"><span class="inline-code" id="-1509277031#q781fm_370">&lt;NODE_ID_TO_ASSIGN&gt;</span> is the <span class="control" id="-1509277031#q781fm_371">node ID</span> assigned to the device being removed.</p></li></ul></section></section><section class="detached"><h2 id="-1509277031#reading-device-attributes" data-toc="reading-device-attributes#CHIP-Tool.md-reading-device-attributes">Reading Device Attributes</h2><p id="-1509277031#q781fm_372">The following command is used to read the current state of the &quot;on/off&quot; attribute from the target device:</p><div class="detached code-block" id="-1509277031#q781fm_373"><pre><code class="language-bash">./chip-tool onoff read on-off 0x1122 1</code></pre></div><p id="-1509277031#q781fm_374">In this command:</p><ul class="list" id="-1509277031#q781fm_375" start="1"><li class="list-item" id="-1509277031#q781fm_378"><p id="-1509277031#q781fm_383"><span class="inline-code" id="-1509277031#q781fm_384">onoff</span> is the cluster for controlling the power state.</p></li><li class="list-item" id="-1509277031#q781fm_379"><p id="-1509277031#q781fm_385"><span class="inline-code" id="-1509277031#q781fm_386">read</span> is a request to retrieve the current state.</p></li><li class="list-item" id="-1509277031#q781fm_380"><p id="-1509277031#q781fm_387"><span class="inline-code" id="-1509277031#q781fm_388">on-off</span> is the specific attribute being queried.</p></li><li class="list-item" id="-1509277031#q781fm_381"><p id="-1509277031#q781fm_389"><span class="inline-code" id="-1509277031#q781fm_390">0x1122</span> is the hexadecimal node ID of the device.</p></li><li class="list-item" id="-1509277031#q781fm_382"><p id="-1509277031#q781fm_391"><span class="inline-code" id="-1509277031#q781fm_392">1</span> is the endpoint number on the target device.</p></li></ul><p id="-1509277031#q781fm_376">Similarly, the command below reads the measurement value from the temperature sensor:</p><div class="detached code-block" id="-1509277031#q781fm_377"><pre><code class="language-bash">./chip-tool temperaturemeasurement read measured-value 0x1122 1</code></pre></div></section><section class="detached"><h2 id="-1509277031#sending-commands-to-device" data-toc="sending-commands-to-device#CHIP-Tool.md-sending-commands-to-device">Sending Commands to Device</h2><p id="-1509277031#q781fm_393">The following command is used to turn on and toggle the device:</p><div class="detached code-block" id="-1509277031#q781fm_394"><pre><code class="language-bash">./chip-tool onoff on 0x1122 1
./chip-tool onoff toggle 0x1122 1</code></pre></div></section><section class="detached"><h2 id="-1509277031#subscribing-to-attributes-and-events" data-toc="subscribing-to-attributes-and-events#CHIP-Tool.md-subscribing-to-attributes-and-events">Subscribing to Attributes and Events</h2><p id="-1509277031#q781fm_395">This section describes how to subscribe to attributes and events in a Matter device using CHIP-Tool.</p><section class="detached"><h3 id="-1509277031#subscribing-to-attributes" data-toc="subscribing-to-attributes#CHIP-Tool.md-subscribing-to-attributes">Subscribing to Attributes</h3><p id="-1509277031#q781fm_398">Display all the attributes available for subscription in a given cluster:</p><div class="detached code-block" id="-1509277031#q781fm_399"><pre><code class="language-bash">./chip-tool &lt;cluster-name&gt; subscribe</code></pre></div><p id="-1509277031#q781fm_400">Subscribe to an attribute:</p><div class="detached code-block" id="-1509277031#q781fm_401"><pre><code class="language-bash">./chip-tool &lt;cluster-name&gt; subscribe &lt;argument&gt; &lt;min-interval&gt; &lt;max-interval&gt; &lt;node_id&gt; &lt;endpoint_id&gt;</code></pre></div><p id="-1509277031#q781fm_402">In this command:</p><ul class="list" id="-1509277031#q781fm_403" start="1"><li class="list-item" id="-1509277031#q781fm_406"><p id="-1509277031#q781fm_412"><span class="control" id="-1509277031#q781fm_413">cluster-name</span> is the name of the cluster.</p></li><li class="list-item" id="-1509277031#q781fm_407"><p id="-1509277031#q781fm_414"><span class="control" id="-1509277031#q781fm_415">argument</span> is the name of the chosen argument.</p></li><li class="list-item" id="-1509277031#q781fm_408"><p id="-1509277031#q781fm_416"><span class="control" id="-1509277031#q781fm_417">min-interval</span> specifies the minimum number of seconds that must elapse since the last report for the server to send a new report.</p></li><li class="list-item" id="-1509277031#q781fm_409"><p id="-1509277031#q781fm_418"><span class="control" id="-1509277031#q781fm_419">max-interval</span> specifies the number of seconds that must elapse since the last report for the server to send a new report.</p></li><li class="list-item" id="-1509277031#q781fm_410"><p id="-1509277031#q781fm_420"><span class="control" id="-1509277031#q781fm_421">node-id</span> is the user-defined ID of the commissioned node.</p></li><li class="list-item" id="-1509277031#q781fm_411"><p id="-1509277031#q781fm_422"><span class="control" id="-1509277031#q781fm_423">endpoint_id</span> is the ID of the endpoint where the chosen cluster is implemented.</p></li></ul><p id="-1509277031#q781fm_404">For example:</p><div class="detached code-block" id="-1509277031#q781fm_405"><pre><code class="language-bash">./chip-tool doorlock subscribe lock-state 5 10 1 1
./chip-tool temperaturemeasurement subscribe measured-value 3 10 1 1
./chip-tool relativehumiditymeasurement subscribe measured-value 3 10 1 2
./chip-tool occupancysensing subscribe occupancy 3 10 1 3</code></pre></div></section><section class="detached"><h3 id="-1509277031#subscribing-to-events" data-toc="subscribing-to-events#CHIP-Tool.md-subscribing-to-events">Subscribing to Events</h3><p id="-1509277031#q781fm_424">Display all the events available for subscription in a given cluster:</p><div class="detached code-block" id="-1509277031#q781fm_425"><pre><code class="language-bash">./chip-tool &lt;cluster-name&gt; subscribe-event</code></pre></div><p id="-1509277031#q781fm_426">Subscribe to an event:</p><div class="detached code-block" id="-1509277031#q781fm_427"><pre><code class="language-bash">./chip-tool &lt;cluster-name&gt; subscribe-event &lt;event-name&gt; &lt;min-interval&gt; &lt;max-interval&gt; &lt;node_id&gt; &lt;endpoint_id&gt;</code></pre></div><p id="-1509277031#q781fm_428">In this command:</p><ul class="list" id="-1509277031#q781fm_429" start="1"><li class="list-item" id="-1509277031#q781fm_432"><p id="-1509277031#q781fm_438"><span class="control" id="-1509277031#q781fm_439">cluster-name</span> is the name of the cluster.</p></li><li class="list-item" id="-1509277031#q781fm_433"><p id="-1509277031#q781fm_440"><span class="control" id="-1509277031#q781fm_441">event-name</span> is the name of the chosen event.</p></li><li class="list-item" id="-1509277031#q781fm_434"><p id="-1509277031#q781fm_442"><span class="control" id="-1509277031#q781fm_443">min-interval</span> specifies the minimum number of seconds that must elapse since the last report for the server to send a new report.</p></li><li class="list-item" id="-1509277031#q781fm_435"><p id="-1509277031#q781fm_444"><span class="control" id="-1509277031#q781fm_445">max-interval</span> specifies the number of seconds that must elapse since the last report for the server to send a new report.</p></li><li class="list-item" id="-1509277031#q781fm_436"><p id="-1509277031#q781fm_446"><span class="control" id="-1509277031#q781fm_447">node_id</span> is the user-defined ID of the commissioned node.</p></li><li class="list-item" id="-1509277031#q781fm_437"><p id="-1509277031#q781fm_448"><span class="control" id="-1509277031#q781fm_449">endpoint_id</span> is the ID of the endpoint where the chosen cluster is implemented.</p></li></ul><p id="-1509277031#q781fm_430">For example:</p><div class="detached code-block" id="-1509277031#q781fm_431"><pre><code class="language-bash">./chip-tool doorlock subscribe-event door-lock-alarm 5 10 1 1</code></pre></div></section></section><section class="detached"><h2 id="-1509277031#references" data-toc="references#CHIP-Tool.md-references">References</h2><ul class="list" id="-1509277031#q781fm_450" start="1"><li class="list-item" id="-1509277031#q781fm_451"><p id="-1509277031#q781fm_456">How to Install Matter on RPi (<a href="https://mattercoder.com/codelabs/how-to-install-matter-on-rpi/">https://mattercoder.com/codelabs/how-to-install-matter-on-rpi/</a>)</p></li><li class="list-item" id="-1509277031#q781fm_452"><p id="-1509277031#q781fm_458">Setting up the Matter Hub (Raspberry Pi) (<a href="https://docs.silabs.com/matter/latest/matter-thread/raspi-img">https://docs.silabs.com/matter/latest/matter-thread/raspi-img</a>)</p></li><li class="list-item" id="-1509277031#q781fm_453"><p id="-1509277031#q781fm_460">CHIP-Tool - Commissioning Device over BLE (<a href="https://github.com/project-chip/connectedhomeip/blob/master/examples/chip-tool/README.md#commission-a-device-over-ble">https://github.com/project-chip/connectedhomeip/blob/master/examples/chip-tool/README.md#commission-a-device-over-ble</a>)</p></li><li class="list-item" id="-1509277031#q781fm_454"><p id="-1509277031#q781fm_462">CHIP-tool Source Code (<a href="https://github.com/project-chip/connectedhomeip/tree/master/examples/chip-tool">https://github.com/project-chip/connectedhomeip/tree/master/examples/chip-tool</a>)</p></li><li class="list-item" id="-1509277031#q781fm_455"><p id="-1509277031#q781fm_464">Silicone Labs' Matter Commissioning Guide (<a href="https://docs.silabs.com/matter/2.2.1/matter-overview-guides/matter-commissioning">https://docs.silabs.com/matter/2.2.1/matter-overview-guides/matter-commissioning</a>)</p></li></ul></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="1823421053">ESP Matter Controller</h1><section class="detached"><h2 id="1823421053#overview" data-toc="overview#ESP-Matter-Controller.md-overview">Overview</h2><p id="1823421053#-wv5n36_8">This section demonstrates how to build and run the <span class="control" id="1823421053#-wv5n36_11">ESP Matter Controller Example</span> from the <span class="control" id="1823421053#-wv5n36_15">ESP-Matter SDK</span> (<a href="#-1918844910#esp-matter-solution">&quot;ESP Matter Solution&quot; in &quot;Espressif&quot;</a>) on <span class="control" id="1823421053#-wv5n36_16">ESP Thread Border Router</span> (<a href="#-1918844910#hardware">&quot;Hardware&quot; in &quot;Espressif&quot;</a>) board. See also Matter Controller implementation on <span class="control" id="1823421053#-wv5n36_17">ESP32-C6</span> (<a href="https://github.com/albert-gee/esp_matter_controller">https://github.com/albert-gee/esp_matter_controller</a>).</p><p id="1823421053#-wv5n36_9">This Matter Controllers implementation supports the following features:</p><ul class="list" id="1823421053#-wv5n36_10" start="1"><li class="list-item" id="1823421053#-wv5n36_18"><p id="1823421053#-wv5n36_28">BLE-WiFi pairing</p></li><li class="list-item" id="1823421053#-wv5n36_19"><p id="1823421053#-wv5n36_29">BLE-Thread pairing</p></li><li class="list-item" id="1823421053#-wv5n36_20"><p id="1823421053#-wv5n36_30">On-network pairing</p></li><li class="list-item" id="1823421053#-wv5n36_21"><p id="1823421053#-wv5n36_31">Invoke cluster commands</p></li><li class="list-item" id="1823421053#-wv5n36_22"><p id="1823421053#-wv5n36_32">Read attributes commands</p></li><li class="list-item" id="1823421053#-wv5n36_23"><p id="1823421053#-wv5n36_33">Read events commands</p></li><li class="list-item" id="1823421053#-wv5n36_24"><p id="1823421053#-wv5n36_34">Write attributes commands</p></li><li class="list-item" id="1823421053#-wv5n36_25"><p id="1823421053#-wv5n36_35">Subscribe attributes commands</p></li><li class="list-item" id="1823421053#-wv5n36_26"><p id="1823421053#-wv5n36_36">Subscribe events commands</p></li><li class="list-item" id="1823421053#-wv5n36_27"><p id="1823421053#-wv5n36_37">Group settings command.</p></li></ul></section><section class="detached"><h2 id="1823421053#build-and-run" data-toc="build-and-run#ESP-Matter-Controller.md-build-and-run">Build and Run</h2><p id="1823421053#-wv5n36_38">Prerequisites:</p><ul class="list" id="1823421053#-wv5n36_39" start="1"><li class="list-item" id="1823421053#-wv5n36_46"><p id="1823421053#-wv5n36_49">ESP-IDF development environment (<a href="#-400735760">ESP-IDF Setup</a>) is set up.</p></li><li class="list-item" id="1823421053#-wv5n36_47"><p id="1823421053#-wv5n36_51">ESP-Matter development environment (<a href="#-401349892">ESP-Matter Setup</a>) is set up.</p></li><li class="list-item" id="1823421053#-wv5n36_48"><p id="1823421053#-wv5n36_53">ESP Thread Border Router (<a href="#-1918844910#hardware">&quot;Hardware&quot; in &quot;Espressif&quot;</a>) board is available.</p></li></ul><section class="detached"><h3 id="1823421053#step-1-set-up-environment" data-toc="step-1-set-up-environment#ESP-Matter-Controller.md-step-1-set-up-environment">Step 1: Set Up Environment</h3><p id="1823421053#-wv5n36_55">Set up the environment and navigate to the <span class="inline-code" id="1823421053#-wv5n36_57">ESP Matter Thread Border Router</span> example directory:</p><div class="detached code-block" id="1823421053#-wv5n36_56"><pre><code class="language-bash">get_idf
get_matter</code></pre></div></section><section class="detached"><h3 id="1823421053#step-2-open-matter-controller-example" data-toc="step-2-open-matter-controller-example#ESP-Matter-Controller.md-step-2-open-matter-controller-example">Step 2: Open Matter Controller Example</h3><p id="1823421053#-wv5n36_58">Navigate to the <span class="inline-code" id="1823421053#-wv5n36_60">Matter Controller</span> examples directory:</p><div class="detached code-block" id="1823421053#-wv5n36_59"><pre><code class="language-bash">cd $ESP_MATTER_PATH/examples/controller</code></pre></div></section><section class="detached"><h3 id="1823421053#step-3-set-the-target-device" data-toc="step-3-set-the-target-device#ESP-Matter-Controller.md-step-3-set-the-target-device">Step 3: Set the target device</h3><p id="1823421053#-wv5n36_61">Set the target device to <span class="control" id="1823421053#-wv5n36_63">esp32s3</span> for Thread Border Router since it uses the ESP32-S3 chip:</p><div class="detached code-block" id="1823421053#-wv5n36_62"><pre><code class="language-bash">idf.py -D SDKCONFIG_DEFAULTS=&quot;sdkconfig.defaults.otbr&quot; set-target esp32s3</code></pre></div></section><section class="detached"><h3 id="1823421053#step-4-edit-project-s-cmakelists-txt" data-toc="step-4-edit-project-s-cmakelists-txt#ESP-Matter-Controller.md-step-4-edit-project-s-cmakelists-txt">Step 4: Edit Project's CMakeLists.txt</h3><div class="detached code-block" id="1823421053#-wv5n36_64"><pre><code class="language-bash">nano CMakeLists.txt</code></pre></div><p id="1823421053#-wv5n36_65">The following changes have to be made to the <span class="inline-code" id="1823421053#-wv5n36_67">CMakeLists.txt</span> file:</p><div class="detached code-block" id="1823421053#-wv5n36_66"><pre><code class="language-cmake"># Cut this part and paste it before the `if(NOT DEFINED ENV{ESP_MATTER_DEVICE_PATH})` block:
set(ESP_MATTER_PATH $ENV{ESP_MATTER_PATH})
set(MATTER_SDK_PATH ${ESP_MATTER_PATH}/connectedhomeip/connectedhomeip)
set(ENV{PATH} &quot;$ENV{PATH}:${ESP_MATTER_PATH}/connectedhomeip/connectedhomeip/.environment/cipd/packages/pigweed&quot;)</code></pre></div></section><section class="detached"><h3 id="1823421053#step-5-connect-to-computer" data-toc="step-5-connect-to-computer#ESP-Matter-Controller.md-step-5-connect-to-computer">Step 5: Connect to Computer</h3><p id="1823421053#-wv5n36_68">Connect the board to the computer using a USB cable.</p><p id="1823421053#-wv5n36_69">The <span class="control" id="1823421053#-wv5n36_70">ESP Thread Border Router</span> board should be connected using USB-2.</p></section><section class="detached"><h3 id="1823421053#step-6-build-and-flash" data-toc="step-6-build-and-flash#ESP-Matter-Controller.md-step-6-build-and-flash">Step 6: Build and Flash</h3><div class="detached code-block" id="1823421053#-wv5n36_71"><pre><code class="language-bash">idf.py build
idf.py -p &lt;PORT&gt; erase-flash flash monitor</code></pre></div></section></section><section class="detached"><h2 id="1823421053#testing" data-toc="testing#ESP-Matter-Controller.md-testing">Testing</h2><section class="detached"><h3 id="1823421053#wi-fi-management" data-toc="wi-fi-management#ESP-Matter-Controller.md-wi-fi-management">Wi-Fi Management</h3><section class="detached"><h4 id="1823421053#connect-to-wi-fi" data-toc="connect-to-wi-fi#ESP-Matter-Controller.md-connect-to-wi-fi">Connect to Wi-Fi</h4><div class="detached code-block" id="1823421053#-wv5n36_78"><pre><code class="language-bash">matter esp wifi connect &lt;SSID&gt; &lt;PASSWORD&gt;

# Example: Connect to Wi-Fi with SSID &quot;MyWiFi&quot; and password &quot;MyPass&quot;
matter esp wifi connect MyWiFi MyPass</code></pre></div></section></section><section class="detached"><h3 id="1823421053#thread-cli" data-toc="thread-cli#ESP-Matter-Controller.md-thread-cli">Thread CLI</h3><p id="1823421053#-wv5n36_79">See also ESP OpenThread CLI Usage (<a href="#-1412866926#usage">&quot;Usage&quot; in &quot;ESP OpenThread CLI&quot;</a>) for more Thread commands.</p><section class="detached"><h4 id="1823421053#initialize-and-commit-thread-dataset" data-toc="initialize-and-commit-thread-dataset#ESP-Matter-Controller.md-initialize-and-commit-thread-dataset">Initialize and Commit Thread Dataset</h4><div class="detached code-block" id="1823421053#-wv5n36_83"><pre><code class="language-bash">matter esp ot_cli dataset init new
matter esp ot_cli dataset commit active</code></pre></div></section><section class="detached"><h4 id="1823421053#start-thread-network" data-toc="start-thread-network#ESP-Matter-Controller.md-start-thread-network">Start Thread Network</h4><div class="detached code-block" id="1823421053#-wv5n36_84"><pre><code class="language-bash">matter esp ot_cli ifconfig up
matter esp ot_cli thread start</code></pre></div></section></section><section class="detached"><h3 id="1823421053#commissioning-matter-devices" data-toc="commissioning-matter-devices#ESP-Matter-Controller.md-commissioning-matter-devices">Commissioning Matter Devices</h3><section class="detached"><h4 id="1823421053#ble-wi-fi-commissioning" data-toc="ble-wi-fi-commissioning#ESP-Matter-Controller.md-ble-wi-fi-commissioning">BLE-Wi-Fi Commissioning</h4><p id="1823421053#-wv5n36_87">Commission a Matter device using BLE and Wi-Fi:</p><div class="detached code-block" id="1823421053#-wv5n36_88"><pre><code class="language-bash">matter esp controller pairing ble-wifi &lt;NODE_ID&gt; &lt;WIFI_SSID&gt; &lt;WIFI_PASSWORD&gt; &lt;PIN_CODE&gt; &lt;DISCRIMINATOR&gt;

Example: Pair a device over BLE Wi-Fi with SSID &quot;MyWiFi&quot; and password &quot;MyPass&quot;
matter esp controller pairing ble-wifi 0x1122 MyWiFi MyPass 20202021 3840</code></pre></div></section><section class="detached"><h4 id="1823421053#ble-thread-commissioning" data-toc="ble-thread-commissioning#ESP-Matter-Controller.md-ble-thread-commissioning">BLE-Thread Commissioning</h4><p id="1823421053#-wv5n36_89">Pair a Matter device using BLE and Thread:</p><div class="detached code-block" id="1823421053#-wv5n36_90"><pre><code class="language-bash">matter esp controller pairing ble-thread &lt;NODE_ID&gt; &lt;THREAD_DATASET&gt; &lt;PIN_CODE&gt; &lt;DISCRIMINATOR&gt;

# Example: Pair a device over BLE Thread with a dataset string
matter esp controller pairing ble-thread 0x1122 &lt;DATASET&gt; 20202021 3840</code></pre></div></section></section><section class="detached"><h3 id="1823421053#reading-attributes" data-toc="reading-attributes#ESP-Matter-Controller.md-reading-attributes">Reading Attributes</h3><p id="1823421053#-wv5n36_91">Read a specific attribute from a cluster on a Matter device:</p><div class="detached code-block" id="1823421053#-wv5n36_92"><pre><code class="language-bash">matter esp controller read-attr &lt;NODE_ID&gt; &lt;ENDPOINT&gt; &lt;CLUSTER_ID&gt; &lt;ATTRIBUTE_ID&gt;</code></pre></div><section class="detached"><h4 id="1823421053#root-node-clusters" data-toc="root-node-clusters#ESP-Matter-Controller.md-root-node-clusters">Root Node Clusters</h4><p id="1823421053#-wv5n36_99">The root node (Endpoint 0) has the following clusters:</p><ul class="list" id="1823421053#-wv5n36_100" start="1"><li class="list-item" id="1823421053#-wv5n36_102"><p id="1823421053#-wv5n36_109">Basic Information (0x0028)</p></li><li class="list-item" id="1823421053#-wv5n36_103"><p id="1823421053#-wv5n36_110">General Commissioning (0x0030)</p></li><li class="list-item" id="1823421053#-wv5n36_104"><p id="1823421053#-wv5n36_111">Network Commissioning (0x0031)</p></li><li class="list-item" id="1823421053#-wv5n36_105"><p id="1823421053#-wv5n36_112">General Diagnostics (0x0033)</p></li><li class="list-item" id="1823421053#-wv5n36_106"><p id="1823421053#-wv5n36_113">Administrator Commissioning (0x003C)</p></li><li class="list-item" id="1823421053#-wv5n36_107"><p id="1823421053#-wv5n36_114">Operational Credentials (0x003E)</p></li><li class="list-item" id="1823421053#-wv5n36_108"><p id="1823421053#-wv5n36_115">Group Key Management (0x003F)</p></li></ul><div class="detached code-block" id="1823421053#-wv5n36_101"><pre><code class="language-bash"># Example: BASIC INFORMATION CLUSTER (0x0028)
## VendorName
matter esp controller read-attr 0x1122 0 0x0028 1
## VendorID
matter esp controller read-attr 0x1122 0 0x0028 2
## ProductName
matter esp controller read-attr 0x1122 0 0x0028 3
## ProductID
matter esp controller read-attr 0x1122 0 0x0028 4

# Example: GENERAL DIAGNOSTICS CLUSTER (0x0033)
## NetworkInterfaces
matter esp controller read-attr 0x1122 0 0x0033 0
## RebootCount
matter esp controller read-attr 0x1122 0 0x0033 1
## UpTime
matter esp controller read-attr 0x1122 0 0x0033 2

# Example: NODE OPERATIONAL CREDENTIALS CLUSTER (0x003D)
## NOCs
matter esp controller read-attr 0x1122 0 0x003E 0
## Fabrics
matter esp controller read-attr 0x1122 0 0x003E 1
## SupportedFabrics
matter esp controller read-attr 0x1122 0 0x003E 2
## CommissionedFabrics
matter esp controller read-attr 0x1122 0 0x003E 3
## TrustedRootCertificates
matter esp controller read-attr 0x1122 0 0x003E 4
## CurrentFabricIndex
matter esp controller read-attr 0x1122 0 0x003E 5</code></pre></div></section><section class="detached"><h4 id="1823421053#on-off-cluster" data-toc="on-off-cluster#ESP-Matter-Controller.md-on-off-cluster">On/Off Cluster</h4><p id="1823421053#-wv5n36_116">On/Off cluster (0x6).</p><div class="detached code-block" id="1823421053#-wv5n36_117"><pre><code class="language-bash"># Example: OnOff attribute (0x0) from the On/Off cluster (0x6)
matter esp controller read-attr 0x1122 0x1 0x6 0x0</code></pre></div></section><section class="detached"><h4 id="1823421053#temperature-measurement-cluster" data-toc="temperature-measurement-cluster#ESP-Matter-Controller.md-temperature-measurement-cluster">Temperature Measurement Cluster</h4><p id="1823421053#-wv5n36_118">Temperature Measurement cluster (0x0402).</p><div class="detached code-block" id="1823421053#-wv5n36_119"><pre><code class="language-bash">## Example: Read Temperature Measurement's measured value
matter esp controller read-attr 0x1122 1 0x0402 0x0000
## Example: Read Temperature Measurement's min measured value
matter esp controller read-attr 0x1122 1 0x0402 0x0001
## Example: Read Temperature Measurement's max measured value
matter esp controller read-attr 0x1122 1 0x0402 0x0002</code></pre></div></section><section class="detached"><h4 id="1823421053#pressure-measurement-cluster" data-toc="pressure-measurement-cluster#ESP-Matter-Controller.md-pressure-measurement-cluster">Pressure Measurement Cluster</h4><p id="1823421053#-wv5n36_120">Pressure Measurement cluster (0x0403).</p><div class="detached code-block" id="1823421053#-wv5n36_121"><pre><code class="language-bash">## Example: Read Pressure Measurement's measured value
matter esp controller read-attr 0x1122 1 0x0403 0x0000
## Example: Read Pressure Measurement's min measured value
matter esp controller read-attr 0x1122 1 0x0403 0x0001
## Example: Read Pressure Measurement's max measured value
matter esp controller read-attr 0x1122 1 0x0403 0x0002</code></pre></div></section><section class="detached"><h4 id="1823421053#thread-border-router-management-cluster" data-toc="thread-border-router-management-cluster#ESP-Matter-Controller.md-thread-border-router-management-cluster">Thread Border Router Management Cluster</h4><p id="1823421053#-wv5n36_122">Thread Border Router Management cluster (0x0452).</p><div class="detached code-block" id="1823421053#-wv5n36_123"><pre><code class="language-bash">## Example: Read Thread Border Router's name
matter esp controller read-attr 0x1122 1 0x0452 0x0000
## Example: Read Thread Border Router's vendor
matter esp controller read-attr 0x1122 1 0x0452 0x0001</code></pre></div></section><section class="detached"><h4 id="1823421053#access-control-cluster" data-toc="access-control-cluster#ESP-Matter-Controller.md-access-control-cluster">Access Control Cluster</h4><p id="1823421053#-wv5n36_124">Access Control (<a href="#-2077639180">Access Control</a>) cluster (0x001F).</p><div class="detached code-block" id="1823421053#-wv5n36_125"><pre><code class="language-bash">matter esp controller read-attr 0x1122 0 0x001F 0x0000</code></pre></div></section></section><section class="detached"><h3 id="1823421053#invoking-cluster-commands" data-toc="invoking-cluster-commands#ESP-Matter-Controller.md-invoking-cluster-commands">Invoking Cluster Commands</h3><p id="1823421053#-wv5n36_127">Invoke a command on a Matter device:</p><div class="detached code-block" id="1823421053#-wv5n36_128"><pre><code class="language-bash">matter esp controller invoke-cmd &lt;NODE_ID&gt; &lt;ENDPOINT&gt; &lt;CLUSTER_ID&gt; &lt;COMMAND_ID&gt; {}</code></pre></div><section class="detached"><h4 id="1823421053#on-off-cluster-commands" data-toc="on-off-cluster-commands#ESP-Matter-Controller.md-on-off-cluster-commands">On/Off Cluster Commands</h4><div class="detached code-block" id="1823421053#-wv5n36_130"><pre><code class="language-bash"># Example: Turn on a light (cluster 0x6, command 0x1) on node 0x1122 at endpoint 0x1
matter esp controller invoke-cmd 0x1122 0x1 0x6 0x1 {}</code></pre></div></section></section></section><section class="detached"><h2 id="1823421053#references" data-toc="references#ESP-Matter-Controller.md-references">References</h2><ul class="list" id="1823421053#-wv5n36_131" start="1"><li class="list-item" id="1823421053#-wv5n36_132"><p id="1823421053#-wv5n36_133">ESP-Matter Controller Example (<a href="https://github.com/espressif/esp-matter/tree/main/examples/controller">https://github.com/espressif/esp-matter/tree/main/examples/controller</a>)</p></li></ul></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-309902166">Orchestrator</h1><section class="detached"><h2 id="-309902166#overview" data-toc="overview#Orchestrator.md-overview">Overview</h2><p id="-309902166#wnqlid_7">This chapter describes the development of the <span class="control" id="-309902166#wnqlid_11">Orchestrator</span> device which facilitates system automation through the following processes:</p><ul class="list" id="-309902166#wnqlid_8" start="1"><li class="list-item" id="-309902166#wnqlid_12"><p id="-309902166#wnqlid_15">Establishing network infrastructure by creating and managing Thread (<a href="#-1790576086">Thread</a>) networks and Matter (<a href="#-1997370655">Matter</a>) Fabrics.</p></li><li class="list-item" id="-309902166#wnqlid_13"><p id="-309902166#wnqlid_18">Commissioning devices to join Matter fabrics (<a href="#279346443">Matter Commissioning</a>) and Thread networks (<a href="#-1790576086#commissioning">&quot;Commissioning&quot; in &quot;Thread&quot;</a>)</p></li><li class="list-item" id="-309902166#wnqlid_14"><p id="-309902166#wnqlid_21">Monitoring sensor data from the Grow Chamber and adjusting actuators in real time.</p></li></ul><p id="-309902166#wnqlid_9">Prerequisites:</p><ul class="list" id="-309902166#wnqlid_10" start="1"><li class="list-item" id="-309902166#wnqlid_22"><p id="-309902166#wnqlid_25">ESP-IDF development environment (<a href="#-400735760">ESP-IDF Setup</a>) is set up.</p></li><li class="list-item" id="-309902166#wnqlid_23"><p id="-309902166#wnqlid_27">ESP-Matter development environment (<a href="#-401349892">ESP-Matter Setup</a>) is set up.</p></li><li class="list-item" id="-309902166#wnqlid_24"><p id="-309902166#wnqlid_29">ESP Thread Border Router (<a href="#-1918844910#hardware">&quot;Hardware&quot; in &quot;Espressif&quot;</a>) board is available.</p></li></ul></section><section class="detached"><h2 id="-309902166#development" data-toc="development#Orchestrator.md-development">Development</h2><section class="detached"><h3 id="-309902166#project-bootstrap" data-toc="project-bootstrap#Orchestrator.md-project-bootstrap">Project Bootstrap</h3><p id="-309902166#wnqlid_33">The following steps from the ESP32 Project Workflow (<a href="#-586960577">ESP32 Project Workflow</a>) guide are required to set up the project:</p><ul class="list" id="-309902166#wnqlid_34" start="1"><li class="list-item" id="-309902166#wnqlid_36"><p id="-309902166#wnqlid_43">**Step 1: Set Up ESP-IDF and ESP-Matter Environment ** (<a href="#-586960577#step-1-set-up-esp-idf-and-esp-matter-environment">&quot;Step 1: Set Up ESP-IDF and ESP-Matter Environment&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li><li class="list-item" id="-309902166#wnqlid_37"><p id="-309902166#wnqlid_45"><span class="control" id="-309902166#wnqlid_48">Step 2: Create a New Project</span> (<a href="#-586960577#step-2-create-a-new-project">&quot;Step 2: Create a New Project&quot; in &quot;ESP32 Project Workflow&quot;</a>) named <span class="inline-code" id="-309902166#wnqlid_47">orchestrator</span></p></li><li class="list-item" id="-309902166#wnqlid_38"><p id="-309902166#wnqlid_49"><span class="control" id="-309902166#wnqlid_51">Step 3: Configure Build Process</span> by updating the <span class="inline-code" id="-309902166#wnqlid_52">CMakeLists.txt</span>. It should include the following:</p><ul class="list" id="-309902166#wnqlid_50" start="1"><li class="list-item" id="-309902166#wnqlid_53"><p id="-309902166#wnqlid_57"><span class="control" id="-309902166#wnqlid_58">ESP_MATTER_PATH</span> and <span class="control" id="-309902166#wnqlid_59">MATTER_SDK_PATH</span> environment variables integrate ESP-Matter and Matter SDK.</p></li><li class="list-item" id="-309902166#wnqlid_54"><p id="-309902166#wnqlid_60"><span class="control" id="-309902166#wnqlid_61">ESP_MATTER_DEVICE_PATH</span> points to the correct hardware HAL.</p></li><li class="list-item" id="-309902166#wnqlid_55"><p id="-309902166#wnqlid_62"><span class="control" id="-309902166#wnqlid_63">EXTRA_COMPONENT_DIRS</span> includes component directories for ESP-Matter, SDK, and device HAL.</p></li><li class="list-item" id="-309902166#wnqlid_56"><p id="-309902166#wnqlid_64"><span class="control" id="-309902166#wnqlid_65">Compiler flags</span> that add C++17, optimizations, Matter defines, disable Thread driver, and suppress RISCV warnings.</p></li></ul></li><li class="list-item" id="-309902166#wnqlid_39"><p id="-309902166#wnqlid_66"><span class="control" id="-309902166#wnqlid_69">Step 4: Create custom partition table</span>:</p><p id="-309902166#wnqlid_67"><span class="inline-code" id="-309902166#wnqlid_70">CONFIG_PARTITION_TABLE_CUSTOM=y</span> and <span class="inline-code" id="-309902166#wnqlid_71">CONFIG_PARTITION_TABLE_CUSTOM_FILENAME=&quot;partitions.csv&quot;</span> in <span class="inline-code" id="-309902166#wnqlid_72">sdkconfig.defaults</span> enable a custom partition table defined in <span class="inline-code" id="-309902166#wnqlid_73">partitions.csv</span>:</p><ul class="list" id="-309902166#wnqlid_68" start="1"><li class="list-item" id="-309902166#wnqlid_74"><p id="-309902166#wnqlid_78"><span class="inline-code" id="-309902166#wnqlid_79">nvs</span> (24 KB) stores persistent key-value data</p></li><li class="list-item" id="-309902166#wnqlid_75"><p id="-309902166#wnqlid_80"><span class="inline-code" id="-309902166#wnqlid_81">phy_init</span> (4 KB) holds PHY calibration settings</p></li><li class="list-item" id="-309902166#wnqlid_76"><p id="-309902166#wnqlid_82"><span class="inline-code" id="-309902166#wnqlid_83">factory</span> (3 MB) contains the main application firmware.</p></li><li class="list-item" id="-309902166#wnqlid_77"><p id="-309902166#wnqlid_84"><span class="inline-code" id="-309902166#wnqlid_85">rcp_fw</span> stores firmware updates for the Radio Co-Processor (RCP) (<a href="#-1790576086#architecture">&quot;Architecture&quot; in &quot;Thread&quot;</a>).</p></li></ul></li><li class="list-item" id="-309902166#wnqlid_40"><p id="-309902166#wnqlid_87"><span class="control" id="-309902166#wnqlid_90">Step 5: Configure Project</span></p><p id="-309902166#wnqlid_88">The <span class="inline-code" id="-309902166#wnqlid_91">sdkconfig.defaults</span> file is used to specify default configuration settings:</p><ul class="list" id="-309902166#wnqlid_89" start="1"><li class="list-item" id="-309902166#wnqlid_92"><p id="-309902166#wnqlid_103">Set Flash size to 8MB</p></li><li class="list-item" id="-309902166#wnqlid_93"><p id="-309902166#wnqlid_104">Enable Wi-Fi station mode only.</p></li><li class="list-item" id="-309902166#wnqlid_94"><p id="-309902166#wnqlid_105">Enable OpenThread with a Border Router.</p></li><li class="list-item" id="-309902166#wnqlid_95"><p id="-309902166#wnqlid_106">Configure IPv6 support for OpenThread (LwIP).</p></li><li class="list-item" id="-309902166#wnqlid_96"><p id="-309902166#wnqlid_107">Enable ESP32 BLE Controller.</p></li><li class="list-item" id="-309902166#wnqlid_97"><p id="-309902166#wnqlid_108">Enable Bluetooth with NimBLE stack.</p></li><li class="list-item" id="-309902166#wnqlid_98"><p id="-309902166#wnqlid_109">Use a custom partition table from <span class="inline-code" id="-309902166#wnqlid_110">partitions.csv</span>.</p></li><li class="list-item" id="-309902166#wnqlid_99"><p id="-309902166#wnqlid_111">Enable the CHIP shell for Matter.</p></li><li class="list-item" id="-309902166#wnqlid_100"><p id="-309902166#wnqlid_112">Enable Matter Controller, disable the server and commissioner features.</p></li><li class="list-item" id="-309902166#wnqlid_101"><p id="-309902166#wnqlid_113">Disable OTA Requestor and route hook.</p></li><li class="list-item" id="-309902166#wnqlid_102"><p id="-309902166#wnqlid_114">Enable WebSocket server support.</p></li></ul></li><li class="list-item" id="-309902166#wnqlid_41"><p id="-309902166#wnqlid_115"><span class="control" id="-309902166#wnqlid_118">Step 6: Set Target Device</span> (<a href="#-586960577#step-3-set-target-device">&quot;Step 3: Set Target Device&quot; in &quot;ESP32 Project Workflow&quot;</a>) to <span class="inline-code" id="-309902166#wnqlid_117">esp32s3</span> since ESP Thread Border Router board is used.</p></li><li class="list-item" id="-309902166#wnqlid_42"><p id="-309902166#wnqlid_119"><span class="control" id="-309902166#wnqlid_121">Step 7: Open the Project in CLion IDE</span> (<a href="#-586960577#step-4-open-the-project-in-clion-ide">&quot;Step 4: Open the Project in CLion IDE&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li></ul></section><section class="detached"><h3 id="-309902166#system-initialization" data-toc="system-initialization#Orchestrator.md-system-initialization">System Initialization</h3><p id="-309902166#wnqlid_122">The main function initializes the essential components:</p><ul class="list" id="-309902166#wnqlid_123" start="1"><li class="list-item" id="-309902166#wnqlid_126"><p id="-309902166#wnqlid_130"><span class="control" id="-309902166#wnqlid_132">ESP NVS</span> (<a href="https://docs.espressif.com/projects/esp-idf/en/stable/esp32/api-reference/storage/nvs_flash.html">https://docs.espressif.com/projects/esp-idf/en/stable/esp32/api-reference/storage/nvs_flash.html</a>) library stores key-value pairs in the device&rsquo;s flash memory.</p></li><li class="list-item" id="-309902166#wnqlid_127"><p id="-309902166#wnqlid_133">Matter Controller Interface (<a href="#1785010100">Matter Controller Interface</a>)</p></li><li class="list-item" id="-309902166#wnqlid_128"><p id="-309902166#wnqlid_135">Websocket Server (<a href="#771240009">Websocket Server</a>)</p></li><li class="list-item" id="-309902166#wnqlid_129"><p id="-309902166#wnqlid_137">Thread Interface (<a href="#-848609994">Thread Interface</a>)</p></li></ul><section class="detached"><h4 id="-309902166#netif-library" data-toc="netif-library#Orchestrator.md-netif-library">Netif Library</h4><p id="-309902166#wnqlid_139">The ESP-NETIF (<a href="https://docs.espressif.com/projects/esp-idf/en/stable/esp32/api-reference/network/esp_netif.html">https://docs.espressif.com/projects/esp-idf/en/stable/esp32/api-reference/network/esp_netif.html</a>) library is an abstraction layer that provides thread-safe APIs for managing network interfaces on top of a TCP/IP stack.</p></section><section class="detached"><h4 id="-309902166#event-loop-library" data-toc="event-loop-library#Orchestrator.md-event-loop-library">Event Loop Library</h4><p id="-309902166#wnqlid_141">The Event Loop Library (<a href="https://docs.espressif.com/projects/esp-idf/en/stable/esp32/api-reference/system/esp_event.html">https://docs.espressif.com/projects/esp-idf/en/stable/esp32/api-reference/system/esp_event.html</a>) lets components publish <span class="control" id="-309902166#wnqlid_143">events</span> indicating important occurrences, such as a successful Wi-Fi connection to the <span class="control" id="-309902166#wnqlid_144">event loop</span>, while other components can register handlers to respond. This decouples event producers from consumers, allowing components to react to state changes without direct application involvement.</p></section></section></section><section class="detached"><h2 id="-309902166#matter-start" data-toc="matter-start#Orchestrator.md-matter-start">Matter Start</h2><p id="-309902166#wnqlid_145">The start (<a href="https://github.com/espressif/esp-matter/blob/f9f62dd6851d93dd9c770f0ed0066e822f955c35/components/esp_matter/esp_matter_core.cpp#L849">https://github.com/espressif/esp-matter/blob/f9f62dd6851d93dd9c770f0ed0066e822f955c35/components/esp_matter/esp_matter_core.cpp#L849</a>) function in <span class="inline-code" id="-309902166#wnqlid_151">esp_matter_core.cpp</span> creates the <span class="control" id="-309902166#wnqlid_152">default event loop</span>, using esp_event_loop_create_default (<a href="https://github.com/espressif/esp-idf/blob/a45d713b03fd96d8805d1cc116f02a4415b360c7/components/esp_event/default_event_loop.c#L92">https://github.com/espressif/esp-idf/blob/a45d713b03fd96d8805d1cc116f02a4415b360c7/components/esp_event/default_event_loop.c#L92</a>). It is shared across other system components.</p><p id="-309902166#wnqlid_146">ESP-Netif is initialized during the initialization of the Matter stack in the ESP32-specific implementation (<a href="https://github.com/espressif/connectedhomeip/blob/9b8fffe0bb4e7ba7aac319f5905070a3476db7cb/src/platform/ESP32/PlatformManagerImpl.cpp#L73">https://github.com/espressif/connectedhomeip/blob/9b8fffe0bb4e7ba7aac319f5905070a3476db7cb/src/platform/ESP32/PlatformManagerImpl.cpp#L73</a>) of <span class="inline-code" id="-309902166#wnqlid_155">PlatformManager</span>, which manages the interaction between the application and platform-specific features.</p><p id="-309902166#wnqlid_147">The ConnectivityManagerImpl_WiFi (<a href="https://github.com/espressif/connectedhomeip/blob/9b8fffe0bb4e7ba7aac319f5905070a3476db7cb/src/platform/ESP32/ConnectivityManagerImpl_WiFi.cpp">https://github.com/espressif/connectedhomeip/blob/9b8fffe0bb4e7ba7aac319f5905070a3476db7cb/src/platform/ESP32/ConnectivityManagerImpl_WiFi.cpp</a>) implements an ESP32-specific WiFi connectivity manager for Matter</p><p id="-309902166#wnqlid_148">The <span class="inline-code" id="-309902166#wnqlid_157">event_callback_t callback</span> function is passed</p><section class="detached"><h3 id="-309902166#deployment" data-toc="deployment#Orchestrator.md-deployment">Deployment</h3><p id="-309902166#wnqlid_158">Follow the steps from the ESP32 Project Workflow (<a href="#-586960577">ESP32 Project Workflow</a>) guide:</p><ul class="list" id="-309902166#wnqlid_159" start="1"><li class="list-item" id="-309902166#wnqlid_161"><p id="-309902166#wnqlid_166"><span class="control" id="-309902166#wnqlid_168">Step 1: Build the Project</span> (<a href="#-586960577#step-7-build-the-project">&quot;Step 7: Build the Project&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li><li class="list-item" id="-309902166#wnqlid_162"><p id="-309902166#wnqlid_169">**Step 2: Connect ESP Thread Border Router board ** (<a href="#-1231632047#step-4-connect-the-esp-thread-border-router-board">&quot;Step 4: Connect the ESP Thread Border Router Board&quot; in &quot;ESP Basic Thread Border Router&quot;</a>)</p></li><li class="list-item" id="-309902166#wnqlid_163"><p id="-309902166#wnqlid_171"><span class="control" id="-309902166#wnqlid_173">Step 3: Determine Serial Port</span> (<a href="#-586960577#step-8-determine-serial-port">&quot;Step 8: Determine Serial Port&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li><li class="list-item" id="-309902166#wnqlid_164"><p id="-309902166#wnqlid_174"><span class="control" id="-309902166#wnqlid_176">Step 4: Flash Project to Target</span> (<a href="#-586960577#step-9-flash-project-to-target">&quot;Step 9: Flash Project to Target&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li><li class="list-item" id="-309902166#wnqlid_165"><p id="-309902166#wnqlid_177"><span class="control" id="-309902166#wnqlid_179">Step 5: Launch IDF Monitor</span> (<a href="#-586960577#step-10-launch-idf-monitor">&quot;Step 10: Launch IDF Monitor&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li></ul></section></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="1785010100">Matter Controller Interface</h1><section class="detached"><h2 id="1785010100#overview" data-toc="overview#Matter-Controller-Interface.md-overview">Overview</h2><p id="1785010100#tu4y4n_8">This component is part of the Orchestrator (<a href="#-309902166">Orchestrator</a>) firmware. It provides the following features:</p><ul class="list" id="1785010100#tu4y4n_9" start="1"><li class="list-item" id="1785010100#tu4y4n_11"><p id="1785010100#tu4y4n_17">Enables Matter CLI commands for Diagnostics, Wi-Fi connection, and factory reset</p></li><li class="list-item" id="1785010100#tu4y4n_12"><p id="1785010100#tu4y4n_18">Enables Matter Controller CLI commands (<a href="#1823421053#testing">&quot;Testing&quot; in &quot;ESP Matter Controller&quot;</a>)</p></li><li class="list-item" id="1785010100#tu4y4n_13"><p id="1785010100#tu4y4n_20">Enables OpenThread CLI commands (<a href="#-1412866926#usage">&quot;Usage&quot; in &quot;ESP OpenThread CLI&quot;</a>)</p></li><li class="list-item" id="1785010100#tu4y4n_14"><p id="1785010100#tu4y4n_22">Configures OpenThread Border Router.</p></li><li class="list-item" id="1785010100#tu4y4n_15"><p id="1785010100#tu4y4n_23">Uses <span class="inline-code" id="1785010100#tu4y4n_25">esp-matter</span> component to start Matter stack with event callback to handle network events. The <span class="inline-code" id="1785010100#tu4y4n_26">esp-matter</span> component also initializes important system components:</p><ul class="list" id="1785010100#tu4y4n_24" start="1"><li class="list-item" id="1785010100#tu4y4n_27"><p id="1785010100#tu4y4n_29">ESP-NETIF (<a href="https://docs.espressif.com/projects/esp-idf/en/stable/esp32/api-reference/network/esp_netif.html">https://docs.espressif.com/projects/esp-idf/en/stable/esp32/api-reference/network/esp_netif.html</a>) library is an abstraction layer that provides thread-safe APIs for managing network interfaces on top of a TCP/IP stack.</p></li><li class="list-item" id="1785010100#tu4y4n_28"><p id="1785010100#tu4y4n_31">ESP Event Loop (<a href="https://docs.espressif.com/projects/esp-idf/en/stable/esp32/api-reference/system/esp_event.html">https://docs.espressif.com/projects/esp-idf/en/stable/esp32/api-reference/system/esp_event.html</a>) allows components to declare events and register handlers, decoupling event producers from consumers. The event loop processes these events by invoking the appropriate handlers. The <span class="inline-code" id="1785010100#tu4y4n_33">default event loop</span> created by <span class="inline-code" id="1785010100#tu4y4n_34">esp_event_loop_create_default</span> is shared by multiple system components.</p></li></ul></li><li class="list-item" id="1785010100#tu4y4n_16"><p id="1785010100#tu4y4n_35">Uses <span class="inline-code" id="1785010100#tu4y4n_37">esp-matter-controller</span> component to enable Matter Controller and Matter Commissioner features ( see ESP-Matter Controller (<a href="#1823421053">ESP Matter Controller</a>) example):</p><ul class="list" id="1785010100#tu4y4n_36" start="1"><li class="list-item" id="1785010100#tu4y4n_39"><p id="1785010100#tu4y4n_49">BLE-WiFi pairing</p></li><li class="list-item" id="1785010100#tu4y4n_40"><p id="1785010100#tu4y4n_50">BLE-Thread pairing</p></li><li class="list-item" id="1785010100#tu4y4n_41"><p id="1785010100#tu4y4n_51">On-network pairing</p></li><li class="list-item" id="1785010100#tu4y4n_42"><p id="1785010100#tu4y4n_52">Invoke cluster commands</p></li><li class="list-item" id="1785010100#tu4y4n_43"><p id="1785010100#tu4y4n_53">Read attributes commands</p></li><li class="list-item" id="1785010100#tu4y4n_44"><p id="1785010100#tu4y4n_54">Read events commands</p></li><li class="list-item" id="1785010100#tu4y4n_45"><p id="1785010100#tu4y4n_55">Write attributes commands</p></li><li class="list-item" id="1785010100#tu4y4n_46"><p id="1785010100#tu4y4n_56">Subscribe attributes commands</p></li><li class="list-item" id="1785010100#tu4y4n_47"><p id="1785010100#tu4y4n_57">Subscribe events commands</p></li><li class="list-item" id="1785010100#tu4y4n_48"><p id="1785010100#tu4y4n_58">Group settings command.</p></li></ul></li></ul></section><section class="detached"><h2 id="1785010100#development" data-toc="development#Matter-Controller-Interface.md-development">Development</h2><p id="1785010100#tu4y4n_59">This section outlines the development of the <span class="control" id="1785010100#tu4y4n_63">Matter Interface</span> component, which provides the features and functions to commission (<a href="#279346443">Matter Commissioning</a>) and manage Matter (<a href="#-1997370655">Matter</a>) devices.</p><p id="1785010100#tu4y4n_60">Pre-requisites:</p><ul class="list" id="1785010100#tu4y4n_61" start="1"><li class="list-item" id="1785010100#tu4y4n_66"><p id="1785010100#tu4y4n_68">The steps in Project Bootstrap (<a href="#-309902166#project-bootstrap">&quot;Project Bootstrap&quot; in &quot;Orchestrator&quot;</a>) section are completed.</p></li><li class="list-item" id="1785010100#tu4y4n_67"><p id="1785010100#tu4y4n_70">System Initialization (<a href="#-309902166#system-initialization">&quot;System Initialization&quot; in &quot;Orchestrator&quot;</a>) is completed.</p></li></ul><section class="detached"><h3 id="1785010100#bootstrap-component" data-toc="bootstrap-component#Matter-Controller-Interface.md-bootstrap-component">Bootstrap Component</h3><p id="1785010100#tu4y4n_72">The command below creates a new component named <span class="inline-code" id="1785010100#tu4y4n_76">matter_controller_interface</span> inside the <span class="inline-code" id="1785010100#tu4y4n_77">components</span> directory.</p><div class="detached code-block" id="1785010100#tu4y4n_73"><pre><code class="language-bash">idf.py create-component matter_controller_interface -C components</code></pre></div><p id="1785010100#tu4y4n_74">Change the file extension of the <span class="inline-code" id="1785010100#tu4y4n_78">matter_controller_interface.c</span> file to <span class="inline-code" id="1785010100#tu4y4n_79">matter_controller_interface.cpp</span> and move it to the <span class="inline-code" id="1785010100#tu4y4n_80">src</span> folder.</p><div class="detached code-block" id="1785010100#tu4y4n_75"><pre><code class="language-bash">mv components/matter_controller_interface/matter_controller_interface.c components/matter_controller_interface/src/matter_controller_interface.cpp</code></pre></div></section></section><section class="detached"><h2 id="1785010100#reading" data-toc="reading#Matter-Controller-Interface.md-reading">Reading</h2><div class="detached code-block" id="1785010100#tu4y4n_81"><pre><code class="language-cpp">#include &quot;esp_matter_controller_read_command.h&quot;
#include &quot;esp_matter_client.h&quot;

void response_callback(const esp_matter::client::response_t *response, void *priv_data)
{
    // Process the response data
    if (response-&gt;status == ESP_OK) {
    // Handle successful response
    } else {
    // Handle error
    }
}

void client_request_callback(peer_device_t *peer_device, request_handle_t *req_handle, void *priv_data)
{
    if (req_handle-&gt;type == READ_ATTR) {
    esp_matter::client::interaction::read::send_request(peer_device, &amp;req_handle-&gt;attribute_path, 1, NULL, 0, response_callback);
    }
}

esp_matter::client::set_request_callback(client_request_callback, NULL);</code></pre></div></section><section class="detached"><h2 id="1785010100#references" data-toc="references#Matter-Controller-Interface.md-references">References</h2><ul class="list" id="1785010100#tu4y4n_82" start="1"><li class="list-item" id="1785010100#tu4y4n_83"><p id="1785010100#tu4y4n_87">ESP-Matter Controller Example (<a href="https://github.com/espressif/esp-matter/tree/main/examples/controller">https://github.com/espressif/esp-matter/tree/main/examples/controller</a>)</p></li><li class="list-item" id="1785010100#tu4y4n_84"><p id="1785010100#tu4y4n_89">ESP-Matter Controller Docs (<a href="https://docs.espressif.com/projects/esp-matter/en/latest/esp32/developing.html#matter-controller">https://docs.espressif.com/projects/esp-matter/en/latest/esp32/developing.html#matter-controller</a>)</p></li><li class="list-item" id="1785010100#tu4y4n_85"><p id="1785010100#tu4y4n_91">ESP-Matter Controller Component (<a href="https://github.com/espressif/esp-matter/tree/main/components/esp_matter_controller/commands">https://github.com/espressif/esp-matter/tree/main/components/esp_matter_controller/commands</a>)</p></li><li class="list-item" id="1785010100#tu4y4n_86"><p id="1785010100#tu4y4n_93">Espressif's SDK for Matter - Matter Controller (<a href="https://docs.espressif.com/projects/esp-matter/en/latest/esp32s3/developing.html#matter-controller">https://docs.espressif.com/projects/esp-matter/en/latest/esp32s3/developing.html#matter-controller</a>)</p></li></ul></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="771240009">Websocket Server</h1><section class="detached"><h2 id="771240009#overview" data-toc="overview#Websocket-Server.md-overview">Overview</h2><p id="771240009#-xq80ii_6">This section outlines the development of the <span class="control" id="771240009#-xq80ii_7">Websocket Server</span> component.</p></section><section class="detached"><h2 id="771240009#development" data-toc="development#Websocket-Server.md-development">Development</h2><p id="771240009#-xq80ii_8">The HTTP server component provides WebSocket support. The WebSocket feature can be enabled in menuconfig using the CONFIG_HTTPD_WS_SUPPORT option.</p><section class="detached"><h3 id="771240009#bootstrap-component" data-toc="bootstrap-component#Websocket-Server.md-bootstrap-component">Bootstrap Component</h3><p id="771240009#-xq80ii_11">The command below creates a new component named <span class="inline-code" id="771240009#-xq80ii_16">websocket_server</span> inside the <span class="inline-code" id="771240009#-xq80ii_17">components</span> directory.</p><div class="detached code-block" id="771240009#-xq80ii_12"><pre><code class="language-bash">idf.py create-component websocket_server -C components</code></pre></div><p id="771240009#-xq80ii_13">Change the file extension of the <span class="inline-code" id="771240009#-xq80ii_18">websocket_server.c</span> file to <span class="inline-code" id="771240009#-xq80ii_19">websocket_server.cpp</span> and move it to the <span class="inline-code" id="771240009#-xq80ii_20">src</span> folder.</p><div class="detached code-block" id="771240009#-xq80ii_14"><pre><code class="language-bash">mv components/matter_controller_interface/matter_controller_interface.c components/matter_controller_interface/src/matter_controller_interface.cpp</code></pre></div><p id="771240009#-xq80ii_15">Enable WebSocket Support by setting the <span class="inline-code" id="771240009#-xq80ii_21">CONFIG_HTTPD_WS_SUPPORT</span> option to <span class="inline-code" id="771240009#-xq80ii_22">y</span> is the <span class="inline-code" id="771240009#-xq80ii_23">sdkconfig.defaults</span> file.</p></section><section class="detached"><h3 id="771240009#json-data" data-toc="json-data#Websocket-Server.md-json-data">JSON Data</h3><p id="771240009#-xq80ii_24">The <span class="inline-code" id="771240009#-xq80ii_28">cJSON</span> library is used to parse and generate JSON data.</p><p id="771240009#-xq80ii_25">It is part of the ESP-IDF components. <span class="inline-code" id="771240009#-xq80ii_29">json</span> should be added to the <span class="inline-code" id="771240009#-xq80ii_30">REQUIRES</span> section of the <span class="inline-code" id="771240009#-xq80ii_31">CMakeLists.txt</span> file.</p><p id="771240009#-xq80ii_26">Usage:</p><div class="detached code-block" id="771240009#-xq80ii_27"><pre><code class="language-c"># Include cJSON in source code:
#include &quot;cJSON.h&quot;

# Parsing JSON:
cJSON *root = cJSON_Parse(my_json_string);
cJSON *format = cJSON_GetObjectItem(root, &quot;format&quot;);
int framerate = cJSON_GetObjectItem(format, &quot;frame rate&quot;)-&gt;valueint;
cJSON_Delete(root); // Clean up after use

# Creating JSON:
cJSON *root = cJSON_CreateObject();
cJSON *fmt = cJSON_CreateObject();

cJSON_AddItemToObject(root, &quot;name&quot;, cJSON_CreateString(&quot;Jack (\&quot;Bee\&quot;) Nimble&quot;));
cJSON_AddItemToObject(root, &quot;format&quot;, fmt);
cJSON_AddStringToObject(fmt, &quot;type&quot;, &quot;rect&quot;);
cJSON_AddNumberToObject(fmt, &quot;width&quot;, 1920);
cJSON_AddNumberToObject(fmt, &quot;height&quot;, 1080);
cJSON_AddFalseToObject(fmt, &quot;interlace&quot;);
cJSON_AddNumberToObject(fmt, &quot;frame rate&quot;, 24);

char *json_str = cJSON_Print(root);
printf(&quot;%s\n&quot;, json_str);

cJSON_Delete(root); // Clean up

# Manual Traversal:
void parse_object(cJSON *item) {
    cJSON *subitem = item-&gt;child;
    while (subitem) {
        printf(&quot;Key: %s\n&quot;, subitem-&gt;string);
        subitem = subitem-&gt;next;
    }
}</code></pre></div></section></section><section class="detached"><h2 id="771240009#references" data-toc="references#Websocket-Server.md-references">References</h2><ul class="list" id="771240009#-xq80ii_32" start="1"><li class="list-item" id="771240009#-xq80ii_33"><p id="771240009#-xq80ii_38">ESP Websocket Echo Server Example (<a href="https://github.com/espressif/esp-idf/tree/master/examples/protocols/http_server/ws_echo_server">https://github.com/espressif/esp-idf/tree/master/examples/protocols/http_server/ws_echo_server</a>)</p></li><li class="list-item" id="771240009#-xq80ii_34"><p id="771240009#-xq80ii_40">ESP HTTPS Websocket Server Example (<a href="https://github.com/espressif/esp-idf/tree/master/examples/protocols/https_server/wss_server">https://github.com/espressif/esp-idf/tree/master/examples/protocols/https_server/wss_server</a>)</p></li><li class="list-item" id="771240009#-xq80ii_35"><p id="771240009#-xq80ii_42">ESP Restful Server Example (<a href="https://github.com/espressif/esp-idf/tree/master/examples/protocols/http_server/restful_server">https://github.com/espressif/esp-idf/tree/master/examples/protocols/http_server/restful_server</a>)</p></li><li class="list-item" id="771240009#-xq80ii_36"><p id="771240009#-xq80ii_44">ESP HTTPS Server Example (<a href="https://github.com/espressif/esp-idf/tree/master/examples/protocols/https_server/simple">https://github.com/espressif/esp-idf/tree/master/examples/protocols/https_server/simple</a>)</p></li><li class="list-item" id="771240009#-xq80ii_37"><p id="771240009#-xq80ii_46">cJSON (<a href="https://github.com/espressif/esp-idf/tree/master/components/json">https://github.com/espressif/esp-idf/tree/master/components/json</a>)</p></li></ul></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-848609994">Thread Interface</h1><section class="detached"><h2 id="-848609994#overview" data-toc="overview#Thread-Interface.md-overview">Overview</h2><p id="-848609994#-c7kyhz_7">This section outlines the development of the <span class="control" id="-848609994#-c7kyhz_11">Thread Interface</span> component, which provides the features and functions to create Thread (<a href="#-1790576086">Thread</a>) networks and commission (<a href="#-1790576086#commissioning">&quot;Commissioning&quot; in &quot;Thread&quot;</a>) devices to join them.</p><p id="-848609994#-c7kyhz_8">This component is part of the Orchestrator (<a href="#-309902166">Orchestrator</a>) firmware.</p><p id="-848609994#-c7kyhz_9">Pre-requisites:</p><ul class="list" id="-848609994#-c7kyhz_10" start="1"><li class="list-item" id="-848609994#-c7kyhz_15"><p id="-848609994#-c7kyhz_17">The steps in Project Bootstrap (<a href="#-309902166#project-bootstrap">&quot;Project Bootstrap&quot; in &quot;Orchestrator&quot;</a>) section are completed.</p></li><li class="list-item" id="-848609994#-c7kyhz_16"><p id="-848609994#-c7kyhz_19">System Initialization (<a href="#-309902166#system-initialization">&quot;System Initialization&quot; in &quot;Orchestrator&quot;</a>) is completed.</p></li></ul></section><section class="detached"><h2 id="-848609994#development" data-toc="development#Thread-Interface.md-development">Development</h2><section class="detached"><h3 id="-848609994#step-1-create-component" data-toc="step-1-create-component#Thread-Interface.md-step-1-create-component">Step 1: Create Component</h3><p id="-848609994#-c7kyhz_25">The command below creates a new component named <span class="inline-code" id="-848609994#-c7kyhz_28">thread_interface</span> inside the <span class="inline-code" id="-848609994#-c7kyhz_29">components</span> directory.</p><div class="detached code-block" id="-848609994#-c7kyhz_26"><pre><code class="language-bash">idf.py create-component thread_interface -C components</code></pre></div><p id="-848609994#-c7kyhz_27">The <span class="inline-code" id="-848609994#-c7kyhz_30">CONFIG_OPENTHREAD_ENABLE</span> configuration option has to be set to <span class="inline-code" id="-848609994#-c7kyhz_31">y</span> in the <span class="inline-code" id="-848609994#-c7kyhz_32">sdkconfig.defaults</span> file in order to enable the OpenThread component.</p></section><section class="detached"><h3 id="-848609994#step-2-change-source-file-extension" data-toc="step-2-change-source-file-extension#Thread-Interface.md-step-2-change-source-file-extension">Step 2: Change Source File Extension</h3><p id="-848609994#-c7kyhz_33">Change the file extension of the <span class="inline-code" id="-848609994#-c7kyhz_35">thread_interface.c</span> file to <span class="inline-code" id="-848609994#-c7kyhz_36">thread_interface.cpp</span>.</p><div class="detached code-block" id="-848609994#-c7kyhz_34"><pre><code class="language-bash">mv components/thread_interface/thread_interface.c components/thread_interface/thread_interface.cpp</code></pre></div></section><section class="detached"><h3 id="-848609994#step-3-manage-thread-network" data-toc="step-3-manage-thread-network#Thread-Interface.md-step-3-manage-thread-network">Step 3: Manage Thread Network</h3><p id="-848609994#-c7kyhz_37">The <span class="inline-code" id="-848609994#-c7kyhz_39">thread_interface.h</span> file declares functions for managing the Thread network:</p><ul class="list" id="-848609994#-c7kyhz_38" start="1"><li class="list-item" id="-848609994#-c7kyhz_40"><p id="-848609994#-c7kyhz_44"><span class="control" id="-848609994#-c7kyhz_47">Initializing the Thread Interface</span></p><p id="-848609994#-c7kyhz_45">The initialization process involves the following steps:</p><ol class="list list-decimal" id="-848609994#-c7kyhz_46" type="1" start="1"><li class="list-item" id="-848609994#-c7kyhz_48"><p id="-848609994#-c7kyhz_51">Configure event handlers to manage Thread network events.</p></li><li class="list-item" id="-848609994#-c7kyhz_49"><p id="-848609994#-c7kyhz_52">Set up the Event VFS (<a href="https://docs.espressif.com/projects/esp-idf/en/stable/esp32/api-reference/storage/vfs.html#eventfd">https://docs.espressif.com/projects/esp-idf/en/stable/esp32/api-reference/storage/vfs.html#eventfd</a>), a lightweight mechanism that represents events as file descriptors, similar to Linux's eventfd. This allows tasks to signal and wait for events. The Event VFS is part of the broader VFS (<a href="https://docs.espressif.com/projects/esp-idf/en/stable/esp32/api-reference/storage/vfs.html">https://docs.espressif.com/projects/esp-idf/en/stable/esp32/api-reference/storage/vfs.html</a>) component, which provides a unified interface for various file systems.</p></li><li class="list-item" id="-848609994#-c7kyhz_50"><p id="-848609994#-c7kyhz_55">Creating a Dedicated FreeRTOS Task, declared in <span class="inline-code" id="-848609994#-c7kyhz_57">thread_task.h</span>, using the <span class="inline-code" id="-848609994#-c7kyhz_58">xTaskCreate</span> function. This task:</p><ul class="list" id="-848609994#-c7kyhz_56" start="1"><li class="list-item" id="-848609994#-c7kyhz_59"><p id="-848609994#-c7kyhz_63">Initializes a new OpenThread network interface using <span class="inline-code" id="-848609994#-c7kyhz_64">esp_netif</span>.</p></li><li class="list-item" id="-848609994#-c7kyhz_60"><p id="-848609994#-c7kyhz_65">Initializes the OpenThread stack and attaches the network interface.</p></li><li class="list-item" id="-848609994#-c7kyhz_61"><p id="-848609994#-c7kyhz_66">Sets up the OpenThread CLI (<a href="#-1790576086#openthread-cli">&quot;OpenThread CLI&quot; in &quot;Thread&quot;</a>)</p></li><li class="list-item" id="-848609994#-c7kyhz_62"><p id="-848609994#-c7kyhz_68">Starts OpenThread.</p></li></ul></li></ol></li><li class="list-item" id="-848609994#-c7kyhz_41"><p id="-848609994#-c7kyhz_69"><span class="control" id="-848609994#-c7kyhz_71">Shutting Down the Thread Interface</span></p><ul class="list" id="-848609994#-c7kyhz_70" start="1"><li class="list-item" id="-848609994#-c7kyhz_72"><p id="-848609994#-c7kyhz_76">Stops the OpenThread stack.</p></li><li class="list-item" id="-848609994#-c7kyhz_73"><p id="-848609994#-c7kyhz_77">Deletes the OpenThread task using <span class="inline-code" id="-848609994#-c7kyhz_78">vTaskDelete</span>.</p></li><li class="list-item" id="-848609994#-c7kyhz_74"><p id="-848609994#-c7kyhz_79">Unregisters the Event VFS.</p></li><li class="list-item" id="-848609994#-c7kyhz_75"><p id="-848609994#-c7kyhz_80">Cleans up allocated semaphores and network interfaces.</p></li></ul></li><li class="list-item" id="-848609994#-c7kyhz_42"><p id="-848609994#-c7kyhz_81"><span class="control" id="-848609994#-c7kyhz_82">Retrieving</span> and <span class="control" id="-848609994#-c7kyhz_83">Setting the Operational Dataset (<a href="#-1790576086#active-operational-dataset">&quot;Active Operational Dataset&quot; in &quot;Thread&quot;</a>)</span></p></li><li class="list-item" id="-848609994#-c7kyhz_43"><p id="-848609994#-c7kyhz_85"><span class="control" id="-848609994#-c7kyhz_87">Getting the Device&rsquo;s Thread Role (<a href="#-1790576086#device-roles">&quot;Device Roles&quot; in &quot;Thread&quot;</a>)</span>:</p><ul class="list" id="-848609994#-c7kyhz_86" start="1"><li class="list-item" id="-848609994#-c7kyhz_89"><p id="-848609994#-c7kyhz_94">Disabled &ndash; The device is not participating in the Thread network.</p></li><li class="list-item" id="-848609994#-c7kyhz_90"><p id="-848609994#-c7kyhz_95">Detached &ndash; The device is trying to connect to a Thread network but is not yet attached.</p></li><li class="list-item" id="-848609994#-c7kyhz_91"><p id="-848609994#-c7kyhz_96">Child &ndash; The device is connected to a Thread network but does not route traffic.</p></li><li class="list-item" id="-848609994#-c7kyhz_92"><p id="-848609994#-c7kyhz_97">Router &ndash; The device is forwarding messages for other Thread nodes.</p></li><li class="list-item" id="-848609994#-c7kyhz_93"><p id="-848609994#-c7kyhz_98">Leader &ndash; The device is managing the Thread network and ensuring proper operation.</p></li></ul></li></ul></section><section class="detached"><h3 id="-848609994#openthread-configuration" data-toc="openthread-configuration#Thread-Interface.md-openthread-configuration">OpenThread Configuration</h3><p id="-848609994#-c7kyhz_99">Create a file that defines default configurations for OpenThread on ESP32-C6:</p><div class="detached code-block" id="-848609994#-c7kyhz_100"><pre><code class="language-bash">touch esp_ot_config_esp32c6.h</code></pre></div><p id="-848609994#-c7kyhz_101">The code below sets up the network interface for Thread communication and configures the radio to use native mode. It also manages storage and task queues through the port configuration.</p><div class="detached code-block" id="-848609994#-c7kyhz_102"><pre><code class="language-c">#pragma once

#include &quot;esp_openthread_types.h&quot;
#include &lt;driver/uart.h&gt;
#include &lt;driver/gpio.h&gt;
#include &lt;esp_netif.h&gt;

#ifdef __cplusplus
extern &quot;C&quot; {
#endif

// -----------------------------------------------------------------------------
// Network Interface Configuration for OpenThread
// -----------------------------------------------------------------------------
#define OT_NETIF_INHERENT_CONFIG() {                         \
    .flags         = (esp_netif_flags_t)0,                   \
    .mac           = { 0 },                                  \
    .ip_info       = { 0 },                                  \
    .get_ip_event  = 0,                                      \
    .lost_ip_event = 0,                                      \
    .if_key        = &quot;OT_DEF&quot;,                              \
    .if_desc       = &quot;THREAD_NETIF&quot;,                         \
    .route_prio    = 15                                     \
}

/* Declare a static inherent configuration instance */
static const esp_netif_inherent_config_t ot_netif_inherent_config_instance = OT_NETIF_INHERENT_CONFIG();

#define OT_NETIF_CONFIG() {                                  \
    .base  = &amp;ot_netif_inherent_config_instance,             \
    .stack = &amp;g_esp_netif_netstack_default_openthread         \
}

// -----------------------------------------------------------------------------
// OpenThread Radio Default Configuration
// -----------------------------------------------------------------------------
#define ESP_OPENTHREAD_DEFAULT_RADIO_CONFIG()              \
{                                                      \
.radio_mode = RADIO_MODE_NATIVE                    \
}

// -----------------------------------------------------------------------------
// OpenThread Host Default Configuration
// -----------------------------------------------------------------------------
#if CONFIG_OPENTHREAD_CONSOLE_TYPE_UART
#define ESP_OPENTHREAD_DEFAULT_HOST_CONFIG()                    \
    {                                                           \
        .host_connection_mode = HOST_CONNECTION_MODE_NONE,  \
    }
#elif CONFIG_OPENTHREAD_CONSOLE_TYPE_USB_SERIAL_JTAG
#define ESP_OPENTHREAD_DEFAULT_HOST_CONFIG()                        \
    {                                                               \
        .host_connection_mode = HOST_CONNECTION_MODE_CLI_USB,       \
        .host_usb_config = USB_SERIAL_JTAG_DRIVER_CONFIG_DEFAULT()    \
    }
#endif

// -----------------------------------------------------------------------------
// OpenThread Port Default Configuration
// -----------------------------------------------------------------------------
#define ESP_OPENTHREAD_DEFAULT_PORT_CONFIG()    \
    {                                           \
        .storage_partition_name = &quot;nvs&quot;,        \
        .netif_queue_size = 10,                 \
        .task_queue_size = 10                   \
    }

// -----------------------------------------------------------------------------
// OpenThread Default Configuration
// -----------------------------------------------------------------------------
#define ESP_OPENTHREAD_DEFAULT_CONFIG()    \
    {                                           \
    .radio_config = ESP_OPENTHREAD_DEFAULT_RADIO_CONFIG(),        \
    .host_config = ESP_OPENTHREAD_DEFAULT_HOST_CONFIG(),                 \
    .port_config = ESP_OPENTHREAD_DEFAULT_PORT_CONFIG()                  \
    }

#ifdef __cplusplus
}
#endif</code></pre></div></section></section><section class="detached"><h2 id="-848609994#references" data-toc="references#Thread-Interface.md-references">References</h2><p id="-848609994#-c7kyhz_103">OpenThread SDK:</p><ul class="list" id="-848609994#-c7kyhz_104" start="1"><li class="list-item" id="-848609994#-c7kyhz_107"><p id="-848609994#-c7kyhz_108">How to Write an OpenThread Application (<a href="https://docs.espressif.com/projects/esp-idf/en/stable/esp32/api-guides/openthread.html#how-to-write-an-openthread-application">https://docs.espressif.com/projects/esp-idf/en/stable/esp32/api-guides/openthread.html#how-to-write-an-openthread-application</a>)</p></li></ul><p id="-848609994#-c7kyhz_105">Android SDK</p><ul class="list" id="-848609994#-c7kyhz_106" start="1"><li class="list-item" id="-848609994#-c7kyhz_110"><p id="-848609994#-c7kyhz_112">Android Thread Commissioner (<a href="https://github.com/openthread/ot-commissioner/tree/main/android">https://github.com/openthread/ot-commissioner/tree/main/android</a>)</p></li><li class="list-item" id="-848609994#-c7kyhz_111"><p id="-848609994#-c7kyhz_114">Thread Network SDK for Android (<a href="https://developers.home.google.com/thread">https://developers.home.google.com/thread</a>)</p></li></ul></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-851317846">Wi-Fi Interface</h1><section class="detached"><h2 id="-851317846#overview" data-toc="overview#Wi-Fi-Interface.md-overview">Overview</h2><p id="-851317846#-omzk6n_6">This section outlines the development of the <span class="control" id="-851317846#-omzk6n_8">Wi-Fi-STA Interface</span> component, which provides the features and functions to connect to Wi-Fi networks and manage the device's Wi-Fi settings.</p><p id="-851317846#-omzk6n_7">This component is part of the Orchestrator (<a href="#-309902166">Orchestrator</a>) firmware.</p></section><section class="detached"><h2 id="-851317846#development" data-toc="development#Wi-Fi-Interface.md-development">Development</h2><section class="detached"><h3 id="-851317846#bootstrapping-the-component" data-toc="bootstrapping-the-component#Wi-Fi-Interface.md-bootstrapping-the-component">Bootstrapping the Component</h3><ol class="list list-decimal" id="-851317846#-omzk6n_12" type="1" start="1"><li class="list-item" id="-851317846#-omzk6n_13"><p id="-851317846#-omzk6n_16">Creates a new component named <span class="inline-code" id="-851317846#-omzk6n_18">wi_fi_sta_interface</span> inside the <span class="inline-code" id="-851317846#-omzk6n_19">components</span> directory.</p><div class="detached code-block" id="-851317846#-omzk6n_17"><pre><code class="language-bash">idf.py create-component wi_fi_sta_interface -C components</code></pre></div></li><li class="list-item" id="-851317846#-omzk6n_14"><p id="-851317846#-omzk6n_20">Rename and move the source file.</p><ol class="list list-decimal" id="-851317846#-omzk6n_21" type="1" start="1"><li class="list-item" id="-851317846#-omzk6n_22"><p id="-851317846#-omzk6n_24">Rename the <span class="inline-code" id="-851317846#-omzk6n_25">wi_fi_sta_interface.c</span> to <span class="inline-code" id="-851317846#-omzk6n_26">wi_fi_sta_interface.cpp</span>.</p></li><li class="list-item" id="-851317846#-omzk6n_23"><p id="-851317846#-omzk6n_27">Move it to src folder.</p></li></ol></li><li class="list-item" id="-851317846#-omzk6n_15"><p id="-851317846#-omzk6n_28">Update the <span class="inline-code" id="-851317846#-omzk6n_33">CMakeLists.txt</span> file.</p><ol class="list list-decimal" id="-851317846#-omzk6n_29" type="1" start="1"><li class="list-item" id="-851317846#-omzk6n_34"><p id="-851317846#-omzk6n_36">Change the location of the <span class="inline-code" id="-851317846#-omzk6n_37">wi_fi_sta_interface.cpp</span> file to the <span class="inline-code" id="-851317846#-omzk6n_38">src</span> folder.</p></li><li class="list-item" id="-851317846#-omzk6n_35"><p id="-851317846#-omzk6n_39">Add required dependencies <span class="inline-code" id="-851317846#-omzk6n_40">esp_event</span>, <span class="inline-code" id="-851317846#-omzk6n_41">esp_netif</span>, and <span class="inline-code" id="-851317846#-omzk6n_42">esp_wifi</span> to the REQUIRES section.</p></li></ol><p id="-851317846#-omzk6n_30">The <span class="inline-code" id="-851317846#-omzk6n_43">CMakeLists.txt</span> file should look like this:</p><div class="detached code-block" id="-851317846#-omzk6n_31"><pre><code class="language-cmake">idf_component_register(SRCS &quot;src/wi_fi_sta_interface.cpp&quot;
                       INCLUDE_DIRS &quot;include&quot;
                       REQUIRES esp_event esp_netif esp_wifi)</code></pre></div><p id="-851317846#-omzk6n_32"></p></li></ol></section><section class="detached"><h3 id="-851317846#wi-fi-station-management" data-toc="wi-fi-station-management#Wi-Fi-Interface.md-wi-fi-station-management">Wi-Fi Station Management</h3></section></section><section class="detached"><h2 id="-851317846#references" data-toc="references#Wi-Fi-Interface.md-references">References</h2><p id="-851317846#-omzk6n_44">ESP Wi-Fi Docs (<a href="https://docs.espressif.com/projects/esp-idf/en/v5.2.5/esp32c6/api-reference/network/esp_wifi.html">https://docs.espressif.com/projects/esp-idf/en/v5.2.5/esp32c6/api-reference/network/esp_wifi.html</a>)</p></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="1966040098">WiFi-Mesh-Lite Interface</h1><p id="1966040098#-bpvmz7_3">ESP-Mesh-Lite (<a href="#-1918844910#esp-mesh-lite">&quot;ESP-Mesh-Lite&quot; in &quot;Espressif&quot;</a>)</p><p id="1966040098#-bpvmz7_4">https://github.com/espressif/esp-mesh-lite/blob/master/components/mesh_lite/User_Guide.md</p></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="1047354404">ESP-Mesh-Lite Network</h1><p id="1047354404#-wqqqeh_3">Prerequisites:</p><ul class="list" id="1047354404#-wqqqeh_4" start="1"><li class="list-item" id="1047354404#-wqqqeh_7"><p id="1047354404#-wqqqeh_8">ESP-IDF development environment (<a href="#-400735760">ESP-IDF Setup</a>) is set up.</p></li></ul><section class="detached"><h2 id="1047354404#build-and-run" data-toc="build-and-run#ESP-Mesh-Lite-Network.md-build-and-run">Build and Run</h2><section class="detached"><h3 id="1047354404#step-1-prepare-the-environment" data-toc="step-1-prepare-the-environment#ESP-Mesh-Lite-Network.md-step-1-prepare-the-environment">Step 1: Prepare the Environment</h3><div class="detached code-block" id="1047354404#-wqqqeh_17"><pre><code class="language-bash">get_idf</code></pre></div></section><section class="detached"><h3 id="1047354404#step-2-clone-esp-mesh-lite-sdk" data-toc="step-2-clone-esp-mesh-lite-sdk#ESP-Mesh-Lite-Network.md-step-2-clone-esp-mesh-lite-sdk">Step 2: Clone ESP-Mesh-Lite SDK</h3><p id="1047354404#-wqqqeh_18">This project uses ESP-Mesh-Lite SDK (<a href="#-1918844910#esp-mesh-lite">&quot;ESP-Mesh-Lite&quot; in &quot;Espressif&quot;</a>) locked to commit 1a27d19 (<a href="https://github.com/espressif/esp-mesh-lite/commit/1a27d1944819cf17ec76cd63ed90c20a1bc28ed9">https://github.com/espressif/esp-mesh-lite/commit/1a27d1944819cf17ec76cd63ed90c20a1bc28ed9</a>).</p><div class="detached code-block" id="1047354404#-wqqqeh_19"><pre><code class="language-bash">cd ~/esp
git clone https://github.com/espressif/esp-mesh-lite.git
cd ~/esp/esp-mesh-lite/
git checkout 1a27d1944819cf17ec76cd63ed90c20a1bc28ed9</code></pre></div></section><section class="detached"><h3 id="1047354404#step-3-choose-no-router-example" data-toc="step-3-choose-no-router-example#ESP-Mesh-Lite-Network.md-step-3-choose-no-router-example">Step 3: Choose No-Router Example</h3><p id="1047354404#-wqqqeh_22">The <span class="control" id="1047354404#-wqqqeh_24">no_router</span> example in the ESP-Mesh-Lite repository demonstrates how to create a mesh network without a traditional Wi-Fi router. Devices communicate directly, forming a decentralized structure.</p><div class="detached code-block" id="1047354404#-wqqqeh_23"><pre><code class="language-bash">cd examples/no_router</code></pre></div></section><section class="detached"><h3 id="1047354404#step-4-set-target-for-no-router-example" data-toc="step-4-set-target-for-no-router-example#ESP-Mesh-Lite-Network.md-step-4-set-target-for-no-router-example">Step 4: Set Target for No-Router Example</h3><div class="detached code-block" id="1047354404#-wqqqeh_25"><pre><code class="language-bash">cd examples/no_router
idf.py set-target esp32c6</code></pre></div></section><section class="detached"><h3 id="1047354404#step-5-configure-the-device" data-toc="step-5-configure-the-device#ESP-Mesh-Lite-Network.md-step-5-configure-the-device">Step 5: Configure the Device</h3><div class="detached code-block" id="1047354404#-wqqqeh_27"><pre><code class="language-bash">idf.py menuconfig</code></pre></div><p id="1047354404#-wqqqeh_28">A device&rsquo;s role is set using <span class="inline-code" id="1047354404#-wqqqeh_34">CONFIG_MESH_ROOT</span>, it can be configured in <span class="control" id="1047354404#-wqqqeh_35">menuconfig</span> <span class="inline-code" id="1047354404#-wqqqeh_36">Example Configuration -&gt; Root Device</span>:</p><ul class="list" id="1047354404#-wqqqeh_29" start="1"><li class="list-item" id="1047354404#-wqqqeh_37"><p id="1047354404#-wqqqeh_39">If <span class="control" id="1047354404#-wqqqeh_40">Enabled (<span class="inline-code" id="1047354404#-wqqqeh_43">CONFIG_MESH_ROOT=y</span>)</span>, the device creates a <span class="control" id="1047354404#-wqqqeh_41">SoftAP</span> and becomes the <span class="control" id="1047354404#-wqqqeh_42">root node</span>.</p></li><li class="list-item" id="1047354404#-wqqqeh_38"><p id="1047354404#-wqqqeh_44">If <span class="control" id="1047354404#-wqqqeh_45">Disabled (<span class="inline-code" id="1047354404#-wqqqeh_49">CONFIG_MESH_ROOT=n</span>)</span>, the device joins an existing network as a <span class="control" id="1047354404#-wqqqeh_46">STA</span> while also creating a <span class="control" id="1047354404#-wqqqeh_47">SoftAP</span> for other devices, making it an <span class="control" id="1047354404#-wqqqeh_48">intermediate node</span> that extends the mesh.</p></li></ul><p id="1047354404#-wqqqeh_30">SoftAP settings <span class="control" id="1047354404#-wqqqeh_50">CONFIG_BRIDGE_SOFTAP_SSID</span> and <span class="control" id="1047354404#-wqqqeh_51">CONFIG_BRIDGE_SOFTAP_PASS</span> are configured in <span class="control" id="1047354404#-wqqqeh_52">menuconfig</span> <span class="inline-code" id="1047354404#-wqqqeh_53">Component config -&gt; Bridge Configuration -&gt; The interface used to provide network data fowarding for other devices -&gt; SoftAP Config</span>.</p><p id="1047354404#-wqqqeh_31">The following settings are also available:</p><ul class="list" id="1047354404#-wqqqeh_32" start="1"><li class="list-item" id="1047354404#-wqqqeh_54"><p id="1047354404#-wqqqeh_55"><span class="inline-code" id="1047354404#-wqqqeh_56">Component config -&gt; ESP Wi-Fi Mesh Lite</span></p></li></ul></section><section class="detached"><h3 id="1047354404#step-6-build" data-toc="step-6-build#ESP-Mesh-Lite-Network.md-step-6-build">Step 6: Build</h3><div class="detached code-block" id="1047354404#-wqqqeh_57"><pre><code class="language-bash">idf.py build</code></pre></div></section><section class="detached"><h3 id="1047354404#step-7-flash" data-toc="step-7-flash#ESP-Mesh-Lite-Network.md-step-7-flash">Step 7: Flash</h3><div class="detached code-block" id="1047354404#-wqqqeh_58"><pre><code class="language-bash">idf.py -p &lt;PORT_TO_ESP32_C6&gt; flash monitor</code></pre></div></section></section><section class="detached"><h2 id="1047354404#provisioning" data-toc="provisioning#ESP-Mesh-Lite-Network.md-provisioning">Provisioning</h2><p id="1047354404#-wqqqeh_59">Provisioning example: https://github.com/espressif/esp-mesh-lite/tree/master/examples/mesh_wifi_provisioning</p><p id="1047354404#-wqqqeh_60">Provisioning Library: Provisioning library provides a mechanism to send network credentials and/or custom data to ESP32 (or its variants like S2, S3, C3, etc.) or ESP8266 devices.</p><p id="1047354404#-wqqqeh_61">This repository contains the source code for the companion Android app for this provisioning mechanism: https://github.com/espressif/esp-mesh-lite/tree/feature/zero_provisioning_android?tab=readme-ov-file#features</p></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="956107380">Dashboard</h1><section class="detached"><h2 id="956107380#overview" data-toc="overview#Dashboard.md-overview">Overview</h2><p id="956107380#-6cwwop_4">The <span class="control" id="956107380#-6cwwop_7">Dashboard</span> is a GUI application that farmers use to configure and manage system components, as well as monitor and adjust environmental conditions.</p><p id="956107380#-6cwwop_5">The environment can be configured for specific crops. When setting up a new plant, farmers can choose from predefined parameters suited to that crop. As the plant grows, they can manually adjust settings.</p><p id="956107380#-6cwwop_6">Source code: GitHub (<a href="https://github.com/albert-gee/old_macdonald_dashboard">https://github.com/albert-gee/old_macdonald_dashboard</a>)</p></section></article></div></section></div></body></html>