<!DOCTYPE html><html><head><meta charset="UTF-8"><script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-bash.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-c.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-cmake.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/prism.js"></script>
<script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-cpp.min.js"></script><style>
        .article {
            position: relative;
            padding-bottom: 24px;
        }
        

        .bordered-element-rounded {
            border: 1px solid #c4c4c4;
            border-radius: 7px;
            overflow: hidden;
        }
        

        .center {
            display: block;
            margin-left: auto;
            margin-right: auto;
        }
        

        .code-block {
            overflow: hidden;
            position: relative;
            padding: 0;
            border-radius: 8px;
            font-variant-ligatures: none;
            background-color: rgba(25, 25, 28, .05);
            word-break: break-all;
        }
        

        .control {
            color: #19191c;
            font-size: 16px;
            font-weight: 670;
        }
        

        .detached {
            margin-block-start: 0;
            margin-block-end: 0;
            margin-bottom: 8px;
        }
        

        .emphasis {
            color: inherit;
            font-weight: inherit;
            font-style: italic;
        }
        

        .flex {
            display: flex;
        }
        

        .header-row {
            background: #e6e6e6;
        }
        

        .image {
            max-width: 100%;
            max-height: 90vh;
            height: auto;
        }
        

        .image-container {
            max-width: 100vw;
        }
        

        .inline-code {
            border-radius: 4px;
            display: inline;
            padding: 2px 1px;
            font-family: JetBrains Sans,monospace;
            background: #e6e6e6;
        }
        

        .list {
            list-style-type: disc;
            padding-left: 0;
            margin-left: 15px;
        }
        

        .list-decimal {
            list-style-type: decimal;
        }
        

        .list-item {
            margin-top: 6px;
            margin-bottom: 6px;
            margin-left: 4px;
        }
        

        .main-title {
            padding-bottom: 24px;
            margin-top: 0;
            font-size: 40px;
            margin-block-start: 0;
            margin-block-end: 0;
        }
        

        .prism {
            page-break-inside: avoid;
        }
        
        /* PrismJS 1.29.0
https://prismjs.com/download.html#themes=prism&languages=markup+css+clike+javascript+abap+abnf+actionscript+ada+agda+al+antlr4+apacheconf+apex+apl+applescript+aql+arduino+arff+armasm+arturo+asciidoc+aspnet+asm6502+asmatmel+autohotkey+autoit+avisynth+avro-idl+awk+bash+basic+batch+bbcode+bbj+bicep+birb+bison+bnf+bqn+brainfuck+brightscript+bro+bsl+c+csharp+cpp+cfscript+chaiscript+cil+cilkc+cilkcpp+clojure+cmake+cobol+coffeescript+concurnas+csp+cooklang+coq+crystal+css-extras+csv+cue+cypher+d+dart+dataweave+dax+dhall+diff+django+dns-zone-file+docker+dot+ebnf+editorconfig+eiffel+ejs+elixir+elm+etlua+erb+erlang+excel-formula+fsharp+factor+false+firestore-security-rules+flow+fortran+ftl+gml+gap+gcode+gdscript+gedcom+gettext+gherkin+git+glsl+gn+linker-script+go+go-module+gradle+graphql+groovy+haml+handlebars+haskell+haxe+hcl+hlsl+hoon+http+hpkp+hsts+ichigojam+icon+icu-message-format+idris+ignore+inform7+ini+io+j+java+javadoc+javadoclike+javastacktrace+jexl+jolie+jq+jsdoc+js-extras+json+json5+jsonp+jsstacktrace+js-templates+julia+keepalived+keyman+kotlin+kumir+kusto+latex+latte+less+lilypond+liquid+lisp+livescript+llvm+log+lolcode+lua+magma+makefile+markdown+markup-templating+mata+matlab+maxscript+mel+mermaid+metafont+mizar+mongodb+monkey+moonscript+n1ql+n4js+nand2tetris-hdl+naniscript+nasm+neon+nevod+nginx+nim+nix+nsis+objectivec+ocaml+odin+opencl+openqasm+oz+parigp+parser+pascal+pascaligo+psl+pcaxis+peoplecode+perl+php+phpdoc+php-extras+plant-uml+plsql+powerquery+powershell+processing+prolog+promql+properties+protobuf+pug+puppet+pure+purebasic+purescript+python+qsharp+q+qml+qore+r+racket+cshtml+jsx+tsx+reason+regex+rego+renpy+rescript+rest+rip+roboconf+robotframework+ruby+rust+sas+sass+scss+scala+scheme+shell-session+smali+smalltalk+smarty+sml+solidity+solution-file+soy+sparql+splunk-spl+sqf+sql+squirrel+stan+stata+iecst+stylus+supercollider+swift+systemd+t4-templating+t4-cs+t4-vb+tap+tcl+tt2+textile+toml+tremor+turtle+twig+typescript+typoscript+unrealscript+uorazor+uri+v+vala+vbnet+velocity+verilog+vhdl+vim+visual-basic+warpscript+wasm+web-idl+wgsl+wiki+wolfram+wren+xeora+xml-doc+xojo+xquery+yaml+yang+zig&plugins=highlight-keywords */
code[class*=language-],pre[class*=language-]{color:#000;background:0 0;text-shadow:0 1px #fff;font-family:Consolas,Monaco,'Andale Mono','Ubuntu Mono',monospace;font-size:1em;text-align:left;white-space:pre-wrap;word-spacing:normal;word-wrap:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}code[class*=language-] ::-moz-selection,code[class*=language-]::-moz-selection,pre[class*=language-] ::-moz-selection,pre[class*=language-]::-moz-selection{text-shadow:none;background:#b3d4fc}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{text-shadow:none;background:#b3d4fc}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{padding:16px;margin:0;overflow:auto}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{color:#9a6e3a;background:hsla(0,0%,100%,.5)}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}

        

        .prompt {
            flex-direction: row;
            letter-spacing: .0015em;
            font-size: 16px;
            font-weight: 400;
            line-height: 24px;
            margin-left: 0;
            margin-right: 0;
        }
        

        .prompt-content {
            padding: 15px;
            overflow: hidden;
            flex: 1 1 auto;
        }
        

        .prompt-content-p p {
            margin-block-start: 0;
            margin-block-end: 0;
        }
        

        .prompt-icon {
            flex: 0 0 auto;
            margin-left: 15px;
            margin-top: 15px;
            fill: currentcolor;
            width: 24px;
            height: 24px;
        }
        

        :root {
            width: 95%;
            max-width: 95vw;
            padding: 0 0 0 30px;
        }
        
        body {
            font-family: JetBrains Sans,serif;
        }
        
        a {
            overflow-wrap: anywhere;
            width: 100vw;
        }
        
        
        @font-face {
            font-family: JetBrains Sans;
            src: url(https://resources.jetbrains.com/storage/jetbrains-sans/JetBrainsSans-Light.woff2) format("woff2"), url(https://resources.jetbrains.com/storage/jetbrains-sans/JetBrainsSans-Light.woff) format("woff");
            font-weight: 300;
            font-style: normal;
        }

        @font-face {
            font-family: JetBrains Sans;
            src: url(https://resources.jetbrains.com/storage/jetbrains-sans/JetBrainsSans-Regular.woff2) format("woff2"), url(https://resources.jetbrains.com/storage/jetbrains-sans/JetBrainsSans-Regular.woff) format("woff");
            font-weight: 400;
            font-style: normal;
        }

        @font-face {
            font-family: JetBrains Sans;
            src: url(https://resources.jetbrains.com/storage/jetbrains-sans/JetBrainsSans-SemiBold.woff2) format("woff2"), url(https://resources.jetbrains.com/storage/jetbrains-sans/JetBrainsSans-SemiBold.woff) format("woff");
            font-weight: 600;
            font-style: normal;
        }
        
        
        code {
            display: inline;
            word-break: break-word;
            font-size: 15px;
            line-height: inherit;
            font-variant-ligatures: none;
            font-family: JetBrains Sans,monospace;
            white-space: pre-line;
            overflow-wrap: break-word;
        }
        
        figcaption {
            margin-top: 5px;
        }
        
        h2 {
            padding-top: 16px;
            padding-bottom: 8px;
            margin-block-start: 0;
            margin-block-end: 0;
        }
        
        h3 {
            padding-top: 8px;
            padding-bottom: 8px;
            margin-block-start: 0;
            margin-block-end: 0;
        }
        
        h4 {
            padding-top: 4px;
            padding-bottom: 8px;
            margin-block-start: 0;
            margin-block-end: 0;
        }
        
        p {
            padding: 0;
            border: 0;
            line-height: 25px;
            margin-block-start: 0;
            margin-block-end: 0;
            padding-bottom: 8px;
        }
        
        div {
            display: block;
        }
        
        table {
            border-collapse: collapse;
            width: 100%;
            page-break-inside: avoid;
        }
        
        th, td {
            border: 1px solid #c4c4c4;
            padding: 10px;
            text-align: left;
            word-break: break-all;
        }
        
        .no-bold {
            font-weight: normal; 
        }
        
        .entry {
            display: grid;
            grid-template-columns: auto max-content;
            grid-template-areas: "chapter page";
            align-items: end;
            gap: 0 .25rem;
            line-height: 25px;
        }
        
        .toc-link-container{
            grid-area: chapter;
            position: relative;
            overflow: hidden;
        }
        
        .toc-link{
            text-decoration: none;
            color: black;
        }
        
        .toc-link-container::after {
            position: absolute;
            padding-left: .25ch;
            content: " . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . "
            ". . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . "
            ". . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ";
            text-align: right;
        }
        
        .page {
            grid-area: page;
            width: 30px;
            text-align: right;
        }
        

        .table-wrapper {
            overflow: hidden;
            box-sizing: border-box;
            font: inherit;
        }
        

        .topic {
            page-break-before: always;
        }
        

        .warning {
            background: rgba(244, 92, 74, .2);
        }
        </style><title>pdfSourceSRS</title></head><body><div><section class="topic"><div><article class="article"><h1 class="main-title">Table of Contents</h1><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#1703914554">Introduction</a></div><div class="page">3</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#194827036">System Design</a></div><div class="page">7</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-487402309">Development Plan</a></div><div class="page">9</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-1455554384">Requirements</a></div><div class="page">13</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#1317451997">Backlog</a></div><div class="page">17</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#429683684">Grow Chamber</a></div><div class="page">24</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-2101489201">Grow Chamber Assembly</a></div><div class="page">25</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#146093280">Root Chamber Assembly</a></div><div class="page">26</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#197990771">Seed Planting</a></div><div class="page">27</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-1652252355">Ventilation</a></div><div class="page">28</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-1957301961">Automation</a></div><div class="page">29</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#661270862">Background</a></div><div class="page">30</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-1790576086">Thread</a></div><div class="page">31</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#1215462931">Forming a Network</a></div><div class="page">35</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#1381824660">Thread Commissioning</a></div><div class="page">37</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-1997370655">Matter</a></div><div class="page">39</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#279346443">Matter Commissioning</a></div><div class="page">40</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#1208879947">Matter Controllers</a></div><div class="page">43</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-1918844910">Espressif</a></div><div class="page">44</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-715994671">Development Environment Setup</a></div><div class="page">47</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-400735760">ESP-IDF Setup</a></div><div class="page">48</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-401349892">ESP-Matter Setup</a></div><div class="page">51</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-586960577">ESP32 Project Workflow</a></div><div class="page">54</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-1685420830">Accessory Devices</a></div><div class="page">60</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#1125845925">Matter Pressure and Temperature Sensor</a></div><div class="page">62</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#2085001628">Matter Relay Switch</a></div><div class="page">73</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#1955462060">Thread Border Routers</a></div><div class="page">80</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-1231632047">ESP Basic Thread Border Router</a></div><div class="page">81</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-497258712">ESP Matter Thread Border Router</a></div><div class="page">91</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#1139179455">System Control</a></div><div class="page">95</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-1412866926">ESP OpenThread CLI</a></div><div class="page">96</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-1509277031">CHIP-Tool</a></div><div class="page">102</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-309902166">Orchestrator</a></div><div class="page">121</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#-848609994">Thread Interface</a></div><div class="page">124</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#773821741">Matter Interface</a></div><div class="page">126</div></div><div class="entry"><div class="toc-link-container"><a class="toc-link" href="#561613140">Control Panel</a></div><div class="page">128</div></div></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="1703914554">Introduction</h1><blockquote class="prompt flex bordered-element-rounded warning detached">
  <svg xmlns="http://www.w3.org/2000/svg" class="prompt-icon">
    <path d="M12.946 3.552L21.52 18.4c.424.735.33 1.6-.519 1.6H3.855c-.85 0-1.817-.865-1.392-1.6l8.573-14.848a1.103 1.103 0 0 1 1.91 0zm.545 12.948a1.5 1.5 0 1 0-1.5 1.5 1.5 1.5 0 0 0 1.5-1.5zM13 8h-2v5h2z"></path>
  </svg>
  <div class="prompt-content prompt-content-p"><p id="1703914554#-g0pb39_8">This document is a work in progress. The content is subject to change.</p></div>
</blockquote>
<section class="detached"><h2 id="1703914554#overview" data-toc="overview#Introduction.md-overview">Overview</h2><p id="1703914554#-g0pb39_9">This project aims to develop a <span class="control" id="1703914554#-g0pb39_12">decentralized system</span> for <span class="control" id="1703914554#-g0pb39_13">Controlled Environment Agriculture</span> (CEA).</p><p id="1703914554#-g0pb39_10">The system has a modular structure, where each module has its own sub-network of accessory devices, such as sensors and actuators, that autonomously monitor and control environmental conditions without requiring a central hub.</p><p id="1703914554#-g0pb39_11">The system prioritizes interoperability, enabling the integration of devices from different manufacturers and the replacement of existing ones without major updates. It also implements security measures to ensure safe data transmission and access control, maintaining system functionality and scalability.</p></section><section class="detached"><h2 id="1703914554#motivation" data-toc="motivation#Introduction.md-motivation">Motivation</h2><p id="1703914554#-g0pb39_14">Advancements in IoT-based monitoring and control systems have improved automation in agriculture, increasing efficiency and productivity.</p><p id="1703914554#-g0pb39_15"><span class="emphasis" id="1703914554#-g0pb39_19">Precision Agriculture</span> enhances field farming by using sensor data, GPS, and automated equipment to precisely manage inputs like water, fertilizers, and pesticides. <span class="emphasis" id="1703914554#-g0pb39_20">Controlled-Environment Agriculture</span> extends this approach by eliminating limitations such as external environmental factors, soil variability, and large-scale deployment challenges through enclosed systems where temperature, humidity, light, and CO₂ are actively regulated. This allows for year-round production, reduces reliance on weather conditions, and ensures consistent crop yields, making it more reliable than traditional open-field farming.</p><p id="1703914554#-g0pb39_16">However, many farming automation startups struggle to succeed, primarily due to the high cost of research and development. Building advanced automation systems requires substantial investment, which raises food production costs and makes it difficult for startups to compete with traditional farms that operate at lower expenses.</p><p id="1703914554#-g0pb39_17">A major factor driving these costs is the reliance on centralized servers or cloud resources for data processing and control. This setup requires complex communication infrastructure, increases operational expenses, and complicates scalability, particularly for larger farms. Additionally, centralized systems create a single point of failure - if the central server or cloud service fails or is compromised, the entire operation can be disrupted. For example, an AWS IoT outage in 2020 caused significant downtime for applications relying on AWS IoT Core, demonstrating the risks of centralized dependency.</p><p id="1703914554#-g0pb39_18">Another issue is the difficulty of integrating components from different manufacturers. Automated farms use a variety of sensors, actuators, and equipment, but differences in APIs and communication protocols can make it challenging to connect these systems smoothly.</p></section><section class="detached"><h2 id="1703914554#discussion" data-toc="discussion#Introduction.md-discussion">Discussion</h2><p id="1703914554#-g0pb39_21">The system leverages the Matter protocol, which ensures compatibility between devices from different manufacturers. This standardisation simplifies integration, replacement, and future expansion of devices. However, the high costs associated with Matter certification &ndash; including a $7,000 annual membership fee for the Connectivity Standards Alliance (CSA) and $3,000 per product certification &ndash; pose significant challenges for small manufacturers and farms operating on tight budgets.</p><p id="1703914554#-g0pb39_22">Future advancements in this system could include the adoption of microfluidics within hydroponic systems. Such developments would enhance resource efficiency and allow for precise control over environmental conditions tailored to specific crops. These innovations align with the system&rsquo;s modular design philosophy, which prioritises adaptability and scalability in agricultural automation.</p></section><section class="detached"><h2 id="1703914554#references" data-toc="references#Introduction.md-references">References</h2><p id="1703914554#-g0pb39_23">[1] L. Adenauer, &ldquo;Up, up and away! The Economics of Vertical Farming,&rdquo; <span class="emphasis" id="1703914554#-g0pb39_46">Journal of Agricultural Studies</span>, doi: 10.5296/jas.v2i1.4526 (<a href="https://doi.org/10.5296/jas.v2i1.4526">https://doi.org/10.5296/jas.v2i1.4526</a>).</p><p id="1703914554#-g0pb39_24">[2] U.S. Department of Agriculture, Office of the Chief Scientist, and U.S. Department of Energy, Bioenergy Technologies Office, Workshop Report: Research and Development Potentials in Indoor Agriculture and Sustainable Urban Ecosystems, Washington, D.C., Feb. 2019. Online (<a href="https://www.usda.gov/sites/default/files/documents/indoor-agriculture-workshop-report.pdf">https://www.usda.gov/sites/default/files/documents/indoor-agriculture-workshop-report.pdf</a>).</p><p id="1703914554#-g0pb39_25">[3] People, power costs keep indoor farming down to Earth, Finance &amp; Commerce, Associated Press, May 14, 2018. Online (<a href="https://finance-commerce.com/2018/05/people-power-costs-keep-indoor-farming-down-to-earth/">https://finance-commerce.com/2018/05/people-power-costs-keep-indoor-farming-down-to-earth/</a>)</p><p id="1703914554#-g0pb39_26">[4] G. Johnson, &ldquo;AeroFarms files for Chapter 11 bankruptcy protection,&rdquo; <span class="emphasis" id="1703914554#-g0pb39_50">Produce Blue Book</span>, Jun. 09, 2023. Online (<a href="https://www.producebluebook.com/2023/06/08/aerofarms-files-for-chapter-11-bankruptcy-protection/">https://www.producebluebook.com/2023/06/08/aerofarms-files-for-chapter-11-bankruptcy-protection/</a>).</p><p id="1703914554#-g0pb39_27">[5] B. C. Baraniuk, &ldquo;Lean times hit the vertical farming business,&rdquo; Jul. 17, 2023. Online (<a href="https://www.bbc.com/news/business-66173872">https://www.bbc.com/news/business-66173872</a>).</p><p id="1703914554#-g0pb39_28">[6] S. B&ouml;kle, D. S. Paraforos, D. Reiser, and H. W. Griepentrog, &ldquo;Conceptual framework of a decentral digital farming system for resilient and safe data management,&rdquo; <span class="emphasis" id="1703914554#-g0pb39_53">Smart Agricultural Technology</span>, Volume 2, Feb. 2022. Online (<a href="https://www.sciencedirect.com/science/article/pii/S2772375522000065">https://www.sciencedirect.com/science/article/pii/S2772375522000065</a>).</p><p id="1703914554#-g0pb39_29">[7] U. Shafi, R. Mumtaz, J. Garc&iacute;a-Nieto, S. A. Hassan, S. A. R. Zaidi, and N. Iqbal, &ldquo;Precision Agriculture Techniques and Practices: From Considerations to applications,&rdquo; <span class="emphasis" id="1703914554#-g0pb39_55">Sensors</span>, vol. 19, no. 17, p. 3796, Sep. 2019, doi: 10.3390/s19173796 (<a href="https://doi.org/10.3390/s19173796">https://doi.org/10.3390/s19173796</a>).</p><p id="1703914554#-g0pb39_30">[8] D. K. S. Karanam Desai, &ldquo;Automation in Agriculture: a Study,&rdquo; <span class="emphasis" id="1703914554#-g0pb39_57">International Journal of Engineering Science</span>, vol. 2(2), Jun. 2016. Online (<a href="https://www.researchgate.net/publication/304650250_Automation_in_Agriculture_A_Study">https://www.researchgate.net/publication/304650250_Automation_in_Agriculture_A_Study</a>).</p><p id="1703914554#-g0pb39_31">[9] &ldquo;Distributed or centralized mobility?,&rdquo; <span class="emphasis" id="1703914554#-g0pb39_59">IEEE Conference Publication | IEEE Xplore</span>, Nov. 01, 2009. Online (<a href="https://ieeexplore.ieee.org/abstract/document/5426302/">https://ieeexplore.ieee.org/abstract/document/5426302/</a>).</p><p id="1703914554#-g0pb39_32">[10] D. Belli, P. Barsocchi, and F. Palumbo, &ldquo;Connectivity standards alliance matter: state of the art and opportunities,&rdquo; <span class="emphasis" id="1703914554#-g0pb39_61">Internet of Things</span>, vol. 25, doi: 10.1016/j.iot.2023.101005 (<a href="https://doi.org/10.1016/j.iot.2023.101005">https://doi.org/10.1016/j.iot.2023.101005</a>).</p><p id="1703914554#-g0pb39_33">[11] G.-J. Ra and I.-Y. Lee, &ldquo;A study on KSI-based authentication management and communication for secure smart home environments,&rdquo; <span class="emphasis" id="1703914554#-g0pb39_63">KSII Transactions on Internet and Information Systems</span>, vol. 12, no. 2, Feb. 2018, doi: 10.3837/tiis.2018.02.021 (<a href="https://doi.org/10.3837/tiis.2018.02.021">https://doi.org/10.3837/tiis.2018.02.021</a>).</p><p id="1703914554#-g0pb39_34">[12] R. Speed, &ldquo;AWS admits to &lsquo;severely impaired&rsquo; services in US-EAST-1, can&rsquo;t even post updates to Service Health Dashboard,&rdquo; <span class="emphasis" id="1703914554#-g0pb39_65">The Register</span>, Nov. 26, 2020. Online (<a href="https://www.theregister.com/2020/11/25/aws_down/">https://www.theregister.com/2020/11/25/aws_down/</a>).</p><p id="1703914554#-g0pb39_35">[13] V. S, V. E. R D, V. A C, V. A, and S. L. S, &ldquo;A STUDY ON DEVELOPMENT OF CROPS BY FOGPONIC SYSTEM USING COCO COIR,&rdquo; <span class="emphasis" id="1703914554#-g0pb39_67">International Research Journal of Engineering and Technology (IRJET)</span>, vol.7. Online (<a href="https://www.irjet.net/archives/V7/i4/IRJET-V7I41142.pdf">https://www.irjet.net/archives/V7/i4/IRJET-V7I41142.pdf</a>).</p><p id="1703914554#-g0pb39_36">[14] V. O. Oner, <span class="emphasis" id="1703914554#-g0pb39_69">Developing IoT Projects with ESP32 - Second Edition</span>, O&rsquo;Reilly Online Learning. Online (<a href="https://learning.oreilly.com/library/view/developing-iot-projects/9781803237688/Text/Chapter_3.xhtml#_idParaDest-48">https://learning.oreilly.com/library/view/developing-iot-projects/9781803237688/Text/Chapter_3.xhtml#_idParaDest-48</a>).</p><p id="1703914554#-g0pb39_37">[15] Alliance Marketing, &ldquo;Peeking Under the Hood of Your Matter Smart Home - CSA-IOT,&rdquo; <span class="emphasis" id="1703914554#-g0pb39_71">CSA-IOT</span>, Aug. 28, 2024. Online (<a href="https://csa-iot.org/newsroom/peeking-under-the-hood-of-your-matter-smart-home/">https://csa-iot.org/newsroom/peeking-under-the-hood-of-your-matter-smart-home/</a>).</p><p id="1703914554#-g0pb39_38">[16] &ldquo;Technical documentation.&rdquo; Online (<a href="https://docs.nordicsemi.com/bundle/ncs-2.6.1/page/matter/chip_tool_guide.html">https://docs.nordicsemi.com/bundle/ncs-2.6.1/page/matter/chip_tool_guide.html</a>).</p><p id="1703914554#-g0pb39_39">[17] &ldquo;Programming Guide - ESP32 - Espressif&rsquo;s SDK for Matter latest documentation.&rdquo; Online (<a href="https://docs.espressif.com/projects/esp-matter/en/latest/esp32/">https://docs.espressif.com/projects/esp-matter/en/latest/esp32/</a>).</p><p id="1703914554#-g0pb39_40">[18] &ldquo;Commissioning | Overview Guides | Silicon Labs Matter | V2.2.1 | Silicon Labs.&rdquo; Online (<a href="https://docs.silabs.com/matter/2.2.1/matter-overview-guides/matter-commissioning">https://docs.silabs.com/matter/2.2.1/matter-overview-guides/matter-commissioning</a>).</p><p id="1703914554#-g0pb39_41">[19] &ldquo;ESP32-H2 Thread/Zigbee &amp; BLE 5 SOC | Espressif Systems.&rdquo; Online (<a href="https://www.espressif.com/en/products/socs/esp32-h2">https://www.espressif.com/en/products/socs/esp32-h2</a>).</p><p id="1703914554#-g0pb39_42">[20] &ldquo;Introduction to Matter | Introduction to Matter | Silicon Labs Matter | V2.1.1 | Silicon Labs.&rdquo; Online (<a href="https://docs.silabs.com/matter/2.1.1/matter-fundamentals-introduction/">https://docs.silabs.com/matter/2.1.1/matter-fundamentals-introduction/</a>).</p><p id="1703914554#-g0pb39_43">[21] &ldquo;Matter FAQs | Frequently Asked Questions - CSA-IOT,&rdquo; <span class="emphasis" id="1703914554#-g0pb39_78">CSA-IOT</span>. Online (<a href="https://csa-iot.org/all-solutions/matter/matter-faq/">https://csa-iot.org/all-solutions/matter/matter-faq/</a>).</p><p id="1703914554#-g0pb39_44">[22] &ldquo;Thread benefits.&rdquo; Online (<a href="https://www.threadgroup.org/What-is-Thread/Thread-Benefits">https://www.threadgroup.org/What-is-Thread/Thread-Benefits</a>).</p><p id="1703914554#-g0pb39_45">[23] &ldquo;OpenThread Border Router,&rdquo; <span class="emphasis" id="1703914554#-g0pb39_81">OpenThread</span>. Online (<a href="https://openthread.io/guides/border-router">https://openthread.io/guides/border-router</a>).</p></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="194827036">System Design</h1><section class="detached"><h2 id="194827036#architecture-overview" data-toc="architecture-overview#System-Design.md-architecture-overview">Architecture Overview</h2><div class="image-container"><img class="center image" id="194827036#-8wceg7_5" alt="Architecture Diagram" title="Architecture Diagram" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/system-design/architecture.png" width="500" height="500"></div><p id="194827036#-8wceg7_6">This automated <span class="control" id="194827036#-8wceg7_11">Controlled Environment Agriculture</span> system is designed with a modular structure composed of independent <span class="control" id="194827036#-8wceg7_12">Grow Chambers</span> that include the following components:</p><ul class="list" id="194827036#-8wceg7_7" start="1"><li class="list-item" id="194827036#-8wceg7_13"><p><span class="control" id="194827036#-8wceg7_16">Root Chamber</span> contains the plant's root system and nutrient solution.</p></li><li class="list-item" id="194827036#-8wceg7_14"><p><span class="control" id="194827036#-8wceg7_17">Lighting</span> provides artificial light for photosynthesis.</p></li><li class="list-item" id="194827036#-8wceg7_15"><p><span class="control" id="194827036#-8wceg7_18">Ventilation</span> regulates temperature, humidity, and CO₂ levels.</p></li></ul><p id="194827036#-8wceg7_8">Each Grow Chamber is an independent unit designed to maintain a controlled environment for plant growth. Environmental conditions are regulated through a mesh network of <span class="control" id="194827036#-8wceg7_19">Accessory Devices</span>:</p><ul class="list" id="194827036#-8wceg7_9" start="1"><li class="list-item" id="194827036#-8wceg7_20"><p><span class="control" id="194827036#-8wceg7_22">Sensors</span> monitor temperature, humidity, light intensity, and CO₂ levels.</p></li><li class="list-item" id="194827036#-8wceg7_21"><p><span class="control" id="194827036#-8wceg7_23">Actuators</span> adjust conditions by controlling fog generation, ventilation, and lighting.</p></li></ul><p id="194827036#-8wceg7_10">The <span class="control" id="194827036#-8wceg7_24">Orchestrator</span> devices allow farmers to set up and manage Grow Chambers, while <span class="control" id="194827036#-8wceg7_25">Controller</span> devices provide an interface for monitoring and control.</p></section><section class="detached"><h2 id="194827036#network-communication" data-toc="network-communication#System-Design.md-network-communication">Network Communication</h2><p id="194827036#-8wceg7_26"><span class="control" id="194827036#-8wceg7_29">Thread</span> protocol enables low-power communication between the devices and ensures network reliability. If one device fails, the rest of the network remains operational.</p><p id="194827036#-8wceg7_27">Wi-Fi and Thread integration through <span class="control" id="194827036#-8wceg7_30">Thread Border Routers</span> allows remote monitoring and control through <span class="control" id="194827036#-8wceg7_31">Controller</span> devices.</p><p id="194827036#-8wceg7_28"><span class="control" id="194827036#-8wceg7_32">Matter</span> enables secure and standardized communication over Wi-Fi, Ethernet, and Thread, allowing sensors, actuators, and controllers to work together without compatibility issues.</p></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-487402309">Development Plan</h1><section class="detached"><h2 id="-487402309#sprint-0-system-design" data-toc="sprint-0-system-design#Development-Plan.md-sprint-0-system-design">Sprint 0: System Design</h2><p id="-487402309#r0kdx6_9">The primary goal of this sprint is to design the system architecture.</p><p id="-487402309#r0kdx6_10">Timeline: September 6, 2024 - October 6, 2024</p><ul class="list" id="-487402309#r0kdx6_11" start="1"><li class="list-item" id="-487402309#r0kdx6_12"><p><span class="no-bold">✅</span> Design system architecture</p></li><li class="list-item" id="-487402309#r0kdx6_13"><p><span class="no-bold">✅</span> Design network infrastructure</p></li><li class="list-item" id="-487402309#r0kdx6_14"><p><span class="no-bold">✅</span> Define hardware and software components</p></li></ul></section><section class="detached"><h2 id="-487402309#sprint-1-accessory-device-development" data-toc="sprint-1-accessory-device-development#Development-Plan.md-sprint-1-accessory-device-development">Sprint 1: Accessory Device Development</h2><p id="-487402309#r0kdx6_15">The primary goal of this sprint is to develop and validate an accessory device, a temperature sensor.</p><p id="-487402309#r0kdx6_16">Timeline: October 6, 2024 - November 7, 2024</p><ul class="list" id="-487402309#r0kdx6_17" start="1"><li class="list-item" id="-487402309#r0kdx6_18"><p><span class="no-bold">✅</span> Set up ESP-IDF and ESP-Matter Development Environment</p></li><li class="list-item" id="-487402309#r0kdx6_19"><p><span class="no-bold">✅</span> Assemble hardware for BMP280-based Sensor</p></li><li class="list-item" id="-487402309#r0kdx6_20"><p><span class="no-bold">✅</span> Develop firmware for BMP280 Sensor</p></li><li class="list-item" id="-487402309#r0kdx6_21"><p><span class="no-bold">✅</span> Test I2C Communication</p></li><li class="list-item" id="-487402309#r0kdx6_22"><p><span class="no-bold">✅</span> Configure Matter Controller on Raspberry Pi</p></li><li class="list-item" id="-487402309#r0kdx6_23"><p><span class="no-bold">✅</span> Test Matter Device Commissioning (BLE &amp; Wi-Fi Pairing)</p></li></ul></section><section class="detached"><h2 id="-487402309#sprint-2-grow-chamber-assembly" data-toc="sprint-2-grow-chamber-assembly#Development-Plan.md-sprint-2-grow-chamber-assembly">Sprint 2: Grow Chamber Assembly</h2><p id="-487402309#r0kdx6_24">The primary goal of this sprint is to assemble the Grow Chamber.</p><p id="-487402309#r0kdx6_25">Timeline: November 8, 2024 - December 10, 2024</p><ul class="list" id="-487402309#r0kdx6_26" start="1"><li class="list-item" id="-487402309#r0kdx6_27"><p><span class="no-bold">✅</span> Assemble grow tent</p></li><li class="list-item" id="-487402309#r0kdx6_28"><p><span class="no-bold">✅</span> Install exhaust fan</p></li><li class="list-item" id="-487402309#r0kdx6_29"><p><span class="no-bold">✅</span> Install lighting</p></li><li class="list-item" id="-487402309#r0kdx6_30"><p><span class="no-bold">✅</span> Assemble root chamber</p></li><li class="list-item" id="-487402309#r0kdx6_31"><p><span class="no-bold">✅</span> Integrate a temperature sensor</p></li><li class="list-item" id="-487402309#r0kdx6_32"><p><span class="no-bold">✅</span> Integrate a Mist Maker</p></li></ul></section><section class="detached"><h2 id="-487402309#sprint-3-orchestrator-device-development" data-toc="sprint-3-orchestrator-device-development#Development-Plan.md-sprint-3-orchestrator-device-development">Sprint 3: Orchestrator Device Development</h2><p id="-487402309#r0kdx6_33">The primary goal of this sprint is to develop and validate an orchestrator device.</p><p id="-487402309#r0kdx6_34">Timeline: January 8, 2025 - February 5, 2025</p><p id="-487402309#r0kdx6_35"><span class="control" id="-487402309#r0kdx6_41">User Stories:</span></p><ul class="list" id="-487402309#r0kdx6_36" start="1"><li class="list-item" id="-487402309#r0kdx6_42"><p>US1: Orchestrator Device Assembly &amp; Configuration</p></li><li class="list-item" id="-487402309#r0kdx6_43"><p>US2: Communication Reliability Across Protocols</p></li><li class="list-item" id="-487402309#r0kdx6_44"><p>US3: Real-Time Sensor Monitoring</p></li><li class="list-item" id="-487402309#r0kdx6_45"><p>US4: Actuator Control Based on Sensor Inputs</p></li><li class="list-item" id="-487402309#r0kdx6_46"><p>US5: Orchestrator Local Data Storage</p></li><li class="list-item" id="-487402309#r0kdx6_47"><p>US6: Device Discovery &amp; Integration</p></li></ul><p id="-487402309#r0kdx6_37"><span class="control" id="-487402309#r0kdx6_48">Functional Requirements:</span></p><ul class="list" id="-487402309#r0kdx6_38" start="1"><li class="list-item" id="-487402309#r0kdx6_49"><p>FR1: Orchestrator Device Management</p></li><li class="list-item" id="-487402309#r0kdx6_50"><p>FR2: Sensor Monitoring &amp; Alerts</p></li><li class="list-item" id="-487402309#r0kdx6_51"><p>FR3: Actuator Control &amp; Automation</p></li><li class="list-item" id="-487402309#r0kdx6_52"><p>FR4: Device Discovery &amp; Integration</p></li></ul><p id="-487402309#r0kdx6_39"><span class="control" id="-487402309#r0kdx6_53">Non-Functional Requirements:</span></p><ul class="list" id="-487402309#r0kdx6_40" start="1"><li class="list-item" id="-487402309#r0kdx6_54"><p>NFR1: Performance</p></li><li class="list-item" id="-487402309#r0kdx6_55"><p>NFR2: Reliability</p></li><li class="list-item" id="-487402309#r0kdx6_56"><p>NFR4: Scalability</p></li></ul></section><section class="detached"><h2 id="-487402309#sprint-4-controller-development" data-toc="sprint-4-controller-development#Development-Plan.md-sprint-4-controller-development">Sprint 4: Controller Development</h2><p id="-487402309#r0kdx6_57">The primary goal of this sprint is to develop and validate a controller device.</p><p id="-487402309#r0kdx6_58">Timeline: February 6, 2025 - February 19, 2025</p><p id="-487402309#r0kdx6_59"><span class="control" id="-487402309#r0kdx6_65">User Stories:</span></p><ul class="list" id="-487402309#r0kdx6_60" start="1"><li class="list-item" id="-487402309#r0kdx6_66"><p>US7: Controller Device Assembly &amp; Configuration</p></li><li class="list-item" id="-487402309#r0kdx6_67"><p>US8: Environment Profiles in Orchestrator</p></li><li class="list-item" id="-487402309#r0kdx6_68"><p>US9: Selecting Environmental Profiles and Settings</p></li><li class="list-item" id="-487402309#r0kdx6_69"><p>US10: Remote Monitoring via Controller Application</p></li><li class="list-item" id="-487402309#r0kdx6_70"><p>US11: Real-Time Alerts for Environmental Deviations</p></li></ul><p id="-487402309#r0kdx6_61"><span class="control" id="-487402309#r0kdx6_71">Functional Requirements:</span></p><ul class="list" id="-487402309#r0kdx6_62" start="1"><li class="list-item" id="-487402309#r0kdx6_72"><p>FR5: Environmental Profiles &amp; Grow Chamber Management</p></li><li class="list-item" id="-487402309#r0kdx6_73"><p>FR6: Remote Monitoring &amp; Control</p></li><li class="list-item" id="-487402309#r0kdx6_74"><p>FR7: User Authentication &amp; Access Control</p></li></ul><p id="-487402309#r0kdx6_63"><span class="control" id="-487402309#r0kdx6_75">Non-Functional Requirements:</span></p><ul class="list" id="-487402309#r0kdx6_64" start="1"><li class="list-item" id="-487402309#r0kdx6_76"><p>NFR3: Security &amp; Access Control</p></li><li class="list-item" id="-487402309#r0kdx6_77"><p>NFR6: Usability &amp; User Experience</p></li></ul></section><section class="detached"><h2 id="-487402309#sprint-5-system-integration" data-toc="sprint-5-system-integration#Development-Plan.md-sprint-5-system-integration">Sprint 5: System Integration</h2><p id="-487402309#r0kdx6_78">The primary goal of this sprint is to integrate all components into the system.</p><p id="-487402309#r0kdx6_79">Timeline: February 20, 2025 - March 5, 2025</p><p id="-487402309#r0kdx6_80"><span class="control" id="-487402309#r0kdx6_86">User Stories:</span></p><ul class="list" id="-487402309#r0kdx6_81" start="1"><li class="list-item" id="-487402309#r0kdx6_87"><p>US12: Integration of Third-Party Agricultural Sensors</p></li><li class="list-item" id="-487402309#r0kdx6_88"><p>US13: Grow Chamber Management &amp; Scaling</p></li><li class="list-item" id="-487402309#r0kdx6_89"><p>US14: Development of Humidity Sensor</p></li><li class="list-item" id="-487402309#r0kdx6_90"><p>US15: Development of CO₂ Sensor</p></li></ul><p id="-487402309#r0kdx6_82"><span class="control" id="-487402309#r0kdx6_91">Functional Requirements:</span></p><ul class="list" id="-487402309#r0kdx6_83" start="1"><li class="list-item" id="-487402309#r0kdx6_92"><p>FR5: Environmental Profiles &amp; Grow Chamber Management</p></li><li class="list-item" id="-487402309#r0kdx6_93"><p>FR6: Remote Monitoring &amp; Control</p></li></ul><p id="-487402309#r0kdx6_84"><span class="control" id="-487402309#r0kdx6_94">Non-Functional Requirements:</span></p><ul class="list" id="-487402309#r0kdx6_85" start="1"><li class="list-item" id="-487402309#r0kdx6_95"><p>NFR5: Interoperability</p></li><li class="list-item" id="-487402309#r0kdx6_96"><p>NFR7: Compliance &amp; Standards</p></li></ul></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-1455554384">Requirements</h1><section class="detached"><h2 id="-1455554384#functional-requirements" data-toc="functional-requirements#Requirements.md-functional-requirements">Functional Requirements</h2><section class="detached"><h3 id="-1455554384#fr1-device-management" data-toc="fr1-device-management#Requirements.md-fr1-device-management">FR1. Device Management</h3><ul class="list" id="-1455554384#-89dl0b_13" start="1"><li class="list-item" id="-1455554384#-89dl0b_14"><p>The system must support the <span class="control" id="-1455554384#-89dl0b_17">ESP32-C6</span> as Controller hardware.</p></li><li class="list-item" id="-1455554384#-89dl0b_15"><p>The Controller must be able to <span class="control" id="-1455554384#-89dl0b_18">continuously monitor device connectivity</span> across Matter, Thread, and Wi-Fi networks.</p></li><li class="list-item" id="-1455554384#-89dl0b_16"><p>The system must provide <span class="control" id="-1455554384#-89dl0b_19">fallback communication modes</span> (e.g., switching from Thread to Wi-Fi) in case of network failure.</p></li></ul></section><section class="detached"><h3 id="-1455554384#fr2-sensor-monitoring-alerts" data-toc="fr2-sensor-monitoring-alerts#Requirements.md-fr2-sensor-monitoring-alerts">FR2. Sensor Monitoring &amp; Alerts</h3><ul class="list" id="-1455554384#-89dl0b_20" start="1"><li class="list-item" id="-1455554384#-89dl0b_21"><p>The system must <span class="control" id="-1455554384#-89dl0b_25">collect real-time sensor data</span> from temperature, humidity, and CO₂ sensors.</p></li><li class="list-item" id="-1455554384#-89dl0b_22"><p>The system must generate <span class="control" id="-1455554384#-89dl0b_26">alerts</span> when sensor values exceed predefined thresholds.</p></li><li class="list-item" id="-1455554384#-89dl0b_23"><p>Users must be able to view <span class="control" id="-1455554384#-89dl0b_27">historical trends of sensor data</span> for diagnostics.</p></li><li class="list-item" id="-1455554384#-89dl0b_24"><p>The system must allow <span class="control" id="-1455554384#-89dl0b_28">manual sensor calibration</span> to maintain accuracy.</p></li></ul></section><section class="detached"><h3 id="-1455554384#fr3-actuator-control-automation" data-toc="fr3-actuator-control-automation#Requirements.md-fr3-actuator-control-automation">FR3. Actuator Control &amp; Automation</h3><ul class="list" id="-1455554384#-89dl0b_29" start="1"><li class="list-item" id="-1455554384#-89dl0b_30"><p>The system must <span class="control" id="-1455554384#-89dl0b_33">automatically trigger actuators</span> (mist maker, exhaust fan, LED grow lights) based on sensor inputs.</p></li><li class="list-item" id="-1455554384#-89dl0b_31"><p>Growers must be able to <span class="control" id="-1455554384#-89dl0b_34">manually override actuator actions</span> via the Controller.</p></li><li class="list-item" id="-1455554384#-89dl0b_32"><p>The system must support <span class="control" id="-1455554384#-89dl0b_35">custom automation rules</span> based on environmental conditions.</p></li></ul></section><section class="detached"><h3 id="-1455554384#fr4-device-discovery-integration" data-toc="fr4-device-discovery-integration#Requirements.md-fr4-device-discovery-integration">FR4. Device Discovery &amp; Integration</h3><ul class="list" id="-1455554384#-89dl0b_36" start="1"><li class="list-item" id="-1455554384#-89dl0b_37"><p>The Controller must <span class="control" id="-1455554384#-89dl0b_40">detect and integrate new sensors and actuators</span> upon activation.</p></li><li class="list-item" id="-1455554384#-89dl0b_38"><p>The system must support <span class="control" id="-1455554384#-89dl0b_41">Matter, Thread, and Wi-Fi</span> for seamless device integration.</p></li><li class="list-item" id="-1455554384#-89dl0b_39"><p>Users must be able to <span class="control" id="-1455554384#-89dl0b_42">manually configure devices</span> if they are not automatically recognized.</p></li></ul></section><section class="detached"><h3 id="-1455554384#fr5-environmental-profiles-grow-chamber-management" data-toc="fr5-environmental-profiles-grow-chamber-management#Requirements.md-fr5-environmental-profiles-grow-chamber-management">FR5. Environmental Profiles &amp; Grow Chamber Management</h3><ul class="list" id="-1455554384#-89dl0b_43" start="1"><li class="list-item" id="-1455554384#-89dl0b_44"><p>The system must support <span class="control" id="-1455554384#-89dl0b_47">predefined and customizable environmental profiles</span> for different plant types.</p></li><li class="list-item" id="-1455554384#-89dl0b_45"><p>Growers must be able to <span class="control" id="-1455554384#-89dl0b_48">apply environmental settings</span> to one or multiple Grow Chambers.</p></li><li class="list-item" id="-1455554384#-89dl0b_46"><p>The system must allow users to <span class="control" id="-1455554384#-89dl0b_49">add, remove, and configure multiple Grow Chambers</span>.</p></li></ul></section><section class="detached"><h3 id="-1455554384#fr6-remote-monitoring-control" data-toc="fr6-remote-monitoring-control#Requirements.md-fr6-remote-monitoring-control">FR6. Remote Monitoring &amp; Control</h3><ul class="list" id="-1455554384#-89dl0b_50" start="1"><li class="list-item" id="-1455554384#-89dl0b_51"><p>The system must provide a <span class="control" id="-1455554384#-89dl0b_54">web-based and mobile Controller application</span> for remote monitoring.</p></li><li class="list-item" id="-1455554384#-89dl0b_52"><p>Users must be able to view <span class="control" id="-1455554384#-89dl0b_55">real-time sensor and actuator data</span>.</p></li><li class="list-item" id="-1455554384#-89dl0b_53"><p>The system must send <span class="control" id="-1455554384#-89dl0b_56">real-time alerts via email, SMS, or push notifications</span>.</p></li></ul></section><section class="detached"><h3 id="-1455554384#fr7-user-authentication-access-control" data-toc="fr7-user-authentication-access-control#Requirements.md-fr7-user-authentication-access-control">FR7. User Authentication &amp; Access Control</h3><ul class="list" id="-1455554384#-89dl0b_57" start="1"><li class="list-item" id="-1455554384#-89dl0b_58"><p>The system must implement <span class="control" id="-1455554384#-89dl0b_61">role-based access control (RBAC)</span> (Administrator, Technician, Grower).</p></li><li class="list-item" id="-1455554384#-89dl0b_59"><p>Remote access to the system must require <span class="control" id="-1455554384#-89dl0b_62">authentication</span>.</p></li><li class="list-item" id="-1455554384#-89dl0b_60"><p>All <span class="control" id="-1455554384#-89dl0b_63">user actions (settings changes, manual overrides) must be logged</span>.</p></li></ul></section></section><section class="detached"><h2 id="-1455554384#non-functional-requirements" data-toc="non-functional-requirements#Requirements.md-non-functional-requirements">Non-Functional Requirements</h2><section class="detached"><h3 id="-1455554384#nfr1-performance" data-toc="nfr1-performance#Requirements.md-nfr1-performance">NFR1. Performance</h3><ul class="list" id="-1455554384#-89dl0b_66" start="1"><li class="list-item" id="-1455554384#-89dl0b_67"><p>The system must process sensor data and actuator responses <span class="control" id="-1455554384#-89dl0b_69">within 1 second</span></p></li><li class="list-item" id="-1455554384#-89dl0b_68"><p>Controller must be capable of handling <span class="control" id="-1455554384#-89dl0b_70">simultaneous data streams</span> from multiple sensors and actuators without performance degradation</p></li></ul></section><section class="detached"><h3 id="-1455554384#nfr2-reliability" data-toc="nfr2-reliability#Requirements.md-nfr2-reliability">NFR2. Reliability</h3><ul class="list" id="-1455554384#-89dl0b_71" start="1"><li class="list-item" id="-1455554384#-89dl0b_72"><p>The system must be <span class="control" id="-1455554384#-89dl0b_75">capable of offline operation</span> in case of network disruptions</p></li><li class="list-item" id="-1455554384#-89dl0b_73"><p>All sensor readings and logs must be stored <span class="control" id="-1455554384#-89dl0b_76">locally for at least 30 days</span></p></li><li class="list-item" id="-1455554384#-89dl0b_74"><p>Automatic device reconnection implemented when network connectivity is restored</p></li></ul></section></section><section class="detached"><h2 id="-1455554384#nfr3-security-access-control" data-toc="nfr3-security-access-control#Requirements.md-nfr3-security-access-control">NFR3. Security &amp; Access Control</h2><ul class="list" id="-1455554384#-89dl0b_77" start="1"><li class="list-item" id="-1455554384#-89dl0b_82"><p>All data communications must be <span class="control" id="-1455554384#-89dl0b_84">encrypted</span></p></li><li class="list-item" id="-1455554384#-89dl0b_83"><p>Remote access to the Controller must require authentication</p></li></ul><section class="detached"><h3 id="-1455554384#nfr4-scalability" data-toc="nfr4-scalability#Requirements.md-nfr4-scalability">NFR4. Scalability</h3><ul class="list" id="-1455554384#-89dl0b_85" start="1"><li class="list-item" id="-1455554384#-89dl0b_86"><p>The system must be <span class="control" id="-1455554384#-89dl0b_88">modular</span>, allowing the addition new devices without major modifications</p></li><li class="list-item" id="-1455554384#-89dl0b_87"><p>Support for at least 20 Grow Chambers with independent environmental settings</p></li></ul></section><section class="detached"><h3 id="-1455554384#nfr5-interoperability" data-toc="nfr5-interoperability#Requirements.md-nfr5-interoperability">NFR5. Interoperability</h3><ul class="list" id="-1455554384#-89dl0b_89" start="1"><li class="list-item" id="-1455554384#-89dl0b_90"><p>The architecture must be designed to support <span class="control" id="-1455554384#-89dl0b_92">third-party sensors and actuators</span></p></li><li class="list-item" id="-1455554384#-89dl0b_91"><p>The Controller must be able to <span class="control" id="-1455554384#-89dl0b_93">automatically detect and configure new devices</span></p></li></ul></section><section class="detached"><h3 id="-1455554384#nfr6-usability-user-experience" data-toc="nfr6-usability-user-experience#Requirements.md-nfr6-usability-user-experience">NFR6. Usability &amp; User Experience</h3><ul class="list" id="-1455554384#-89dl0b_94" start="1"><li class="list-item" id="-1455554384#-89dl0b_95"><p>Controller must provide an <span class="control" id="-1455554384#-89dl0b_96">intuitive interface</span> that can be used with minimal training</p></li></ul></section><section class="detached"><h3 id="-1455554384#nfr7-compliance-standards" data-toc="nfr7-compliance-standards#Requirements.md-nfr7-compliance-standards">NFR7. Compliance &amp; Standards</h3><ul class="list" id="-1455554384#-89dl0b_97" start="1"><li class="list-item" id="-1455554384#-89dl0b_98"><p>The system must support the <span class="control" id="-1455554384#-89dl0b_99">Matter 1.3 and Thread 1.2</span> IoT standards</p></li></ul></section></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="1317451997">Backlog</h1><section class="detached"><h2 id="1317451997#us1-border-router" data-toc="us1-border-router#Backlog.md-us1-border-router">US1: Border Router</h2><p id="1317451997#-ejwdxk_18"><span class="emphasis" id="1317451997#-ejwdxk_21">As a developer, I want to set up a Border Router so that Thread devices can communicate with external IP networks.</span></p><p id="1317451997#-ejwdxk_19"><span class="control" id="1317451997#-ejwdxk_22">Acceptance Criteria:</span></p><ul class="list" id="1317451997#-ejwdxk_20" start="1"><li class="list-item" id="1317451997#-ejwdxk_23"><p>The Border Router must connect the Thread Network to external IP networks (Wi-Fi or Ethernet).</p></li><li class="list-item" id="1317451997#-ejwdxk_24"><p>The Border Router must run on ESP Thread Border Router board.</p></li><li class="list-item" id="1317451997#-ejwdxk_25"><p>The system must provide a Web GUI for configuring and monitoring Thread networks.</p></li><li class="list-item" id="1317451997#-ejwdxk_26"><p>The system must allow devices to communicate with the internet.</p></li></ul></section><section class="detached"><h2 id="1317451997#us2-communication-reliability-across-protocols" data-toc="us2-communication-reliability-across-protocols#Backlog.md-us2-communication-reliability-across-protocols">US2: Communication Reliability Across Protocols</h2><p id="1317451997#-ejwdxk_27"><span class="emphasis" id="1317451997#-ejwdxk_30">As a Border Router, I want to ensure smooth communication between Matter, Thread, and Wi-Fi devices so that all system components remain connected.</span></p><p id="1317451997#-ejwdxk_28"><span class="control" id="1317451997#-ejwdxk_31">Acceptance Criteria:</span></p><ul class="list" id="1317451997#-ejwdxk_29" start="1"><li class="list-item" id="1317451997#-ejwdxk_32"><p>The Border Router must <span class="control" id="1317451997#-ejwdxk_36">continuously monitor device connectivity</span> across Matter, Thread, and Wi-Fi networks.</p></li><li class="list-item" id="1317451997#-ejwdxk_33"><p>The system must <span class="control" id="1317451997#-ejwdxk_37">automatically reconnect devices</span> if they temporarily lose connection.</p></li><li class="list-item" id="1317451997#-ejwdxk_34"><p>The system must trigger an <span class="control" id="1317451997#-ejwdxk_38">alert</span> if a device remains disconnected beyond a defined threshold.</p></li><li class="list-item" id="1317451997#-ejwdxk_35"><p>The Border Router must provide <span class="control" id="1317451997#-ejwdxk_39">fallback communication modes</span> (e.g., switching from Thread to Wi-Fi) if a primary network fails.</p></li></ul></section><section class="detached"><h2 id="1317451997#us3-real-time-sensor-monitoring" data-toc="us3-real-time-sensor-monitoring#Backlog.md-us3-real-time-sensor-monitoring">US3: Real-Time Sensor Monitoring</h2><p id="1317451997#-ejwdxk_40"><span class="emphasis" id="1317451997#-ejwdxk_43">As a Controller, I want to monitor all connected sensors in real-time so that I can adjust environmental conditions dynamically.</span></p><p id="1317451997#-ejwdxk_41"><span class="control" id="1317451997#-ejwdxk_44">Acceptance Criteria:</span></p><ul class="list" id="1317451997#-ejwdxk_42" start="1"><li class="list-item" id="1317451997#-ejwdxk_45"><p>The Controller must collect <span class="control" id="1317451997#-ejwdxk_49">real-time sensor data</span> (humidity, temperature, CO₂, etc.).</p></li><li class="list-item" id="1317451997#-ejwdxk_46"><p>The system must alert when a sensor value goes outside the defined Environmental Profile range.</p></li><li class="list-item" id="1317451997#-ejwdxk_47"><p>The technician must be able to view <span class="control" id="1317451997#-ejwdxk_50">historical sensor data trends</span> for diagnosing system performance.</p></li><li class="list-item" id="1317451997#-ejwdxk_48"><p>The system must <span class="control" id="1317451997#-ejwdxk_51">automatically trigger corrective actions</span> based on sensor readings (e.g., activate mist maker if humidity drops).</p></li></ul></section><section class="detached"><h2 id="1317451997#us4-actuator-control-based-on-sensor-inputs" data-toc="us4-actuator-control-based-on-sensor-inputs#Backlog.md-us4-actuator-control-based-on-sensor-inputs">US4: Actuator Control Based on Sensor Inputs</h2><p id="1317451997#-ejwdxk_52"><span class="emphasis" id="1317451997#-ejwdxk_55">As a Controller, I want to trigger actuators (mist maker, exhaust fan, LED grow lights) based on sensor inputs so that plants receive optimal care.</span></p><p id="1317451997#-ejwdxk_53"><span class="control" id="1317451997#-ejwdxk_56">Acceptance Criteria:</span></p><ul class="list" id="1317451997#-ejwdxk_54" start="1"><li class="list-item" id="1317451997#-ejwdxk_57"><p>The system must trigger the <span class="control" id="1317451997#-ejwdxk_60">mist maker</span> if humidity drops below the target range.</p></li><li class="list-item" id="1317451997#-ejwdxk_58"><p>The system must activate the <span class="control" id="1317451997#-ejwdxk_61">exhaust fan</span> if CO₂ levels exceed the defined threshold.</p></li><li class="list-item" id="1317451997#-ejwdxk_59"><p>The technician must be able to <span class="control" id="1317451997#-ejwdxk_62">manually override actuator actions</span> if needed.</p></li></ul></section><section class="detached"><h2 id="1317451997#us5-controller-local-data-storage" data-toc="us5-controller-local-data-storage#Backlog.md-us5-controller-local-data-storage">US5: Controller Local Data Storage</h2><p id="1317451997#-ejwdxk_63"><span class="emphasis" id="1317451997#-ejwdxk_66">As a Controller, I want to store sensor data locally so that I can continue operations even during network failures.</span></p><p id="1317451997#-ejwdxk_64"><span class="control" id="1317451997#-ejwdxk_67">Acceptance Criteria:</span></p><ul class="list" id="1317451997#-ejwdxk_65" start="1"><li class="list-item" id="1317451997#-ejwdxk_68"><p>The Controller must <span class="control" id="1317451997#-ejwdxk_70">store all sensor readings and actuator logs locally</span> in case of network disruptions.</p></li><li class="list-item" id="1317451997#-ejwdxk_69"><p>The technician must be able to access locally stored data through a <span class="control" id="1317451997#-ejwdxk_71">diagnostic interface</span>.</p></li></ul></section><section class="detached"><h2 id="1317451997#us6-controller-device" data-toc="us6-controller-device#Backlog.md-us6-controller-device">US6: Controller Device</h2><p id="1317451997#-ejwdxk_72"><span class="emphasis" id="1317451997#-ejwdxk_75">As a technician, I want to assemble and configure the Controller device so that growers can remotely monitor and control the system.</span></p><p id="1317451997#-ejwdxk_73"><span class="control" id="1317451997#-ejwdxk_76">Acceptance Criteria:</span></p><ul class="list" id="1317451997#-ejwdxk_74" start="1"><li class="list-item" id="1317451997#-ejwdxk_77"><p>The Controller device must be assembled and flashed with the appropriate firmware.</p></li><li class="list-item" id="1317451997#-ejwdxk_78"><p>The mobile/web application must be deployed to connect with the Orchestrator.</p></li><li class="list-item" id="1317451997#-ejwdxk_79"><p>The controller must display real-time sensor data and allow actuator control.</p></li></ul></section><section class="detached"><h2 id="1317451997#us7-device-discovery-integration" data-toc="us7-device-discovery-integration#Backlog.md-us7-device-discovery-integration">US7: Device Discovery &amp; Integration</h2><p id="1317451997#-ejwdxk_80"><span class="emphasis" id="1317451997#-ejwdxk_83">As n Controller, I want to detect new accessory devices (sensors, actuators) and add them to the network so that they can be controlled efficiently.</span></p><p id="1317451997#-ejwdxk_81"><span class="control" id="1317451997#-ejwdxk_84">Acceptance Criteria:</span></p><ul class="list" id="1317451997#-ejwdxk_82" start="1"><li class="list-item" id="1317451997#-ejwdxk_85"><p>The Controller must automatically <span class="control" id="1317451997#-ejwdxk_91">detect new sensors and actuators</span> when they are powered on and within the network range.</p></li><li class="list-item" id="1317451997#-ejwdxk_86"><p>The system must support <span class="control" id="1317451997#-ejwdxk_92">Matter, Thread, and Wi-Fi</span> communication protocols for seamless integration.</p></li><li class="list-item" id="1317451997#-ejwdxk_87"><p>The Controller must be able to <span class="control" id="1317451997#-ejwdxk_93">assign each new device</span> to a specific Grow Chamber.</p></li><li class="list-item" id="1317451997#-ejwdxk_88"><p>The technician can <span class="control" id="1317451997#-ejwdxk_94">manually configure detected devices</span> if they are not automatically recognized.</p></li><li class="list-item" id="1317451997#-ejwdxk_89"><p>The system must ensure that newly added devices <span class="control" id="1317451997#-ejwdxk_95">sync with predefined Environmental Profiles</span> for optimal operation.</p></li><li class="list-item" id="1317451997#-ejwdxk_90"><p>The system must notify the technician if a device <span class="control" id="1317451997#-ejwdxk_96">fails to connect or has a communication issue</span>.</p></li></ul></section><section class="detached"><h2 id="1317451997#us8-environment-profiles-in-controller" data-toc="us8-environment-profiles-in-controller#Backlog.md-us8-environment-profiles-in-controller">US8: Environment Profiles in Controller</h2><p id="1317451997#-ejwdxk_97"><span class="emphasis" id="1317451997#-ejwdxk_100">As a Controller, I want to define preset environmental configurations for different plant types so that growers can easily set up new crops.</span></p><p id="1317451997#-ejwdxk_98"><span class="control" id="1317451997#-ejwdxk_101">Acceptance Criteria:</span></p><ul class="list" id="1317451997#-ejwdxk_99" start="1"><li class="list-item" id="1317451997#-ejwdxk_102"><p>The system must include <span class="control" id="1317451997#-ejwdxk_105">predefined Environmental Profiles</span> for various plant types (e.g., leafy greens, fruiting plants, herbs).</p></li><li class="list-item" id="1317451997#-ejwdxk_103"><p>The technician must be able to <span class="control" id="1317451997#-ejwdxk_106">create and customize new Environmental Profiles</span> based on specific crop needs.</p></li><li class="list-item" id="1317451997#-ejwdxk_104"><p>Each Environmental Profile must define: </p><ul class="list" id="1317451997#-ejwdxk_107" start="1"><li class="list-item" id="1317451997#-ejwdxk_108"><p><span class="control" id="1317451997#-ejwdxk_113">Target Humidity Range (%)</span></p></li><li class="list-item" id="1317451997#-ejwdxk_109"><p><span class="control" id="1317451997#-ejwdxk_114">Target Temperature Range (&deg;C/&deg;F)</span></p></li><li class="list-item" id="1317451997#-ejwdxk_110"><p><span class="control" id="1317451997#-ejwdxk_115">Target CO₂ Levels (ppm)</span></p></li><li class="list-item" id="1317451997#-ejwdxk_111"><p><span class="control" id="1317451997#-ejwdxk_116">Light Intensity &amp; Schedule</span></p></li><li class="list-item" id="1317451997#-ejwdxk_112"><p><span class="control" id="1317451997#-ejwdxk_117">Ventilation Requirements</span></p></li></ul></li></ul></section><section class="detached"><h2 id="1317451997#us9-selecting-environmental-profiles-and-settings" data-toc="us9-selecting-environmental-profiles-and-settings#Backlog.md-us9-selecting-environmental-profiles-and-settings">US9: Selecting Environmental Profiles and Settings</h2><p id="1317451997#-ejwdxk_118"><span class="emphasis" id="1317451997#-ejwdxk_121">As a grower, I want to select environmental settings for different crops so that I can optimize growth conditions.</span></p><p id="1317451997#-ejwdxk_119"><span class="control" id="1317451997#-ejwdxk_122">Acceptance Criteria:</span></p><ul class="list" id="1317451997#-ejwdxk_120" start="1"><li class="list-item" id="1317451997#-ejwdxk_123"><p>The system allows the grower to <span class="control" id="1317451997#-ejwdxk_126">select from predefined Environmental Profiles</span> tailored for specific crops.</p></li><li class="list-item" id="1317451997#-ejwdxk_124"><p>Growers can <span class="control" id="1317451997#-ejwdxk_127">customize temperature, humidity, CO₂ levels, and light schedules</span> for each crop.</p></li><li class="list-item" id="1317451997#-ejwdxk_125"><p>The system must apply the <span class="control" id="1317451997#-ejwdxk_128">selected environmental settings to one or multiple Grow Chambers</span>.</p></li></ul></section><section class="detached"><h2 id="1317451997#us10-remote-monitoring-via-controller-application" data-toc="us10-remote-monitoring-via-controller-application#Backlog.md-us10-remote-monitoring-via-controller-application">US10: Remote Monitoring via Controller Application</h2><p id="1317451997#-ejwdxk_129"><span class="emphasis" id="1317451997#-ejwdxk_132">As a grower, I want to remotely monitor grow chambers via a web application so that I can check the status of my crops from anywhere.</span></p><p id="1317451997#-ejwdxk_130"><span class="control" id="1317451997#-ejwdxk_133">Acceptance Criteria:</span></p><ul class="list" id="1317451997#-ejwdxk_131" start="1"><li class="list-item" id="1317451997#-ejwdxk_134"><p>The web application must display <span class="control" id="1317451997#-ejwdxk_137">real-time data</span> for all Grow Chambers.</p></li><li class="list-item" id="1317451997#-ejwdxk_135"><p>Growers must be able to <span class="control" id="1317451997#-ejwdxk_138">view temperature, humidity, CO₂, and actuator status</span>.</p></li><li class="list-item" id="1317451997#-ejwdxk_136"><p>The interface must allow <span class="control" id="1317451997#-ejwdxk_139">quick switching between different Grow Chambers</span>.</p></li></ul></section><section class="detached"><h2 id="1317451997#us11-real-time-alerts-for-environmental-deviations" data-toc="us11-real-time-alerts-for-environmental-deviations#Backlog.md-us11-real-time-alerts-for-environmental-deviations">US11: Real-Time Alerts for Environmental Deviations</h2><p id="1317451997#-ejwdxk_140"><span class="emphasis" id="1317451997#-ejwdxk_143">As a grower, I want to receive real-time alerts when temperature, humidity, or CO₂ levels exceed acceptable thresholds so that I can take corrective actions.</span></p><p id="1317451997#-ejwdxk_141"><span class="control" id="1317451997#-ejwdxk_144">Acceptance Criteria:</span></p><ul class="list" id="1317451997#-ejwdxk_142" start="1"><li class="list-item" id="1317451997#-ejwdxk_145"><p>The system must trigger <span class="control" id="1317451997#-ejwdxk_148">real-time alerts</span> when sensor values exceed or fall below predefined thresholds.</p></li><li class="list-item" id="1317451997#-ejwdxk_146"><p>The alert system must differentiate between <span class="control" id="1317451997#-ejwdxk_149">critical, warning, and informational notifications</span>.</p></li><li class="list-item" id="1317451997#-ejwdxk_147"><p>The system must log all alerts and corrective actions taken for future reference.</p></li></ul></section><section class="detached"><h2 id="1317451997#us12-integration-of-third-party-agricultural-sensors" data-toc="us12-integration-of-third-party-agricultural-sensors#Backlog.md-us12-integration-of-third-party-agricultural-sensors">US12: Integration of Third-Party Agricultural Sensors</h2><p id="1317451997#-ejwdxk_150"><span class="emphasis" id="1317451997#-ejwdxk_153">As a grower, I want to integrate third-party accessory devices into the system so that I can easily replace or add new devices.</span></p><p id="1317451997#-ejwdxk_151"><span class="control" id="1317451997#-ejwdxk_154">Acceptance Criteria:</span></p><ul class="list" id="1317451997#-ejwdxk_152" start="1"><li class="list-item" id="1317451997#-ejwdxk_155"><p>The system must support <span class="control" id="1317451997#-ejwdxk_159">Matter, Thread, and Wi-Fi-compatible sensors</span> from third-party manufacturers.</p></li><li class="list-item" id="1317451997#-ejwdxk_156"><p>The grower must be able to <span class="control" id="1317451997#-ejwdxk_160">manually configure third-party devices</span>.</p></li><li class="list-item" id="1317451997#-ejwdxk_157"><p>The system must display <span class="control" id="1317451997#-ejwdxk_161">data from third-party sensors alongside built-in system sensors</span>.</p></li><li class="list-item" id="1317451997#-ejwdxk_158"><p>Alerts and automation rules must be <span class="control" id="1317451997#-ejwdxk_162">customizable for third-party sensors</span>.</p></li></ul></section><section class="detached"><h2 id="1317451997#us13-grow-chamber-management-scaling" data-toc="us13-grow-chamber-management-scaling#Backlog.md-us13-grow-chamber-management-scaling">US13: Grow Chamber Management &amp; Scaling</h2><p id="1317451997#-ejwdxk_163"><span class="emphasis" id="1317451997#-ejwdxk_166">As a grower, I want to manage Grow Chambers, so I can scale my output.</span></p><p id="1317451997#-ejwdxk_164"><span class="control" id="1317451997#-ejwdxk_167">Acceptance Criteria:</span></p><ul class="list" id="1317451997#-ejwdxk_165" start="1"><li class="list-item" id="1317451997#-ejwdxk_168"><p>The system must allow growers to <span class="control" id="1317451997#-ejwdxk_171">add, remove, and configure multiple Grow Chambers</span>.</p></li><li class="list-item" id="1317451997#-ejwdxk_169"><p>The dashboard must provide a <span class="control" id="1317451997#-ejwdxk_172">centralized view of all active Grow Chambers</span>.</p></li><li class="list-item" id="1317451997#-ejwdxk_170"><p>The grower must be able to <span class="control" id="1317451997#-ejwdxk_173">duplicate existing chamber configurations</span> to streamline setup for new chambers.</p></li></ul></section><section class="detached"><h2 id="1317451997#us14-development-of-humidity-sensor" data-toc="us14-development-of-humidity-sensor#Backlog.md-us14-development-of-humidity-sensor">US14: Development of Humidity Sensor</h2><p id="1317451997#-ejwdxk_174"><span class="control" id="1317451997#-ejwdxk_177">As a developer, I want to implement a humidity sensor so that the system can accurately measure and regulate humidity levels.</span></p><p id="1317451997#-ejwdxk_175"><span class="control" id="1317451997#-ejwdxk_178">Acceptance Criteria:</span></p><ul class="list" id="1317451997#-ejwdxk_176" start="1"><li class="list-item" id="1317451997#-ejwdxk_179"><p>The system must successfully interface with the <span class="control" id="1317451997#-ejwdxk_181">DHT22 sensor</span> to collect <span class="control" id="1317451997#-ejwdxk_182">real-time humidity and temperature data</span>.</p></li><li class="list-item" id="1317451997#-ejwdxk_180"><p>The humidity sensor must provide readings within <span class="control" id="1317451997#-ejwdxk_183">&plusmn;2% accuracy</span> in the target range.</p></li></ul></section><section class="detached"><h2 id="1317451997#us15-development-of-co-sensor" data-toc="us15-development-of-co-sensor#Backlog.md-us15-development-of-co-sensor">US15: Development of CO₂ Sensor</h2><p id="1317451997#-ejwdxk_184"><span class="control" id="1317451997#-ejwdxk_187">As a developer, I want to implement a CO₂ sensor so that the system can monitor and regulate carbon dioxide levels in grow chambers.</span></p><p id="1317451997#-ejwdxk_185"><span class="control" id="1317451997#-ejwdxk_188">Acceptance Criteria:</span></p><ul class="list" id="1317451997#-ejwdxk_186" start="1"><li class="list-item" id="1317451997#-ejwdxk_189"><p>The system must successfully interface with the CO₂ sensor to collect <span class="control" id="1317451997#-ejwdxk_191">real-time CO₂ data</span>.</p></li><li class="list-item" id="1317451997#-ejwdxk_190"><p>The CO₂ sensor must provide readings within <span class="control" id="1317451997#-ejwdxk_192">&plusmn;50 ppm accuracy</span> within the operational range.</p></li></ul></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="429683684">Grow Chamber</h1><section class="detached"><h2 id="429683684#overview" data-toc="overview#Grow-Chamber.md-overview">Overview</h2><p id="429683684#r1p6sx_6">A <span class="control" id="429683684#r1p6sx_7">Grow Chamber</span> is a self-contained module within the system, designed to provide an independent, controlled environment for plant growth.</p></section><section class="detached"><h2 id="429683684#system-design" data-toc="system-design#Grow-Chamber.md-system-design">System Design</h2><p id="429683684#r1p6sx_8">Commercially available grow tents for indoor plant cultivation function as individual <span class="control" id="429683684#r1p6sx_13">Grow Chambers</span>, providing structure and isolating the growing environment.</p><p id="429683684#r1p6sx_9">A bucket at the centre of the tent acts as a <span class="control" id="429683684#r1p6sx_14">Root Chamber</span>. It contains multiple <span class="control" id="429683684#r1p6sx_15">Plant Slots</span> that hold net pots filled with growing medium, where seeds are planted.</p><p id="429683684#r1p6sx_10">As the seeds germinate, their stems grow upward to form a canopy, while roots develop below. The <span class="control" id="429683684#r1p6sx_16">Fogponics System</span> delivers a fine, nutrient-rich mist to the roots, generated by an ultrasonic mist maker submerged in a water-nutrient solution.</p><p id="429683684#r1p6sx_11"><span class="control" id="429683684#r1p6sx_17">Lighting panels</span> positioned in the corners provide the necessary wavelengths for growth. The walls of the Tent and the Root Chamber are lined with Mylar, a reflective material that enhances light distribution for the plants.</p><p id="429683684#r1p6sx_12">The <span class="control" id="429683684#r1p6sx_18">Ventilation system</span> maintains airflow and regulates the temperature within the Grow chamber.</p></section><section class="detached"><h2 id="429683684#hardware-components" data-toc="hardware-components#Grow-Chamber.md-hardware-components">Hardware Components</h2><p id="429683684#r1p6sx_19">The hardware components were sourced from easily accessible suppliers, such as Canadian Tire and Amazon.</p></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-2101489201">Grow Chamber Assembly</h1><p id="-2101489201#-9jcjay_3">Required Components:</p><ul class="list" id="-2101489201#-9jcjay_4" start="1"><li class="list-item" id="-2101489201#-9jcjay_5"><p>Grow Tent for indoor plant cultivation (24&quot; x 24&quot; x 48&quot;, 61cm x 61cm x 122cm)</p></li><li class="list-item" id="-2101489201#-9jcjay_6"><p>Full Spectrum Grow Light for Indoor Plants</p></li><li class="list-item" id="-2101489201#-9jcjay_7"><p>Inline Fan: 4-inch diameter</p></li><li class="list-item" id="-2101489201#-9jcjay_8"><p>Carbon Filter: 4-inch flange diameter, 14 inches long</p></li><li class="list-item" id="-2101489201#-9jcjay_9"><p>Ducting: 4-inch diameter, 8 feet long</p></li><li class="list-item" id="-2101489201#-9jcjay_10"><p>Rubber Coupler Connector: Compatible with a 4-inch diameter</p></li></ul></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="146093280">Root Chamber Assembly</h1><p id="146093280#-mxvcyz_3">Required Components:</p><ul class="list" id="146093280#-mxvcyz_4" start="1"><li class="list-item" id="146093280#-mxvcyz_7"><p>Canadian Tire Plastic Food Grade Safe Bucket, 5-Gal/19-L (37.20 cm x 31.00 cm) or 7.5-L</p></li><li class="list-item" id="146093280#-mxvcyz_8"><p>Mylar Films</p></li><li class="list-item" id="146093280#-mxvcyz_9"><p>Ultrasonic Mist Maker, 400ml/h</p></li><li class="list-item" id="146093280#-mxvcyz_10"><p>Brushless DC Fan, 12V, IP67, 120mm x 25mm</p></li><li class="list-item" id="146093280#-mxvcyz_11"><p>Peristaltic Pump, 12V 3x5mm</p></li><li class="list-item" id="146093280#-mxvcyz_12"><p>Silicone tube, 3x5mm 5m</p></li><li class="list-item" id="146093280#-mxvcyz_13"><p>Aquarium air pump</p></li><li class="list-item" id="146093280#-mxvcyz_14"><p>FS400-SHT3X Soil Temperature and Humidity Sensor (SHT35)</p></li><li class="list-item" id="146093280#-mxvcyz_15"><p>Ultrasonic Distance Sensor, water-resistant</p></li><li class="list-item" id="146093280#-mxvcyz_16"><p>2&quot; Net pots</p></li></ul><p id="146093280#-mxvcyz_5">Required Tools:</p><ul class="list" id="146093280#-mxvcyz_6" start="1"><li class="list-item" id="146093280#-mxvcyz_17"><p>Heat Gun</p></li><li class="list-item" id="146093280#-mxvcyz_18"><p>Hole Saw, 1.5&quot; diameter</p></li><li class="list-item" id="146093280#-mxvcyz_19"><p>Wire Stripper</p></li><li class="list-item" id="146093280#-mxvcyz_20"><p>12V 1A AC/DC Power Adapter</p></li><li class="list-item" id="146093280#-mxvcyz_21"><p>12V DC Power Jack Connector Adapter, Male Plug &amp; Female Socket Set, 5.5 X 2.1mm</p></li></ul></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="197990771">Seed Planting</h1><p id="197990771#-cub8im_3">Required Components:</p><ul class="list" id="197990771#-cub8im_4" start="1"><li class="list-item" id="197990771#-cub8im_5"><p>Fertilizer</p></li><li class="list-item" id="197990771#-cub8im_6"><p>Clay Pellets</p></li><li class="list-item" id="197990771#-cub8im_7"><p>Organic cotton balls</p></li><li class="list-item" id="197990771#-cub8im_8"><p>Arugula Seeds</p></li></ul></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-1652252355">Ventilation</h1><p id="-1652252355#-4dcs14_3">The tent&rsquo;s internal volume is approximately 64,512 cubic inches, which converts to about 37.34 cubic feet: 32&rdquo; &times; 32&rdquo; &times; 63&rdquo; &divide; 1,728 &asymp; 37.34 ft&sup3;</p><p id="-1652252355#-4dcs14_4">The 130 CFM inline duct fan can replace 37 cubic feet of air in about 17 seconds: 37 ft&sup3; &divide; 130 ft&sup3;/min &asymp; 0.28 minutes</p><p id="-1652252355#-4dcs14_5">For effective growing conditions, it&rsquo;s recommended to perform a full air exchange every one to three minutes. This ensures fresh air circulation, stable temperature, and proper humidity levels.</p></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-1957301961">Automation</h1><section class="detached"><h2 id="-1957301961#overview" data-toc="overview#Automation.md-overview">Overview</h2><p id="-1957301961#-ev6tmq_6">The system regulates the environment and resource availability based on plant growth stages, ensuring optimal conditions from germination to maturity. This involves developing components, assembling hardware, and integrating software.</p></section><section class="detached"><h2 id="-1957301961#hardware" data-toc="hardware#Automation.md-hardware">Hardware</h2><p id="-1957301961#-ev6tmq_7">The system uses <span class="control" id="-1957301961#-ev6tmq_8">Espressif</span> development boards: <span class="control" id="-1957301961#-ev6tmq_9">ESP32-C6</span> and <span class="control" id="-1957301961#-ev6tmq_10">ESP32-H2</span> for sensor data processing and actuator control, and the <span class="control" id="-1957301961#-ev6tmq_11">Thread Border Router board</span> for communication with Thread-enabled devices and external networks. Sensors monitor temperature, humidity, and CO₂ levels, while actuators such as mist makers, exhaust fans, and LED grow lights adjust conditions based on automation rules.</p></section><section class="detached"><h2 id="-1957301961#software" data-toc="software#Automation.md-software">Software</h2><p id="-1957301961#-ev6tmq_12">The system uses Thread (<a href="#-1790576086">Thread</a>) for low-power, mesh-based wireless communication between sensors, actuators, and control units. Matter (<a href="#-1997370655">Matter</a>) is used as the application layer protocol to enable device interoperability and secure communication.</p><p id="-1957301961#-ev6tmq_13">Development is based on <span class="control" id="-1957301961#-ev6tmq_16">ESP-IDF v5.3.2</span>, the official framework for ESP32, with <span class="control" id="-1957301961#-ev6tmq_17">ESP-Matter v1.4</span> integrated for Matter device support. The environment is set up on <span class="control" id="-1957301961#-ev6tmq_18">Ubuntu 24.04</span>, selected for its stability and compatibility with development tools.</p></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="661270862">Background</h1><p id="661270862#-81wtfd_3">This section provides an overview of the relevant background information necessary to understand the project's context, including key concepts and technologies.</p></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-1790576086">Thread</h1><section class="detached"><h2 id="-1790576086#overview" data-toc="overview#Thread.md-overview">Overview</h2><p id="-1790576086#-bx7zh1_11"><span class="control" id="-1790576086#-bx7zh1_14">Thread</span> is an IPv6-based networking protocol designed for low-power Internet of Things devices in an IEEE 802.15.4-2006 wireless mesh network.</p><p id="-1790576086#-bx7zh1_12"><span class="control" id="-1790576086#-bx7zh1_15">Matter (<a href="#-1997370655">Matter</a>)</span> devices can communicate with each other using Thread as a transport protocol.</p><p id="-1790576086#-bx7zh1_13"><span class="control" id="-1790576086#-bx7zh1_17">OpenThread (OT)</span> is an open-source implementation of the <span class="control" id="-1790576086#-bx7zh1_18">Thread</span> networking protocol.</p></section><section class="detached"><h2 id="-1790576086#resilience" data-toc="resilience#Thread.md-resilience">Resilience</h2><p id="-1790576086#-bx7zh1_19">The Thread Network prevents <span class="control" id="-1790576086#-bx7zh1_20">single points of failure</span> through device redundancy and autonomous role transitions, but in topologies like a Thread Network Partition with only one Border Router, failure of that Border Router can disrupt external network access due to the lack of a backup. Devices in a Thread Network can communicate directly without an active Border Router. Having multiple Border Routers allows connections to one or more external networks, improving reliability and redundancy.</p></section><section class="detached"><h2 id="-1790576086#architecture" data-toc="architecture#Thread.md-architecture">Architecture</h2><p id="-1790576086#-bx7zh1_21">OpenThread runs on various OS or bare-metal systems, including Linux and ESP32, due to its narrow abstraction layer and portable C/C++ design. It supports the following designs:</p><ul class="list" id="-1790576086#-bx7zh1_22" start="1"><li class="list-item" id="-1790576086#-bx7zh1_23"><p><span class="control" id="-1790576086#-bx7zh1_26">System-on-chip (SoC):</span> a single chip combines a processor and an 802.15.4 radio for Thread. In this design, both OpenThread and the device's main software (application layer) run on the same processor. This mode is used in <span class="control" id="-1790576086#-bx7zh1_27">end devices</span> like sensors and actuators (ESP32-H2, ESP32-C6).</p></li><li class="list-item" id="-1790576086#-bx7zh1_24"><p><span class="control" id="-1790576086#-bx7zh1_28">Radio Co-Processor (RCP):</span> the host processor runs the full OpenThread stack, while a separate Thread radio chip handles only the PHY and MAC layers of IEEE 802.15.4. They communicate using the Spinel protocol over SPI or UART. Since the host processor manages all networking tasks, it typically remains powered on, making this setup ideal for devices that prioritize performance over power efficiency. This mode is used in <span class="control" id="-1790576086#-bx7zh1_29">Thread Border Routers</span>, where a host processor, such as an ESP32-S3 or ESP32, is paired with an ESP32-H2 or ESP32-C6 as the Thread radio co-processor.</p></li><li class="list-item" id="-1790576086#-bx7zh1_25"><p><span class="control" id="-1790576086#-bx7zh1_30">Network Co-Processor (NCP):</span> OpenThread runs on a Thread-enabled SoC, while the application software runs separately on a host processor. These two processors communicate using wpantund over SPI or UART, with the Spinel protocol managing the connection. Unlike RCP, this design allows the host processor to sleep, while the Thread-enabled chip stays active to maintain network connectivity. This design is beneficial for power-saving devices that require a constant network connection but do not need the host processor to remain active at all times.</p></li></ul></section><section class="detached"><h2 id="-1790576086#device-types" data-toc="device-types#Thread.md-device-types">Device Types</h2><p id="-1790576086#-bx7zh1_31">There are two types of Thread devices:</p><ul class="list" id="-1790576086#-bx7zh1_32" start="1"><li class="list-item" id="-1790576086#-bx7zh1_33"><p><span class="control" id="-1790576086#-bx7zh1_35">Minimal Thread Device (MTD)</span> communicates only with its FTD parent.</p></li><li class="list-item" id="-1790576086#-bx7zh1_34"><p><span class="control" id="-1790576086#-bx7zh1_36">Full Thread Device (FTD)</span> communicates with other FTDs and its MTD children.</p></li></ul></section><section class="detached"><h2 id="-1790576086#device-roles" data-toc="device-roles#Thread.md-device-roles">Device Roles</h2><p id="-1790576086#-bx7zh1_37">A Thread device can have multiple roles. For example, it can act as a Router, Border Router, and Commissioner simultaneously. See also Commissioning Roles (<a href="#1381824660#commissioning-roles">&quot;Commissioning Roles&quot; in &quot;Thread Commissioning&quot;</a>).</p><section class="detached"><h3 id="-1790576086#router" data-toc="router#Thread.md-router">Router</h3><p id="-1790576086#-bx7zh1_42">A <span class="control" id="-1790576086#-bx7zh1_45">Router</span> is an FTD (<a href="#-1790576086#device-types">&quot;Device Types&quot; in &quot;Thread&quot;</a>) that provides routing services in a Thread Network. It forwards packets, maintains routing information, and serves as a Parent for End Devices (<a href="#-1790576086#end-device">&quot;End Device&quot; in &quot;Thread&quot;</a>). Additionally, Routers support Thread Commissioning (<a href="#1381824660">Thread Commissioning</a>), handling device joining and security services.</p><p id="-1790576086#-bx7zh1_43">A <span class="control" id="-1790576086#-bx7zh1_49">Leader</span> is a special Router that manages a Thread Network Partition. Each Partition has one Leader, elected dynamically from the available Routers. If the Leader fails, another Router automatically takes over. The Leader is responsible for:</p><ul class="list" id="-1790576086#-bx7zh1_44" start="1"><li class="list-item" id="-1790576086#-bx7zh1_50"><p>Assigning and managing Router IDs.</p></li><li class="list-item" id="-1790576086#-bx7zh1_51"><p>Maintaining Thread Network Data.</p></li><li class="list-item" id="-1790576086#-bx7zh1_52"><p>Coordinating network operations.</p></li></ul></section><section class="detached"><h3 id="-1790576086#end-device" data-toc="end-device#Thread.md-end-device">End Device</h3><p id="-1790576086#-bx7zh1_53">An <span class="control" id="-1790576086#-bx7zh1_56">End Device</span> is a device that connects to the Thread Network but does not forward packets like a Router (<a href="#-1790576086#router">&quot;Router&quot; in &quot;Thread&quot;</a>). Instead, it relies on a Parent Router for communication. End Devices are typically low-power devices, such as sensors or actuators, that do not need to maintain full network topology information.</p><p id="-1790576086#-bx7zh1_54">Depending on their capabilities and power management strategies, End Devices are classified into the following types:</p><ul class="list" id="-1790576086#-bx7zh1_55" start="1"><li class="list-item" id="-1790576086#-bx7zh1_58"><p><span class="control" id="-1790576086#-bx7zh1_62">Router-Eligible End Device (REED)</span> is an FTD (<a href="#-1790576086#device-types">&quot;Device Types&quot; in &quot;Thread&quot;</a>) that operates as an End Device but can be promoted to a Router (<a href="#-1790576086#router">&quot;Router&quot; in &quot;Thread&quot;</a>) if the network requires additional routing capacity. It does not forward messages but maintains connections with Routers and supports Thread Commissioning (<a href="#1381824660">Thread Commissioning</a>).</p></li><li class="list-item" id="-1790576086#-bx7zh1_59"><p>A <span class="control" id="-1790576086#-bx7zh1_66">Full End Device (FED)</span> is an FTD (<a href="#-1790576086#device-types">&quot;Device Types&quot; in &quot;Thread&quot;</a>) that operates as an End Device and will never become a Router. Unlike a REED, a FED cannot be promoted to a Router.</p></li><li class="list-item" id="-1790576086#-bx7zh1_60"><p>A <span class="control" id="-1790576086#-bx7zh1_68">Minimal End Device (MED)</span> is an MTD (<a href="#-1790576086#device-types">&quot;Device Types&quot; in &quot;Thread&quot;</a>) that keeps its radio on at all times and can communicate with its Parent Router whenever needed. MEDs do not forward messages or participate in routing.</p></li><li class="list-item" id="-1790576086#-bx7zh1_61"><p>A <span class="control" id="-1790576086#-bx7zh1_70">Sleepy End Device (SED)</span> is an MTD (<a href="#-1790576086#device-types">&quot;Device Types&quot; in &quot;Thread&quot;</a>) that turns off its radio when idle to save power. It periodically wakes up to communicate with its Parent Router but does not forward messages.</p></li></ul></section><section class="detached"><h3 id="-1790576086#border-router" data-toc="border-router#Thread.md-border-router">Border Router</h3><p id="-1790576086#-bx7zh1_72">A <span class="control" id="-1790576086#-bx7zh1_75">Thread Border Router</span> is a device that connects a Thread Network to external IP networks, such as Wi-Fi or Ethernet. It allows Thread devices to communicate with the internet or other smart home ecosystems.</p><p id="-1790576086#-bx7zh1_73">OpenThread's implementation of a Border Router is called <span class="control" id="-1790576086#-bx7zh1_76">OpenThread Border Router (OTBR)</span>.</p><p id="-1790576086#-bx7zh1_74">Espressif (<a href="#-1918844910">Espressif</a>) provides the ESP Thread Border Router SDK (<a href="#-1918844910#esp-thread-border-router-solution">&quot;ESP Thread Border Router Solution&quot; in &quot;Espressif&quot;</a>) and hardware platforms (<a href="#-1918844910#esp-thread-border-router-solution">&quot;ESP Thread Border Router Solution&quot; in &quot;Espressif&quot;</a>) for building Thread Border Routers.</p></section></section><section class="detached"><h2 id="-1790576086#openthread-cli" data-toc="openthread-cli#Thread.md-openthread-cli">OpenThread CLI</h2><p id="-1790576086#-bx7zh1_80">The <span class="control" id="-1790576086#-bx7zh1_82">OpenThread CLI</span> is a command-line interface that provides configuration and management APIs for OpenThread.</p><p id="-1790576086#-bx7zh1_81">It is used on OpenThread Border Routers (OTBR), Commissioners, and other Thread devices. The available commands depend on the device type. The <span class="inline-code" id="-1790576086#-bx7zh1_83">help</span> command prints all the supported commands.</p></section><section class="detached"><h2 id="-1790576086#references" data-toc="references#Thread.md-references">References</h2><ul class="list" id="-1790576086#-bx7zh1_84" start="1"><li class="list-item" id="-1790576086#-bx7zh1_85"><p>OpenThread Platforms (<a href="https://openthread.io/platforms">https://openthread.io/platforms</a>)</p></li><li class="list-item" id="-1790576086#-bx7zh1_86"><p>OpenThread Node Roles and Types (<a href="https://openthread.io/guides/thread-primer/node-roles-and-types">https://openthread.io/guides/thread-primer/node-roles-and-types</a>)</p></li><li class="list-item" id="-1790576086#-bx7zh1_87"><p>OpenThread Border Router (<a href="https://openthread.io/guides/border-router">https://openthread.io/guides/border-router</a>)</p></li><li class="list-item" id="-1790576086#-bx7zh1_88"><p>Espressif OpenThread API (<a href="https://docs.espressif.com/projects/esp-idf/en/stable/esp32s2/api-guides/openthread.html">https://docs.espressif.com/projects/esp-idf/en/stable/esp32s2/api-guides/openthread.html</a>)</p></li><li class="list-item" id="-1790576086#-bx7zh1_89"><p>OpenThread CLI Overview (<a href="https://openthread.io/reference/cli">https://openthread.io/reference/cli</a>)</p></li><li class="list-item" id="-1790576086#-bx7zh1_90"><p>Espressif OpenThread CLI (<a href="https://github.com/espressif/esp-idf/tree/v5.4/examples/openthread/ot_cli">https://github.com/espressif/esp-idf/tree/v5.4/examples/openthread/ot_cli</a>)</p></li><li class="list-item" id="-1790576086#-bx7zh1_91"><p>ESP Thread Border Router SDK (<a href="https://docs.espressif.com/projects/esp-thread-br/en/latest/">https://docs.espressif.com/projects/esp-thread-br/en/latest/</a>)</p></li></ul></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="1215462931">Forming a Network</h1><section class="detached"><h2 id="1215462931#active-operational-dataset" data-toc="active-operational-dataset#Forming-a-Network.md-active-operational-dataset">Active Operational Dataset</h2><p id="1215462931#-i9e7i6_5">The <span class="control" id="1215462931#-i9e7i6_7">Active Operational Dataset</span> contains the configuration settings that Thread devices use to connect and operate within a specific Thread network:</p><ul class="list" id="1215462931#-i9e7i6_6" start="1"><li class="list-item" id="1215462931#-i9e7i6_8"><p><span class="control" id="1215462931#-i9e7i6_18">Active Timestamp</span> &ndash; Determines dataset priority.</p></li><li class="list-item" id="1215462931#-i9e7i6_9"><p><span class="control" id="1215462931#-i9e7i6_19">Channel</span> &ndash; PHY-layer channel for network communication.</p></li><li class="list-item" id="1215462931#-i9e7i6_10"><p><span class="control" id="1215462931#-i9e7i6_20">Channel Mask</span> &ndash; Defines channels for network discovery and scanning.</p></li><li class="list-item" id="1215462931#-i9e7i6_11"><p><span class="control" id="1215462931#-i9e7i6_21">Extended PAN ID</span> &ndash; Unique identifier for the Thread network.</p></li><li class="list-item" id="1215462931#-i9e7i6_12"><p><span class="control" id="1215462931#-i9e7i6_22">Mesh-Local Prefix</span> &ndash; IPv6 prefix for local device communication.</p></li><li class="list-item" id="1215462931#-i9e7i6_13"><p><span class="control" id="1215462931#-i9e7i6_23">Network Key</span> is a 128-bit key used to secure communication within the Thread network.</p></li><li class="list-item" id="1215462931#-i9e7i6_14"><p><span class="control" id="1215462931#-i9e7i6_24">Network Name</span> &ndash; Human-readable network identifier.</p></li><li class="list-item" id="1215462931#-i9e7i6_15"><p><span class="control" id="1215462931#-i9e7i6_25">PAN ID</span> &ndash; MAC-layer identifier for data transmissions.</p></li><li class="list-item" id="1215462931#-i9e7i6_16"><p><span class="control" id="1215462931#-i9e7i6_26">PSKc</span> &ndash; Security key for network authentication.</p></li><li class="list-item" id="1215462931#-i9e7i6_17"><p><span class="control" id="1215462931#-i9e7i6_27">Security Policy</span> &ndash; Specifies allowed and restricted security operations.</p></li></ul></section><section class="detached"><h2 id="1215462931#thread-network-data" data-toc="thread-network-data#Forming-a-Network.md-thread-network-data">Thread Network Data</h2><p id="1215462931#-i9e7i6_28"><span class="control" id="1215462931#-i9e7i6_32">Thread Network Data</span> is a collection of network-related information managed and distributed by the Leader (<a href="#-1790576086#router">&quot;Router&quot; in &quot;Thread&quot;</a>) in a Thread network.</p><p id="1215462931#-i9e7i6_29">It includes the following details:</p><ul class="list" id="1215462931#-i9e7i6_30" start="1"><li class="list-item" id="1215462931#-i9e7i6_34"><p>Border Routers</p></li><li class="list-item" id="1215462931#-i9e7i6_35"><p>On-mesh prefixes</p></li><li class="list-item" id="1215462931#-i9e7i6_36"><p>External routes</p></li><li class="list-item" id="1215462931#-i9e7i6_37"><p>6LoWPAN contexts</p></li><li class="list-item" id="1215462931#-i9e7i6_38"><p>Network commissioning parameters</p></li></ul><p id="1215462931#-i9e7i6_31">The Leader (<a href="#-1790576086#router">&quot;Router&quot; in &quot;Thread&quot;</a>) collects and updates Thread Network Data, distributing changes using MLE (Mesh Link Establishment) messages. Routers and REEDs store the full data, while End Devices (MTDs) (<a href="#-1790576086#end-device">&quot;End Device&quot; in &quot;Thread&quot;</a>) can store either the full set or only a stable subset to save resources.</p></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="1381824660">Thread Commissioning</h1><p id="1381824660#-poxibj_3">The <span class="control" id="1381824660#-poxibj_6">Joiner ID</span> is derived from the Joiner Discerner if one is set; otherwise, it is derived from the device's factory-assigned EUI-64 using SHA-256. This ID also serves as the device's IEEE 802.15.4 Extended Address during commissioning. When the device joins a Thread network, it automatically receives the Network Key.</p><section class="detached"><h2 id="1381824660#commissioning-roles" data-toc="commissioning-roles#Thread-Commissioning.md-commissioning-roles">Commissioning Roles</h2><p id="1381824660#-poxibj_7">The Thread Specification defines several commissioning roles within the <span class="control" id="1381824660#-poxibj_9">Mesh Commissioning Protocol (MeshCoP):</span></p><ul class="list" id="1381824660#-poxibj_8" start="1"><li class="list-item" id="1381824660#-poxibj_10"><p id="1381824660#-poxibj_14"><span class="control" id="1381824660#-poxibj_16">Commissioner</span> manages device authentication and onboarding in a Thread network. It provides network credentials to new devices (<span class="control" id="1381824660#-poxibj_17">Joiners</span>) and can update network parameters or perform diagnostics. Types of Commissioners:</p><ul class="list" id="1381824660#-poxibj_15" start="1"><li class="list-item" id="1381824660#-poxibj_18"><p><span class="control" id="1381824660#-poxibj_21">On-Mesh Commissioner</span> operates inside the Thread network and has full control over commissioning.</p></li><li class="list-item" id="1381824660#-poxibj_19"><p><span class="control" id="1381824660#-poxibj_22">External Commissioner</span> resides outside the Thread network and connects via a <span class="control" id="1381824660#-poxibj_23">Border Agent</span> (e.g., a mobile app or cloud service).</p></li><li class="list-item" id="1381824660#-poxibj_20"><p><span class="control" id="1381824660#-poxibj_24">Native Commissioner</span> uses the same Thread interface as the mesh to manage commissioning.</p></li></ul></li><li class="list-item" id="1381824660#-poxibj_11"><p id="1381824660#-poxibj_25"><span class="control" id="1381824660#-poxibj_26">Joiner</span> is a Thread device attempting to join a commissioned Thread network. It does not have network credentials and must authenticate with a Commissioner to gain access.</p></li><li class="list-item" id="1381824660#-poxibj_12"><p id="1381824660#-poxibj_27"><span class="control" id="1381824660#-poxibj_28">Border Agent (BA)</span> relays messages between an External or Native Commissioner and the Thread Network, ensuring secure communication between external networks and the Thread network.</p></li><li class="list-item" id="1381824660#-poxibj_13"><p id="1381824660#-poxibj_29"><span class="control" id="1381824660#-poxibj_30">Joiner Router</span> is a Router or REED that assists a Joiner in communicating with a Commissioner when the Joiner is not within direct range. It does not perform full routing but forwards Joiner messages to facilitate secure commissioning.</p></li></ul></section><section class="detached"><h2 id="1381824660#references" data-toc="references#Thread-Commissioning.md-references">References</h2><ul class="list" id="1381824660#-poxibj_31" start="1"><li class="list-item" id="1381824660#-poxibj_32"><p>Thread Commissioning (<a href="https://www.threadgroup.org/Portals/0/documents/support/CommissioningWhitePaper_658_2.pdf">https://www.threadgroup.org/Portals/0/documents/support/CommissioningWhitePaper_658_2.pdf</a>)</p></li><li class="list-item" id="1381824660#-poxibj_33"><p>OpenThread commissioning (<a href="https://docs.nordicsemi.com/bundle/ncs-latest/page/nrf/protocols/thread/overview/commissioning.html">https://docs.nordicsemi.com/bundle/ncs-latest/page/nrf/protocols/thread/overview/commissioning.html</a>)</p></li></ul></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-1997370655">Matter</h1><section class="detached"><h2 id="-1997370655#overview" data-toc="overview#Matter.md-overview">Overview</h2><p id="-1997370655#w33v6c_6">Matter is an <span class="control" id="-1997370655#w33v6c_7">IP-based</span> IoT connectivity standard that defines a common application layer for secure and interoperable communication over <span class="control" id="-1997370655#w33v6c_8">Wi-Fi</span>, <span class="control" id="-1997370655#w33v6c_9">Thread (<a href="#-1790576086">Thread</a>)</span>, and <span class="control" id="-1997370655#w33v6c_10">Ethernet</span> networks.</p></section><section class="detached"><h2 id="-1997370655#fabrics" data-toc="fabrics#Matter.md-fabrics">Fabrics</h2><p id="-1997370655#w33v6c_12">A <span class="control" id="-1997370655#w33v6c_13">Matter Fabric</span> is a private virtual network that connects Matter Devices and extends across Wi-Fi, Thread, and Ethernet physical networks. During the Matter commissioning process, controllers assign Fabric credentials to ensure secure integration.</p></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="279346443">Matter Commissioning</h1><p id="279346443#-uvo4ba_4"><span class="control" id="279346443#-uvo4ba_6">Matter Commissioning</span> is the process of adding a <span class="control" id="279346443#-uvo4ba_7">Commissionee</span> device to a <span class="control" id="279346443#-uvo4ba_8">Fabric</span> by a <span class="control" id="279346443#-uvo4ba_9">Commissioner</span> device.</p><section class="detached"><h2 id="279346443#commissioning-process" data-toc="commissioning-process#Matter-Commissioning.md-commissioning-process">Commissioning Process</h2><p id="279346443#-uvo4ba_10">Matter Commissioning involves the following steps:</p><ol class="list list-decimal" id="279346443#-uvo4ba_11" type="1" start="1"><li class="list-item" id="279346443#-uvo4ba_14"><p>The Commissioner retrieves the Onboarding Payload (<a href="#279346443#onboarding-payload">&quot;Onboarding Payload&quot; in &quot;Matter Commissioning&quot;</a>) and discovers (<a href="#279346443#device-discovery">&quot;Device Discovery&quot; in &quot;Matter Commissioning&quot;</a>) the Commissionee device.</p></li><li class="list-item" id="279346443#-uvo4ba_15"><p>Passcode-Authenticated Session Establishment (PASE) is used to establish encryption keys, securing communication between the Commissioner and Commissionee. This process also sets up an attestation challenge for verifying the device&rsquo;s authenticity.</p></li><li class="list-item" id="279346443#-uvo4ba_16"><p>The Commissioner verifies the Commissionee&rsquo;s authenticity through Device Attestation, ensuring it is a certified Matter device.</p></li><li class="list-item" id="279346443#-uvo4ba_17"><p>The Commissioner configures the Commissionee by providing essential information including network configuration settings, such as Wi-Fi credentials (SSID and passphrase) or Thread network credentials.</p></li><li class="list-item" id="279346443#-uvo4ba_18"><p>The Commissionee joins the operational network, unless it is already connected. The Commissioner or Administrator identifies or discovers the device&rsquo;s IPv6 address to enable further communication.</p></li><li class="list-item" id="279346443#-uvo4ba_19"><p>Certificate-Authenticated Session Establishment (CASE) is used to derive long-term encryption keys, securing all future unicast communication between the Commissioner or Administrator and the Commissionee.</p></li><li class="list-item" id="279346443#-uvo4ba_20"><p>The Commissioning process completes with an encrypted message exchange, confirming successful onboarding using CASE-derived encryption keys on the operational network.</p></li></ol><section class="detached"><h3 id="279346443#onboarding-payload" data-toc="onboarding-payload#Matter-Commissioning.md-onboarding-payload">Onboarding Payload</h3><p id="279346443#-uvo4ba_23">The <span class="control" id="279346443#-uvo4ba_25">Commissionee</span> shares the <span class="control" id="279346443#-uvo4ba_26">Onboarding Payload</span> with the <span class="control" id="279346443#-uvo4ba_27">Commissioner</span> through a <span class="emphasis" id="279346443#-uvo4ba_28">QR Code</span>, <span class="emphasis" id="279346443#-uvo4ba_29">Manual Pairing Code</span>, or <span class="emphasis" id="279346443#-uvo4ba_30">NFC Tag</span>. It is composed of required and optional information. The following information may be included:</p><ul class="list" id="279346443#-uvo4ba_24" start="1"><li class="list-item" id="279346443#-uvo4ba_31"><p><span class="control" id="279346443#-uvo4ba_39">Version</span> specifies the payload format version, allowing future updates. It is 3 bits (0b000) for machine-readable formats and 1 bit (0b0) for Manual Pairing Codes.</p></li><li class="list-item" id="279346443#-uvo4ba_32"><p><span class="control" id="279346443#-uvo4ba_40">Vendor ID</span> is a 16-bit identifier assigned by the Connectivity Standards Alliance (CSA) to uniquely identify a device manufacturer. It ensures that devices from different manufacturers can be distinguished within the Matter ecosystem.</p></li><li class="list-item" id="279346443#-uvo4ba_33"><p><span class="control" id="279346443#-uvo4ba_41">Product ID</span> is a 16-bit identifier assigned by the manufacturer to differentiate between their products. It helps identify specific device models and is used in commissioning and attestation processes.</p></li><li class="list-item" id="279346443#-uvo4ba_34"><p><span class="control" id="279346443#-uvo4ba_42">Custom Flow</span> is a 2-bit enumeration that specifies whether additional steps are required before commissioning. It informs the Commissioner if the device is ready for commissioning immediately, requires user interaction (such as pressing a button), or needs an external service interaction before being available for setup.</p></li><li class="list-item" id="279346443#-uvo4ba_35"><p><span class="control" id="279346443#-uvo4ba_43">Discovery Capabilities Bitmask</span> is an 8-bit bitmask included in machine-readable formats. It indicates the discovery technologies (e.g., BLE, Wi-Fi, Thread) supported by the device, helping the Commissioner determine how to find and connect to it.</p></li><li class="list-item" id="279346443#-uvo4ba_36"><p><span class="control" id="279346443#-uvo4ba_44">Discriminator</span> is a 12-bit identifier used to distinguish between multiple commissionable device advertisements. When a device enters commissioning mode, it broadcasts this value over BLE, Wi-Fi, or Thread, and it must match the value the device advertises. Each device should have a unique Discriminator to improve discovery and setup reliability. In machine-readable formats, the full 12-bit Discriminator is used, while in Manual Pairing Codes, only the upper 4 bits are included.</p></li><li class="list-item" id="279346443#-uvo4ba_37"><p><span class="control" id="279346443#-uvo4ba_45">Passcode</span> is a 27-bit numeric value used to authenticate the device during commissioning, serving as proof of possession. It is encoded as an 8-digit decimal number ranging from 00000001 to 99999998, excluding invalid values. The Passcode is also used as a shared secret to establish a secure channel between the Commissioner and the device for further onboarding steps.</p></li><li class="list-item" id="279346443#-uvo4ba_38"><p><span class="control" id="279346443#-uvo4ba_46">TLV Data</span> is optional, variable-length information stored in machine-readable formats using the Tag-Length-Value encoding. This data provides additional commissioning details.</p></li></ul></section><section class="detached"><h3 id="279346443#device-discovery" data-toc="device-discovery#Matter-Commissioning.md-device-discovery">Device Discovery</h3><p id="279346443#-uvo4ba_47"><span class="control" id="279346443#-uvo4ba_49">Device Discovery</span> is the process where a <span class="control" id="279346443#-uvo4ba_50">Commissioner</span> identifies a <span class="control" id="279346443#-uvo4ba_51">Commissionee</span> before onboarding it to a <span class="control" id="279346443#-uvo4ba_52">Fabric</span>. Devices announce their presence through the following methods:</p><ul class="list" id="279346443#-uvo4ba_48" start="1"><li class="list-item" id="279346443#-uvo4ba_53"><p><span class="control" id="279346443#-uvo4ba_57">BLE</span> is used by devices without network credentials to advertise their presence. The Commissioner scans for advertisements containing the Discriminator, Vendor ID, and Product ID to identify the correct device.</p></li><li class="list-item" id="279346443#-uvo4ba_54"><p><span class="control" id="279346443#-uvo4ba_58">Wi-Fi / Ethernet</span> is used by devices already connected to a network, announcing themselves via mDNS.</p></li><li class="list-item" id="279346443#-uvo4ba_55"><p><span class="control" id="279346443#-uvo4ba_59">Thread</span> is used by Thread-enabled devices, which register with a Thread Border Router using Service Registration Protocol (SRP).</p></li><li class="list-item" id="279346443#-uvo4ba_56"><p><span class="control" id="279346443#-uvo4ba_60">User-Directed Commissioning (UDC)</span> allows a device to actively search for Commissioners, letting the user select one for onboarding.</p></li></ul></section></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="1208879947">Matter Controllers</h1><section class="detached"><h2 id="1208879947#overview" data-toc="overview#Matter-Controllers.md-overview">Overview</h2><p id="1208879947#vmb3ze_5">A Matter Controller is a Node in a Matter Fabric that has the permissions needed to send commands or otherwise manage or coordinate other Nodes on the same Fabric.</p></section><section class="detached"><h2 id="1208879947#subscribing-to-events-or-attributes" data-toc="subscribing-to-events-or-attributes#Matter-Controllers.md-subscribing-to-events-or-attributes">Subscribing to events or attributes</h2><p id="1208879947#vmb3ze_6">Subscribing to an event or attribute means that its current state is automatically refreshed whenever changes occur within the Matter network. The events or attributes available for subscription are defined by the cluster in use.</p><p id="1208879947#vmb3ze_7">Multiple subscriptions can run at once, and a single subscription can cover several events or several attributes - even if those come from different clusters. However, each subscription must be dedicated to either events or attributes; they cannot be mixed in one subscription.</p></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-1918844910">Espressif</h1><section class="detached"><h2 id="-1918844910#overview" data-toc="overview#Espressif.md-overview">Overview</h2><p id="-1918844910#eshc0z_9"><span class="control" id="-1918844910#eshc0z_10">Espressif</span> is a semiconductor company that develops SoCs, microcontrollers, and development boards for IoT applications.</p></section><section class="detached"><h2 id="-1918844910#development-boards" data-toc="development-boards#Espressif.md-development-boards">Development Boards</h2><p id="-1918844910#eshc0z_11">Espressif&rsquo;s development boards are used in this system to enable wireless communication and automation:</p><ul class="list" id="-1918844910#eshc0z_12" start="1"><li class="list-item" id="-1918844910#eshc0z_13"><p>ESP32-H2-DevKitM-1 (<a href="https://docs.espressif.com/projects/esp-dev-kits/en/latest/esp32h2/esp32-h2-devkitm-1/index.html">https://docs.espressif.com/projects/esp-dev-kits/en/latest/esp32h2/esp32-h2-devkitm-1/index.html</a>) is a development board with Thread and Bluetooth LE connectivity, designed for low-power applications.</p></li><li class="list-item" id="-1918844910#eshc0z_14"><p>ESP32-C6-DevKitC-1 (<a href="https://docs.espressif.com/projects/esp-dev-kits/en/latest/esp32c6/esp32-c6-devkitc-1/index.html">https://docs.espressif.com/projects/esp-dev-kits/en/latest/esp32c6/esp32-c6-devkitc-1/index.html</a>) is a development board with Wi-Fi 6, Bluetooth LE, and Thread connectivity.</p></li><li class="list-item" id="-1918844910#eshc0z_15"><p>ESP32-DevKitM-1 (<a href="https://docs.espressif.com/projects/esp-dev-kits/en/latest/esp32/esp32-devkitm-1/index.html">https://docs.espressif.com/projects/esp-dev-kits/en/latest/esp32/esp32-devkitm-1/index.html</a>) is a development board with Wi-Fi and Bluetooth LE connectivity, designed for general-purpose applications.</p></li><li class="list-item" id="-1918844910#eshc0z_16"><p>ESP Thread Border Router (<a href="https://docs.espressif.com/projects/esp-thread-br/en/latest/hardware_platforms.html">https://docs.espressif.com/projects/esp-thread-br/en/latest/hardware_platforms.html</a>) is a development board that acts as a Thread Border Router, enabling communication between Thread networks and Wi-Fi or Ethernet for external connectivity.</p></li></ul></section><section class="detached"><h2 id="-1918844910#esp-idf-framework" data-toc="esp-idf-framework#Espressif.md-esp-idf-framework">ESP-IDF Framework</h2><p id="-1918844910#eshc0z_21"><span class="control" id="-1918844910#eshc0z_22">ESP-IDF</span> (<span class="control" id="-1918844910#eshc0z_23">Espressif IoT Development Framework</span>) is Espressif&rsquo;s official IoT Development Framework for the ESP32, ESP32-S, ESP32-C and ESP32-H series of SoCs.</p></section><section class="detached"><h2 id="-1918844910#esp-matter-solution" data-toc="esp-matter-solution#Espressif.md-esp-matter-solution">ESP Matter Solution</h2><p id="-1918844910#eshc0z_24">The <span class="control" id="-1918844910#eshc0z_27">Espressif's SDK for Matter</span> is the official Matter (<a href="#-1997370655">Matter</a>) development framework for ESP32 series SoCs.</p><p id="-1918844910#eshc0z_25">Wi-Fi-enabled ESP32, ESP32-C, and ESP32-S series can be used to build Matter Wi-Fi devices, with the ESP32-S series also supporting Ethernet connectivity via an external controller.</p><p id="-1918844910#eshc0z_26">ESP32-H series SoCs, which support IEEE 802.15.4, are used for Matter-compatible Thread end devices.</p></section><section class="detached"><h2 id="-1918844910#esp-thread-border-router-solution" data-toc="esp-thread-border-router-solution#Espressif.md-esp-thread-border-router-solution">ESP Thread Border Router Solution</h2><p id="-1918844910#eshc0z_29">The <span class="control" id="-1918844910#eshc0z_34">Espressif Thread Border Router SDK</span> is a FreeRTOS-based solution built on the ESP-IDF (<a href="#-1918844910#esp-idf-framework">&quot;ESP-IDF Framework&quot; in &quot;Espressif&quot;</a>) and OpenThread (<a href="#-1790576086">Thread</a>) stack. It supports both Wi-Fi and Ethernet interfaces as the backbone link, combined with 802.15.4 SoCs for Thread communication.</p><p id="-1918844910#eshc0z_30">The Wi-Fi-based Espressif Thread Border runs on two SoCs:</p><ul class="list" id="-1918844910#eshc0z_31" start="1"><li class="list-item" id="-1918844910#eshc0z_37"><p>The host Wi-Fi SoC, which runs OpenThread Border Router (ESP32, ESP32-S, or ESP32-C series SoC).</p></li><li class="list-item" id="-1918844910#eshc0z_38"><p>The Radio Co-Processor (RCP), which enables the Border Router to access the 802.15.4 physical and MAC layers (ESP32-H series SoC).</p></li></ul><p id="-1918844910#eshc0z_32">Espressif also provides a single <span class="control" id="-1918844910#eshc0z_39">ESP THREAD BR-ZIGBEE GW</span> board that integrates both the host SoC and the RCP into a single board.</p><p id="-1918844910#eshc0z_33">Espressif also provides a <span class="control" id="-1918844910#eshc0z_40">ESP Thread BR-Zigbee GW_SUB</span> daughter board for building an Ethernet-enabled Thread Border Router. It must be connected to a Wi-Fi-based ESP Thread Border Router.</p></section><section class="detached"><h2 id="-1918844910#references" data-toc="references#Espressif.md-references">References</h2><ul class="list" id="-1918844910#eshc0z_41" start="1"><li class="list-item" id="-1918844910#eshc0z_42"><p>About Espressif (<a href="https://www.espressif.com/en/about">https://www.espressif.com/en/about</a>)</p></li><li class="list-item" id="-1918844910#eshc0z_43"><p>Espressif Development Boards (<a href="https://www.espressif.com/en/products/devkits/">https://www.espressif.com/en/products/devkits/</a>)</p></li><li class="list-item" id="-1918844910#eshc0z_44"><p>ESP IoT Development Framework (<a href="https://www.espressif.com/en/products/sdks/esp-idf">https://www.espressif.com/en/products/sdks/esp-idf</a>)</p></li></ul></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-715994671">Development Environment Setup</h1></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-400735760">ESP-IDF Setup</h1><section class="detached"><h2 id="-400735760#overview" data-toc="overview#ESP-IDF-Setup.md-overview">Overview</h2><p id="-400735760#-79m457_10">This section demonstrates how to set up the ESP-IDF (<a href="#-1918844910#esp-idf-framework">&quot;ESP-IDF Framework&quot; in &quot;Espressif&quot;</a>) development environment for building and running applications on ESP32 SoCs.</p><p id="-400735760#-79m457_11">This project uses ESP-IDF v5.3.2 (<a href="https://docs.espressif.com/projects/esp-idf/en/v5.3.2/">https://docs.espressif.com/projects/esp-idf/en/v5.3.2/</a>), locked to commit fb25eb0 (<a href="https://github.com/espressif/esp-idf/commit/fb25eb02ebcf78a78b4c34a839238a4a56accec7">https://github.com/espressif/esp-idf/commit/fb25eb02ebcf78a78b4c34a839238a4a56accec7</a>).</p></section><section class="detached"><h2 id="-400735760#step-1-install-prerequisites" data-toc="step-1-install-prerequisites#ESP-IDF-Setup.md-step-1-install-prerequisites">Step 1: Install Prerequisites</h2><div class="detached code-block" id="-400735760#-79m457_15"><pre><code class="language-bash">sudo apt-get install git wget flex bison gperf python3 python3-pip python3-venv cmake ninja-build ccache libffi-dev libssl-dev dfu-util libusb-1.0-0</code></pre></div></section><section class="detached"><h2 id="-400735760#step-2-get-esp-idf" data-toc="step-2-get-esp-idf#ESP-IDF-Setup.md-step-2-get-esp-idf">Step 2: Get ESP-IDF</h2><div class="detached code-block" id="-400735760#-79m457_16"><pre><code class="language-bash">mkdir -p ~/esp
cd ~/esp
git clone -b release/v5.3 --recursive https://github.com/espressif/esp-idf.git esp-idf-5.3
cd ~/esp/esp-idf-5.3
git checkout fb25eb02ebcf78a78b4c34a839238a4a56accec7</code></pre></div></section><section class="detached"><h2 id="-400735760#step-3-set-up-the-tools" data-toc="step-3-set-up-the-tools#ESP-IDF-Setup.md-step-3-set-up-the-tools">Step 3: Set up the Tools</h2><p id="-400735760#-79m457_17">ESP-IDF provides a script <span class="inline-code" id="-400735760#-79m457_19">install.sh</span> that installs the required tools such as the compiler, debugger, Python packages, etc.:</p><div class="detached code-block" id="-400735760#-79m457_18"><pre><code class="language-bash">./install.sh all</code></pre></div></section><section class="detached"><h2 id="-400735760#step-4-create-get-idf-alias" data-toc="step-4-create-get-idf-alias#ESP-IDF-Setup.md-step-4-create-get-idf-alias">Step 4: Create get_idf Alias</h2><p id="-400735760#-79m457_20">ESP-IDF provides a script <span class="inline-code" id="-400735760#-79m457_23">export.sh</span> that sets environment variables so the tools are usable from the command line. The script sets IDF_PATH, updates PATH with ESP-IDF tools, verifies Python compatibility, and enables idf.py auto-completion.</p><p id="-400735760#-79m457_21">Create an alias for executing export.sh by adding the following line to <span class="inline-code" id="-400735760#-79m457_24">~/.bashrc</span> file:</p><div class="detached code-block" id="-400735760#-79m457_22"><pre><code class="language-bash">alias get_idf='. $HOME/esp/esp-idf-5.3/export.sh'</code></pre></div></section><section class="detached"><h2 id="-400735760#step-5-refresh-configuration" data-toc="step-5-refresh-configuration#ESP-IDF-Setup.md-step-5-refresh-configuration">Step 5: Refresh Configuration</h2><p id="-400735760#-79m457_25">Restart your terminal session or run:</p><div class="detached code-block" id="-400735760#-79m457_26"><pre><code class="language-bash">source ~/.bashrc</code></pre></div><p id="-400735760#-79m457_27">Now, running <span class="inline-code" id="-400735760#-79m457_29">get_idf</span> will set up or refresh the esp-idf environment in any terminal session.</p><div class="image-container"><img class="center image" id="-400735760#-79m457_28" alt="get_idf output" title="get_idf output" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/development-environment/esp-idf-v5-4.jpg" width="500" height="525"></div></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-401349892">ESP-Matter Setup</h1><p id="-401349892#im5vo9_4">This section demonstrates how to set up the Espressif's SDK for Matter (<a href="#-1918844910#esp-idf-framework">&quot;ESP-IDF Framework&quot; in &quot;Espressif&quot;</a>) for building Matter applications on ESP32 SoCs.</p><p id="-401349892#im5vo9_5">This project uses Espressif's SDK for Matter v1.4 (<a href="https://github.com/espressif/esp-matter/tree/release/v1.4">https://github.com/espressif/esp-matter/tree/release/v1.4</a>), locked to commit 30af618 (<a href="https://github.com/espressif/esp-matter/commit/30af618a6e962623a0098ad6a33b468f33dc49c7">https://github.com/espressif/esp-matter/commit/30af618a6e962623a0098ad6a33b468f33dc49c7</a>).</p><section class="detached"><h2 id="-401349892#step-1-install-prerequisites" data-toc="step-1-install-prerequisites#ESP-Matter-Setup.md-step-1-install-prerequisites">Step 1: Install Prerequisites</h2><div class="detached code-block" id="-401349892#im5vo9_15"><pre><code class="language-bash">sudo apt-get install git gcc g++ pkg-config libssl-dev libdbus-1-dev \
 	libglib2.0-dev libavahi-client-dev ninja-build python3-venv python3-dev \
 	python3-pip unzip libgirepository1.0-dev libcairo2-dev libreadline-dev</code></pre></div><p id="-401349892#im5vo9_16">Refer to the Matter Build Guide (<a href="https://github.com/espressif/connectedhomeip/blob/v1.3-branch/docs/guides/BUILDING.md">https://github.com/espressif/connectedhomeip/blob/v1.3-branch/docs/guides/BUILDING.md</a>) for more details.</p></section><section class="detached"><h2 id="-401349892#step-2-clone-esp-matter-repository" data-toc="step-2-clone-esp-matter-repository#ESP-Matter-Setup.md-step-2-clone-esp-matter-repository">Step 2: Clone ESP-Matter Repository</h2><p id="-401349892#im5vo9_18">It includes esp-matter SDK and tools (e.g., CHIP-tool, CHIP-cert, ZAP).</p><div class="detached code-block" id="-401349892#im5vo9_19"><pre><code class="language-bash">cd ~/esp/
git clone -b release/v1.4 --recursive https://github.com/espressif/esp-matter.git esp-matter-1.4
cd esp-matter-1.4
git checkout 30af618a6e962623a0098ad6a33b468f33dc49c7</code></pre></div></section><section class="detached"><h2 id="-401349892#step-3-bootstrap-esp-matter" data-toc="step-3-bootstrap-esp-matter#ESP-Matter-Setup.md-step-3-bootstrap-esp-matter">Step 3: Bootstrap ESP-Matter</h2><div class="detached code-block" id="-401349892#im5vo9_20"><pre><code class="language-bash">~/esp/esp-matter-1.4/install.sh</code></pre></div><div class="image-container"><img class="center image" id="-401349892#im5vo9_21" alt="Bootstrapping ESP-Matter" title="Bootstrapping ESP-Matter" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/accessory-devices/image14.png" width="500" height="614"></div></section><section class="detached"><h2 id="-401349892#step-4-create-get-matter-alias" data-toc="step-4-create-get-matter-alias#ESP-Matter-Setup.md-step-4-create-get-matter-alias">Step 4: Create get_matter Alias</h2><p id="-401349892#im5vo9_22">The script <span class="inline-code" id="-401349892#im5vo9_24">~/esp/esp-matter/export.sh</span> configures the environment. Create an alias for executing it by adding the following line to <span class="inline-code" id="-401349892#im5vo9_25">~/.bashrc</span> file:</p><div class="detached code-block" id="-401349892#im5vo9_23"><pre><code class="language-bash">alias get_matter='. $HOME/esp/esp-matter/export.sh'</code></pre></div></section><section class="detached"><h2 id="-401349892#step-5-refresh-configuration" data-toc="step-5-refresh-configuration#ESP-Matter-Setup.md-step-5-refresh-configuration">Step 5: Refresh Configuration</h2><p id="-401349892#im5vo9_26">Restart your terminal session or run:</p><div class="detached code-block" id="-401349892#im5vo9_27"><pre><code class="language-bash">source ~/.bashrc</code></pre></div><p id="-401349892#im5vo9_28">Now, running <span class="inline-code" id="-401349892#im5vo9_29">get_matter</span> will set up or refresh the ESP-Matter environment in any terminal session.</p></section><section class="detached"><h2 id="-401349892#references" data-toc="references#ESP-Matter-Setup.md-references">References</h2><ul class="list" id="-401349892#im5vo9_30" start="1"><li class="list-item" id="-401349892#im5vo9_31"><p>Connected Home over IP v1.3 (<a href="https://github.com/espressif/connectedhomeip/tree/v1.3-branch">https://github.com/espressif/connectedhomeip/tree/v1.3-branch</a>)</p></li><li class="list-item" id="-401349892#im5vo9_32"><p>Connected Home IP Documentation (<a href="https://project-chip.github.io/connectedhomeip-doc/index.html">https://project-chip.github.io/connectedhomeip-doc/index.html</a>)</p></li></ul></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-586960577">ESP32 Project Workflow</h1><p id="-586960577#z8dmjcm_4">This section describes the workflow for creating, building, and deploying a new project.</p><p id="-586960577#z8dmjcm_5">Prerequisites:</p><ul class="list" id="-586960577#z8dmjcm_6" start="1"><li class="list-item" id="-586960577#z8dmjcm_18"><p>ESP-IDF (<a href="#-400735760">ESP-IDF Setup</a>) development environment is set up.</p></li><li class="list-item" id="-586960577#z8dmjcm_19"><p>ESP-Matter (<a href="#-401349892">ESP-Matter Setup</a>) development environment is set up.</p></li><li class="list-item" id="-586960577#z8dmjcm_20"><p>ESP32 (<a href="#-1918844910#development-boards">&quot;Development Boards&quot; in &quot;Espressif&quot;</a>) development board is available.</p></li><li class="list-item" id="-586960577#z8dmjcm_21"><p>CLion 2024.3.3 or later is installed.</p></li></ul><section class="detached"><h2 id="-586960577#step-1-set-up-esp-idf-environment" data-toc="step-1-set-up-esp-idf-environment#ESP32-Project-Workflow.md-step-1-set-up-esp-idf-environment">Step 1: Set Up ESP-IDF Environment</h2><p id="-586960577#z8dmjcm_25">Run the alias, created during the development setup, to initialise the ESP-IDF environment in the current terminal session:</p><div class="detached code-block" id="-586960577#z8dmjcm_26"><pre><code class="language-bash">get_idf</code></pre></div></section><section class="detached"><h2 id="-586960577#step-2-create-a-new-project" data-toc="step-2-create-a-new-project#ESP32-Project-Workflow.md-step-2-create-a-new-project">Step 2: Create a New Project</h2><p id="-586960577#z8dmjcm_27">ESP-IDF provides the idf.py (<a href="https://docs.espressif.com/projects/esp-idf/en/v5.2.3/esp32/api-guides/tools/idf-py.html">https://docs.espressif.com/projects/esp-idf/en/v5.2.3/esp32/api-guides/tools/idf-py.html</a>) command-line tool as a front-end for managing project builds, deployment, debugging, and other tasks, simplifying the workflow significantly. It integrates several essential tools, including CMake for project configuration, Ninja for building, and esptool.py for flashing the target device.</p><div class="detached code-block" id="-586960577#z8dmjcm_28"><pre><code class="language-bash">idf.py create-project &lt;project name&gt;
cd &lt;project name&gt;</code></pre></div></section><section class="detached"><h2 id="-586960577#step-3-set-esp32-as-the-target-device" data-toc="step-3-set-esp32-as-the-target-device#ESP32-Project-Workflow.md-step-3-set-esp32-as-the-target-device">Step 3: Set ESP32 as the target device</h2><p id="-586960577#z8dmjcm_30">The following sets the target device:</p><div class="detached code-block" id="-586960577#z8dmjcm_31"><pre><code class="language-bash">idf.py set-target &lt;chip_name&gt;
idf.py set-target esp32h2</code></pre></div><p id="-586960577#z8dmjcm_32">It creates a new <span class="inline-code" id="-586960577#z8dmjcm_33">sdkconfig</span> file in the root directory of the project. This configuration file can be modified via <span class="inline-code" id="-586960577#z8dmjcm_34">idf.py menuconfig</span>.</p></section><section class="detached"><h2 id="-586960577#step-4-open-the-project-in-clion-ide" data-toc="step-4-open-the-project-in-clion-ide#ESP32-Project-Workflow.md-step-4-open-the-project-in-clion-ide">Step 4: Open the Project in CLion IDE</h2><p id="-586960577#z8dmjcm_35">Create a toolchain named <span class="control" id="-586960577#z8dmjcm_42">ESP-IDF</span> with the environment file set to <span class="inline-code" id="-586960577#z8dmjcm_43">esp-idf/script.sh</span>:</p><div class="image-container"><img class="center image" id="-586960577#z8dmjcm_36" alt="Toolchain setup" title="Toolchain setup" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/accessory-devices/image10.png" width="500" height="375"></div><p id="-586960577#z8dmjcm_37">Set up a CMake profile with the following Matter environmental variables:</p><div class="detached code-block" id="-586960577#z8dmjcm_38"><pre><code class="language-bash">ESP_MATTER_PATH=/home/albert/esp/esp-matter-1.4;ZAP_INSTALL_PATH=/home/albert/esp/esp-matter-1.4/connectedhomeip/connectedhomeip/.environment/cipd/packages/zap;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/snap/bin:/home/albert/.local/share/JetBrains/Toolbox/scripts:/home/albert/esp/esp-matter-1.4/connectedhomeip/connectedhomeip/.environment/cipd/packages/pigweed</code></pre></div><div class="image-container"><img class="center image" id="-586960577#z8dmjcm_39" alt="CMake profile configuration" title="CMake profile configuration" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/accessory-devices/image26.png" width="500" height="369"></div><p id="-586960577#z8dmjcm_40">Structure of a new ESP-IDF project:</p><div class="image-container"><img class="center image" id="-586960577#z8dmjcm_41" alt="Structure of a new ESP-IDF project" title="Structure of a new ESP-IDF project" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/accessory-devices/image12.png" width="500" height="230"></div></section><section class="detached"><h2 id="-586960577#step-5-create-default-configuration" data-toc="step-5-create-default-configuration#ESP32-Project-Workflow.md-step-5-create-default-configuration">Step 5: Create Default Configuration</h2><div class="detached code-block" id="-586960577#z8dmjcm_44"><pre><code class="language-bash">touch sdkconfig.defaults</code></pre></div></section><section class="detached"><h2 id="-586960577#step-6-update-cmakelists-txt" data-toc="step-6-update-cmakelists-txt#ESP32-Project-Workflow.md-step-6-update-cmakelists-txt">Step 6: Update CMakeLists.txt</h2><p id="-586960577#z8dmjcm_45">Update the <span class="inline-code" id="-586960577#z8dmjcm_47">CMakeLists.txt</span> file to include the Matter SDK:</p><div class="detached code-block" id="-586960577#z8dmjcm_46"><pre><code class="language-cmake"># For more information about build system see
# https://docs.espressif.com/projects/esp-idf/en/latest/api-guides/build-system.html
# The following five lines of boilerplate have to be in your project's
# CMakeLists in this exact order for cmake to work correctly
cmake_minimum_required(VERSION 3.16)

# Set an error message if ESP_MATTER_PATH is not set
if(NOT DEFINED ENV{ESP_MATTER_PATH})
    message(FATAL_ERROR &quot;Please set ESP_MATTER_PATH to the path of esp-matter repo&quot;)
endif(NOT DEFINED ENV{ESP_MATTER_PATH})

# The set() commands should be placed after the cmake_minimum() line but before the include() line.
set(PROJECT_VER &quot;1.0&quot;)
set(PROJECT_VER_NUMBER 1)
set(ESP_MATTER_PATH $ENV{ESP_MATTER_PATH})
set(MATTER_SDK_PATH ${ESP_MATTER_PATH}/connectedhomeip/connectedhomeip)
set(ENV{PATH} &quot;$ENV{PATH}:${ESP_MATTER_PATH}/connectedhomeip/connectedhomeip/.environment/cipd/packages/pigweed&quot;)

# Pulls in the rest of the CMake functionality to configure the project, discover all the components, etc.
include($ENV{IDF_PATH}/tools/cmake/project.cmake)
# Include common component dependencies and configurations from ESP-Matter examples
include(${ESP_MATTER_PATH}/examples/common/cmake_common/components_include.cmake)

# Optional list of additional directories to search for components.
set(EXTRA_COMPONENT_DIRS
        &quot;${MATTER_SDK_PATH}/config/esp32/components&quot;
        &quot;${ESP_MATTER_PATH}/components&quot;
        ${extra_components_dirs_append})

# Declare the project
project(project-example)

# Set the C++ standard to C++17
idf_build_set_property(CXX_COMPILE_OPTIONS &quot;-std=gnu++17;-Os;-DCHIP_HAVE_CONFIG_H;-Wno-overloaded-virtual&quot; APPEND)
idf_build_set_property(C_COMPILE_OPTIONS &quot;-Os&quot; APPEND)
# For RISCV chips, project_include.cmake sets -Wno-format, but does not clear various
# flags that depend on -Wformat
idf_build_set_property(COMPILE_OPTIONS &quot;-Wno-format-nonliteral;-Wno-format-security&quot; APPEND)
# Enable colored output in ninja builds
add_compile_options(-fdiagnostics-color=always -Wno-write-strings)</code></pre></div></section><section class="detached"><h2 id="-586960577#step-7-build-the-project" data-toc="step-7-build-the-project#ESP32-Project-Workflow.md-step-7-build-the-project">Step 7: Build the Project</h2><div class="detached code-block" id="-586960577#z8dmjcm_48"><pre><code class="language-bash">idf.py build</code></pre></div></section><section class="detached"><h2 id="-586960577#step-8-determine-serial-port" data-toc="step-8-determine-serial-port#ESP32-Project-Workflow.md-step-8-determine-serial-port">Step 8: Determine Serial Port</h2><p id="-586960577#z8dmjcm_49">Connect the ESP32 board to the computer and check under which serial port the board is visible. Serial ports have the following naming patterns: <span class="inline-code" id="-586960577#z8dmjcm_50">/dev/tty</span>.</p></section><section class="detached"><h2 id="-586960577#step-9-flash-project-to-target" data-toc="step-9-flash-project-to-target#ESP32-Project-Workflow.md-step-9-flash-project-to-target">Step 9: Flash Project to Target</h2><div class="detached code-block" id="-586960577#z8dmjcm_51"><pre><code class="language-bash">idf.py -p &lt;PORT&gt; flash</code></pre></div></section><section class="detached"><h2 id="-586960577#step-10-launch-idf-monitor" data-toc="step-10-launch-idf-monitor#ESP32-Project-Workflow.md-step-10-launch-idf-monitor">Step 10: Launch IDF Monitor</h2><p id="-586960577#z8dmjcm_52">Use the monitor application and exit using <span class="inline-code" id="-586960577#z8dmjcm_54">CTRL+]</span>:</p><div class="detached code-block" id="-586960577#z8dmjcm_53"><pre><code class="language-bash">idf.py -p &lt;PORT&gt; monitor</code></pre></div></section><section class="detached"><h2 id="-586960577#references" data-toc="references#ESP32-Project-Workflow.md-references">References</h2><p id="-586960577#z8dmjcm_55">IDF Frontend - idf.py (<a href="https://docs.espressif.com/projects/esp-idf/en/stable/esp32h2/api-guides/tools/idf-py.html">https://docs.espressif.com/projects/esp-idf/en/stable/esp32h2/api-guides/tools/idf-py.html</a>)</p></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-1685420830">Accessory Devices</h1><section class="detached"><h2 id="-1685420830#overview" data-toc="overview#Accessory-Devices.md-overview">Overview</h2><p id="-1685420830#x2j4nn_6"><span class="control" id="-1685420830#x2j4nn_7">Accessory Devices</span> are Matter (<a href="#-1997370655">Matter</a>)-compatible Thread End Devices (<a href="#-1790576086#end-device">&quot;End Device&quot; in &quot;Thread&quot;</a>) that monitor and control environmental conditions within a Grow Chamber. They include <span class="control" id="-1685420830#x2j4nn_10">sensors</span> and <span class="control" id="-1685420830#x2j4nn_11">actuators</span>.</p></section><section class="detached"><h2 id="-1685420830#sensors" data-toc="sensors#Accessory-Devices.md-sensors">Sensors</h2><p id="-1685420830#x2j4nn_12">A sensor is any device that generates some sort of output when exposed to a phenomenon.</p><p id="-1685420830#x2j4nn_13">The table below lists the sensors utilised in this project:</p><div class="table-wrapper detached"><table id="-1685420830#x2j4nn_14"><tr class="header-row" id="-1685420830#x2j4nn_16"><th id="-1685420830#x2j4nn_21"><p><span class="control" id="-1685420830#x2j4nn_23">Sensor</span></p></th><th id="-1685420830#x2j4nn_22"><p><span class="control" id="-1685420830#x2j4nn_24">Purpose</span></p></th></tr><tr class="" id="-1685420830#x2j4nn_17"><td id="-1685420830#x2j4nn_25"><p>BMP280</p></td><td id="-1685420830#x2j4nn_26"><p>Temperature and air pressure</p></td></tr><tr class="" id="-1685420830#x2j4nn_18"><td id="-1685420830#x2j4nn_27"><p>BH1750 or TSL2561</p></td><td id="-1685420830#x2j4nn_28"><p>Light intensity</p></td></tr><tr class="" id="-1685420830#x2j4nn_19"><td id="-1685420830#x2j4nn_29"><p>DHT22</p></td><td id="-1685420830#x2j4nn_30"><p>Temperature and humidity</p></td></tr><tr class="" id="-1685420830#x2j4nn_20"><td id="-1685420830#x2j4nn_31"><p>MH-Z19B</p></td><td id="-1685420830#x2j4nn_32"><p>Carbon dioxide (CO₂) levels</p></td></tr></table></div><p id="-1685420830#x2j4nn_15">The sensor devices utilise the ESP32-H2 microcontrollers with Thread connectivity and low power consumption, enabling effective operation in various agricultural settings.</p></section><section class="detached"><h2 id="-1685420830#actuators" data-toc="actuators#Accessory-Devices.md-actuators">Actuators</h2><p id="-1685420830#x2j4nn_33">Actuators are located on the output side of IoT solutions. They change their state based on an analog or digital signal from the microcontroller and produce an output that affects the environment.</p><p id="-1685420830#x2j4nn_34">The table below lists the actuators that will be utilised in this project:</p><div class="table-wrapper detached"><table id="-1685420830#x2j4nn_35"><tr class="header-row" id="-1685420830#x2j4nn_37"><th id="-1685420830#x2j4nn_42"><p><span class="control" id="-1685420830#x2j4nn_44">Actuator</span></p></th><th id="-1685420830#x2j4nn_43"><p><span class="control" id="-1685420830#x2j4nn_45">Purpose</span></p></th></tr><tr class="" id="-1685420830#x2j4nn_38"><td id="-1685420830#x2j4nn_46"><p>Ultrasonic mist maker</p></td><td id="-1685420830#x2j4nn_47"><p>Fog generation</p></td></tr><tr class="" id="-1685420830#x2j4nn_39"><td id="-1685420830#x2j4nn_48"><p>Exhaust fan, 120mm DC</p></td><td id="-1685420830#x2j4nn_49"><p>Ventilation</p></td></tr><tr class="" id="-1685420830#x2j4nn_40"><td id="-1685420830#x2j4nn_50"><p>LED grow lights</p></td><td id="-1685420830#x2j4nn_51"><p>Plant growth lighting</p></td></tr><tr class="" id="-1685420830#x2j4nn_41"><td id="-1685420830#x2j4nn_52"><p>Air pump and air stone</p></td><td id="-1685420830#x2j4nn_53"><p>Aeration for water inside Root Chamber</p></td></tr></table></div><p id="-1685420830#x2j4nn_36">Actuator devices utilise the ESP32-DevKitM-1 microcontrollers. In contrast to ESP32-H2, the ESP32-DevKitM-1 does not support Thread connectivity and has higher power consumption. It is used to control actuators, which inherently consume a lot of power.</p></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="1125845925">Matter Pressure and Temperature Sensor</h1><section class="detached"><h2 id="1125845925#overview" data-toc="overview#Matter-Pressure-and-Temperature-Sensor.md-overview">Overview</h2><p id="1125845925#-qo3vsg_9">The <span class="control" id="1125845925#-qo3vsg_14">Matter Pressure and Temperature Sensor</span> is a Matter (<a href="#-1997370655">Matter</a>)-compatible SED (<a href="#-1790576086#end-device">&quot;End Device&quot; in &quot;Thread&quot;</a>) device that reads temperature and pressure data from a BMP280 sensor and exposes the readings as Matter attributes.</p><p id="1125845925#-qo3vsg_10">This section describes the development of a Matter-compatible temperature and pressure sensor.</p><p id="1125845925#-qo3vsg_11">Source Code: GitHub (<a href="https://github.com/albert-gee/matter_bmp280">https://github.com/albert-gee/matter_bmp280</a>)</p><p id="1125845925#-qo3vsg_12">Prerequisites:</p><ul class="list" id="1125845925#-qo3vsg_13" start="1"><li class="list-item" id="1125845925#-qo3vsg_18"><p>ESP-IDF development environment (<a href="#-400735760">ESP-IDF Setup</a>) is set up.</p></li><li class="list-item" id="1125845925#-qo3vsg_19"><p>ESP-Matter development environment (<a href="#-401349892">ESP-Matter Setup</a>) is set up.</p></li><li class="list-item" id="1125845925#-qo3vsg_20"><p>ESP32-H2-DevKitM-1 (<a href="https://docs.espressif.com/projects/esp-dev-kits/en/latest/esp32h2/esp32-h2-devkitm-1/index.html">https://docs.espressif.com/projects/esp-dev-kits/en/latest/esp32h2/esp32-h2-devkitm-1/index.html</a>) is available.</p></li></ul></section><section class="detached"><h2 id="1125845925#hardware-assembly" data-toc="hardware-assembly#Matter-Pressure-and-Temperature-Sensor.md-hardware-assembly">Hardware Assembly</h2><section class="detached"><h3 id="1125845925#wiring-bmp280-to-esp32" data-toc="wiring-bmp280-to-esp32#Matter-Pressure-and-Temperature-Sensor.md-wiring-bmp280-to-esp32">Wiring BMP280 to ESP32</h3><p id="1125845925#-qo3vsg_26">The <span class="control" id="1125845925#-qo3vsg_34">ESP32-H2</span> development board reads data from the <span class="control" id="1125845925#-qo3vsg_35">BMP280</span>, a low-power sensor designed for battery-powered devices. They communicate using <span class="control" id="1125845925#-qo3vsg_36">I2C (Inter-Integrated Circuit)</span>, a serial, synchronous, half-duplex protocol. The ESP32 has two I2C ports, each capable of operating as a controller or target. In this project, the ESP32-H2 acts as the controller, while the BMP280 functions as the target.</p><p id="1125845925#-qo3vsg_27">The I2C bus has two lines: the Serial Data Line (SDA) and the Serial Clock Line (SCL). On the ESP32-H2, SDA and SCL can be assigned to any available GPIO pins.</p><p id="1125845925#-qo3vsg_28">On the ESP32-DevKitM-1, GPIO21 is used for SDA, and GPIO22 is used for SCL.</p><p id="1125845925#-qo3vsg_29">The table below shows the connections for the BMP280 sensor to the ESP32-DevKitM-1 microcontroller:</p><div class="table-wrapper detached"><table id="1125845925#-qo3vsg_30"><tr class="header-row" id="1125845925#-qo3vsg_37"><th id="1125845925#-qo3vsg_43"><p><span class="control" id="1125845925#-qo3vsg_45">BMP280 Pin</span></p></th><th id="1125845925#-qo3vsg_44"><p><span class="control" id="1125845925#-qo3vsg_46">ESP32 Pin</span></p></th></tr><tr class="" id="1125845925#-qo3vsg_38"><td id="1125845925#-qo3vsg_47"><p>VCC</p></td><td id="1125845925#-qo3vsg_48"><p>3.3V</p></td></tr><tr class="" id="1125845925#-qo3vsg_39"><td id="1125845925#-qo3vsg_49"><p>GND</p></td><td id="1125845925#-qo3vsg_50"><p>GND</p></td></tr><tr class="" id="1125845925#-qo3vsg_40"><td id="1125845925#-qo3vsg_51"><p>SDA</p></td><td id="1125845925#-qo3vsg_52"><p>GPIO21</p></td></tr><tr class="" id="1125845925#-qo3vsg_41"><td id="1125845925#-qo3vsg_53"><p>SCL</p></td><td id="1125845925#-qo3vsg_54"><p>GPIO22</p></td></tr><tr class="" id="1125845925#-qo3vsg_42"><td id="1125845925#-qo3vsg_55"><p>SDO</p></td><td id="1125845925#-qo3vsg_56"><p>GND</p></td></tr></table></div><p id="1125845925#-qo3vsg_31">The pictures below show the connections for the BMP280 sensor to the ESP32-DevKitM-1 microcontroller:</p><div class="image-container"><img class="center image" id="1125845925#-qo3vsg_32" alt="BMP280 connected to ESP32-DevKitM-1 (front)" title="BMP280 connected to ESP32-DevKitM-1 (front)" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/accessory-devices/image7.jpg" width="500" height="282"></div><div class="image-container"><img class="center image" id="1125845925#-qo3vsg_33" alt="BMP280 connected to ESP32-DevKitM-1 (back)" title="BMP280 connected to ESP32-DevKitM-1 (back)" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/accessory-devices/image4.jpg" width="500" height="282"></div></section><section class="detached"><h3 id="1125845925#testing-i2c-connectivity" data-toc="testing-i2c-connectivity#Matter-Pressure-and-Temperature-Sensor.md-testing-i2c-connectivity">Testing I2C Connectivity</h3><p id="1125845925#-qo3vsg_57">The I2C tools (<a href="https://github.com/espressif/esp-idf/tree/release/v5.4/examples/peripherals/i2c/i2c_tools">https://github.com/espressif/esp-idf/tree/release/v5.4/examples/peripherals/i2c/i2c_tools</a>) from ESP-IDF examples were used to test communication with the sensor device.</p><p id="1125845925#-qo3vsg_58">The following command configures the I2C bus with specific GPIO number, port number and frequency:</p><div class="detached code-block" id="1125845925#-qo3vsg_59"><pre><code class="language-bash">i2cconfig --port=0 --sda=21 --scl=22 --freq=100000</code></pre></div><p id="1125845925#-qo3vsg_60">The following command scans an I2C bus for devices and output a table with the list of detected devices on the bus:</p><div class="detached code-block" id="1125845925#-qo3vsg_61"><pre><code class="language-bash">i2cdetect</code></pre></div><div class="image-container"><img class="center image" id="1125845925#-qo3vsg_62" alt="i2cconfig output" title="i2cconfig output" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/accessory-devices/image20.png" width="500" height="350"></div><p id="1125845925#-qo3vsg_63">It displays the address 0x76 since the SDO pin is connected to GND.</p><p id="1125845925#-qo3vsg_64">The following command get the value of the &ldquo;ID&rdquo; register which contains the chip identification number chip_id, which is 0x58:</p><div class="detached code-block" id="1125845925#-qo3vsg_65"><pre><code class="language-bash">i2cget -c 0x76 -r 0xD0 -l 1</code></pre></div><ul class="list" id="1125845925#-qo3vsg_66" start="1"><li class="list-item" id="1125845925#-qo3vsg_68"><p>-c option to specify the address of I2C device (acquired from i2cdetect command).</p></li><li class="list-item" id="1125845925#-qo3vsg_69"><p>-r option to specify the register address you want to inspect.</p></li><li class="list-item" id="1125845925#-qo3vsg_70"><p>-l option to specify the length of the content.</p></li></ul></section></section><section class="detached"><h2 id="1125845925#firmware-development" data-toc="firmware-development#Matter-Pressure-and-Temperature-Sensor.md-firmware-development">Firmware Development</h2><p id="1125845925#-qo3vsg_71">The firmware for the ESP32-H2 was developed using the <span class="control" id="1125845925#-qo3vsg_78">ESP-IDF framework</span>.</p><p id="1125845925#-qo3vsg_72">The BMP280 datasheet (<span class="emphasis" id="1125845925#-qo3vsg_79">BST-BMP280-DS001-26</span>) is used as a reference during development.</p><section class="detached"><h3 id="1125845925#project-bootstrap" data-toc="project-bootstrap#Matter-Pressure-and-Temperature-Sensor.md-project-bootstrap">Project Bootstrap</h3><p id="1125845925#-qo3vsg_80">Follow the following steps from the ESP32 Project Workflow (<a href="#-586960577">ESP32 Project Workflow</a>) guide:</p><ul class="list" id="1125845925#-qo3vsg_81" start="1"><li class="list-item" id="1125845925#-qo3vsg_83"><p>Step 1: Set Up ESP-IDF Environment (<a href="#-586960577#step-1-set-up-esp-idf-environment">&quot;Step 1: Set Up ESP-IDF Environment&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li><li class="list-item" id="1125845925#-qo3vsg_84"><p>Step 2: Create a New Project (<a href="#-586960577#step-2-create-a-new-project">&quot;Step 2: Create a New Project&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li><li class="list-item" id="1125845925#-qo3vsg_85"><p>Step 3: Set ESP32 as the target device (<a href="#-586960577#step-3-set-esp32-as-the-target-device">&quot;Step 3: Set ESP32 as the target device&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li><li class="list-item" id="1125845925#-qo3vsg_86"><p>Step 4: Open the Project in CLion IDE (<a href="#-586960577#step-4-open-the-project-in-clion-ide">&quot;Step 4: Open the Project in CLion IDE&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li><li class="list-item" id="1125845925#-qo3vsg_87"><p>Step 5: Create Default Configuration (<a href="#-586960577#step-5-create-default-configuration">&quot;Step 5: Create Default Configuration&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li><li class="list-item" id="1125845925#-qo3vsg_88"><p>Step 6: Update CMakeLists.txt (<a href="#-586960577#step-6-update-cmakelists-txt">&quot;Step 6: Update CMakeLists.txt&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li></ul></section><section class="detached"><h3 id="1125845925#driver-component-development" data-toc="driver-component-development#Matter-Pressure-and-Temperature-Sensor.md-driver-component-development">Driver Component Development</h3><p id="1125845925#-qo3vsg_95">The command below creates a new component named <span class="inline-code" id="1125845925#-qo3vsg_109">bmp280_driver</span> inside the <span class="inline-code" id="1125845925#-qo3vsg_110">components</span> directory.</p><div class="detached code-block" id="1125845925#-qo3vsg_96"><pre><code class="language-bash">idf.py create-component bmp280_driver -C components</code></pre></div><div class="image-container"><img class="center image" id="1125845925#-qo3vsg_97" alt="Creating a new component within an ESP-IDF project" title="Creating a new component within an ESP-IDF project" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/accessory-devices/image1.png" width="500" height="102"></div><p id="1125845925#-qo3vsg_98">The ESP-IDF framework includes a driver for working with I2C devices. To ensure that this component can use the driver, the <span class="inline-code" id="1125845925#-qo3vsg_111">REQUIRES</span> directive must be added to <span class="inline-code" id="1125845925#-qo3vsg_112">components/bmp280_driver/CMakeLists.txt</span> as follows:</p><div class="detached code-block" id="1125845925#-qo3vsg_99"><pre><code class="language-bash">REQUIRES &quot;driver&quot;</code></pre></div><div class="image-container"><img class="center image" id="1125845925#-qo3vsg_100" alt="Using the REQUIRES Directive" title="Using the REQUIRES Directive" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/accessory-devices/image25.png" width="500" height="135"></div><p id="1125845925#-qo3vsg_101">This directive ensures that the build system includes the I2C driver as a dependency for the component during the build process.</p><p id="1125845925#-qo3vsg_102">The <span class="inline-code" id="1125845925#-qo3vsg_113">i2c_utils.h</span> header file declares utility functions for initializing, managing, and performing operations on an I2C master bus and its connected devices.</p><p id="1125845925#-qo3vsg_103">The <span class="inline-code" id="1125845925#-qo3vsg_114">i2c_utils.c</span> file implements these functions and includes <span class="inline-code" id="1125845925#-qo3vsg_115">driver/i2c_master.h</span> ($IDF_PATH/components/driver/i2c/include/driver/i2c_master.h) to access the driver&rsquo;s API in controller mode.</p><p id="1125845925#-qo3vsg_104">The BMP280 code is designed according to the specifications outlined in the BST-BMP280-DS001-26 datasheet. Communication with the sensor is performed through read and write operations on its 8-bit registers.</p><div class="image-container"><img class="center image" id="1125845925#-qo3vsg_105" alt="BMP280 Memory Map. Source: BST-BMP280-DS001-26 datasheet" title="BMP280 Memory Map. Source: BST-BMP280-DS001-26 datasheet" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/accessory-devices/image35.png" width="500" height="172"></div><p id="1125845925#-qo3vsg_106">The <span class="inline-code" id="1125845925#-qo3vsg_116">bmp280_driver.h</span> header file declares the configurations, constants, and functions needed to interface with and operate the sensor, based on the datasheet.</p><p id="1125845925#-qo3vsg_107">The <span class="inline-code" id="1125845925#-qo3vsg_117">bmp280_driver.c</span> file implements these functions, providing support for sensor initialization, configuration, and data handling. It adheres to the datasheet to verify the sensor, apply compensation to raw measurements, and configure parameters like oversampling, operating modes, and filters.</p><p id="1125845925#-qo3vsg_108">The BMP280 sensor uses factory-programmed calibration parameters to adjust raw data for accurate measurements. These parameters are stored in the sensor's non-volatile memory (NVM) during production, are unique to each device, and cannot be modified by the user, as described in Section 3.11.2 of the datasheet. The <span class="inline-code" id="1125845925#-qo3vsg_118">bmp280_calibration.h</span> header declares the constants, structures, and functions needed to handle this calibration data. It includes functionality to read the parameters and apply them to raw pressure and temperature readings. The <span class="inline-code" id="1125845925#-qo3vsg_119">bmp280_calibration.c</span> file implements these functions, following the temperature and pressure compensation formulas specified in Section 3.11 of the datasheet.</p></section><section class="detached"><h3 id="1125845925#matter-component-development" data-toc="matter-component-development#Matter-Pressure-and-Temperature-Sensor.md-matter-component-development">Matter Component Development</h3><p id="1125845925#-qo3vsg_120">The command below creates a new component named bmp280_driver inside the components directory.</p><div class="detached code-block" id="1125845925#-qo3vsg_121"><pre><code class="language-bash">idf.py create-component matter_interface -C components</code></pre></div><p id="1125845925#-qo3vsg_122">The <span class="inline-code" id="1125845925#-qo3vsg_125">matter_temperature_sensor.h</span> file defines functions for managing a Matter-compatible temperature sensor.</p><p id="1125845925#-qo3vsg_123">The <span class="inline-code" id="1125845925#-qo3vsg_126">matter_temperature_sensor.c</span> file implements these functions using Espressif&rsquo;s Matter SDK, built on the Matter SDK.</p><p id="1125845925#-qo3vsg_124">In the Matter ecosystem, devices are represented as Nodes, which consist of Endpoints representing specific functions, such as temperature measurement. Endpoints are organized into Clusters that group related features. This implementation sets up a Node with an Endpoint for temperature measurement, configures its Clusters, and manages communication within the Matter network.</p></section><section class="detached"><h3 id="1125845925#integration-of-bmp280-driver-with-esp-matter" data-toc="integration-of-bmp280-driver-with-esp-matter#Matter-Pressure-and-Temperature-Sensor.md-integration-of-bmp280-driver-with-esp-matter">Integration of BMP280 Driver with ESP-Matter</h3><p id="1125845925#-qo3vsg_127">The bmp280_driver component outputs temperature and pressure readings as 32-bit signed integers (int32_t), following the BMP280 datasheet specifications. These integers are used to process the sensor&rsquo;s raw 20-bit data for precise calculations, including compensation and scaling. The readings represent scaled real-world values to preserve decimal precision using integer arithmetic. For example, a temperature of 25.25&deg;C is stored as 2525 (in units of 0.01&deg;C), and a pressure of 1013.25 is stored as 101325 (in Pascals).</p><p id="1125845925#-qo3vsg_128">During integration with ESP-Matter, an issue arose because ESP-Matter defines attributes like measured_value, min_measured_value, and max_measured_value in its Temperature and Pressure Measurement Clusters using the nullable&lt; int16_t&gt; data type. This required the BMP280&rsquo;s outputs, represented as int32_t, to be reduced to fit within the int16_t range of -32,768 to 32,767. The BMP280 outputs temperature values within a range of -40&deg;C to +85&deg;C and pressure values within a range of 300 hPa to 1100 hPa. For temperature, no additional scaling was necessary because even the maximum value, when scaled (e.g., 85.00&deg;C becomes 8500), fits comfortably within the int16_t range without any loss of precision.</p><p id="1125845925#-qo3vsg_129">For pressure, however, scaled values can exceed the limit of the int16_t range. Multiplying higher values by 100 to preserve decimal precision increases their magnitude beyond the int16_t limit. For example, a pressure of 1013.25 becomes 101325 when scaled, which far exceeds the int16_t range.</p><p id="1125845925#-qo3vsg_130">To address this, the scaling approach was modified. Instead of multiplying by 100 to represent hundredths of Pascals, pressure values were scaled by 10. This reduced the magnitude of the scaled values, allowing them to fit within the int16_t range. For example, a pressure of 1013.25 is scaled to 10132, which fits comfortably within the range. Similarly, the maximum pressure of 1100.00 is scaled to 11000.</p></section><section class="detached"><h3 id="1125845925#reading-the-temperature" data-toc="reading-the-temperature#Matter-Pressure-and-Temperature-Sensor.md-reading-the-temperature">Reading the Temperature</h3><p id="1125845925#-qo3vsg_131">To manage temperature readings, two approaches were considered:</p><ul class="list" id="1125845925#-qo3vsg_132" start="1"><li class="list-item" id="1125845925#-qo3vsg_135"><p>Regularly poll the temperature sensor, for example, using a timer. Each new reading is written directly to the attribute&rsquo;s stored value.</p></li><li class="list-item" id="1125845925#-qo3vsg_136"><p>Update the temperature reading only when a client requests it. In this approach, the sensor retrieves the latest temperature data and writes it to the attribute before responding to the client.</p></li></ul><p id="1125845925#-qo3vsg_133">The second approach requires a mechanism to dynamically fetch the latest sensor data during a client read operation. ESP-Matter provides native support for callbacks during attribute write operations, but not for reads. In the ESP-Matter repository on GitHub, Issue #264 (<a href="https://github.com/espressif/esp-matter/issues/264">https://github.com/espressif/esp-matter/issues/264</a>) includes a discussion about using the <span class="inline-code" id="1125845925#-qo3vsg_138">ATTRIBUTE_FLAG_OVERRIDE</span> flag to implement such functionality. The discussion describes a workaround involving modifications to the framework&rsquo;s internal <span class="inline-code" id="1125845925#-qo3vsg_139">esp_matter_attribute.cpp</span> file to override the default attribute behavior and introduce custom read logic.</p><p id="1125845925#-qo3vsg_134">A more maintainable alternative would be to leverage the flag directly within application code. This approach avoids modifying the framework itself. However, it introduces additional complexity and can cause delays in client responses, as the sensor data must be fetched in real-time for each read request. Due to these challenges, the first option was chosen for its simplicity and faster response times.</p></section></section><section class="detached"><h2 id="1125845925#testing" data-toc="testing#Matter-Pressure-and-Temperature-Sensor.md-testing">Testing</h2><section class="detached"><h3 id="1125845925#testing-with-chip-tool" data-toc="testing-with-chip-tool#Matter-Pressure-and-Temperature-Sensor.md-testing-with-chip-tool">Testing with CHIP-Tool</h3><p id="1125845925#-qo3vsg_142">Refer to CHIP-Tool (<a href="#-1509277031">CHIP-Tool</a>) for more details.</p><div class="detached code-block" id="1125845925#-qo3vsg_143"><pre><code class="language-bash">matter onboardingcodes ble</code></pre></div><div class="detached code-block" id="1125845925#-qo3vsg_144"><pre><code class="language-bash">matter esp attribute get 0x0001 0x00000402 0x00000000
matter esp attribute get 0x0002 0x00000403 0x00000000</code></pre></div></section><section class="detached"><h3 id="1125845925#connecting-to-google-home" data-toc="connecting-to-google-home#Matter-Pressure-and-Temperature-Sensor.md-connecting-to-google-home">Connecting to Google Home</h3><p id="1125845925#-qo3vsg_146">It is also possible to use third-party software, such as the Google Home app, as a controller. However, the device appears offline in Google Home despite being successfully commissioned. To address this issue, a structured troubleshooting process was undertaken:</p><ul class="list" id="1125845925#-qo3vsg_147" start="1"><li class="list-item" id="1125845925#-qo3vsg_152"><p>Flash Memory Reset: The device&rsquo;s flash memory was erased to remove any residual configurations that could interfere with its functionality.</p></li><li class="list-item" id="1125845925#-qo3vsg_153"><p>Network Configuration Check: It was confirmed that both the mobile device and the hardware were connected to a 2.4 GHz Wi-Fi network, as the system does not support 5 GHz networks.</p></li><li class="list-item" id="1125845925#-qo3vsg_154"><p>Device Reset: The hardware was reset to ensure proper initialization and resolve any temporary issues.</p></li></ul><p id="1125845925#-qo3vsg_148">Vaishali Avhale, Associate QA Engineer at Espressif Systems, provided feedback on a related issue in the Espressif ESP-Matter GitHub repository (Issue #1125 (<a href="https://github.com/espressif/esp-matter/issues/1125">https://github.com/espressif/esp-matter/issues/1125</a>)). She tested the system using a Google Nest Hub 2nd Generation as a hub and confirmed that it worked correctly in this configuration. She noted that a hub device is a required component for proper operation within Google's ecosystem.</p><div class="image-container"><img class="center image" id="1125845925#-qo3vsg_149" alt="Google Home app detecting a device that is broadcasting its presence using Bluetooth Low Energy (BLE)" title="Google Home app detecting a device that is broadcasting its presence using Bluetooth Low Energy (BLE)" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/accessory-devices/image5.jpg" width="93" height="200"></div><div class="image-container"><img class="center image" id="1125845925#-qo3vsg_150" alt="Google Home app requesting QR code for commissioning" title="Google Home app requesting QR code for commissioning" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/accessory-devices/image3.jpg" width="93" height="200"></div><div class="image-container"><img class="center image" id="1125845925#-qo3vsg_151" alt="Google Home app notifies that its hardware doesn&amp;rsquo;t support Matter" title="Google Home app notifies that its hardware doesn&amp;rsquo;t support Matter" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/accessory-devices/image29.jpg" width="93" height="200"></div></section></section><section class="detached"><h2 id="1125845925#references" data-toc="references#Matter-Pressure-and-Temperature-Sensor.md-references">References</h2><ul class="list" id="1125845925#-qo3vsg_156" start="1"><li class="list-item" id="1125845925#-qo3vsg_157"><p>BMP280 &ndash; Data sheet (<a href="https://www.bosch-sensortec.com/media/boschsensortec/downloads/datasheets/bst-bmp280-ds001-26.pdf">https://www.bosch-sensortec.com/media/boschsensortec/downloads/datasheets/bst-bmp280-ds001-26.pdf</a>)</p></li><li class="list-item" id="1125845925#-qo3vsg_158"><p>Telink Matter Developers Guide (<a href="https://wiki.telink-semi.cn/doc/an/TelinkMatterDevelopersGuide_en.pdf">https://wiki.telink-semi.cn/doc/an/TelinkMatterDevelopersGuide_en.pdf</a>)</p></li><li class="list-item" id="1125845925#-qo3vsg_159"><p>ESP-Matter Sensors Example (<a href="https://github.com/espressif/esp-matter/tree/main/examples/sensors">https://github.com/espressif/esp-matter/tree/main/examples/sensors</a>)</p></li></ul></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="2085001628">Matter Relay Switch</h1><section class="detached"><h2 id="2085001628#overview" data-toc="overview#Matter-Relay-Switch.md-overview">Overview</h2><p id="2085001628#-jwiz6v_7">The <span class="control" id="2085001628#-jwiz6v_12">Matter Relay Switch</span> is a Matter (<a href="#-1997370655">Matter</a>)-compatible REED (<a href="#-1790576086#end-device">&quot;End Device&quot; in &quot;Thread&quot;</a>) device that can be controlled remotely to turn a relay on or off. It can be used to control various devices, such as lights or fans.</p><p id="2085001628#-jwiz6v_8">This section describes the development of the <span class="control" id="2085001628#-jwiz6v_15">Matter Relay Switch</span>.</p><p id="2085001628#-jwiz6v_9">Source Code: GitHub (<a href="https://github.com/albert-gee/matter_relay">https://github.com/albert-gee/matter_relay</a>)</p><p id="2085001628#-jwiz6v_10">Prerequisites:</p><ul class="list" id="2085001628#-jwiz6v_11" start="1"><li class="list-item" id="2085001628#-jwiz6v_17"><p>ESP-IDF development environment (<a href="#-400735760">ESP-IDF Setup</a>) is set up.</p></li><li class="list-item" id="2085001628#-jwiz6v_18"><p>Matter development environment (<a href="#773821741">Matter Interface</a>) is set up.</p></li><li class="list-item" id="2085001628#-jwiz6v_19"><p>ESP32-H2-DevKitM-1 (<a href="https://docs.espressif.com/projects/esp-dev-kits/en/latest/esp32h2/esp32-h2-devkitm-1/index.html">https://docs.espressif.com/projects/esp-dev-kits/en/latest/esp32h2/esp32-h2-devkitm-1/index.html</a>) is available.</p></li></ul></section><section class="detached"><h2 id="2085001628#hardware-assembly" data-toc="hardware-assembly#Matter-Relay-Switch.md-hardware-assembly">Hardware Assembly</h2><section class="detached"><h3 id="2085001628#wiring-relay-to-esp32" data-toc="wiring-relay-to-esp32#Matter-Relay-Switch.md-wiring-relay-to-esp32">Wiring Relay to ESP32</h3><p id="2085001628#-jwiz6v_24">The <span class="control" id="2085001628#-jwiz6v_32">Valefod 5V 1-Channel Relay Module</span> is used to control loads up to 10A using a low-power control signal from a microcontroller such as an Arduino or ESP32. It features optocoupler isolation for improved signal integrity and supports both high and low trigger configurations.</p><p id="2085001628#-jwiz6v_25">The relay has the following terminal layout:</p><ul class="list" id="2085001628#-jwiz6v_26" start="1"><li class="list-item" id="2085001628#-jwiz6v_33"><p><span class="control" id="2085001628#-jwiz6v_35">Side 1: Control Terminals</span></p><ul class="list" id="2085001628#-jwiz6v_36" start="1"><li class="list-item" id="2085001628#-jwiz6v_37"><p>DC+ (Power Supply Positive): Connect to a 5V power supply.</p></li><li class="list-item" id="2085001628#-jwiz6v_38"><p>DC- (Power Supply Negative): Connect to the ground of the power supply.</p></li><li class="list-item" id="2085001628#-jwiz6v_39"><p>IN (Input Signal): Connect to a GPIO pin on the microcontroller to control the relay.</p></li></ul></li><li class="list-item" id="2085001628#-jwiz6v_34"><p><span class="control" id="2085001628#-jwiz6v_40">Side 2: Switch Terminals</span></p><ul class="list" id="2085001628#-jwiz6v_41" start="1"><li class="list-item" id="2085001628#-jwiz6v_42"><p>COM (Common Terminal): Shared terminal for the relay's switch.</p></li><li class="list-item" id="2085001628#-jwiz6v_43"><p>NO (Normally Open): Open circuit by default; closes when the relay is activated.</p></li><li class="list-item" id="2085001628#-jwiz6v_44"><p>NC (Normally Closed): Closed circuit by default; opens when the relay is activated.</p></li></ul></li></ul><p id="2085001628#-jwiz6v_27">The Normally Open (NO) terminal is used when the circuit should remain open (off) by default, requiring activation to close the circuit. The Normally Closed (NC) terminal is used when the circuit should remain closed (on) by default, opening only when the relay is activated.</p><div class="image-container"><img class="center image" id="2085001628#-jwiz6v_28" alt="Wiring Relay to ESP32" title="Wiring Relay to ESP32" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/accessory-devices/image39.jpg" width="500" height="888"></div><div class="image-container"><img class="center image" id="2085001628#-jwiz6v_29" alt="Wiring Relay to ESP32" title="Wiring Relay to ESP32" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/accessory-devices/image40.jpg" width="500" height="888"></div><div class="image-container"><img class="center image" id="2085001628#-jwiz6v_30" alt="Wiring Relay to ESP32" title="Wiring Relay to ESP32" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/accessory-devices/image13.jpg" width="500" height="282"></div><div class="image-container"><img class="center image" id="2085001628#-jwiz6v_31" alt="Wiring Relay to ESP32" title="Wiring Relay to ESP32" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/accessory-devices/image24.jpg" width="500" height="282"></div></section></section><section class="detached"><h2 id="2085001628#firmware-development" data-toc="firmware-development#Matter-Relay-Switch.md-firmware-development">Firmware Development</h2><p id="2085001628#-jwiz6v_45">The firmware uses the ESP-IDF (<a href="#-1918844910#esp-idf-framework">&quot;ESP-IDF Framework&quot; in &quot;Espressif&quot;</a>) framework with the SDK for Matter. It sets up an On/Off endpoint and configures callbacks to manage Matter attributes, enabling GPIO-based relay control.</p><section class="detached"><h3 id="2085001628#project-bootstrap" data-toc="project-bootstrap#Matter-Relay-Switch.md-project-bootstrap">Project Bootstrap</h3><p id="2085001628#-jwiz6v_49">Follow the following steps from the ESP32 Project Workflow (<a href="#-586960577">ESP32 Project Workflow</a>) guide:</p><ul class="list" id="2085001628#-jwiz6v_50" start="1"><li class="list-item" id="2085001628#-jwiz6v_52"><p>Step 1: Set Up ESP-IDF Environment (<a href="#-586960577#step-1-set-up-esp-idf-environment">&quot;Step 1: Set Up ESP-IDF Environment&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li><li class="list-item" id="2085001628#-jwiz6v_53"><p>Step 2: Create a New Project (<a href="#-586960577#step-2-create-a-new-project">&quot;Step 2: Create a New Project&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li><li class="list-item" id="2085001628#-jwiz6v_54"><p>Step 3: Set ESP32 as the target device (<a href="#-586960577#step-3-set-esp32-as-the-target-device">&quot;Step 3: Set ESP32 as the target device&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li><li class="list-item" id="2085001628#-jwiz6v_55"><p>Step 4: Open the Project in CLion IDE (<a href="#-586960577#step-4-open-the-project-in-clion-ide">&quot;Step 4: Open the Project in CLion IDE&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li><li class="list-item" id="2085001628#-jwiz6v_56"><p>Step 5: Create Default Configuration (<a href="#-586960577#step-5-create-default-configuration">&quot;Step 5: Create Default Configuration&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li><li class="list-item" id="2085001628#-jwiz6v_57"><p>Step 6: Update CMakeLists.txt (<a href="#-586960577#step-6-update-cmakelists-txt">&quot;Step 6: Update CMakeLists.txt&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li></ul></section><section class="detached"><h3 id="2085001628#gpio-configuration" data-toc="gpio-configuration#Matter-Relay-Switch.md-gpio-configuration">GPIO Configuration</h3><p id="2085001628#-jwiz6v_64">The header file <span class="inline-code" id="2085001628#-jwiz6v_70">$IDF_PATH/components/esp_driver_gpio/include/driver/gpio.h</span> can be included with:</p><div class="detached code-block" id="2085001628#-jwiz6v_65"><pre><code class="language-c">#include &quot;driver/gpio.h&quot;</code></pre></div><p id="2085001628#-jwiz6v_66">This header file is a part of the API provided by the <span class="inline-code" id="2085001628#-jwiz6v_71">esp_driver_gpio</span> component. To declare that your component depends on esp_driver_gpio, the following line has to be added to CMakeLists.txt:</p><div class="detached code-block" id="2085001628#-jwiz6v_67"><pre><code class="language-cmake">REQUIRES esp_driver_gpio</code></pre></div><p id="2085001628#-jwiz6v_68">or</p><div class="detached code-block" id="2085001628#-jwiz6v_69"><pre><code class="language-cmake">PRIV_REQUIRES esp_driver_gpio</code></pre></div></section></section><section class="detached"><h2 id="2085001628#testing" data-toc="testing#Matter-Relay-Switch.md-testing">Testing</h2><section class="detached"><h3 id="2085001628#testing-with-chip-tool" data-toc="testing-with-chip-tool#Matter-Relay-Switch.md-testing-with-chip-tool">Testing with CHIP-Tool</h3><p id="2085001628#-jwiz6v_73">Refer to CHIP-Tool (<a href="#-1509277031">CHIP-Tool</a>) for more details.</p><div class="detached code-block" id="2085001628#-jwiz6v_74"><pre><code class="language-bash">matter onboardingcodes ble

matter esp attribute set 0x1 0x6 0x0 1
matter esp attribute get 0x1 0x6 0x0</code></pre></div></section></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="1955462060">Thread Border Routers</h1><section class="detached"><h2 id="1955462060#overview" data-toc="overview#Thread-Border-Routers.md-overview">Overview</h2><p id="1955462060#-5bcf5j_5">Thread Border Routers (<a href="#-1790576086#border-router">&quot;Border Router&quot; in &quot;Thread&quot;</a>) provide IP connectivity between the Thread Network of accessory devices (<a href="#-1685420830">Accessory Devices</a>) and adjacent external W-Fi network, such as a home LAN, building network, or the broader Internet.</p><p id="1955462060#-5bcf5j_6">This section walks through how to set up and run ESP Basic Thread Border Router (<a href="#-1231632047">ESP Basic Thread Border Router</a>) and ESP Matter Thread Border Router (<a href="#-497258712">ESP Matter Thread Border Router</a>) examples on the ESP Thread Border Router (<a href="#-1918844910#esp-thread-border-router-solution">&quot;ESP Thread Border Router Solution&quot; in &quot;Espressif&quot;</a>) board.</p></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-1231632047">ESP Basic Thread Border Router</h1><section class="detached"><h2 id="-1231632047#overview" data-toc="overview#ESP-Basic-Thread-Border-Router.md-overview">Overview</h2><p id="-1231632047#ryz19g_9">The <span class="inline-code" id="-1231632047#ryz19g_11">ESP Basic Thread Border Router</span> example from ESP_IDF (<a href="#-1918844910#esp-idf-framework">&quot;ESP-IDF Framework&quot; in &quot;Espressif&quot;</a>) demonstrates how to build firmware for a basic Thread Border Router device running on Espressif's hardware.</p><p id="-1231632047#ryz19g_10">The firmware configures the OpenThread platform using default radio, host, and port settings. Optionally, it enables external coexistence and sets up mDNS (with the hostname &quot;esp-ot-br&quot;), along with OTA and web server support if enabled. Finally, it launches the Border Router.</p></section><section class="detached"><h2 id="-1231632047#build-and-run" data-toc="build-and-run#ESP-Basic-Thread-Border-Router.md-build-and-run">Build and Run</h2><p id="-1231632047#ryz19g_13">This section demonstrates how to build and run the <span class="control" id="-1231632047#ryz19g_22">ESP Basic Thread Border Router</span> example.</p><p id="-1231632047#ryz19g_14">Prerequisites:</p><ul class="list" id="-1231632047#ryz19g_15" start="1"><li class="list-item" id="-1231632047#ryz19g_23"><p>ESP-IDF development environment (<a href="#-400735760">ESP-IDF Setup</a>) is set up.</p></li><li class="list-item" id="-1231632047#ryz19g_24"><p>ESP THREAD BR-ZIGBEE GW (<a href="#-1790576086#border-router">&quot;Border Router&quot; in &quot;Thread&quot;</a>) board</p></li></ul><div class="image-container"><img class="center image" id="-1231632047#ryz19g_16" alt="ESP Thread Border Router/Zigbee Gateway" title="ESP Thread Border Router/Zigbee Gateway" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/orchestrator-devices/esp-thread-border-router.jpg" width="500" height="282"></div><section class="detached"><h3 id="-1231632047#step-1-build-the-rcp-image" data-toc="step-1-build-the-rcp-image#ESP-Basic-Thread-Border-Router.md-step-1-build-the-rcp-image">Step 1: Build the RCP Image</h3><div class="detached code-block" id="-1231632047#ryz19g_27"><pre><code class="language-bash">get_idf
cd $IDF_PATH/examples/openthread/ot_rcp/
idf.py set-target esp32h2   # Select the ESP32-H2. Skipping this step would result in a build error.
idf.py build</code></pre></div><p id="-1231632047#ryz19g_28">The firmware does not need to be manually flashed onto the device. It will be integrated into the Border Router firmware and automatically installed onto the ESP32-H2 chip during the first boot-up. <span class="inline-code" id="-1231632047#ryz19g_29">idf.py menuconfig</span> can be used for customized settings.</p></section><section class="detached"><h3 id="-1231632047#step-2-clone-espressif-thread-border-router-sdk" data-toc="step-2-clone-espressif-thread-border-router-sdk#ESP-Basic-Thread-Border-Router.md-step-2-clone-espressif-thread-border-router-sdk">Step 2: Clone Espressif Thread Border Router SDK</h3><p id="-1231632047#ryz19g_30">This project uses Espressif Thread Border Router SDK locked to commit cf3a09f (<a href="https://github.com/espressif/esp-thread-br/commit/cf3a09f5f44991a4e65b2d1c5113637e1d086b68">https://github.com/espressif/esp-thread-br/commit/cf3a09f5f44991a4e65b2d1c5113637e1d086b68</a>).</p><div class="detached code-block" id="-1231632047#ryz19g_31"><pre><code class="language-bash">cd ~/esp
git clone --recursive https://github.com/espressif/esp-thread-br.git
cd ~/esp/esp-thread-br/
git checkout cf3a09f5f44991a4e65b2d1c5113637e1d086b68
cd ~/esp/esp-thread-br/examples/basic_thread_border_router</code></pre></div></section><section class="detached"><h3 id="-1231632047#step-3-configure-the-device-optional" data-toc="step-3-configure-the-device-optional#ESP-Basic-Thread-Border-Router.md-step-3-configure-the-device-optional">Step 3: Configure the Device (Optional)</h3><p id="-1231632047#ryz19g_33">This section describes how to configure the device using <span class="inline-code" id="-1231632047#ryz19g_44">idf.py menuconfig</span>. This step is <span class="emphasis" id="-1231632047#ryz19g_45">optional</span> because the device can be configured using the OpenThread CLI (<a href="#-1790576086#openthread-cli">&quot;OpenThread CLI&quot; in &quot;Thread&quot;</a>) after flashing the firmware.</p><p id="-1231632047#ryz19g_34">The default configuration in <span class="inline-code" id="-1231632047#ryz19g_47">sdkconfig.default</span> file is designed to work out of the box on the ESP Thread Border Router board with ESP32-S3 as the default SoC target. For other SoCs, the target must be configured using <span class="inline-code" id="-1231632047#ryz19g_48">idf.py set-target &lt;chip_name&gt;</span>.</p><p id="-1231632047#ryz19g_35">The command below opens the configuration menu:</p><div class="detached code-block" id="-1231632047#ryz19g_36"><pre><code class="language-bash">idf.py menuconfig</code></pre></div><p id="-1231632047#ryz19g_37">Enable <span class="control" id="-1231632047#ryz19g_49">automatic start mode</span> and the <span class="control" id="-1231632047#ryz19g_50">Web GUI</span>:</p><ul class="list" id="-1231632047#ryz19g_38" start="1"><li class="list-item" id="-1231632047#ryz19g_51"><p><span class="inline-code" id="-1231632047#ryz19g_52">ESP Thread Border Router Example &rarr; Enable the automatic start mode in Thread Border</span></p></li></ul><p id="-1231632047#ryz19g_39">In <span class="control" id="-1231632047#ryz19g_53">automatic start mode</span>, the device first attempts to use the Wi-Fi SSID and password stored in <span class="control" id="-1231632047#ryz19g_54">NVS</span> ( Non-Volatile Storage). If no Wi-Fi credentials are found in NVS, it uses <span class="control" id="-1231632047#ryz19g_55">EXAMPLE_WIFI_SSID</span> and <span class="control" id="-1231632047#ryz19g_56">EXAMPLE_WIFI_PASSWORD</span>, retrieved from the following configuration options:</p><ul class="list" id="-1231632047#ryz19g_40" start="1"><li class="list-item" id="-1231632047#ryz19g_57"><p><span class="inline-code" id="-1231632047#ryz19g_59">Example Connection Configuration &rarr; WiFi SSID</span></p></li><li class="list-item" id="-1231632047#ryz19g_58"><p><span class="inline-code" id="-1231632047#ryz19g_60">Example Connection Configuration &rarr; WiFi Password</span></p></li></ul><p id="-1231632047#ryz19g_41">Additionally, <span class="control" id="-1231632047#ryz19g_61">Thread dataset</span> can be configured:</p><p id="-1231632047#ryz19g_42"><span class="inline-code" id="-1231632047#ryz19g_62">Component config &rarr; OpenThread &rarr; Thread Core Features &rarr; Thread Operational Dataset</span></p><div class="image-container"><img class="center image" id="-1231632047#ryz19g_43" alt="Thread Border Router Dataset" title="Thread Border Router Dataset" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/orchestrator-devices/esp-thread-border-router-dataset.png" width="400" height="226"></div></section><section class="detached"><h3 id="-1231632047#step-4-connect-the-esp-thread-border-router-board" data-toc="step-4-connect-the-esp-thread-border-router-board#ESP-Basic-Thread-Border-Router.md-step-4-connect-the-esp-thread-border-router-board">Step 4: Connect the ESP Thread Border Router Board</h3><p id="-1231632047#ryz19g_63">Use <span class="control" id="-1231632047#ryz19g_64">USB2 (ESP32-S3)</span> on the ESP Thread Border Router Board to connect the board to the computer. Only the ESP32-S3 ( main SoC) port needs to be connected. The main SoC automatically programs the Thread co-processor.</p></section><section class="detached"><h3 id="-1231632047#step-5-build-and-flash" data-toc="step-5-build-and-flash#ESP-Basic-Thread-Border-Router.md-step-5-build-and-flash">Step 5: Build and Flash</h3><div class="detached code-block" id="-1231632047#ryz19g_65"><pre><code class="language-bash">idf.py build 
idf.py -p &lt;PORT&gt; flash monitor</code></pre></div></section></section><section class="detached"><h2 id="-1231632047#openthread-cli" data-toc="openthread-cli#ESP-Basic-Thread-Border-Router.md-openthread-cli">OpenThread CLI</h2><p id="-1231632047#ryz19g_66">This section demonstrates how to use the OpenThread CLI (<a href="#-1790576086#openthread-cli">&quot;OpenThread CLI&quot; in &quot;Thread&quot;</a>) on the ESP Thread Border Router.</p><p id="-1231632047#ryz19g_67">OpenThread CLI is enabled in the ESP OpenThread component (<a href="https://github.com/espressif/esp-idf/blob/master/components/openthread/Kconfig">https://github.com/espressif/esp-idf/blob/master/components/openthread/Kconfig</a>) by default. It can also be enabled/disabled using the <span class="inline-code" id="-1231632047#ryz19g_77">idf.py menuconfig</span> command:</p><ul class="list" id="-1231632047#ryz19g_68" start="1"><li class="list-item" id="-1231632047#ryz19g_78"><p><span class="inline-code" id="-1231632047#ryz19g_79">Component config &rarr; OpenThread &rarr; Thread Console &rarr; Enable OpenThread Command-Line Interface</span></p></li></ul><p id="-1231632047#ryz19g_69">The <span class="inline-code" id="-1231632047#ryz19g_80">ESP Thread Border Router</span> project extends the standard <span class="inline-code" id="-1231632047#ryz19g_81">OpenThread CLI</span> by including the OpenThread Extension Commands (<a href="https://github.com/espressif/esp-thread-br/tree/main/components/esp_ot_cli_extension#wifi">https://github.com/espressif/esp-thread-br/tree/main/components/esp_ot_cli_extension#wifi</a>) component with additional commands demonstrated below, such as Wi-Fi management and IP address printing.</p><section class="detached"><h3 id="-1231632047#wi-fi-management" data-toc="wi-fi-management#ESP-Basic-Thread-Border-Router.md-wi-fi-management">Wi-Fi Management</h3><p id="-1231632047#ryz19g_83">Connect the ESP Thread Border Router to a Wi-Fi network:</p><div class="detached code-block" id="-1231632047#ryz19g_84"><pre><code class="language-bash">wifi connect -s &lt;SSID&gt; -p &lt;PASSWORD&gt;</code></pre></div><p id="-1231632047#ryz19g_85">Disconnect the ESP Thread Border Router from the Wi-Fi network:</p><div class="detached code-block" id="-1231632047#ryz19g_86"><pre><code class="language-bash">wifi disconnect</code></pre></div><p id="-1231632047#ryz19g_87">Print the current Wi-Fi network state:</p><div class="detached code-block" id="-1231632047#ryz19g_88"><pre><code class="language-bash">wifi state</code></pre></div></section><section class="detached"><h3 id="-1231632047#ip-addresses-and-network-interfaces" data-toc="ip-addresses-and-network-interfaces#ESP-Basic-Thread-Border-Router.md-ip-addresses-and-network-interfaces">IP Addresses and Network Interfaces</h3><p id="-1231632047#ryz19g_89">Print all the IP address on each interface of lwIP of the Thread Border Router:</p><div class="detached code-block" id="-1231632047#ryz19g_90"><pre><code class="language-bash">ip print</code></pre></div><div class="image-container"><img class="center image" id="-1231632047#ryz19g_91" alt="Print IPs" title="Print IPs" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/orchestrator-devices/tbr_1.png" width="400" height="307"></div><p id="-1231632047#ryz19g_92">The output lists network interfaces (netif):</p><ul class="list" id="-1231632047#ryz19g_93" start="1"><li class="list-item" id="-1231632047#ryz19g_97"><p><span class="control" id="-1231632047#ryz19g_101">nt</span></p></li><li class="list-item" id="-1231632047#ryz19g_98"><p>**ot ** (OpenThread Network Interface (<a href="https://github.com/espressif/esp-idf/blob/release/v5.3/components/openthread/src/esp_openthread_lwip_netif.c#L136">https://github.com/espressif/esp-idf/blob/release/v5.3/components/openthread/src/esp_openthread_lwip_netif.c#L136</a>)),</p></li><li class="list-item" id="-1231632047#ryz19g_99"><p>**st ** (Wi-Fi Station (STA) interface (<a href="https://github.com/espressif/esp-idf/blob/release/v5.3/components/esp_netif/lwip/netif/wlanif.c#L223">https://github.com/espressif/esp-idf/blob/release/v5.3/components/esp_netif/lwip/netif/wlanif.c#L223</a>)), this includes the <span class="control" id="-1231632047#ryz19g_104">Global Unicast Address</span> (<span class="control" id="-1231632047#ryz19g_105">GUA</span>), which falls within the 2000::/3 range (starts with 2xxx, 3xxx). This address is globally routable and can be used for external access if the Wi-Fi router&rsquo;s firewall allows incoming connections to this address.</p></li><li class="list-item" id="-1231632047#ryz19g_100"><p><span class="control" id="-1231632047#ryz19g_106">lo</span> (Loopback interface (<a href="https://github.com/espressif/esp-lwip/blob/2.1.3-esp/src/core/netif.c#L151">https://github.com/espressif/esp-lwip/blob/2.1.3-esp/src/core/netif.c#L151</a>)).</p></li></ul><p id="-1231632047#ryz19g_94">If the Thread Border Router is connected to a Wi-Fi network, we can ping it from another device. The following commands should be run on a Linux machine to find the name of the Wi-Fi network interfaces and then use it to ping the Thread Border Router:</p><div class="detached code-block" id="-1231632047#ryz19g_95"><pre><code class="language-bash">ip addr
ping6 -I &lt;INTERFACE&gt; &lt;DEVICE_IP&gt;
ping6 -I wlo1 fe80::aaaa:0000:0000:0000
ping6 -I wlo1 2604::aaaa:0000:0000:0000</code></pre></div><div class="image-container"><img class="center image" id="-1231632047#ryz19g_96" alt="Ping" title="Ping" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/orchestrator-devices/tbr_2.png" width="400" height="147"></div></section><section class="detached"><h3 id="-1231632047#forming-thread-network" data-toc="forming-thread-network#ESP-Basic-Thread-Border-Router.md-forming-thread-network">Forming Thread network</h3><p id="-1231632047#ryz19g_108">The following commands form a Thread network (<a href="#1215462931">Forming a Network</a>):</p><ol class="list list-decimal" id="-1231632047#ryz19g_109" type="1" start="1"><li class="list-item" id="-1231632047#ryz19g_111"><p id="-1231632047#ryz19g_117"><span class="emphasis" id="-1231632047#ryz19g_119">Optional</span>. Delete any previous settings stored on non-volatile memory, and then trigger a platform reset:</p><div class="detached code-block" id="-1231632047#ryz19g_118"><pre><code class="language-bash">factoryreset</code></pre></div></li><li class="list-item" id="-1231632047#ryz19g_112"><p id="-1231632047#ryz19g_120">Initialize a new dataset:</p><div class="detached code-block" id="-1231632047#ryz19g_121"><pre><code class="language-bash">dataset init new</code></pre></div></li><li class="list-item" id="-1231632047#ryz19g_113"><p id="-1231632047#ryz19g_122">Commit the new Operational Dataset buffer to Active Operational Dataset:</p><div class="detached code-block" id="-1231632047#ryz19g_123"><pre><code class="language-bash">dataset commit active</code></pre></div></li><li class="list-item" id="-1231632047#ryz19g_114"><p id="-1231632047#ryz19g_124">Enable IPv6 communication:</p><div class="detached code-block" id="-1231632047#ryz19g_125"><pre><code class="language-bash">ifconfig up</code></pre></div></li><li class="list-item" id="-1231632047#ryz19g_115"><p id="-1231632047#ryz19g_126">Enable Thread interface</p><div class="detached code-block" id="-1231632047#ryz19g_127"><pre><code class="language-bash">thread start</code></pre></div></li><li class="list-item" id="-1231632047#ryz19g_116"><p id="-1231632047#ryz19g_128">Show the Active Operational Dataset. The optional <span class="inline-code" id="-1231632047#ryz19g_133">-x</span> argument prints it as hex-encoded TLVs:</p><div class="detached code-block" id="-1231632047#ryz19g_129"><pre><code class="language-bash">dataset active -x</code></pre></div><div class="image-container"><img class="center image" id="-1231632047#ryz19g_130" alt="Active Operational Dataset" title="Active Operational Dataset" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/orchestrator-devices/ot_cli_1.png" width="500" height="442"></div><p id="-1231632047#ryz19g_131">The ip print (<a href="#-1231632047#ip-addresses-and-network-interfaces">&quot;IP Addresses and Network Interfaces&quot; in &quot;ESP Basic Thread Border Router&quot;</a>) command now shows the Thread interface with the IPv6 address:</p><div class="image-container"><img class="center image" id="-1231632047#ryz19g_132" alt="Ping" title="Ping" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/orchestrator-devices/tbr_3.png" width="400" height="352"></div></li></ol></section><section class="detached"><h3 id="-1231632047#managing-border-routing-manager" data-toc="managing-border-routing-manager#ESP-Basic-Thread-Border-Router.md-managing-border-routing-manager">Managing Border Routing Manager</h3><p id="-1231632047#ryz19g_135">The Border Routing Manager starts automatically after enabling the Thread interface. The <span class="inline-code" id="-1231632047#ryz19g_142">br</span> command can be used to manage the Border Routing Manager.</p><p id="-1231632047#ryz19g_136">Print the current state of Border Routing Manager:</p><div class="detached code-block" id="-1231632047#ryz19g_137"><pre><code class="language-bash">br state</code></pre></div><p id="-1231632047#ryz19g_138">Initializes the Border Routing Manager:</p><div class="detached code-block" id="-1231632047#ryz19g_139"><pre><code class="language-bash">br init &lt;infrastructure-network-index&gt; &lt;is-running&gt;</code></pre></div><p id="-1231632047#ryz19g_140">Enables the Border Routing Manager:</p><div class="detached code-block" id="-1231632047#ryz19g_141"><pre><code class="language-bash">br enable</code></pre></div></section><section class="detached"><h3 id="-1231632047#information-commands" data-toc="information-commands#ESP-Basic-Thread-Border-Router.md-information-commands">Information Commands</h3><p id="-1231632047#ryz19g_143">The <span class="inline-code" id="-1231632047#ryz19g_144">platform</span> command prints the current platform. The <span class="inline-code" id="-1231632047#ryz19g_145">version</span> and <span class="inline-code" id="-1231632047#ryz19g_146">rcp version</span> print the OpenThread version and the radio version respectively.</p></section></section><section class="detached"><h2 id="-1231632047#restful-api-and-web-gui" data-toc="restful-api-and-web-gui#ESP-Basic-Thread-Border-Router.md-restful-api-and-web-gui">RESTful API and Web GUI</h2><p id="-1231632047#ryz19g_147">The ESP Thread Border Router provides a RESTful API and Web GUI for managing the Thread Border Router. It is disabled by default and can be enabled using <span class="inline-code" id="-1231632047#ryz19g_151">idf.py menuconfig</span>:</p><ul class="list" id="-1231632047#ryz19g_148" start="1"><li class="list-item" id="-1231632047#ryz19g_152"><p><span class="inline-code" id="-1231632047#ryz19g_153">ESP Thread Border Router Example &rarr; Enable the web server in Thread Border Router</span></p></li></ul><section class="detached"><h3 id="-1231632047#web-gui-access" data-toc="web-gui-access#ESP-Basic-Thread-Border-Router.md-web-gui-access">Web GUI Access</h3><p id="-1231632047#ryz19g_154">The Web GUI can be accessed using the IP address of the Thread Border Router:</p><div class="detached code-block" id="-1231632047#ryz19g_155"><pre><code class="language-bash">http://&lt;DEVICE_IP&gt;/index.html</code></pre></div><p id="-1231632047#ryz19g_156">The Web GUI can be accessed using the IPv4 address assigned by the Wi-Fi router or the device's IPv6 Global Unicast Address (see <span class="inline-code" id="-1231632047#ryz19g_157">ip print</span> in extension-commands). IPv4 is only accessible within the local network unless port forwarding is configured on the router. IPv6 can be accessed externally if a firewall rule is added on the router.</p></section><section class="detached"><h3 id="-1231632047#restful-api-client-library-generation" data-toc="restful-api-client-library-generation#ESP-Basic-Thread-Border-Router.md-restful-api-client-library-generation">RESTful API Client Library Generation</h3><p id="-1231632047#ryz19g_158">The API is documented using the OpenAPI specification in the openapi.yaml (<a href="https://github.com/espressif/esp-thread-br/blob/main/components/esp_ot_br_server/src/openapi.yaml">https://github.com/espressif/esp-thread-br/blob/main/components/esp_ot_br_server/src/openapi.yaml</a>) file. OpenAPI Generator (<a href="https://github.com/OpenAPITools/openapi-generator">https://github.com/OpenAPITools/openapi-generator</a>) can be used to generate a client library.</p><p id="-1231632047#ryz19g_159">The following commands should be run on a Linux machine with installed Docker and Node.js to generate a TypeScript client library for the ESP-Thread Border Router server:</p><div class="detached code-block" id="-1231632047#ryz19g_160"><pre><code class="language-bash">docker run --rm -v &quot;${PWD}:/local&quot; openapitools/openapi-generator-cli generate -i /local/openapi.yaml -g typescript-fetch -o /local/out/typescript-fetch
sudo chown -R $USER:$USER out/
npm install --safe-dev typescript</code></pre></div></section></section><section class="detached"><h2 id="-1231632047#references" data-toc="references#ESP-Basic-Thread-Border-Router.md-references">References</h2><ul class="list" id="-1231632047#ryz19g_163" start="1"><li class="list-item" id="-1231632047#ryz19g_164"><p>Espressif Thread Border Router SDK (<a href="https://github.com/espressif/esp-thread-br">https://github.com/espressif/esp-thread-br</a>)</p></li><li class="list-item" id="-1231632047#ryz19g_165"><p>OpenThread - ESP Thread Border Router (<a href="https://mattercoder.com/codelabs/how-to-install-border-router-on-esp32/?index=..%2F..index#0">https://mattercoder.com/codelabs/how-to-install-border-router-on-esp32/?index=..%2F..index#0</a>)</p></li><li class="list-item" id="-1231632047#ryz19g_166"><p>Espressif - Build and Run ESP Thread Border Router (<a href="https://docs.espressif.com/projects/esp-thread-br/en/latest/dev-guide/build_and_run.html">https://docs.espressif.com/projects/esp-thread-br/en/latest/dev-guide/build_and_run.html</a>)</p></li><li class="list-item" id="-1231632047#ryz19g_167"><p>OpenThread - Build a Thread Network with the ESP32H2 and ESP Thread Border Router Board (<a href="https://openthread.io/codelabs/esp-openthread-hardware">https://openthread.io/codelabs/esp-openthread-hardware</a>)</p></li><li class="list-item" id="-1231632047#ryz19g_168"><p>How to Install Border Router on ESP32-DevKit and ESP32-H2 (<a href="https://mattercoder.com/codelabs/how-to-install-border-router-on-esp32/?index=..%2F..index#0">https://mattercoder.com/codelabs/how-to-install-border-router-on-esp32/?index=..%2F..index#0</a>)</p></li><li class="list-item" id="-1231632047#ryz19g_169"><p>Web GUI (<a href="https://docs.espressif.com/projects/esp-thread-br/en/latest/codelab/web-gui.html">https://docs.espressif.com/projects/esp-thread-br/en/latest/codelab/web-gui.html</a>)</p></li><li class="list-item" id="-1231632047#ryz19g_170"><p>Global Unicast Address (<a href="https://docs.oracle.com/cd/E19120-01/open.solaris/819-3000/ipv6-overview-130/index.html">https://docs.oracle.com/cd/E19120-01/open.solaris/819-3000/ipv6-overview-130/index.html</a>)</p></li></ul></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-497258712">ESP Matter Thread Border Router</h1><section class="detached"><h2 id="-497258712#overview" data-toc="overview#ESP-Matter-Thread-Border-Router.md-overview">Overview</h2><p id="-497258712#-xid9kj_9">The <span class="inline-code" id="-497258712#-xid9kj_12">ESP Matter Thread Border Router</span> example from Espressif's SDK for Matter (<a href="#-1918844910#esp-matter-solution">&quot;ESP Matter Solution&quot; in &quot;Espressif&quot;</a>) demonstrates how to build firmware for a Matter-compliant Thread Border Router device running on Espressif's hardware.</p><p id="-497258712#-xid9kj_10">The firmware creates a Matter node and configures a Thread Border Router endpoint. If Thread support is enabled, it configures the OpenThread platform with default radio, host, and port settings. Finally, it starts the Matter stack with an event callback to handle network events and initializes the diagnostic console if enabled.</p><p id="-497258712#-xid9kj_11">When the ESP32 connects to Wi-Fi and gets an IP, it sets up Wi-Fi as the backbone for OpenThread and starts the Thread Border Router to enable communication between Thread and Wi-Fi. A static variable stops it from running more than once.</p></section><section class="detached"><h2 id="-497258712#build-and-run" data-toc="build-and-run#ESP-Matter-Thread-Border-Router.md-build-and-run">Build and Run</h2><p id="-497258712#-xid9kj_14">This section demonstrates how to build and run the <span class="inline-code" id="-497258712#-xid9kj_22">ESP Matter Thread Border Router</span> example from Espressif's SDK for Matter (<a href="#-1918844910#esp-matter-solution">&quot;ESP Matter Solution&quot; in &quot;Espressif&quot;</a>).</p><p id="-497258712#-xid9kj_15">Prerequisites:</p><ul class="list" id="-497258712#-xid9kj_16" start="1"><li class="list-item" id="-497258712#-xid9kj_24"><p>ESP-IDF development environment (<a href="#-400735760">ESP-IDF Setup</a>) is set up.</p></li><li class="list-item" id="-497258712#-xid9kj_25"><p>ESP-Matter development environment (<a href="#-401349892">ESP-Matter Setup</a>) is set up.</p></li><li class="list-item" id="-497258712#-xid9kj_26"><p>ESP THREAD BR-ZIGBEE GW (<a href="#-1790576086#border-router">&quot;Border Router&quot; in &quot;Thread&quot;</a>) board</p></li></ul><section class="detached"><h3 id="-497258712#step-1-build-and-configure-the-rcp-image" data-toc="step-1-build-and-configure-the-rcp-image#ESP-Matter-Thread-Border-Router.md-step-1-build-and-configure-the-rcp-image">Step 1: Build and Configure the RCP Image</h3><p id="-497258712#-xid9kj_30">The build process is similar to the Basic Thread Border Router example (<a href="#-1231632047#build-and-run">&quot;Build and Run&quot; in &quot;ESP Basic Thread Border Router&quot;</a>). The following steps from the Basic Thread Border Router example are required if not already completed:</p><ol class="list list-decimal" id="-497258712#-xid9kj_31" type="1" start="1"><li class="list-item" id="-497258712#-xid9kj_33"><p>Follow Step 1: Build the RCP Image (<a href="#-1231632047#step-1-build-the-rcp-image">&quot;Step 1: Build the RCP Image&quot; in &quot;ESP Basic Thread Border Router&quot;</a>).</p></li><li class="list-item" id="-497258712#-xid9kj_34"><p>Follow optional Step 3: Configure the Device (<a href="#-1231632047#step-3-configure-the-device-optional">&quot;Step 3: Configure the Device (Optional)&quot; in &quot;ESP Basic Thread Border Router&quot;</a>).</p></li></ol></section><section class="detached"><h3 id="-497258712#step-2-set-up-environment" data-toc="step-2-set-up-environment#ESP-Matter-Thread-Border-Router.md-step-2-set-up-environment">Step 2: Set Up Environment</h3><p id="-497258712#-xid9kj_37">Set up the environment and navigate to the <span class="inline-code" id="-497258712#-xid9kj_39">ESP Matter Thread Border Router</span> example directory:</p><div class="detached code-block" id="-497258712#-xid9kj_38"><pre><code class="language-bash">get_idf
get_matter
cd $ESP_MATTER_PATH/examples/thread_border_router</code></pre></div></section><section class="detached"><h3 id="-497258712#step-3-set-target-to-esp32-s3" data-toc="step-3-set-target-to-esp32-s3#ESP-Matter-Thread-Border-Router.md-step-3-set-target-to-esp32-s3">Step 3: Set target to ESP32-S3</h3><div class="detached code-block" id="-497258712#-xid9kj_40"><pre><code class="language-bash">idf.py set-target esp32s3</code></pre></div></section><section class="detached"><h3 id="-497258712#step-4-connect-the-esp-thread-border-router-board" data-toc="step-4-connect-the-esp-thread-border-router-board#ESP-Matter-Thread-Border-Router.md-step-4-connect-the-esp-thread-border-router-board">Step 4: Connect the ESP Thread Border Router Board</h3><p id="-497258712#-xid9kj_41">Follow Step 4: Connect the ESP Thread Border Router Board (<a href="#-1231632047#step-4-connect-the-esp-thread-border-router-board">&quot;Step 4: Connect the ESP Thread Border Router Board&quot; in &quot;ESP Basic Thread Border Router&quot;</a>) from the Basic Thread Border Router example.</p></section><section class="detached"><h3 id="-497258712#step-5-build-and-flash" data-toc="step-5-build-and-flash#ESP-Matter-Thread-Border-Router.md-step-5-build-and-flash">Step 5: Build and Flash</h3><div class="detached code-block" id="-497258712#-xid9kj_43"><pre><code class="language-bash">idf.py build 
idf.py -p &lt;PORT&gt; flash monitor</code></pre></div></section></section><section class="detached"><h2 id="-497258712#matter-cli" data-toc="matter-cli#ESP-Matter-Thread-Border-Router.md-matter-cli">Matter CLI</h2><p id="-497258712#-xid9kj_44">This section demonstrates how to use the Matter CLI on the ESP Matter Thread Border Router.</p><p id="-497258712#-xid9kj_45">The device automatically starts BLE advertising when powered on. The following command can be used to check the state:</p><div class="detached code-block" id="-497258712#-xid9kj_46"><pre><code class="language-bash">matter ble adv state</code></pre></div><p id="-497258712#-xid9kj_47">The following command prints the Matter configuration, including the PIN code and Discriminator, needed for commissioning:</p><div class="detached code-block" id="-497258712#-xid9kj_48"><pre><code class="language-bash">matter config</code></pre></div></section><section class="detached"><h2 id="-497258712#chip-tool" data-toc="chip-tool#ESP-Matter-Thread-Border-Router.md-chip-tool">CHIP-Tool</h2><p id="-497258712#-xid9kj_49">The Thread Border Router management cluster allows provisioning of the Thread interface using a Matter commissioner.</p><section class="detached"><h3 id="-497258712#commissioning-to-wi-fi-over-ble" data-toc="commissioning-to-wi-fi-over-ble#ESP-Matter-Thread-Border-Router.md-commissioning-to-wi-fi-over-ble">Commissioning to Wi-Fi over BLE</h3><p id="-497258712#-xid9kj_52">Refer to Commissioning to Wi-Fi over BLE using CHIP Tool (<a href="#-1509277031#commissioning-to-wi-fi-over-ble">&quot;Commissioning to Wi-Fi over BLE&quot; in &quot;CHIP-Tool&quot;</a>).</p></section><section class="detached"><h3 id="-497258712#joining-a-thread-network" data-toc="joining-a-thread-network#ESP-Matter-Thread-Border-Router.md-joining-a-thread-network">Joining a Thread Network</h3><p id="-497258712#-xid9kj_54">After commissioning, a fail-safe timer must be armed:</p><div class="detached code-block" id="-497258712#-xid9kj_55"><pre><code class="language-bash">./chip-tool generalcommissioning arm-fail-safe &lt;TIMEOUT_IN_SEC&gt; 1 &lt;NODE_ID&gt; 0
./chip-tool generalcommissioning arm-fail-safe 120 1 0x1122 0</code></pre></div><p id="-497258712#-xid9kj_56">Provision the Border Router using an active dataset in HEX TLV format (the same format used for commissioning a Matter over Thread (<a href="#-1509277031#commissioning-to-thread-over-ble">&quot;Commissioning to Thread over BLE&quot; in &quot;CHIP-Tool&quot;</a>) device via the <span class="inline-code" id="-497258712#-xid9kj_64">ble-thread</span> command). The <span class="control" id="-497258712#-xid9kj_65">Thread Border Router Management Cluster</span> should be used:</p><div class="detached code-block" id="-497258712#-xid9kj_57"><pre><code class="language-bash">./chip-tool threadborderroutermanagement set-active-dataset-request hex:&lt;ACTIVE_DATASET&gt; &lt;NODE_ID&gt; 1</code></pre></div><p id="-497258712#-xid9kj_58">If the active dataset command succeeds, complete the commissioning process by disarming the fail-safe timer and committing the configuration to non-volatile storage:</p><div class="detached code-block" id="-497258712#-xid9kj_59"><pre><code class="language-bash">./chip-tool generalcommissioning commissioning-complete &lt;NODE_ID&gt; 1</code></pre></div><p id="-497258712#-xid9kj_60">Verify the configuration by retrieving the active dataset:</p><div class="detached code-block" id="-497258712#-xid9kj_61"><pre><code class="language-bash">./chip-tool threadborderroutermanagement get-active-dataset-request &lt;NODE_ID&gt; 1</code></pre></div><p id="-497258712#-xid9kj_62">The response includes a <span class="inline-code" id="-497258712#-xid9kj_66">DatasetResponse</span> containing the active dataset in hex-encoded format.</p></section></section><section class="detached"><h2 id="-497258712#references" data-toc="references#ESP-Matter-Thread-Border-Router.md-references">References</h2><ul class="list" id="-497258712#-xid9kj_67" start="1"><li class="list-item" id="-497258712#-xid9kj_68"><p>ESP-Matter Thread Border Router (<a href="https://github.com/espressif/esp-matter/tree/main/examples/thread_border_router">https://github.com/espressif/esp-matter/tree/main/examples/thread_border_router</a>)</p></li><li class="list-item" id="-497258712#-xid9kj_69"><p>CHIP-Tool - Thread Border Router Usage (<a href="https://project-chip.github.io/connectedhomeip-doc/platforms/nxp/nxp_otbr_guide.html">https://project-chip.github.io/connectedhomeip-doc/platforms/nxp/nxp_otbr_guide.html</a>)</p></li></ul></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="1139179455">System Control</h1><section class="detached"><h2 id="1139179455#overview" data-toc="overview#System-Control.md-overview">Overview</h2><p id="1139179455#jbgfli_5">This chapter describes the tools and interfaces for configuring, managing, and monitoring the system. It demonstrates existing solutions - like the ESP OpenThread CLI (<a href="#-1412866926">ESP OpenThread CLI</a>) for Thread management and the CHIP-Tool (<a href="#-1509277031">CHIP-Tool</a>) for Matter - and introduces the new Orchestrator (<a href="#-309902166">Orchestrator</a>) device and Control Panel (<a href="#561613140">Control Panel</a>).</p></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-1412866926">ESP OpenThread CLI</h1><p id="-1412866926#no1k5f_4">This section describes how to build and run the OpenThread CLI (<a href="#-1790576086#openthread-cli">&quot;OpenThread CLI&quot; in &quot;Thread&quot;</a>) example project from the ESP-IDF (<a href="#-1918844910#esp-idf-framework">&quot;ESP-IDF Framework&quot; in &quot;Espressif&quot;</a>). It can be used to test and debug the OpenThread stack on ESP32 series SoCs (<a href="#-1918844910#development-boards">&quot;Development Boards&quot; in &quot;Espressif&quot;</a>).</p><p id="-1412866926#no1k5f_5">Prerequisites:</p><ul class="list" id="-1412866926#no1k5f_6" start="1"><li class="list-item" id="-1412866926#no1k5f_13"><p>ESP-IDF development environment (<a href="#-400735760">ESP-IDF Setup</a>) is set up.</p></li><li class="list-item" id="-1412866926#no1k5f_14"><p>ESP32-H2-DevKitM-1 (<a href="https://docs.espressif.com/projects/esp-dev-kits/en/latest/esp32h2/esp32-h2-devkitm-1/index.html">https://docs.espressif.com/projects/esp-dev-kits/en/latest/esp32h2/esp32-h2-devkitm-1/index.html</a>) is available.</p></li></ul><section class="detached"><h2 id="-1412866926#build-and-run" data-toc="build-and-run#ESP-OpenThread-CLI.md-build-and-run">Build and Run</h2><p id="-1412866926#no1k5f_17">This section demonstrates how to build and run the OpenThread CLI example on the <span class="control" id="-1412866926#no1k5f_23">ESP32-H2 devkit</span>.</p><section class="detached"><h3 id="-1412866926#step-1-prepare-the-environment" data-toc="step-1-prepare-the-environment#ESP-OpenThread-CLI.md-step-1-prepare-the-environment">Step 1: Prepare the Environment</h3><div class="detached code-block" id="-1412866926#no1k5f_24"><pre><code class="language-bash">get_idf
cd $IDF_PATH/examples/openthread/ot_cli</code></pre></div></section><section class="detached"><h3 id="-1412866926#step-2-set-target-to-esp32-h2" data-toc="step-2-set-target-to-esp32-h2#ESP-OpenThread-CLI.md-step-2-set-target-to-esp32-h2">Step 2: Set target to ESP32-H2</h3><div class="detached code-block" id="-1412866926#no1k5f_25"><pre><code class="language-bash">idf.py set-target esp32h2</code></pre></div></section><section class="detached"><h3 id="-1412866926#step-3-optional-configure-the-device" data-toc="step-3-optional-configure-the-device#ESP-OpenThread-CLI.md-step-3-optional-configure-the-device">Step 3 (Optional): Configure the Device</h3><p id="-1412866926#no1k5f_26">The example can run with the default configuration. <span class="inline-code" id="-1412866926#no1k5f_28">idf.py menuconfig</span> can be used for customized settings:</p><ul class="list" id="-1412866926#no1k5f_27" start="1"><li class="list-item" id="-1412866926#no1k5f_29"><p>Enabling Joiner Role: <span class="inline-code" id="-1412866926#no1k5f_30">Component Config &rarr; OpenThread &rarr; Thread Core Features &rarr; Enable Joiner</span></p></li></ul></section><section class="detached"><h3 id="-1412866926#step-4-connect-to-the-computer" data-toc="step-4-connect-to-the-computer#ESP-OpenThread-CLI.md-step-4-connect-to-the-computer">Step 4: Connect to the Computer</h3><p id="-1412866926#no1k5f_31">Connect the ESP32-H2-DevKitM-1 to the computer using a USB cable.</p></section><section class="detached"><h3 id="-1412866926#step-5-build-and-flash" data-toc="step-5-build-and-flash#ESP-OpenThread-CLI.md-step-5-build-and-flash">Step 5: Build and Flash</h3><div class="detached code-block" id="-1412866926#no1k5f_32"><pre><code class="language-bash">idf.py build
idf.py -p &lt;PORT_TO_ESP32_H2&gt; flash monitor</code></pre></div></section></section><section class="detached"><h2 id="-1412866926#usage" data-toc="usage#ESP-OpenThread-CLI.md-usage">Usage</h2><section class="detached"><h3 id="-1412866926#joining-thread-network" data-toc="joining-thread-network#ESP-OpenThread-CLI.md-joining-thread-network">Joining Thread Network</h3><p id="-1412866926#no1k5f_38">A Thread device can join the network using either a minimal dataset (providing only the Network Key) or a complete Active Operational Dataset.</p><p id="-1412866926#no1k5f_39"><span class="control" id="-1412866926#no1k5f_47">Example 1: Joining with Minimal Provisioning (Network Key Only)</span></p><p id="-1412866926#no1k5f_40">The device is initially provisioned with only the Network Key. After joining, the device synchronizes with the network and automatically receives the complete Active Operational Dataset.</p><div class="detached code-block" id="-1412866926#no1k5f_41"><pre><code class="language-bash">dataset networkkey 00112233445566778899aabbccddeeff
dataset commit active
ifconfig up
thread start</code></pre></div><p id="-1412866926#no1k5f_42">Display the full Active Operational Dataset:</p><div class="detached code-block" id="-1412866926#no1k5f_43"><pre><code class="language-bash">dataset active</code></pre></div><p id="-1412866926#no1k5f_44"><span class="control" id="-1412866926#no1k5f_48">Example 2: Joining with the Full Active Operational Dataset</span></p><p id="-1412866926#no1k5f_45">In this method, all network parameters (such as PAN ID, channel, Mesh-Local Prefix, etc.) are provisioned upfront. The device is configured with the complete dataset before starting the Thread interface.</p><div class="detached code-block" id="-1412866926#no1k5f_46"><pre><code class="language-bash">dataset set active 0e080000000000010000000300001835060004001fffe00208fe7bb701f5f1125d0708fd75cbde7c6647bd0510b3914792d44f45b6c7d76eb9306eec94030f4f70656e5468726561642d35383332010258320410e35c581af5029b054fc904a24c2b27700c0402a0fff8
ifconfig up
thread start</code></pre></div></section><section class="detached"><h3 id="-1412866926#commissioning" data-toc="commissioning#ESP-OpenThread-CLI.md-commissioning">Commissioning</h3><p id="-1412866926#no1k5f_49"><span class="control" id="-1412866926#no1k5f_54">Joiner device</span>:</p><ul class="list" id="-1412866926#no1k5f_50" start="1"><li class="list-item" id="-1412866926#no1k5f_55"><p id="-1412866926#no1k5f_57">Get the factory-assigned IEEE EUI-64 address (e.g., <span class="inline-code" id="-1412866926#no1k5f_59">744dbdfffe63f5c8</span>).</p><div class="detached code-block" id="-1412866926#no1k5f_58"><pre><code class="language-bash">eui64</code></pre></div></li><li class="list-item" id="-1412866926#no1k5f_56"><p id="-1412866926#no1k5f_60">Bring the IPv6 interface up, enable the Thread Joiner role, and start the Thread protocol:</p><div class="detached code-block" id="-1412866926#no1k5f_61"><pre><code class="language-bash">ifconfig up
joiner start J00MMM
thread start</code></pre></div></li></ul><p id="-1412866926#no1k5f_51"><span class="control" id="-1412866926#no1k5f_62">Commissioner device</span>:</p><ul class="list" id="-1412866926#no1k5f_52" start="1"><li class="list-item" id="-1412866926#no1k5f_63"><p id="-1412866926#no1k5f_66">Start the Commissioner role:</p><div class="detached code-block" id="-1412866926#no1k5f_67"><pre><code class="language-bash">commissioner start</code></pre></div></li><li class="list-item" id="-1412866926#no1k5f_64"><p id="-1412866926#no1k5f_68">Add a joiner entry:</p><div class="detached code-block" id="-1412866926#no1k5f_69"><pre><code class="language-bash">commissioner joiner add &lt;eui64|discerner&gt; &lt;pksd&gt;</code></pre></div><p id="-1412866926#no1k5f_70">Example:</p><div class="detached code-block" id="-1412866926#no1k5f_71"><pre><code class="language-bash">commissioner joiner add 744dbdfffe63f5c8 J00MMM or commissioner joiner add * J00MMM</code></pre></div></li><li class="list-item" id="-1412866926#no1k5f_65"><p id="-1412866926#no1k5f_72">Display all Joiner entries in table format:</p><div class="detached code-block" id="-1412866926#no1k5f_73"><pre><code class="language-bash">commissioner joiner table</code></pre></div></li></ul><p id="-1412866926#no1k5f_53">The Joiner device receives the Network Key when joining the network.</p></section><section class="detached"><h3 id="-1412866926#testing" data-toc="testing#ESP-OpenThread-CLI.md-testing">Testing</h3><p id="-1412866926#no1k5f_74">The command <span class="inline-code" id="-1412866926#no1k5f_77">router table</span> prints a list of routers in a table format. Each router is identified by its Extended MAC.</p><p id="-1412866926#no1k5f_75">The command <span class="inline-code" id="-1412866926#no1k5f_78">extaddr</span> returns the Extended MAC address of a device.</p><p id="-1412866926#no1k5f_76">The <span class="inline-code" id="-1412866926#no1k5f_79">joiner id</span> command returns the Joiner ID used for commissioning.</p></section><section class="detached"><h3 id="-1412866926#sending-udp-packets" data-toc="sending-udp-packets#ESP-OpenThread-CLI.md-sending-udp-packets">Sending UDP packets</h3><p id="-1412866926#no1k5f_80">Running UDP Server:</p><div class="detached code-block" id="-1412866926#no1k5f_81"><pre><code class="language-bash">udpsockserver open
udpsockserver bind 12345
udpsockserver status</code></pre></div><p id="-1412866926#no1k5f_82">Sending a UDP packet and closing the server:</p><div class="detached code-block" id="-1412866926#no1k5f_83"><pre><code class="language-bash">udpsockserver send fdf9:2548:ce39:efbb:9612:c4a0:477b:349a 12346 hello
udpsockserver close</code></pre></div><p id="-1412866926#no1k5f_84">Running UDP Client:</p><div class="detached code-block" id="-1412866926#no1k5f_85"><pre><code class="language-bash">udpsockclient open # or udpsockclient open &lt;port&gt;, e.g., udpsockclient open 12345
udpsockclient status</code></pre></div><p id="-1412866926#no1k5f_86">Sending a UDP packet and closing the client:</p><div class="detached code-block" id="-1412866926#no1k5f_87"><pre><code class="language-bash">udpsockclient send fdf9:2548:ce39:efbb:79b9:4ac4:f686:8fc9 12346 hello
udpsockclient close</code></pre></div></section><section class="detached"><h3 id="-1412866926#scan-and-discover" data-toc="scan-and-discover#ESP-OpenThread-CLI.md-scan-and-discover">Scan and Discover</h3><p id="-1412866926#no1k5f_88">The <span class="inline-code" id="-1412866926#no1k5f_91">scan</span> command performs IEEE 802.15.4 scan to find nearby devices. The <span class="inline-code" id="-1412866926#no1k5f_92">discover</span> command performs an MLE Discovery operation to find Thread networks nearby.</p><div class="image-container"><img class="center image" id="-1412866926#no1k5f_89" alt="Thread Discover" title="Thread Discover" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/orchestrator-devices/thc_1.png" width="500" height="179"></div><div class="image-container"><img class="center image" id="-1412866926#no1k5f_90" alt="Thread Scan" title="Thread Scan" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/orchestrator-devices/thc_2.png" width="500" height="130"></div></section></section><section class="detached"><h2 id="-1412866926#references" data-toc="references#ESP-OpenThread-CLI.md-references">References</h2><ul class="list" id="-1412866926#no1k5f_93" start="1"><li class="list-item" id="-1412866926#no1k5f_94"><p>OpenThread CLI Command Reference (<a href="https://openthread.io/reference/cli/commands">https://openthread.io/reference/cli/commands</a>)</p></li><li class="list-item" id="-1412866926#no1k5f_95"><p>Forming a Thread network on the Thread Border Router (<a href="https://openthread.io/codelabs/esp-openthread-hardware#3">https://openthread.io/codelabs/esp-openthread-hardware#3</a>)</p></li><li class="list-item" id="-1412866926#no1k5f_96"><p>How to set up a Command Line Interface on a thread device (<a href="https://mattercoder.com/codelabs/how-to-install-border-router-on-esp32/?index=..%2F..index#5">https://mattercoder.com/codelabs/how-to-install-border-router-on-esp32/?index=..%2F..index#5</a>)</p></li><li class="list-item" id="-1412866926#no1k5f_97"><p>OpenThread CLI - Commissioning (<a href="https://github.com/openthread/ot-commissioner/tree/main/src/app/cli">https://github.com/openthread/ot-commissioner/tree/main/src/app/cli</a>)</p></li><li class="list-item" id="-1412866926#no1k5f_98"><p>OpenThread CLI - Operational Datasets (<a href="https://github.com/openthread/openthread/blob/main/src/cli/README_DATASET.md">https://github.com/openthread/openthread/blob/main/src/cli/README_DATASET.md</a>)</p></li><li class="list-item" id="-1412866926#no1k5f_99"><p>ESP OT-CLI Example (<a href="https://github.com/espressif/esp-idf/tree/master/examples/openthread/ot_cli">https://github.com/espressif/esp-idf/tree/master/examples/openthread/ot_cli</a>)</p></li><li class="list-item" id="-1412866926#no1k5f_100"><p>Build and Run CLI device (<a href="https://docs.espressif.com/projects/esp-thread-br/en/latest/dev-guide/build_and_run.html#build-and-run-the-thread-cli-device">https://docs.espressif.com/projects/esp-thread-br/en/latest/dev-guide/build_and_run.html#build-and-run-the-thread-cli-device</a>)</p></li></ul></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-1509277031">CHIP-Tool</h1><section class="detached"><h2 id="-1509277031#overview" data-toc="overview#CHIP-Tool.md-overview">Overview</h2><p id="-1509277031#z5fur0c_11">CHIP Tool (chip-tool) is a Matter controller implementation that allows to commission a Matter device into a network and to communicate with it. It was used for testing accessory devices.</p><p id="-1509277031#z5fur0c_12">CHIP Tool was built and installed on a <span class="control" id="-1509277031#z5fur0c_14">Raspberry Pi 4 Model B</span> (4GB RAM and 32GB SD card) running <span class="emphasis" id="-1509277031#z5fur0c_15">Ubuntu Server for Raspberry Pi 24.04.1 LTS</span>. <span class="emphasis" id="-1509277031#z5fur0c_16">Raspberry Pi Imager v1.8.5</span> was used to flash the Ubuntu image onto the SD card.</p><p id="-1509277031#z5fur0c_13">Matter v1.4.0.0 (<a href="https://github.com/project-chip/connectedhomeip/releases/tag/v1.4.0.0">https://github.com/project-chip/connectedhomeip/releases/tag/v1.4.0.0</a>) SDK was used to build the CHIP-Tool application.</p></section><section class="detached"><h2 id="-1509277031#raspberry-pi-setup" data-toc="raspberry-pi-setup#CHIP-Tool.md-raspberry-pi-setup">Raspberry Pi Setup</h2><p id="-1509277031#z5fur0c_18">This section outlines the steps to set up a Raspberry Pi as a Matter controller using CHIP-Tool. The process is time-consuming.</p><section class="detached"><h3 id="-1509277031#step-1-ubuntu-installation" data-toc="step-1-ubuntu-installation#CHIP-Tool.md-step-1-ubuntu-installation">Step 1. Ubuntu installation</h3><ol class="list list-decimal" id="-1509277031#z5fur0c_24" type="1" start="1"><li class="list-item" id="-1509277031#z5fur0c_31"><p>Install the OS </p><ol class="list list-decimal" id="-1509277031#z5fur0c_32" type="1" start="1"><li class="list-item" id="-1509277031#z5fur0c_33"><p id="-1509277031#z5fur0c_38">Download the Ubuntu Server image from the Ubuntu website (<a href="https://ubuntu.com/download/raspberry-pi">https://ubuntu.com/download/raspberry-pi</a>).</p></li><li class="list-item" id="-1509277031#z5fur0c_34"><p id="-1509277031#z5fur0c_40">Download and install Raspberry Pi Imager on Ubuntu Desktop:</p><div class="detached code-block" id="-1509277031#z5fur0c_41"><pre><code class="language-bash">sudo apt update
sudo apt install rpi-imager</code></pre></div></li><li class="list-item" id="-1509277031#z5fur0c_35"><p id="-1509277031#z5fur0c_42">Insert the SD card into card reader and connect it to the computer.</p></li><li class="list-item" id="-1509277031#z5fur0c_36"><p id="-1509277031#z5fur0c_43">Select the Ubuntu image and the SD card in Raspberry Pi Imager.</p></li><li class="list-item" id="-1509277031#z5fur0c_37"><p id="-1509277031#z5fur0c_44">Edit Settings (Wi-Fi and SSH credentials and enable SSH) and flash the image onto the SD card.</p></li></ol></li></ol><div class="image-container"><img class="center image" id="-1509277031#z5fur0c_25" alt="Alt Text" title="Alt Text" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/orchestrator-devices/rpi_1.jpg" width="500" height="352"></div><div class="image-container"><img class="center image" id="-1509277031#z5fur0c_26" alt="Alt Text" title="Alt Text" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/orchestrator-devices/rpi_2.jpg" width="500" height="352"></div><div class="image-container"><img class="center image" id="-1509277031#z5fur0c_27" alt="Alt Text" title="Alt Text" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/orchestrator-devices/rpi_3.jpg" width="500" height="352"></div><div class="image-container"><img class="center image" id="-1509277031#z5fur0c_28" alt="Alt Text" title="Alt Text" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/orchestrator-devices/rpi_4.jpg" width="500" height="605"></div><div class="image-container"><img class="center image" id="-1509277031#z5fur0c_29" alt="Alt Text" title="Alt Text" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/orchestrator-devices/rpi_5.jpg" width="500" height="352"></div><div class="image-container"><img class="center image" id="-1509277031#z5fur0c_30" alt="Alt Text" title="Alt Text" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/orchestrator-devices/rpi_6.jpg" width="500" height="352"></div></section><section class="detached"><h3 id="-1509277031#step-2-connecting-to-raspberry-pi" data-toc="step-2-connecting-to-raspberry-pi#CHIP-Tool.md-step-2-connecting-to-raspberry-pi">Step 2. Connecting to Raspberry Pi</h3><p id="-1509277031#z5fur0c_45">Insert the SD card into the Raspberry Pi and power it on. It will automatically connect to Wi-Fi using the credentials provided during the installation process. It can take a few minutes for the Raspberry Pi to boot up. Once it is ready, connect to it using SSH with the credentials provided during the installation process.</p><div class="detached code-block" id="-1509277031#z5fur0c_46"><pre><code class="language-bash">ssh ggc_user@mattercontroller.local</code></pre></div><div class="image-container"><img class="center image" id="-1509277031#z5fur0c_47" alt="Connecting to Raspberry Pi" title="Connecting to Raspberry Pi" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/orchestrator-devices/rpi_7.png" width="500" height="569"></div></section><section class="detached"><h3 id="-1509277031#step-3-installing-pre-requisites" data-toc="step-3-installing-pre-requisites#CHIP-Tool.md-step-3-installing-pre-requisites">Step 3. Installing Pre-requisites</h3><ol class="list list-decimal" id="-1509277031#z5fur0c_48" type="1" start="1"><li class="list-item" id="-1509277031#z5fur0c_49"><p id="-1509277031#z5fur0c_55">Update the system and install Raspberry Pi-specific dependencies (<a href="https://github.com/project-chip/connectedhomeip/blob/master/docs/guides/BUILDING.md#installing-prerequisites-on-raspberry-pi-4">https://github.com/project-chip/connectedhomeip/blob/master/docs/guides/BUILDING.md#installing-prerequisites-on-raspberry-pi-4</a>):</p><div class="detached code-block" id="-1509277031#z5fur0c_56"><pre><code class="language-bash">sudo apt update
sudo apt upgrade
sudo apt-get install git gcc g++ pkg-config libssl-dev libdbus-1-dev \
     libglib2.0-dev libavahi-client-dev ninja-build python3-venv python3-dev \
     python3-pip unzip libgirepository1.0-dev libcairo2-dev libreadline-dev \
     default-jre
sudo apt-get install bluez avahi-utils
sudo reboot
ssh ggc_user@mattercontroller.local</code></pre></div></li><li class="list-item" id="-1509277031#z5fur0c_50"><p id="-1509277031#z5fur0c_58">Edit the <span class="inline-code" id="-1509277031#z5fur0c_62">bluetooth.service</span> unit:</p><div class="detached code-block" id="-1509277031#z5fur0c_59"><pre><code class="language-bash">sudo systemctl edit bluetooth.service</code></pre></div><p id="-1509277031#z5fur0c_60">Add the following content:</p><div class="detached code-block" id="-1509277031#z5fur0c_61"><pre><code class="language-bash">[Service]
ExecStart=
ExecStart=/usr/sbin/bluetoothd -E -P battery
Restart=always
RestartSec=3</code></pre></div></li><li class="list-item" id="-1509277031#z5fur0c_51"><p id="-1509277031#z5fur0c_63">Enable and Start the Bluetooth service:</p><div class="detached code-block" id="-1509277031#z5fur0c_64"><pre><code class="language-bash">sudo systemctl start bluetooth.service</code></pre></div></li><li class="list-item" id="-1509277031#z5fur0c_52"><p id="-1509277031#z5fur0c_65">Edit the dbus-fi.w1.wpa_supplicant1.service file:</p><div class="detached code-block" id="-1509277031#z5fur0c_66"><pre><code class="language-bash">sudo nano /etc/systemd/system/dbus-fi.w1.wpa_supplicant1.service</code></pre></div><p id="-1509277031#z5fur0c_67">Replace the line #11 with:</p><div class="detached code-block" id="-1509277031#z5fur0c_68"><pre><code class="language-bash">ExecStart=/usr/sbin/wpa_supplicant -u -s -O /run/wpa_supplicant</code></pre></div></li><li class="list-item" id="-1509277031#z5fur0c_53"><p id="-1509277031#z5fur0c_69">Edit the wpa_supplicant.conf file:</p><div class="detached code-block" id="-1509277031#z5fur0c_70"><pre><code class="language-bash">sudo nano /etc/wpa_supplicant/wpa_supplicant.conf</code></pre></div><p id="-1509277031#z5fur0c_71">Add the following content:</p><div class="detached code-block" id="-1509277031#z5fur0c_72"><pre><code class="language-bash">ctrl_interface=DIR=/run/wpa_supplicant
update_config=1</code></pre></div></li><li class="list-item" id="-1509277031#z5fur0c_54"><p id="-1509277031#z5fur0c_73">Reboot the Raspberry Pi:</p><div class="detached code-block" id="-1509277031#z5fur0c_74"><pre><code class="language-bash">sudo reboot
ssh ggc_user@mattercontroller.local</code></pre></div></li></ol></section><section class="detached"><h3 id="-1509277031#step-4-building-chip-tool" data-toc="step-4-building-chip-tool#CHIP-Tool.md-step-4-building-chip-tool">Step 4. Building CHIP Tool</h3><p id="-1509277031#z5fur0c_75">The application will require installation of Matter SDK on Raspberry Pi:</p><ol class="list list-decimal" id="-1509277031#z5fur0c_76" type="1" start="1"><li class="list-item" id="-1509277031#z5fur0c_77"><p id="-1509277031#z5fur0c_81">Clone the Matter SDK repository:</p><div class="detached code-block" id="-1509277031#z5fur0c_82"><pre><code class="language-bash">mkdir matter
cd ~/matter
git clone https://github.com/project-chip/connectedhomeip.git
cd connectedhomeip/
git checkout tags/v1.4.0.0</code></pre></div></li><li class="list-item" id="-1509277031#z5fur0c_78"><p id="-1509277031#z5fur0c_83">Prepare Matter SDK:</p><div class="detached code-block" id="-1509277031#z5fur0c_84"><pre><code class="language-bash">./scripts/checkout_submodules.py --shallow --platform  linux
source ~/matter/connectedhomeip/scripts/activate.sh</code></pre></div><div class="image-container"><img class="center image" id="-1509277031#z5fur0c_85" alt="Matter SDK Installation" title="Matter SDK Installation" src="/home/albert/WritersideProjects/COMP8900/old-macdonald/Writerside/images/methodology/orchestrator-devices/rpi_8.png" width="500" height="686"></div></li><li class="list-item" id="-1509277031#z5fur0c_79"><p id="-1509277031#z5fur0c_86">Build CHIP Tool using build_examples.py:</p><p id="-1509277031#z5fur0c_87">The <span class="inline-code" id="-1509277031#z5fur0c_93">targets</span> command retrieves supported build targets listed below:</p><div class="detached code-block" id="-1509277031#z5fur0c_88"><pre><code class="language-bash">./scripts/build/build_examples.py targets</code></pre></div><ul class="list" id="-1509277031#z5fur0c_89" start="1"><li class="list-item" id="-1509277031#z5fur0c_94"><p><span class="control" id="-1509277031#z5fur0c_104">Ameba:</span></p><ul class="list" id="-1509277031#z5fur0c_105" start="1"><li class="list-item" id="-1509277031#z5fur0c_106"><p><span class="inline-code" id="-1509277031#z5fur0c_107">amebad-{all-clusters, all-clusters-minimal, light, light-switch, pigweed}</span></p></li></ul></li><li class="list-item" id="-1509277031#z5fur0c_95"><p><span class="control" id="-1509277031#z5fur0c_108">ASR:</span> <span class="inline-code" id="-1509277031#z5fur0c_109">asr-{asr582x, asr595x, asr550x}-{all-clusters, all-clusters-minimal, lighting, light-switch, lock, bridge, temperature-measurement, thermostat, ota-requestor, dishwasher, refrigerator}</span></p><ul class="list" id="-1509277031#z5fur0c_110" start="1"><li class="list-item" id="-1509277031#z5fur0c_111"><p>Optional flags: <span class="inline-code" id="-1509277031#z5fur0c_112">[-ota] [-shell] [-no_logging] [-factory] [-rotating_id] [-rio]</span></p></li></ul></li><li class="list-item" id="-1509277031#z5fur0c_96"><p><span class="control" id="-1509277031#z5fur0c_113">Android:</span> <span class="inline-code" id="-1509277031#z5fur0c_114">android-{arm, arm64, x86, x64, androidstudio-arm, androidstudio-arm64, androidstudio-x86, androidstudio-x64}-{chip-tool, chip-test, tv-server, tv-casting-app, java-matter-controller, kotlin-matter-controller, virtual-device-app}</span></p><ul class="list" id="-1509277031#z5fur0c_115" start="1"><li class="list-item" id="-1509277031#z5fur0c_116"><p>Optional flags: <span class="inline-code" id="-1509277031#z5fur0c_117">[-no-debug]</span></p></li></ul></li><li class="list-item" id="-1509277031#z5fur0c_97"><p><span class="control" id="-1509277031#z5fur0c_118">Bouffalolab:</span> <span class="inline-code" id="-1509277031#z5fur0c_119">bouffalolab-{bl602dk, bl704ldk, bl706dk, bl602-night-light, bl706-night-light, bl602-iot-matter-v1, xt-zb6-devkit}-light</span></p><ul class="list" id="-1509277031#z5fur0c_120" start="1"><li class="list-item" id="-1509277031#z5fur0c_121"><p>Optional flags: <span class="inline-code" id="-1509277031#z5fur0c_122">[-ethernet] [-wifi] [-thread] [-easyflash] [-littlefs] [-shell] [-mfd] [-rotating_device_id] [-rpc] [-cdc] [-mot] [-resetcnt] [-memmonitor] [-115200] [-fp]</span></p></li></ul></li><li class="list-item" id="-1509277031#z5fur0c_98"><p><span class="control" id="-1509277031#z5fur0c_123">Texas Instruments (TI):</span></p><ul class="list" id="-1509277031#z5fur0c_124" start="1"><li class="list-item" id="-1509277031#z5fur0c_125"><p><span class="inline-code" id="-1509277031#z5fur0c_128">cc32xx-{lock, air-purifier}</span></p></li><li class="list-item" id="-1509277031#z5fur0c_126"><p><span class="inline-code" id="-1509277031#z5fur0c_129">ti-cc13x4_26x4-{lighting, lock, pump, pump-controller}</span></p></li><li class="list-item" id="-1509277031#z5fur0c_127"><p>Optional flags: <span class="inline-code" id="-1509277031#z5fur0c_130">[-mtd] [-ftd]</span></p></li></ul></li><li class="list-item" id="-1509277031#z5fur0c_99"><p><span class="control" id="-1509277031#z5fur0c_131">Cypress (Infineon):</span> <span class="inline-code" id="-1509277031#z5fur0c_132">cyw30739-{cyw30739b2_p5_evk_01, cyw30739b2_p5_evk_02, cyw30739b2_p5_evk_03, cyw930739m2evb_01, cyw930739m2evb_02}-{light, light-switch, lock, thermostat}</span></p></li><li class="list-item" id="-1509277031#z5fur0c_100"><p><span class="control" id="-1509277031#z5fur0c_133">Silicon Labs (EFR32):</span> <span class="inline-code" id="-1509277031#z5fur0c_134">efr32-{brd2704b, brd4316a, brd4317a, brd4318a, brd4319a, brd4186a, brd4187a, brd2601b, brd4187c, brd4186c, brd2703a, brd4338a, brd2605a}-{window-covering, switch, unit-test, light, lock, thermostat, pump, air-quality-sensor-app}</span></p><ul class="list" id="-1509277031#z5fur0c_135" start="1"><li class="list-item" id="-1509277031#z5fur0c_136"><p>Optional flags: <span class="inline-code" id="-1509277031#z5fur0c_137">[-rpc] [-with-ota-requestor] [-icd] [-low-power] [-shell] [-no-logging] [-openthread-mtd] [-heap-monitoring] [-no-openthread-cli] [-show-qr-code] [-wifi] [-rs9116] [-wf200] [-siwx917] [-ipv4] [-additional-data-advertising] [-use-ot-lib] [-use-ot-coap-lib] [-no-version] [-skip-rps-generation]</span></p></li></ul></li><li class="list-item" id="-1509277031#z5fur0c_101"><p><span class="control" id="-1509277031#z5fur0c_138">Espressif (ESP32):</span> <span class="inline-code" id="-1509277031#z5fur0c_139">esp32-{m5stack, c3devkit, devkitc, qemu}-{all-clusters, all-clusters-minimal, energy-management, ota-provider, ota-requestor, shell, light, lock, bridge, temperature-measurement, tests}</span></p><ul class="list" id="-1509277031#z5fur0c_140" start="1"><li class="list-item" id="-1509277031#z5fur0c_141"><p>Optional flags: <span class="inline-code" id="-1509277031#z5fur0c_142">[-rpc] [-ipv6only] [-tracing] [-data-model-disabled] [-data-model-enabled]</span></p></li></ul></li><li class="list-item" id="-1509277031#z5fur0c_102"><p><span class="control" id="-1509277031#z5fur0c_143">General:</span></p><ul class="list" id="-1509277031#z5fur0c_144" start="1"><li class="list-item" id="-1509277031#z5fur0c_145"><p><span class="inline-code" id="-1509277031#z5fur0c_146">genio-lighting-app</span></p></li></ul></li><li class="list-item" id="-1509277031#z5fur0c_103"><p><span class="control" id="-1509277031#z5fur0c_147">Linux:</span></p><ul class="list" id="-1509277031#z5fur0c_148" start="1"><li class="list-item" id="-1509277031#z5fur0c_149"><p><span class="inline-code" id="-1509277031#z5fur0c_154">linux-fake-tests</span></p></li><li class="list-item" id="-1509277031#z5fur0c_150"><p>Optional flags: <span class="inline-code" id="-1509277031#z5fur0c_155">[-mbedtls] [-boringssl] [-asan] [-tsan] [-ubsan] [-libfuzzer] [-ossfuzz] [-pw-fuzztest] [-coverage] [-dmalloc] [-clang]</span> <span class="inline-code" id="-1509277031#z5fur0c_156">linux-arm64-{rpc-console, all-clusters, all-clusters-minimal, chip-tool, thermostat, java-matter-controller, kotlin-matter-controller, minmdns, light, light-data-model-no-unique-id, lock, shell, ota-provider, ota-requestor, simulated-app1, simulated-app2, python-bindings, tv-app, tv-casting-app, bridge, fabric-admin, fabric-bridge, tests, chip-cert, address-resolve-tool, contact-sensor, dishwasher, microwave-oven, refrigerator, rvc, air-purifier, lit-icd, air-quality-sensor, network-manager, energy-management}</span></p></li><li class="list-item" id="-1509277031#z5fur0c_151"><p>Optional flags: <span class="inline-code" id="-1509277031#z5fur0c_157">[-nodeps] [-nlfaultinject] [-platform-mdns] [-minmdns-verbose] [-libnl] [-same-event-loop] [-no-interactive] [-ipv6only] [-no-ble] [-no-wifi] [-no-thread] [-no-shell] [-mbedtls] [-boringssl] [-asan] [-tsan] [-ubsan] [-libfuzzer] [-ossfuzz] [-pw-fuzztest] [-coverage] [-dmalloc] [-clang] [-test] [-rpc] [-with-ui] [-evse-test-event] [-enable-dnssd-tests] [-disable-dnssd-tests] [-chip-casting-simplified] [-data-model-check] [-data-model-disabled] [-data-model-enabled] [-check-failure-die]</span></p></li><li class="list-item" id="-1509277031#z5fur0c_152"><p><span class="inline-code" id="-1509277031#z5fur0c_158">linux-arm64-efr32-test-runner</span></p></li><li class="list-item" id="-1509277031#z5fur0c_153"><p>Optional flags: <span class="inline-code" id="-1509277031#z5fur0c_159">[-clang]</span></p></li></ul></li></ul><p id="-1509277031#z5fur0c_90">The <span class="inline-code" id="-1509277031#z5fur0c_160">linux-arm64-chip-tool</span> and <span class="inline-code" id="-1509277031#z5fur0c_161">linux-arm64-all-clusters</span> targets were selected from the Linux section, with the <span class="inline-code" id="-1509277031#z5fur0c_162">-ipv6only</span> and <span class="inline-code" id="-1509277031#z5fur0c_163">-platform-mdns</span> flags:</p><div class="detached code-block" id="-1509277031#z5fur0c_91"><pre><code class="language-bash">./scripts/build/build_examples.py --target linux-arm64-chip-tool-ipv6only-platform-mdns gen
cd ~/matter/connectedhomeip/out/linux-arm64-chip-tool-ipv6only-platform-mdns
ninja -j 1 &amp; disown</code></pre></div><p id="-1509277031#z5fur0c_92">Building the CHIP-Tool is a time-consuming process. To prevent SSH session timeouts, ninja was executed in the background. The job count was limited to 1 (<span class="inline-code" id="-1509277031#z5fur0c_164">-j 1</span>) to reduce memory usage. <span class="inline-code" id="-1509277031#z5fur0c_165">tail -f nohup.out</span> can be used to monitor the output.</p></li><li class="list-item" id="-1509277031#z5fur0c_80"><p id="-1509277031#z5fur0c_166">Move the built CHIP Tool:</p><div class="detached code-block" id="-1509277031#z5fur0c_167"><pre><code class="language-bash">mv ~/matter/connectedhomeip/out/linux-arm64-chip-tool-ipv6only-platform-mdns/chip-tool ~/matter/chip-tool
rm -rf ~/matter/connectedhomeip/out/linux-arm64-chip-tool-ipv6only-platform-mdns</code></pre></div></li></ol></section><section class="detached"><h3 id="-1509277031#step-5-testing" data-toc="step-5-testing#CHIP-Tool.md-step-5-testing">Step 5. Testing</h3><p id="-1509277031#z5fur0c_168">Running CHIP Tool:</p><div class="detached code-block" id="-1509277031#z5fur0c_169"><pre><code class="language-bash">cd ~/matter
./chip-tool</code></pre></div></section></section><section class="detached"><h2 id="-1509277031#commissioning" data-toc="commissioning#CHIP-Tool.md-commissioning">Commissioning</h2><p id="-1509277031#z5fur0c_170">This section describes the Matter commissioning (<a href="#279346443">Matter Commissioning</a>) using CHIP Tool.</p><p id="-1509277031#z5fur0c_171">The following command should be run on the Commissionee to print the static configuration that includes the <span class="control" id="-1509277031#z5fur0c_178">PIN code</span> and <span class="control" id="-1509277031#z5fur0c_179">Discriminator</span> (<span class="emphasis" id="-1509277031#z5fur0c_180">0xf00</span> is <span class="emphasis" id="-1509277031#z5fur0c_181">3840</span> in decimal):</p><div class="detached code-block" id="-1509277031#z5fur0c_172"><pre><code class="language-bash">matter config</code></pre></div><section class="detached"><h3 id="-1509277031#commissioning-to-wi-fi-over-ble" data-toc="commissioning-to-wi-fi-over-ble#CHIP-Tool.md-commissioning-to-wi-fi-over-ble">Commissioning to Wi-Fi over BLE</h3><p id="-1509277031#z5fur0c_182">A Commissionee joins an existing IP network over Bluetooth LE before being commissioned into a Matter network.</p><p id="-1509277031#z5fur0c_183">The following CHIP-Tool command starts commissioning onto a <span class="control" id="-1509277031#z5fur0c_189">Wi-Fi</span> network over BLE:</p><div class="detached code-block" id="-1509277031#z5fur0c_184"><pre><code class="language-bash">./chip-tool pairing ble-wifi 0x1122 SSID WIFIPASS 20202021 3840
./chip-tool pairing ble-wifi &lt;NODE_ID_TO_ASSIGN&gt; &lt;SSID&gt; &lt;PASSWORD&gt; &lt;PIN&gt; &lt;DISCRIMINATOR&gt;</code></pre></div><p id="-1509277031#z5fur0c_185">The parameters are defined as follows:</p><ul class="list" id="-1509277031#z5fur0c_186" start="1"><li class="list-item" id="-1509277031#z5fur0c_190"><p><span class="inline-code" id="-1509277031#z5fur0c_195">&lt;NODE_ID_TO_ASSIGN&gt;</span> is the node ID assigned to the device being commissioned, which can be a decimal or hexadecimal number prefixed with &lsquo;0x&rsquo;.</p></li><li class="list-item" id="-1509277031#z5fur0c_191"><p><span class="inline-code" id="-1509277031#z5fur0c_196">&lt;SSID&gt;</span> is the Wi-Fi SSID, provided as a plain string or in hexadecimal format as &lsquo;hex:XXXXXXXX&rsquo;, where each byte of the SSID is represented as two-digit hexadecimal numbers.</p></li><li class="list-item" id="-1509277031#z5fur0c_192"><p><span class="inline-code" id="-1509277031#z5fur0c_197">&lt;PASSWORD&gt;</span> is the Wi-Fi password, given as a plain string or hex data.</p></li><li class="list-item" id="-1509277031#z5fur0c_193"><p><span class="inline-code" id="-1509277031#z5fur0c_198">&lt;PIN&gt;</span> is the PIN code for authentication.</p></li><li class="list-item" id="-1509277031#z5fur0c_194"><p><span class="inline-code" id="-1509277031#z5fur0c_199">&lt;DISCRIMINATOR&gt;</span> is the discriminator value.</p></li></ul><p id="-1509277031#z5fur0c_187">CHIP-Tool starts the commissioning process, which includes the following steps:</p><ol class="list list-decimal" id="-1509277031#z5fur0c_188" type="1" start="1"><li class="list-item" id="-1509277031#z5fur0c_200"><p id="-1509277031#z5fur0c_209"><span class="control" id="-1509277031#z5fur0c_211">Initialization</span></p><ul class="list" id="-1509277031#z5fur0c_210" start="1"><li class="list-item" id="-1509277031#z5fur0c_212"><p>Initializes storage and loads key-value store (KVS) configurations.</p></li><li class="list-item" id="-1509277031#z5fur0c_213"><p>Detects network interfaces and identifies the WiFi interface.</p></li><li class="list-item" id="-1509277031#z5fur0c_214"><p>Sets up UDP transport manager and BLE transport layers.</p></li></ul></li><li class="list-item" id="-1509277031#z5fur0c_201"><p id="-1509277031#z5fur0c_215"><span class="control" id="-1509277031#z5fur0c_217">Fabric and Node Setup</span></p><ul class="list" id="-1509277031#z5fur0c_216" start="1"><li class="list-item" id="-1509277031#z5fur0c_218"><p>Loads the fabric table, which contains information about existing secure networks.</p></li><li class="list-item" id="-1509277031#z5fur0c_219"><p>Creates a new fabric with a unique Fabric ID and Node ID.</p></li></ul></li><li class="list-item" id="-1509277031#z5fur0c_202"><p id="-1509277031#z5fur0c_220"><span class="control" id="-1509277031#z5fur0c_222">BLE Scanning and Connection</span></p><ul class="list" id="-1509277031#z5fur0c_221" start="1"><li class="list-item" id="-1509277031#z5fur0c_223"><p>Scans for nearby BLE devices.</p></li><li class="list-item" id="-1509277031#z5fur0c_224"><p>Identifies the correct device using a discriminator match.</p></li><li class="list-item" id="-1509277031#z5fur0c_225"><p>Establishes a BLE connection with the device.</p></li></ul></li><li class="list-item" id="-1509277031#z5fur0c_203"><p id="-1509277031#z5fur0c_226"><span class="control" id="-1509277031#z5fur0c_228">Secure Session Establishment</span></p><ul class="list" id="-1509277031#z5fur0c_227" start="1"><li class="list-item" id="-1509277031#z5fur0c_229"><p>Performs a PASE (Password Authenticated Session Establishment) handshake over BLE.</p></li><li class="list-item" id="-1509277031#z5fur0c_230"><p>Exchanges secure messages to establish an encrypted session.</p></li><li class="list-item" id="-1509277031#z5fur0c_231"><p>Marks the session as &quot;Active&quot; upon success.</p></li></ul></li><li class="list-item" id="-1509277031#z5fur0c_204"><p id="-1509277031#z5fur0c_232"><span class="control" id="-1509277031#z5fur0c_234">Commissioning Process</span></p><ul class="list" id="-1509277031#z5fur0c_233" start="1"><li class="list-item" id="-1509277031#z5fur0c_235"><p>Reads the device&rsquo;s attributes and capabilities.</p></li><li class="list-item" id="-1509277031#z5fur0c_236"><p>Arms a fail-safe mechanism to prevent accidental changes.</p></li><li class="list-item" id="-1509277031#z5fur0c_237"><p>Configures the device based on regional regulatory requirements.</p></li></ul></li><li class="list-item" id="-1509277031#z5fur0c_205"><p id="-1509277031#z5fur0c_238"><span class="control" id="-1509277031#z5fur0c_240">Certificate Exchange</span></p><ul class="list" id="-1509277031#z5fur0c_239" start="1"><li class="list-item" id="-1509277031#z5fur0c_241"><p>The device provides PAI (Product Attestation Intermediate) and DAC (Device Attestation Certificate).</p></li><li class="list-item" id="-1509277031#z5fur0c_242"><p>The system verifies the certificates and device authenticity.</p></li></ul></li><li class="list-item" id="-1509277031#z5fur0c_206"><p id="-1509277031#z5fur0c_243"><span class="control" id="-1509277031#z5fur0c_245">Attestation and Verification</span></p><ul class="list" id="-1509277031#z5fur0c_244" start="1"><li class="list-item" id="-1509277031#z5fur0c_246"><p>Validates the device&rsquo;s attestation data to ensure a trusted identity.</p></li><li class="list-item" id="-1509277031#z5fur0c_247"><p>Performs a revocation check to confirm the device&rsquo;s legitimacy.</p></li></ul></li><li class="list-item" id="-1509277031#z5fur0c_207"><p id="-1509277031#z5fur0c_248"><span class="control" id="-1509277031#z5fur0c_250">Operational Certificate Signing</span></p><ul class="list" id="-1509277031#z5fur0c_249" start="1"><li class="list-item" id="-1509277031#z5fur0c_251"><p>The device generates a CSR (Certificate Signing Request).</p></li><li class="list-item" id="-1509277031#z5fur0c_252"><p>The system issues a NOC (Node Operational Certificate) to authenticate the device in the network.</p></li></ul></li><li class="list-item" id="-1509277031#z5fur0c_208"><p id="-1509277031#z5fur0c_253"><span class="control" id="-1509277031#z5fur0c_255">Finalizing the Pairing</span></p><ul class="list" id="-1509277031#z5fur0c_254" start="1"><li class="list-item" id="-1509277031#z5fur0c_256"><p>Sends the root certificate to the device.</p></li><li class="list-item" id="-1509277031#z5fur0c_257"><p>Marks the pairing process as &quot;Success,&quot; making the device a trusted member of the Matter network.</p></li></ul></li></ol></section><section class="detached"><h3 id="-1509277031#commissioning-to-thread-over-ble" data-toc="commissioning-to-thread-over-ble#CHIP-Tool.md-commissioning-to-thread-over-ble">Commissioning to Thread over BLE</h3><p id="-1509277031#z5fur0c_258">The following CHIP-Tool command initiates commissioning onto a <span class="control" id="-1509277031#z5fur0c_262">Thread</span> network over BLE:</p><div class="detached code-block" id="-1509277031#z5fur0c_259"><pre><code class="language-bash">./chip-tool pairing ble-thread 0x1122 20202021 3840
./chip-tool pairing ble-thread &lt;NODE_ID_TO_ASSIGN&gt; hex:&lt;OPERATIONAL_DATASET&gt; &lt;PIN&gt; &lt;DISCRIMINATOR&gt;</code></pre></div><p id="-1509277031#z5fur0c_260">The parameters are defined as follows:</p><ul class="list" id="-1509277031#z5fur0c_261" start="1"><li class="list-item" id="-1509277031#z5fur0c_263"><p><span class="inline-code" id="-1509277031#z5fur0c_267">&lt;NODE_ID_TO_ASSIGN&gt;</span> is the node ID assigned to the device being commissioned, which can be a decimal number or a hexadecimal number prefixed with &lsquo;0x&rsquo;.</p></li><li class="list-item" id="-1509277031#z5fur0c_264"><p><span class="inline-code" id="-1509277031#z5fur0c_268">&lt;OPERATIONAL_DATASET&gt;</span> is the Thread Operational Dataset (<a href="#-1790576086">Thread</a>), which contains the network credentials needed to join a Thread network. It is provided in hexadecimal format (<span class="inline-code" id="-1509277031#z5fur0c_270">hex:XXXXXXXX</span>), where each byte of the dataset is represented as two-digit hexadecimal numbers.</p></li><li class="list-item" id="-1509277031#z5fur0c_265"><p><span class="inline-code" id="-1509277031#z5fur0c_271">&lt;PIN&gt;</span> is the PIN code for authentication.</p></li><li class="list-item" id="-1509277031#z5fur0c_266"><p><span class="inline-code" id="-1509277031#z5fur0c_272">&lt;DISCRIMINATOR&gt;</span> is the discriminator value.</p></li></ul></section><section class="detached"><h3 id="-1509277031#commissioning-over-existing-ip-network" data-toc="commissioning-over-existing-ip-network#CHIP-Tool.md-commissioning-over-existing-ip-network">Commissioning over Existing IP Network</h3><p id="-1509277031#z5fur0c_273">A Commissionee already connected to a Wi-Fi, Ethernet, or Thread network can be commissioned without BLE discovery, using <span class="control" id="-1509277031#z5fur0c_282">mDNS service discovery</span> instead.</p><p id="-1509277031#z5fur0c_274">The following CHIP-Tool command commissions a device that is already connected to a <span class="control" id="-1509277031#z5fur0c_283">Wi-Fi</span> or <span class="control" id="-1509277031#z5fur0c_284">Ethernet</span> network:</p><div class="detached code-block" id="-1509277031#z5fur0c_275"><pre><code class="language-bash">./chip-tool pairing onnetwork 0x1122 20202021
./chip-tool pairing onnetwork &lt;NODE_ID_TO_ASSIGN&gt; &lt;PIN&gt;</code></pre></div><p id="-1509277031#z5fur0c_276">The parameters are defined as follows:</p><ul class="list" id="-1509277031#z5fur0c_277" start="1"><li class="list-item" id="-1509277031#z5fur0c_285"><p><span class="inline-code" id="-1509277031#z5fur0c_287">&lt;NODE_ID_TO_ASSIGN&gt;</span> is the <span class="control" id="-1509277031#z5fur0c_288">node ID</span> assigned to the device being commissioned.</p></li><li class="list-item" id="-1509277031#z5fur0c_286"><p><span class="inline-code" id="-1509277031#z5fur0c_289">&lt;PIN&gt;</span> is the PIN code for authentication.</p></li></ul><p id="-1509277031#z5fur0c_278">The following CHIP-Tool command commissions a device that is already connected to a <span class="control" id="-1509277031#z5fur0c_290">Thread</span> network:</p><div class="detached code-block" id="-1509277031#z5fur0c_279"><pre><code class="language-bash">./chip-tool pairing onnetwork-thread 0x1122 hex:&lt;OPERATIONAL_DATASET&gt; 20202021
./chip-tool pairing onnetwork-thread &lt;NODE_ID_TO_ASSIGN&gt; hex:&lt;OPERATIONAL_DATASET&gt; &lt;PIN&gt;</code></pre></div><p id="-1509277031#z5fur0c_280">The parameters are defined as follows:</p><ul class="list" id="-1509277031#z5fur0c_281" start="1"><li class="list-item" id="-1509277031#z5fur0c_291"><p><span class="inline-code" id="-1509277031#z5fur0c_294">&lt;NODE_ID_TO_ASSIGN&gt;</span> is the <span class="control" id="-1509277031#z5fur0c_295">node ID</span> assigned to the device being commissioned.</p></li><li class="list-item" id="-1509277031#z5fur0c_292"><p><span class="inline-code" id="-1509277031#z5fur0c_296">&lt;OPERATIONAL_DATASET&gt;</span> is the <span class="control" id="-1509277031#z5fur0c_297">Thread Operational Dataset</span>, which contains the network credentials for joining a Thread network.</p></li><li class="list-item" id="-1509277031#z5fur0c_293"><p><span class="inline-code" id="-1509277031#z5fur0c_298">&lt;PIN&gt;</span> is the <span class="control" id="-1509277031#z5fur0c_299">PIN code</span> for authentication.</p></li></ul></section><section class="detached"><h3 id="-1509277031#removing-a-device-from-fabric" data-toc="removing-a-device-from-fabric#CHIP-Tool.md-removing-a-device-from-fabric">Removing a Device from Fabric</h3><p id="-1509277031#z5fur0c_300">The following CHIP-Tool command removes a device from the Matter Fabric:</p><div class="detached code-block" id="-1509277031#z5fur0c_301"><pre><code class="language-bash">./chip-tool pairing unpair 0x1122
./chip-tool pairing unpair &lt;NODE_ID_TO_ASSIGN&gt;</code></pre></div><p id="-1509277031#z5fur0c_302">The parameters are defined as follows:</p><ul class="list" id="-1509277031#z5fur0c_303" start="1"><li class="list-item" id="-1509277031#z5fur0c_304"><p><span class="inline-code" id="-1509277031#z5fur0c_305">&lt;NODE_ID_TO_ASSIGN&gt;</span> is the <span class="control" id="-1509277031#z5fur0c_306">node ID</span> assigned to the device being removed.</p></li></ul></section></section><section class="detached"><h2 id="-1509277031#reading-device-attributes" data-toc="reading-device-attributes#CHIP-Tool.md-reading-device-attributes">Reading Device Attributes</h2><p id="-1509277031#z5fur0c_307">The following command is used to read the current state of the &quot;on/off&quot; attribute from the target device:</p><div class="detached code-block" id="-1509277031#z5fur0c_308"><pre><code class="language-bash">./chip-tool onoff read on-off 0x1122 1</code></pre></div><p id="-1509277031#z5fur0c_309">In this command:</p><ul class="list" id="-1509277031#z5fur0c_310" start="1"><li class="list-item" id="-1509277031#z5fur0c_313"><p><span class="inline-code" id="-1509277031#z5fur0c_318">onoff</span> is the cluster for controlling the power state.</p></li><li class="list-item" id="-1509277031#z5fur0c_314"><p><span class="inline-code" id="-1509277031#z5fur0c_319">read</span> is a request to retrieve the current state.</p></li><li class="list-item" id="-1509277031#z5fur0c_315"><p><span class="inline-code" id="-1509277031#z5fur0c_320">on-off</span> is the specific attribute being queried.</p></li><li class="list-item" id="-1509277031#z5fur0c_316"><p><span class="inline-code" id="-1509277031#z5fur0c_321">0x1122</span> is the hexadecimal node ID of the device.</p></li><li class="list-item" id="-1509277031#z5fur0c_317"><p><span class="inline-code" id="-1509277031#z5fur0c_322">1</span> is the endpoint number on the target device.</p></li></ul><p id="-1509277031#z5fur0c_311">Similarly, the command below reads the measurement value from the temperature sensor:</p><div class="detached code-block" id="-1509277031#z5fur0c_312"><pre><code class="language-bash">./chip-tool temperaturemeasurement read measured-value 0x1122 1</code></pre></div></section><section class="detached"><h2 id="-1509277031#sending-commands-to-device" data-toc="sending-commands-to-device#CHIP-Tool.md-sending-commands-to-device">Sending Commands to Device</h2><p id="-1509277031#z5fur0c_323">The following command is used to turn on and toggle the device:</p><div class="detached code-block" id="-1509277031#z5fur0c_324"><pre><code class="language-bash">./chip-tool onoff on 0x1122 1
./chip-tool onoff toggle 0x1122 1</code></pre></div></section><section class="detached"><h2 id="-1509277031#subscribing-to-attributes-and-events" data-toc="subscribing-to-attributes-and-events#CHIP-Tool.md-subscribing-to-attributes-and-events">Subscribing to Attributes and Events</h2><p id="-1509277031#z5fur0c_325">This section describes how to subscribe (<a href="#1208879947#subscribing-to-events-or-attributes">&quot;Subscribing to events or attributes&quot; in &quot;Matter Controllers&quot;</a>) to attributes and events in a Matter device using CHIP-Tool.</p><section class="detached"><h3 id="-1509277031#subscribing-to-attributes" data-toc="subscribing-to-attributes#CHIP-Tool.md-subscribing-to-attributes">Subscribing to Attributes</h3><p id="-1509277031#z5fur0c_329">Display all the attributes available for subscription in a given cluster:</p><div class="detached code-block" id="-1509277031#z5fur0c_330"><pre><code class="language-bash">./chip-tool &lt;cluster-name&gt; subscribe</code></pre></div><p id="-1509277031#z5fur0c_331">Subscribe to an attribute:</p><div class="detached code-block" id="-1509277031#z5fur0c_332"><pre><code class="language-bash">./chip-tool &lt;cluster-name&gt; subscribe &lt;argument&gt; &lt;min-interval&gt; &lt;max-interval&gt; &lt;node_id&gt; &lt;endpoint_id&gt;</code></pre></div><p id="-1509277031#z5fur0c_333">In this command:</p><ul class="list" id="-1509277031#z5fur0c_334" start="1"><li class="list-item" id="-1509277031#z5fur0c_337"><p><span class="control" id="-1509277031#z5fur0c_343">cluster-name</span> is the name of the cluster.</p></li><li class="list-item" id="-1509277031#z5fur0c_338"><p><span class="control" id="-1509277031#z5fur0c_344">argument</span> is the name of the chosen argument.</p></li><li class="list-item" id="-1509277031#z5fur0c_339"><p><span class="control" id="-1509277031#z5fur0c_345">min-interval</span> specifies the minimum number of seconds that must elapse since the last report for the server to send a new report.</p></li><li class="list-item" id="-1509277031#z5fur0c_340"><p><span class="control" id="-1509277031#z5fur0c_346">max-interval</span> specifies the number of seconds that must elapse since the last report for the server to send a new report.</p></li><li class="list-item" id="-1509277031#z5fur0c_341"><p><span class="control" id="-1509277031#z5fur0c_347">node-id</span> is the user-defined ID of the commissioned node.</p></li><li class="list-item" id="-1509277031#z5fur0c_342"><p><span class="control" id="-1509277031#z5fur0c_348">endpoint_id</span> is the ID of the endpoint where the chosen cluster is implemented.</p></li></ul><p id="-1509277031#z5fur0c_335">For example:</p><div class="detached code-block" id="-1509277031#z5fur0c_336"><pre><code class="language-bash">./chip-tool doorlock subscribe lock-state 5 10 1 1
./chip-tool temperaturemeasurement subscribe measured-value 3 10 1 1
./chip-tool relativehumiditymeasurement subscribe measured-value 3 10 1 2
./chip-tool occupancysensing subscribe occupancy 3 10 1 3</code></pre></div></section><section class="detached"><h3 id="-1509277031#subscribing-to-events" data-toc="subscribing-to-events#CHIP-Tool.md-subscribing-to-events">Subscribing to Events</h3><p id="-1509277031#z5fur0c_349">Display all the events available for subscription in a given cluster:</p><div class="detached code-block" id="-1509277031#z5fur0c_350"><pre><code class="language-bash">./chip-tool &lt;cluster-name&gt; subscribe-event</code></pre></div><p id="-1509277031#z5fur0c_351">Subscribe to an event:</p><div class="detached code-block" id="-1509277031#z5fur0c_352"><pre><code class="language-bash">./chip-tool &lt;cluster-name&gt; subscribe-event &lt;event-name&gt; &lt;min-interval&gt; &lt;max-interval&gt; &lt;node_id&gt; &lt;endpoint_id&gt;</code></pre></div><p id="-1509277031#z5fur0c_353">In this command:</p><ul class="list" id="-1509277031#z5fur0c_354" start="1"><li class="list-item" id="-1509277031#z5fur0c_357"><p><span class="control" id="-1509277031#z5fur0c_363">cluster-name</span> is the name of the cluster.</p></li><li class="list-item" id="-1509277031#z5fur0c_358"><p><span class="control" id="-1509277031#z5fur0c_364">event-name</span> is the name of the chosen event.</p></li><li class="list-item" id="-1509277031#z5fur0c_359"><p><span class="control" id="-1509277031#z5fur0c_365">min-interval</span> specifies the minimum number of seconds that must elapse since the last report for the server to send a new report.</p></li><li class="list-item" id="-1509277031#z5fur0c_360"><p><span class="control" id="-1509277031#z5fur0c_366">max-interval</span> specifies the number of seconds that must elapse since the last report for the server to send a new report.</p></li><li class="list-item" id="-1509277031#z5fur0c_361"><p><span class="control" id="-1509277031#z5fur0c_367">node_id</span> is the user-defined ID of the commissioned node.</p></li><li class="list-item" id="-1509277031#z5fur0c_362"><p><span class="control" id="-1509277031#z5fur0c_368">endpoint_id</span> is the ID of the endpoint where the chosen cluster is implemented.</p></li></ul><p id="-1509277031#z5fur0c_355">For example:</p><div class="detached code-block" id="-1509277031#z5fur0c_356"><pre><code class="language-bash">./chip-tool doorlock subscribe-event door-lock-alarm 5 10 1 1</code></pre></div></section></section><section class="detached"><h2 id="-1509277031#references" data-toc="references#CHIP-Tool.md-references">References</h2><ul class="list" id="-1509277031#z5fur0c_369" start="1"><li class="list-item" id="-1509277031#z5fur0c_370"><p>How to Install Matter on RPi (<a href="https://mattercoder.com/codelabs/how-to-install-matter-on-rpi/">https://mattercoder.com/codelabs/how-to-install-matter-on-rpi/</a>)</p></li><li class="list-item" id="-1509277031#z5fur0c_371"><p>Setting up the Matter Hub (Raspberry Pi) (<a href="https://docs.silabs.com/matter/latest/matter-thread/raspi-img">https://docs.silabs.com/matter/latest/matter-thread/raspi-img</a>)</p></li><li class="list-item" id="-1509277031#z5fur0c_372"><p>CHIP-Tool - Commissioning Device over BLE (<a href="https://github.com/project-chip/connectedhomeip/blob/master/examples/chip-tool/README.md#commission-a-device-over-ble">https://github.com/project-chip/connectedhomeip/blob/master/examples/chip-tool/README.md#commission-a-device-over-ble</a>)</p></li><li class="list-item" id="-1509277031#z5fur0c_373"><p>CHIP-tool Source Code (<a href="https://github.com/project-chip/connectedhomeip/tree/master/examples/chip-tool">https://github.com/project-chip/connectedhomeip/tree/master/examples/chip-tool</a>)</p></li><li class="list-item" id="-1509277031#z5fur0c_374"><p>Silicone Labs' Matter Commissioning Guide (<a href="https://docs.silabs.com/matter/2.2.1/matter-overview-guides/matter-commissioning">https://docs.silabs.com/matter/2.2.1/matter-overview-guides/matter-commissioning</a>)</p></li></ul></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-309902166">Orchestrator</h1><section class="detached"><h2 id="-309902166#overview" data-toc="overview#Orchestrator.md-overview">Overview</h2><p id="-309902166#u0yvqj_7"><span class="control" id="-309902166#u0yvqj_10">Orchestrators</span> drive system automation by establishing network infrastructure, integrating new devices, and continuously optimizing environmental conditions for plant growth.</p><p id="-309902166#u0yvqj_8">Orchestrators combine the key features of OpenThread CLI (<a href="#-1790576086#openthread-cli">&quot;OpenThread CLI&quot; in &quot;Thread&quot;</a>) and Matter Controller:</p><ul class="list" id="-309902166#u0yvqj_9" start="1"><li class="list-item" id="-309902166#u0yvqj_12"><p>Create and manage Thread (<a href="#-1790576086">Thread</a>) networks and commission (<a href="#1381824660">Thread Commissioning</a>) devices to join them.</p></li><li class="list-item" id="-309902166#u0yvqj_13"><p>Establish Matter (<a href="#-1997370655">Matter</a>) Fabrics and commission (<a href="#279346443">Matter Commissioning</a>) devices to join them.</p></li><li class="list-item" id="-309902166#u0yvqj_14"><p>Monitor sensor data from the Grow Chamber and adjust actuators in real time.</p></li></ul></section><section class="detached"><h2 id="-309902166#hardware" data-toc="hardware#Orchestrator.md-hardware">Hardware</h2><p id="-309902166#u0yvqj_19">The ESP32-C6 (<a href="#-1918844910#development-boards">&quot;Development Boards&quot; in &quot;Espressif&quot;</a>) supports both Thread and Wi-Fi protocols but cannot manage both communications at the same time. This limitation makes it unsuitable for use as a Thread Border Router. However, its dual-protocol support makes it ideal for functioning as an Orchestrator Device.</p></section><section class="detached"><h2 id="-309902166#firmware" data-toc="firmware#Orchestrator.md-firmware">Firmware</h2><p id="-309902166#u0yvqj_21">The firmware for the Orchestrator was developed using the ESP-IDF framework (<a href="#-1918844910#esp-idf-framework">&quot;ESP-IDF Framework&quot; in &quot;Espressif&quot;</a>).</p><section class="detached"><h3 id="-309902166#project-bootstrap" data-toc="project-bootstrap#Orchestrator.md-project-bootstrap">Project Bootstrap</h3><p id="-309902166#u0yvqj_28">Follow the following steps from the ESP32 Project Workflow (<a href="#-586960577">ESP32 Project Workflow</a>) guide:</p><ul class="list" id="-309902166#u0yvqj_29" start="1"><li class="list-item" id="-309902166#u0yvqj_31"><p>Step 1: Set Up ESP-IDF Environment (<a href="#-586960577#step-1-set-up-esp-idf-environment">&quot;Step 1: Set Up ESP-IDF Environment&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li><li class="list-item" id="-309902166#u0yvqj_32"><p>Step 2: Create a New Project (<a href="#-586960577#step-2-create-a-new-project">&quot;Step 2: Create a New Project&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li><li class="list-item" id="-309902166#u0yvqj_33"><p>Step 3: Set ESP32 as the target device (<a href="#-586960577#step-3-set-esp32-as-the-target-device">&quot;Step 3: Set ESP32 as the target device&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li><li class="list-item" id="-309902166#u0yvqj_34"><p>Step 4: Open the Project in CLion IDE (<a href="#-586960577#step-4-open-the-project-in-clion-ide">&quot;Step 4: Open the Project in CLion IDE&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li><li class="list-item" id="-309902166#u0yvqj_35"><p>Step 5: Create Default Configuration (<a href="#-586960577#step-5-create-default-configuration">&quot;Step 5: Create Default Configuration&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li><li class="list-item" id="-309902166#u0yvqj_36"><p>Step 6: Update CMakeLists.txt (<a href="#-586960577#step-6-update-cmakelists-txt">&quot;Step 6: Update CMakeLists.txt&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li></ul></section><section class="detached"><h3 id="-309902166#development-of-components" data-toc="development-of-components#Orchestrator.md-development-of-components">Development of Components</h3><p id="-309902166#u0yvqj_43">The following sections describe the development process of the components implemented in the Orchestrator firmware:</p><ul class="list" id="-309902166#u0yvqj_44" start="1"><li class="list-item" id="-309902166#u0yvqj_45"><p>Thread Interface (<a href="#-848609994">Thread Interface</a>)</p></li><li class="list-item" id="-309902166#u0yvqj_46"><p>Matter Interface (<a href="#773821741">Matter Interface</a>)</p></li></ul></section><section class="detached"><h3 id="-309902166#general-system-initialization" data-toc="general-system-initialization#Orchestrator.md-general-system-initialization">General System Initialization</h3><p id="-309902166#u0yvqj_49">The main function initializes the essential components:</p><ul class="list" id="-309902166#u0yvqj_50" start="1"><li class="list-item" id="-309902166#u0yvqj_51"><p>The NVS (<a href="https://docs.espressif.com/projects/esp-idf/en/stable/esp32/api-reference/storage/nvs_flash.html">https://docs.espressif.com/projects/esp-idf/en/stable/esp32/api-reference/storage/nvs_flash.html</a>) library stores key-value pairs in the device&rsquo;s flash memory.</p></li><li class="list-item" id="-309902166#u0yvqj_52"><p>The Event Loop (<a href="https://docs.espressif.com/projects/esp-idf/en/stable/esp32/api-reference/system/esp_event.html">https://docs.espressif.com/projects/esp-idf/en/stable/esp32/api-reference/system/esp_event.html</a>) allows components to declare events and register handlers, decoupling event producers from consumers. An event loop processes these events by invoking the appropriate handlers. The <span class="inline-code" id="-309902166#u0yvqj_55">default event loop</span> created by <span class="inline-code" id="-309902166#u0yvqj_56">esp_event_loop_create_default</span> is shared by multiple system components.</p></li></ul></section><section class="detached"><h3 id="-309902166#components-initialization" data-toc="components-initialization#Orchestrator.md-components-initialization">Components Initialization</h3><ul class="list" id="-309902166#u0yvqj_57" start="1"><li class="list-item" id="-309902166#u0yvqj_58"><p>Thread Interface (<a href="#-848609994">Thread Interface</a>)</p></li><li class="list-item" id="-309902166#u0yvqj_59"><p>Matter Interface (<a href="#773821741">Matter Interface</a>)</p></li></ul></section><section class="detached"><h3 id="-309902166#deployment" data-toc="deployment#Orchestrator.md-deployment">Deployment</h3><p id="-309902166#u0yvqj_62">Follow the following steps from the ESP32 Project Workflow (<a href="#-586960577">ESP32 Project Workflow</a>) guide:</p><ul class="list" id="-309902166#u0yvqj_63" start="1"><li class="list-item" id="-309902166#u0yvqj_65"><p>Step 7: Build the Project (<a href="#-586960577#step-7-build-the-project">&quot;Step 7: Build the Project&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li><li class="list-item" id="-309902166#u0yvqj_66"><p>Step 8: Determine Serial Port (<a href="#-586960577#step-8-determine-serial-port">&quot;Step 8: Determine Serial Port&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li><li class="list-item" id="-309902166#u0yvqj_67"><p>Step 9: Flash Project to Target (<a href="#-586960577#step-9-flash-project-to-target">&quot;Step 9: Flash Project to Target&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li><li class="list-item" id="-309902166#u0yvqj_68"><p>Step 10: Launch IDF Monitor (<a href="#-586960577#step-10-launch-idf-monitor">&quot;Step 10: Launch IDF Monitor&quot; in &quot;ESP32 Project Workflow&quot;</a>)</p></li></ul></section></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="-848609994">Thread Interface</h1><section class="detached"><h2 id="-848609994#overview" data-toc="overview#Thread-Interface.md-overview">Overview</h2><p id="-848609994#-3hxt5t_7">This section outlines the development of the <span class="control" id="-848609994#-3hxt5t_9">Thread Interface</span> component, which provides the features and functions to create Thread (<a href="#-1790576086">Thread</a>) networks and commission (<a href="#1381824660">Thread Commissioning</a>) devices to join them.</p><p id="-848609994#-3hxt5t_8">This component is part of the Orchestrator (<a href="#-309902166">Orchestrator</a>) firmware.</p></section><section class="detached"><h2 id="-848609994#development" data-toc="development#Thread-Interface.md-development">Development</h2><section class="detached"><h3 id="-848609994#bootstrapping-the-component" data-toc="bootstrapping-the-component#Thread-Interface.md-bootstrapping-the-component">Bootstrapping the Component</h3><p id="-848609994#-3hxt5t_15">The command below creates a new component named <span class="inline-code" id="-848609994#-3hxt5t_18">thread_interface</span> inside the <span class="inline-code" id="-848609994#-3hxt5t_19">components</span> directory.</p><div class="detached code-block" id="-848609994#-3hxt5t_16"><pre><code class="language-bash">idf.py create-component thread_interface -C components</code></pre></div><p id="-848609994#-3hxt5t_17">The <span class="inline-code" id="-848609994#-3hxt5t_20">CONFIG_OPENTHREAD_ENABLE</span> configuration option has to be set to <span class="inline-code" id="-848609994#-3hxt5t_21">y</span> in the <span class="inline-code" id="-848609994#-3hxt5t_22">sdkconfig.defaults</span> file in order to enable the OpenThread component.</p></section><section class="detached"><h3 id="-848609994#component-initialization" data-toc="component-initialization#Thread-Interface.md-component-initialization">Component Initialization</h3><p id="-848609994#-3hxt5t_23">The component encapsulates all OpenThread setup within a dedicated FreeRTOS task.</p><p id="-848609994#-3hxt5t_24">It initializes the essential components required for OpenThread operation:</p><ul class="list" id="-848609994#-3hxt5t_25" start="1"><li class="list-item" id="-848609994#-3hxt5t_28"><p>The Event VFS (<a href="https://docs.espressif.com/projects/esp-idf/en/stable/esp32/api-reference/storage/vfs.html#eventfd">https://docs.espressif.com/projects/esp-idf/en/stable/esp32/api-reference/storage/vfs.html#eventfd</a>) provides a lightweight mechanism for representing events as file descriptors, similar to Linux's eventfd, which enables tasks to signal and wait for events. It is part of the VFS (<a href="https://docs.espressif.com/projects/esp-idf/en/stable/esp32/api-reference/storage/vfs.html">https://docs.espressif.com/projects/esp-idf/en/stable/esp32/api-reference/storage/vfs.html</a>) Component that offers a unified interface for interacting with various file systems.</p></li><li class="list-item" id="-848609994#-3hxt5t_29"><p>The ESP-NETIF (<a href="https://docs.espressif.com/projects/esp-idf/en/stable/esp32/api-reference/network/esp_netif.html">https://docs.espressif.com/projects/esp-idf/en/stable/esp32/api-reference/network/esp_netif.html</a>) library is an abstraction layer that provides thread-safe APIs for managing network interfaces on top of a TCP/IP stack.</p></li></ul><p id="-848609994#-3hxt5t_26">It initializes the OpenThread stack using default radio, host, and port configurations, creates an OpenThread network interface via <span class="inline-code" id="-848609994#-3hxt5t_33">esp_netif</span>, and sets up additional features such as the CLI (<a href="#-1790576086#openthread-cli">&quot;OpenThread CLI&quot; in &quot;Thread&quot;</a>) and state indicator when enabled.</p><p id="-848609994#-3hxt5t_27">Once configured, it launches the OpenThread main loop and performs cleanup upon completion.</p></section></section><section class="detached"><h2 id="-848609994#references" data-toc="references#Thread-Interface.md-references">References</h2><p id="-848609994#-3hxt5t_35">OpenThread SDK:</p><ul class="list" id="-848609994#-3hxt5t_36" start="1"><li class="list-item" id="-848609994#-3hxt5t_39"><p>How to Write an OpenThread Application (<a href="https://docs.espressif.com/projects/esp-idf/en/stable/esp32/api-guides/openthread.html#how-to-write-an-openthread-application">https://docs.espressif.com/projects/esp-idf/en/stable/esp32/api-guides/openthread.html#how-to-write-an-openthread-application</a>)</p></li></ul><p id="-848609994#-3hxt5t_37">Android SDK</p><ul class="list" id="-848609994#-3hxt5t_38" start="1"><li class="list-item" id="-848609994#-3hxt5t_41"><p>Android Thread Commissioner (<a href="https://github.com/openthread/ot-commissioner/tree/main/android">https://github.com/openthread/ot-commissioner/tree/main/android</a>)</p></li><li class="list-item" id="-848609994#-3hxt5t_42"><p>Thread Network SDK for Android (<a href="https://developers.home.google.com/thread">https://developers.home.google.com/thread</a>)</p></li></ul></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="773821741">Matter Interface</h1><section class="detached"><h2 id="773821741#reading" data-toc="reading#Matter-Interface.md-reading">Reading</h2><div class="detached code-block" id="773821741#-vkyo1k_5"><pre><code class="language-cpp">#include &quot;esp_matter_controller_read_command.h&quot;
#include &quot;esp_matter_client.h&quot;

void response_callback(const esp_matter::client::response_t *response, void *priv_data)
{
    // Process the response data
    if (response-&gt;status == ESP_OK) {
    // Handle successful response
    } else {
    // Handle error
    }
}

void client_request_callback(peer_device_t *peer_device, request_handle_t *req_handle, void *priv_data)
{
    if (req_handle-&gt;type == READ_ATTR) {
    esp_matter::client::interaction::read::send_request(peer_device, &amp;req_handle-&gt;attribute_path, 1, NULL, 0, response_callback);
    }
}

esp_matter::client::set_request_callback(client_request_callback, NULL);</code></pre></div></section><section class="detached"><h2 id="773821741#references" data-toc="references#Matter-Interface.md-references">References</h2><ul class="list" id="773821741#-vkyo1k_6" start="1"><li class="list-item" id="773821741#-vkyo1k_7"><p>ESP-Matter Controller Example (<a href="https://github.com/espressif/esp-matter/tree/main/examples/controller">https://github.com/espressif/esp-matter/tree/main/examples/controller</a>)</p></li><li class="list-item" id="773821741#-vkyo1k_8"><p>ESP-Matter Controller Docs (<a href="https://docs.espressif.com/projects/esp-matter/en/latest/esp32/developing.html#matter-controller">https://docs.espressif.com/projects/esp-matter/en/latest/esp32/developing.html#matter-controller</a>)</p></li><li class="list-item" id="773821741#-vkyo1k_9"><p>ESP-Matter Controller Component (<a href="https://github.com/espressif/esp-matter/tree/main/components/esp_matter_controller/commands">https://github.com/espressif/esp-matter/tree/main/components/esp_matter_controller/commands</a>)</p></li></ul></section></article></div></section><section class="topic"><div><article class="article"><h1 class="main-title" id="561613140">Control Panel</h1><section class="detached"><h2 id="561613140#overview" data-toc="overview#Control-Panel.md-overview">Overview</h2><p id="561613140#-5z13z_4">A <span class="control" id="561613140#-5z13z_6">Control Panel</span> is a GUI application that farmers use to configure and manage system components, as well as monitor and adjust environmental conditions.</p><p id="561613140#-5z13z_5">The environment can be configured for specific crops. When setting up a new plant, farmers can choose from predefined parameters suited to that crop. As the plant grows, they can manually adjust settings.</p></section></article></div></section></div></body></html>